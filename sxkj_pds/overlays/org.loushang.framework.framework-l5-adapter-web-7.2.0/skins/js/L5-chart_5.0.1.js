
var svgRoot=document.getElementsByTagName('svg').item(0);var titleGroup=document.createElementNS("http://www.w3.org/2000/svg","g");svgRoot.appendChild(titleGroup);var titleText=document.createElementNS("http://www.w3.org/2000/svg","text");titleGroup.appendChild(titleText);titleText.setAttribute("id","title");titleText.setAttribute("font-family","SimSun");titleText.setAttribute("font-size","20");titleText.setAttribute("transform","translate(300,50)");titleText.setAttribute("style","font-weight:bold;text-anchor:middle;font-size:20");var timeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");svgRoot.appendChild(timeGroup);timeGroup.setAttribute("id","skeleton");var timeText=document.createElementNS("http://www.w3.org/2000/svg","text");timeGroup.appendChild(timeText);timeText.setAttribute("id","updateTime");timeText.setAttribute("font-family","SimSun");timeText.setAttribute("font-size","14");timeText.setAttribute("transform","translate(180, 480)");var chart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.setAttribute("id","chart");chart.setAttribute("transform","translate(100, 340)");svgRoot.appendChild(chart);var backGroup=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(backGroup);backGroup.setAttribute("id","backGroup");var des=document.createElementNS("http://www.w3.org/2000/svg","g");svgRoot.appendChild(des);des.setAttribute("id","des");var deslist=document.createElementNS("http://www.w3.org/2000/svg","g");des.appendChild(deslist);deslist.setAttribute("id","deslist");deslist.setAttribute("transform","translate(600,80)");var destext=document.createElementNS("http://www.w3.org/2000/svg","g");des.appendChild(destext);destext.setAttribute("id","destext");destext.setAttribute("font-family","SimSun");destext.setAttribute("font-size","12");destext.setAttribute("transform","translate(620,89)");var defs=document.createElementNS("http://www.w3.org/2000/svg","defs");svgRoot.appendChild(defs);var filter=document.createElementNS("http://www.w3.org/2000/svg","filter");defs.appendChild(filter);filter.setAttribute("id","DropShadowFilter");filter.setAttribute("filterUnits","objectBoundingBox");filter.setAttribute("x","-10%");filter.setAttribute("y","-10%");filter.setAttribute("width","120%");filter.setAttribute("height","120%");var feGaussianBlur=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");filter.appendChild(feGaussianBlur);feGaussianBlur.setAttribute("in","SourceAlpha");feGaussianBlur.setAttribute("stdDeviation","2");feGaussianBlur.setAttribute("result","BlurAlpha");var feOffset=document.createElementNS("http://www.w3.org/2000/svg","feOffset");filter.appendChild(feOffset);feOffset.setAttribute("in","BlurAlpha");feOffset.setAttribute("dx","4");feOffset.setAttribute("dy","4");feOffset.setAttribute("result","OffsetBlurAlpha");var feMerge=document.createElementNS("http://www.w3.org/2000/svg","feMerge");filter.appendChild(feMerge);var feMergeNode1=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");feMerge.appendChild(feMergeNode1);feMergeNode1.setAttribute("in","OffsetBlurAlpha");var feMergeNode2=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");feMerge.appendChild(feMergeNode2);feMergeNode2.setAttribute("in","SourceGraphic");var defsLinearGrad=document.createElementNS("http://www.w3.org/2000/svg","defs");svgRoot.appendChild(defsLinearGrad);var linearGrad=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");defsLinearGrad.appendChild(linearGrad);linearGrad.setAttribute("id","linearGrad");linearGrad.setAttribute("gradientUnits","userSpaceOnUse");var defsMenu=document.createElementNS("http://www.w3.org/2000/svg","defs");svgRoot.appendChild(defsMenu);var menuId=document.createElementNS("http://www.w3.org/2000/svg","menu");defsMenu.appendChild(menuId);menuId.setAttribute("id","myContextMenu");var header=document.createElementNS("http://www.w3.org/2000/svg","header");menuId.appendChild(header);var headerValue=document.createTextNode("Custom Menu");header.appendChild(headerValue);var item=document.createElementNS("http://www.w3.org/2000/svg","item");menuId.appendChild(item);item.setAttribute("id","About");item.setAttribute("action","About");var itemValue=document.createTextNode("about Adobe SVG Viewer");item.appendChild(itemValue);var seq=0;function BaseChart(){this.id=seq++;this.count=0;this.title="";this.xAxisTitle="";this.yAxisTitle="";this.dataUrl=null;this.doc=document;this.colors=["#FF7744","#C2A00E","#66FFCC","#FF66CC","#3399CC","#C2CC0E","#CC99FF","#71A214","#FFCC66","#CCFF66"];this.backgroudColors=null;this.xLineColor=null;this.yLineColor=null;this.currentColor=0;this.chartEleGroup=[];this.desList=new Array();this.desTextList=new Array();this.coordType=0;this.maxSize=0;this.showScrool=false;this.data=null;window[this.id]=this;}
BaseChart.prototype.show=function(showLegend,showTime){this.initSvg();this.drawChart(showLegend,showTime);this.drawMenu();}
BaseChart.prototype.getColor=function(){var color=this.colors[this.currentColor];this.currentColor++;if(this.currentColor>=this.colors.length){this.currentColor=0;}
return color;}
BaseChart.prototype.setColors=function(colors){this.colors=colors;}
BaseChart.prototype.getBackgroudColors=function(){return this.backgroudColors;}
BaseChart.prototype.setBackgroudColors=function(){this.backgroudColors=["#FFFFFF","#FFAA33","#EE7700"];}
BaseChart.prototype.customBackgroudColors=function(colorArray){this.backgroudColors=colorArray;}
BaseChart.prototype.getWebPath=function(){var paths=top.document.location.pathname.split("/");var webPaht="";if(paths[0]==''){webPath="/"+paths[1];}else{webPath="/"+paths[0];}
return webPath;}
BaseChart.prototype.setTitle=function(title){this.title=title;}
BaseChart.prototype.setXAxisTitle=function(xAxisTitle){this.xAxisTitle=xAxisTitle}
BaseChart.prototype.setYAxisTitle=function(yAxisTitle){this.yAxisTitle=yAxisTitle;}
BaseChart.prototype.initSvg=function(){}
BaseChart.prototype.getDoc=function(){return this.doc;}
BaseChart.prototype.setDataUrl=function(url){this.dataUrl=url;}
BaseChart.prototype.setChartData=function(data){this.data=data;}
BaseChart.prototype.getChartData=function(){if(this.data){return this.data;}
if(this.dataUrl){this.data=BaseChart.requestData(this.dataUrl);}
return this.data;}
BaseChart.prototype.drawChart=function(showLegend,showTime){this.setTextNodeValue("title",this.title);if(this.coordType==0){var data=this.getChartData();this.count=data.length;for(i=0;i<data.length;i++){var dataName=data[i].name;var dataValue=Number(data[i].value);this.addChartItem(showLegend,dataValue,dataName,false,this.count,i);}}else if(this.coordType==1){var data=this.getChartData();this.count=data.length;if(this.count>10){if(this.showScrool){createScrool(this.count,this.eleWidth,this.spaceWidth,this.chartWidth);}}
for(i=0;i<data.length;i++){var dataName=data[i].name;var dataValue=data[i].value;this.addChartItem(showLegend,dataValue,dataName,false,this.count,i);}
this.createCoord(this.count);}else if(this.coordType==2){var data=this.getChartData();this.count=data.length;for(i=0;i<data.length;i++){var dataName=data[i].name;var dataLeftValue=Number(data[i].leftValue);var dataRightValue=Number(data[i].rightValue);this.addChartItemLeft(showLegend,dataLeftValue,dataName,false,this.count,i);this.addChartItemRight(showLegend,dataRightValue,false,this.count,i);}
if(this.count>6){if(this.showScrool){createScrool(this.count,this.eleWidth,this.spaceWidth,this.chartWidth);}}
this.createCoord(this.count);if((this.leftColors.length==1)&&showLegend){this.createDualAxisDes();}}else if(this.coordType==3){var data=this.getChartData();this.count=data.length;for(i=0;i<data.length;i++){var dataComboName=data[i].comboName;var dataGroupName=data[i].groupName;var dataValue=data[i].value;this.addChartItem(showLegend,dataValue,dataComboName,dataGroupName,false,this.count,i);}
if(this.count*dataGroupName.length>10){if(this.showScrool){createScrool(this.count*dataGroupName.length,this.eleWidth,this.spaceWidth,this.chartWidth);}}
this.createCoord(this.count);}
if(showTime){this.refeshDateTime();}}
BaseChart.prototype.createCoord=function(count){this.drawAsixCoord();this.setCoordBack();this.drawCoordLines(count);}
BaseChart.prototype.getMaxValue=function(){var data=this.getChartData();for(i=0;i<data.length;i++){var dataValue=Number(data[i].value);if(dataValue>this.maxSize){this.maxSize=dataValue;}}}
BaseChart.prototype.drawAsixCoord=function(){var asixGroup=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(asixGroup);asixGroup.setAttribute("id","asixGroup");var asixPath=document.createElementNS("http://www.w3.org/2000/svg","path");asixGroup.appendChild(asixPath);asixPath.setAttribute("d","M0,0H-5 0V-240 h -5 10 -5 V 0H396 0");asixPath.setAttribute("style","fill:none;stroke:black;filter:url(#DropShadowFilter)");var gradUnit=this.chartHeight/10;this.getMaxValue();for(var i=10;i>=0;i--){var gradValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradValue.appendChild(this.getDoc().createTextNode(this.getTotalGrad(this.maxSize)-this.getTotalGrad(this.maxSize)/10*i+"-"));gradValue.setAttribute("transform","translate(-30,"+(gradUnit*i-236)+")");asixGroup.appendChild(gradValue);}
var gradXAsixName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradXAsixName.setAttribute("id","xAxisTitle");gradXAsixName.setAttribute("font-family","SimSun");asixGroup.appendChild(gradXAsixName);this.setTextNodeValue("xAxisTitle",this.xAxisTitle);gradXAsixName.setAttribute("style","text-anchor:middle;font-weight:normal;font-size:14");gradXAsixName.setAttribute("transform","translate(-20,34)");var gradLeftName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradLeftName.setAttribute("id","yAxisTitle");gradLeftName.setAttribute("font-family","SimSun");asixGroup.appendChild(gradLeftName);this.setTextNodeValue("yAxisTitle",this.yAxisTitle);gradLeftName.setAttribute("style","text-anchor:middle;font-weight:normal;font-size:14");gradLeftName.setAttribute("transform","translate(-30,-256)");}
BaseChart.prototype.setCoordBack=function(){if(this.getBackgroudColors()){var rect=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');rect.setAttribute("x",0);rect.setAttribute("y",-240);rect.setAttribute("width",this.chartWidth);rect.setAttribute("height",this.chartHeight);this.doc.getElementById("backGroup").appendChild(rect);if(this.getBackgroudColors().length==1){rect.setAttribute("fill",this.getBackgroudColors()[0]);}else if(this.getBackgroudColors().length==3){var bc0=this.getBackgroudColors()[0];var bc1=this.getBackgroudColors()[1];var bc2=this.getBackgroudColors()[2];var stop1=document.createElementNS("http://www.w3.org/2000/svg","stop");linearGrad.appendChild(stop1);stop1.setAttribute("stop-color",bc0);stop1.setAttribute("offset","0%");var stop2=document.createElementNS("http://www.w3.org/2000/svg","stop");linearGrad.appendChild(stop2);stop2.setAttribute("stop-color",bc1);stop2.setAttribute("offset","30%");var stop3=document.createElementNS("http://www.w3.org/2000/svg","stop");linearGrad.appendChild(stop3);stop3.setAttribute("stop-color",bc2);stop3.setAttribute("offset","60%");rect.setAttribute("fill","url(#linearGrad)");}}}
BaseChart.prototype.setCoordLineColor=function(xLineColor,yLineColor){this.xLineColor=xLineColor;this.yLineColor=yLineColor;}
BaseChart.prototype.drawCoordLines=function(count){var xx=0;var yy=0;if(this.xLineColor){for(var t=0;t<=10;t++){yy=-this.chartHeight/10*t;var xline=this.getDoc().createElementNS('http://www.w3.org/2000/svg','line');xline.setAttribute("style","stroke-width:0.5;stroke:"+this.xLineColor);xline.setAttribute("x1",0);xline.setAttribute("y1",yy);xline.setAttribute("x2",this.chartWidth);xline.setAttribute("y2",yy);this.doc.getElementById("backGroup").appendChild(xline);}
var yline=this.getDoc().createElementNS('http://www.w3.org/2000/svg','line');yline.setAttribute("style","stroke-width:0.2;stroke:"+this.xLineColor);yline.setAttribute("x1",this.chartWidth);yline.setAttribute("y1",0);yline.setAttribute("x2",this.chartWidth);yline.setAttribute("y2",-this.chartHeight);this.doc.getElementById("backGroup").appendChild(yline);}
if(this.yLineColor){for(var m=0;m<count;m++){xx=this.chartWidth/(count-1)*m
var yline=this.getDoc().createElementNS('http://www.w3.org/2000/svg','line');yline.setAttribute("style","stroke-width:0.2;stroke:"+this.yLineColor);yline.setAttribute("x1",xx);yline.setAttribute("y1",0);yline.setAttribute("x2",xx);yline.setAttribute("y2",-this.chartHeight);this.doc.getElementById("backGroup").appendChild(yline);}}}
BaseChart.prototype.createDesList=function(DesListGroup,DesTextGroup,EleID,EleName,EleColor){var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');ele.setAttribute("transform","translate(0,"+18*EleID+")");ele.setAttribute("width","10");ele.setAttribute("height","10");ele.setAttribute("style","stroke:white;fill:"+EleColor);this.getDoc().getElementById(DesListGroup).appendChild(ele);var ele2=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');ele2.setAttribute("transform","translate(0,"+18*EleID+")");ele2.appendChild(this.getDoc().createTextNode(EleName));this.getDoc().getElementById(DesTextGroup).appendChild(ele2);}
BaseChart.prototype.refeshDateTime=function(){var datetime,temp,date,time;datetime=new Date().toLocaleString();temp=datetime.lastIndexOf(" ");date=datetime.substring(0,temp);time=datetime.substring(temp+1,datetime.length);this.setTextNodeValue("updateTime","数据更新时间: "+date+" "+time);}
BaseChart.prototype.setLinearGrad=function(index,color){var linearGrad=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");defsLinearGrad.appendChild(linearGrad);linearGrad.setAttribute("x1","0%");linearGrad.setAttribute("y1","0%");linearGrad.setAttribute("x2","0%");linearGrad.setAttribute("y2","100%");linearGrad.setAttribute("id","linearGrad"+index);linearGrad.setAttribute("gradientUnits","objectBoundingBox");var stop1=document.createElementNS("http://www.w3.org/2000/svg","stop");linearGrad.appendChild(stop1);stop1.setAttribute("stop-color",color);stop1.setAttribute("offset","10%");stop1.setAttribute("stop-opacity",0.5);var stop2=document.createElementNS("http://www.w3.org/2000/svg","stop");linearGrad.appendChild(stop2);stop2.setAttribute("stop-color",color);stop2.setAttribute("stop-opacity",1);stop2.setAttribute("offset","90%");}
BaseChart.prototype.setTextNodeValue=function(id,value){if(this.doc.getElementById(id).hasChildNodes()==true){var a=this.doc.getElementById(id);var b=a.firstChild;b.nodeValue=value;}
else{var item=this.doc.createTextNode(value)
this.doc.getElementById(id).appendChild(item);}}
BaseChart.prototype.getTotalGrad=function(maxSize){var a=Number(maxSize%10);var b=Math.floor(maxSize/10);var c=0;c=b+(10-b%10);var totalGrad=c*10;return totalGrad;}
BaseChart.prototype.addEvent=function(evtName,func){var EleList=this.chartEleGroup.childNodes;for(var i=0;i<EleList.length;i++){objet=EleList.item(i);var pre=objet.getAttribute(evtName);if(!pre){objet.setAttribute(evtName,func);}else{objet.setAttribute(evtName,pre+";"+func);}}}
BaseChart.prototype.modifyEvent=function(evtName,func){var EleList=this.chartEleGroup.childNodes;for(var i=0;i<EleList.length;i++){objet=EleList.item(i);objet.setAttribute(evtName,func);}}
BaseChart.prototype.drawMenu=function(){if(window.navigator.appName.match(/Adobe/gi)){var newMenuRoot=parseXML(printNode(document.getElementById('myContextMenu')),contextMenu);contextMenu.replaceChild(newMenuRoot.firstChild,contextMenu.firstChild);}}
BaseChart.msxmlNames=["MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];BaseChart.createXHR=function(){if(BaseChart.httpObjectName){try{if(BaseChart.httpObjectName=="XMLHttpRequest"){return new XMLHttpRequest();}else{return new ActiveXObject(BaseChart.httpObjectName);}}catch(e){BaseChart.httpObjectName=null;}}
try{BaseChart.httpObjectName="XMLHttpRequest";return new XMLHttpRequest();}catch(e){}
for(var i=0;i<JSONRpcClient.msxmlNames.length;i++){try{JSONRpcClient.httpObjectName=JSONRpcClient.msxmlNames[i];return new ActiveXObject(JSONRpcClient.msxmlNames[i]);}catch(e){}}
BaseChart.httpObjectName=null;throw new Error("Can't create XMLHttpRequest object");};BaseChart.requestData=function(url){var xhr=BaseChart.createXHR();if(xhr!=null){xhr.open("GET",url,false);xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.send();return eval("("+xhr.responseText+")");}};BaseChart.drawScrool=function(){var coverRect1=document.createElementNS("http://www.w3.org/2000/svg","rect");chart.appendChild(coverRect1);coverRect1.setAttribute("id","hiddenrectleft");coverRect1.setAttribute("transform","translate(-1000, -500)");coverRect1.setAttribute("width","1000");coverRect1.setAttribute("height","620");coverRect1.setAttribute("style","fill:white;stroke:none");var coverRect2=document.createElementNS("http://www.w3.org/2000/svg","rect");chart.appendChild(coverRect2);coverRect2.setAttribute("id","hiddenrectright");coverRect2.setAttribute("transform","translate(398, -500)");coverRect2.setAttribute("width","1000");coverRect2.setAttribute("height","506");coverRect2.setAttribute("style","fill:white;stroke:none");var coverRect3=document.createElementNS("http://www.w3.org/2000/svg","rect");chart.appendChild(coverRect3);coverRect3.setAttribute("id","hiddenrectright2");coverRect3.setAttribute("transform","translate(402, 0)");coverRect3.setAttribute("width","1000");coverRect3.setAttribute("height","100");coverRect3.setAttribute("style","fill:white;stroke:none");var scrool=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(scrool);scrool.setAttribute("id","scrool");}
var myMapApp=null;function createScrool(count,eleWidth,eleSpace,chartWidth){BaseChart.drawScrool();myMapApp=new mapApp(false,undefined);var scrollbarStyles={"fill":"whitesmoke","stroke":"dimgray","stroke-width":1};var scrollerStyles={"fill":"lightgray","stroke":"dimgray","stroke-width":1};var triangleStyles={"fill":"dimgray"};var highlightStyles={"fill":"dimgray","stroke":"dimgray","stroke-width":1};var sw=chartWidth-(eleWidth*count+eleSpace*count);scrolledObject1=new scrolledObject("parentChart",0,sw,0,-300,"sb1horiz","sb1vert");myMapApp.scrollbars["sb1horiz"]=new scrollbar("sb1horiz","scrool",-30,60,446,15,scrolledObject1.maxX,scrolledObject1.minX,0.2495,0,0.005,"top_bottom",scrollbarStyles,scrollerStyles,triangleStyles,highlightStyles,scrolledObject1);return myMapApp;}
function scrolledObject(contentId,maxX,minX,maxY,minY,sbXId,sbYId){this.content=document.getElementById(contentId);this.transX=0;this.transY=0;this.maxX=maxX;this.minX=minX;this.maxY=maxY;this.minY=minY;this.sbXId=sbXId;this.sbYId=sbYId;this.panActive=false;this.parent=this.content.parentNode;}
scrolledObject.prototype.scrollbarChanged=function(id,changeType,valueAbs,valuePerc){if(changeType=="scrollChange"||"scrolledStep"){if(id.match(/horiz/gi)){this.transX=valueAbs;}
if(id.match(/vert/gi)){this.transY=valueAbs;}
this.content.setAttributeNS(null,"transform","translate("+this.transX+","+this.transY+")");}}
scrolledObject.prototype.handleEvent=function(evt){if(evt.type=="mousedown"){this.coords=myMapApp.calcCoord(evt,this.parent);this.panActive=true;}
if(evt.type=="mousemove"&&this.panActive){var coords=myMapApp.calcCoord(evt,this.parent);this.transX+=coords.x-this.coords.x;this.transY+=coords.y-this.coords.y;if(this.transX<this.minX){this.transX=this.minX;}
if(this.transX>this.maxX){this.transX=this.maxX;}
if(this.transY<this.minY){this.transY=this.minY;}
if(this.transY>this.maxY){this.transY=this.maxY;}
this.content.setAttributeNS(null,"transform","translate("+this.transX+","+this.transY+")");if(myMapApp.scrollbars[this.sbXId]){myMapApp.scrollbars[this.sbXId].scrollToValue(this.transX);}
if(myMapApp.scrollbars[this.sbYId]){myMapApp.scrollbars[this.sbYId].scrollToValue(this.transY);}
this.coords=coords;}
if(evt.type=="mouseup"||evt.type=="mouseout"){this.panActive=false;}
evt.preventDefault();}

function mapApp(adjustVBonWindowResize,resizeCallbackFunction){this.adjustVBonWindowResize=adjustVBonWindowResize;this.resizeCallbackFunction=resizeCallbackFunction;this.initialized=false;if(!document.documentElement.getScreenCTM){document.documentElement.addEventListener("SVGScroll",this,false);document.documentElement.addEventListener("SVGZoom",this,false);}
try{window.addEventListener("resize",this,false);}
catch(er){document.documentElement.addEventListener("SVGResize",this,false);}
this.navigator="Batik";if(window.navigator){if(window.navigator.appName.match(/Adobe/gi)){this.navigator="Adobe";}
if(window.navigator.appName.match(/Netscape/gi)){this.navigator="Mozilla";}
if(window.navigator.userAgent){if(window.navigator.userAgent.match(/Opera/gi)){this.navigator="Opera";}
if(window.navigator.userAgent.match(/AppleWebKit/gi)||window.navigator.userAgent.match(/Safari/gi)){this.navigator="Safari";}}}
this.resetFactors();this.tooltipsEnabled=false;this.Windows=new Array();this.checkBoxes=new Array();this.radioButtonGroups=new Array();this.tabgroups=new Array();this.textboxes=new Array();this.buttons=new Array();this.selectionLists=new Array();this.comboboxes=new Array();this.sliders=new Array();this.scrollbars=new Array();this.colourPickers=new Array();this.htmlAreas=new Array();this.tables=new Array();}
mapApp.prototype.handleEvent=function(evt){if(evt.type=="SVGResize"||evt.type=="resize"||evt.type=="SVGScroll"||evt.type=="SVGZoom"){this.resetFactors();}
if((evt.type=="mouseover"||evt.type=="mouseout"||evt.type=="mousemove")&&this.tooltipsEnabled){this.displayTooltip(evt);}}
mapApp.prototype.resetFactors=function(){if(window.innerWidth){this.innerWidth=window.innerWidth;this.innerHeight=window.innerHeight;}
else{var viewPort=document.documentElement.viewport;this.innerWidth=viewPort.width;this.innerHeight=viewPort.height;}
if(this.adjustVBonWindowResize){this.adjustViewBox();}
if(!document.documentElement.getScreenCTM){var svgroot=document.documentElement;this.viewBox=new ViewBox(svgroot);var trans=svgroot.currentTranslate;var scale=svgroot.currentScale;this.m=this.viewBox.getTM();this.m=this.m.scale(1/scale);this.m=this.m.translate(-trans.x,-trans.y);}
if(this.resizeCallbackFunction&&this.initialized){if(typeof(this.resizeCallbackFunction)=="function"){this.resizeCallbackFunction();}}
this.initialized=true;}
mapApp.prototype.adjustViewBox=function(){document.documentElement.setAttributeNS(null,"viewBox","0 0 "+this.innerWidth+" "+this.innerHeight);}
mapApp.prototype.calcCoord=function(evt,ctmNode){var svgPoint=document.documentElement.createSVGPoint();svgPoint.x=evt.clientX;svgPoint.y=evt.clientY;if(!document.documentElement.getScreenCTM){if(ctmNode){var matrix=getTransformToRootElement(ctmNode);}
else{var matrix=getTransformToRootElement(evt.target);}
svgPoint=svgPoint.matrixTransform(matrix.inverse().multiply(this.m));}
else{if(ctmNode){var matrix=ctmNode.getScreenCTM();}
else{var matrix=evt.target.getScreenCTM();}
svgPoint=svgPoint.matrixTransform(matrix.inverse());}
return svgPoint;}
mapApp.prototype.calcInvCoord=function(svgPoint){if(!document.documentElement.getScreenCTM){var matrix=getTransformToRootElement(document.documentElement);}
else{var matrix=document.documentElement.getScreenCTM();}
svgPoint=svgPoint.matrixTransform(matrix);return svgPoint;}
mapApp.prototype.initTooltips=function(groupId,tooltipTextAttribs,tooltipRectAttribs,xOffset,yOffset,padding){var nrArguments=6;if(arguments.length==nrArguments){this.toolTipGroup=document.getElementById(groupId);this.tooltipTextAttribs=tooltipTextAttribs;if(!this.tooltipTextAttribs["font-size"]){this.tooltipTextAttribs["font-size"]=12;}
this.tooltipRectAttribs=tooltipRectAttribs;this.xOffset=xOffset;this.yOffset=yOffset;this.padding=padding;if(!this.toolTipGroup){alert("Error: could not find tooltip group with id '"+groupId+"'. Please specify a correct tooltip parent group id!");}
else{this.toolTipGroup.setAttributeNS(null,"visibility","hidden");this.toolTipGroup.setAttributeNS(null,"pointer-events","none");this.tooltipsEnabled=true;this.tooltipText=document.createElementNS(svgNS,"text");for(var attrib in this.tooltipTextAttribs){value=this.tooltipTextAttribs[attrib];if(attrib=="font-size"){value+="px";}
this.tooltipText.setAttributeNS(null,attrib,value);}
var textNode=document.createTextNode("Tooltip");this.tooltipText.appendChild(textNode);this.toolTipGroup.appendChild(this.tooltipText);var bbox=this.tooltipText.getBBox();this.tooltipRect=document.createElementNS(svgNS,"rect");this.tooltipRect.setAttributeNS(null,"x",bbox.x-this.padding);this.tooltipRect.setAttributeNS(null,"y",bbox.y-this.padding);this.tooltipRect.setAttributeNS(null,"width",bbox.width+this.padding*2);this.tooltipRect.setAttributeNS(null,"height",bbox.height+this.padding*2);for(var attrib in this.tooltipRectAttribs){this.tooltipRect.setAttributeNS(null,attrib,this.tooltipRectAttribs[attrib]);}
this.toolTipGroup.insertBefore(this.tooltipRect,this.tooltipText);}}
else{alert("Error in method 'initTooltips': wrong nr of arguments! You have to pass over "+nrArguments+" parameters.");}}
mapApp.prototype.addTooltip=function(tooltipNode,tooltipTextvalue,followmouse,checkForUpdates,targetOrCurrentTarget,childAttrib){var nrArguments=6;if(arguments.length==nrArguments){if(typeof(tooltipNode)=="string"){tooltipNode=document.getElementById(tooltipNode);}
if(!tooltipNode.hasAttributeNS(attribNS,"tooltip")){if(tooltipTextvalue){tooltipNode.setAttributeNS(attribNS,"tooltip",tooltipTextvalue);}
else{tooltipNode.setAttributeNS(attribNS,"tooltip","Tooltip");}}
if(checkForUpdates){tooltipNode.setAttributeNS(attribNS,"tooltipUpdates","true");}
if(targetOrCurrentTarget=="target"){tooltipNode.setAttributeNS(attribNS,"tooltipParent","true");}
if(childAttrib){tooltipNode.setAttributeNS(attribNS,"tooltipAttrib",childAttrib);}
tooltipNode.addEventListener("mouseover",this,false);tooltipNode.addEventListener("mouseout",this,false);if(followmouse){tooltipNode.addEventListener("mousemove",this,false);}}
else{alert("Error in method 'addTooltip()': wrong nr of arguments! You have to pass over "+nrArguments+" parameters.");}}
mapApp.prototype.displayTooltip=function(evt){var curEl=evt.currentTarget;var coords=this.calcCoord(evt,this.toolTipGroup.parentNode);if(evt.type=="mouseover"){this.toolTipGroup.setAttributeNS(null,"visibility","visible");this.toolTipGroup.setAttributeNS(null,"transform","translate("+(coords.x+this.xOffset)+","+(coords.y+this.yOffset)+")");this.updateTooltip(evt);}
if(evt.type=="mouseout"){this.toolTipGroup.setAttributeNS(null,"visibility","hidden");}
if(evt.type=="mousemove"){this.toolTipGroup.setAttributeNS(null,"transform","translate("+(coords.x+this.xOffset)+","+(coords.y+this.yOffset)+")");if(curEl.hasAttributeNS(attribNS,"tooltipUpdates")){this.updateTooltip(evt);}}}
mapApp.prototype.updateTooltip=function(evt){var el=evt.currentTarget;if(el.hasAttributeNS(attribNS,"tooltipParent")){var attribName="tooltip";if(el.hasAttributeNS(attribNS,"tooltipAttrib")){attribName=el.getAttributeNS(attribNS,"tooltipAttrib");}
el=evt.target;var myText=el.getAttributeNS(attribNS,attribName);}
else{var myText=el.getAttributeNS(attribNS,"tooltip");}
if(myText){var textArray=myText.split("\\n");while(this.tooltipText.hasChildNodes()){this.tooltipText.removeChild(this.tooltipText.lastChild);}
for(var i=0;i<textArray.length;i++){var tspanEl=document.createElementNS(svgNS,"tspan");tspanEl.setAttributeNS(null,"x",0);var dy=this.tooltipTextAttribs["font-size"];if(i==0){var dy=0;}
tspanEl.setAttributeNS(null,"dy",dy);var textNode=document.createTextNode(textArray[i]);tspanEl.appendChild(textNode);this.tooltipText.appendChild(tspanEl);}
var bbox=this.tooltipText.getBBox();this.tooltipRect.setAttributeNS(null,"x",bbox.x-this.padding);this.tooltipRect.setAttributeNS(null,"y",bbox.y-this.padding);this.tooltipRect.setAttributeNS(null,"width",bbox.width+this.padding*2);this.tooltipRect.setAttributeNS(null,"height",bbox.height+this.padding*2);}
else{this.toolTipGroup.setAttributeNS(null,"visibility","hidden");}}
mapApp.prototype.enableTooltips=function(){this.tooltipsEnabled=true;}
mapApp.prototype.disableTooltips=function(){this.tooltipsEnabled=false;this.toolTipGroup.setAttributeNS(null,"visibility","hidden");}
ViewBox.VERSION="1.0";function ViewBox(svgNode){if(arguments.length>0){this.init(svgNode);}}
ViewBox.prototype.init=function(svgNode){var viewBox=svgNode.getAttributeNS(null,"viewBox");var preserveAspectRatio=svgNode.getAttributeNS(null,"preserveAspectRatio");if(viewBox!=""){var params=viewBox.split(/\s*,\s*|\s+/);this.x=parseFloat(params[0]);this.y=parseFloat(params[1]);this.width=parseFloat(params[2]);this.height=parseFloat(params[3]);}else{this.x=0;this.y=0;this.width=innerWidth;this.height=innerHeight;}
this.setPAR(preserveAspectRatio);var dummy=this.getTM();};ViewBox.prototype.getTM=function(){var svgRoot=document.documentElement;var matrix=document.documentElement.createSVGMatrix();this.windowWidth=svgRoot.getAttributeNS(null,"width");if(this.windowWidth.match(/%/)||this.windowWidth==null){if(this.windowWidth==null){if(window.innerWidth){this.windowWidth=window.innerWidth;}
else{this.windowWidth=svgRoot.viewport.width;}}
else{var factor=parseFloat(this.windowWidth.replace(/%/,""))/100;if(window.innerWidth){this.windowWidth=window.innerWidth*factor;}
else{this.windowWidth=svgRoot.viewport.width*factor;}}}
else{this.windowWidth=parseFloat(this.windowWidth);}
this.windowHeight=svgRoot.getAttributeNS(null,"height");if(this.windowHeight.match(/%/)||this.windowHeight==null){if(this.windowHeight==null){if(window.innerHeight){this.windowHeight=window.innerHeight;}
else{this.windowHeight=svgRoot.viewport.height;}}
else{var factor=parseFloat(this.windowHeight.replace(/%/,""))/100;if(window.innerHeight){this.windowHeight=window.innerHeight*factor;}
else{this.windowHeight=svgRoot.viewport.height*factor;}}}
else{this.windowHeight=parseFloat(this.windowHeight);}
var x_ratio=this.width/this.windowWidth;var y_ratio=this.height/this.windowHeight;matrix=matrix.translate(this.x,this.y);if(this.alignX=="none"){matrix=matrix.scaleNonUniform(x_ratio,y_ratio);}else{if(x_ratio<y_ratio&&this.meetOrSlice=="meet"||x_ratio>y_ratio&&this.meetOrSlice=="slice")
{var x_trans=0;var x_diff=this.windowWidth*y_ratio-this.width;if(this.alignX=="Mid")
x_trans=-x_diff/2;else if(this.alignX=="Max")
x_trans=-x_diff;matrix=matrix.translate(x_trans,0);matrix=matrix.scale(y_ratio);}
else if(x_ratio>y_ratio&&this.meetOrSlice=="meet"||x_ratio<y_ratio&&this.meetOrSlice=="slice")
{var y_trans=0;var y_diff=this.windowHeight*x_ratio-this.height;if(this.alignY=="Mid")
y_trans=-y_diff/2;else if(this.alignY=="Max")
y_trans=-y_diff;matrix=matrix.translate(0,y_trans);matrix=matrix.scale(x_ratio);}
else
{matrix=matrix.scale(x_ratio);}}
return matrix;}
ViewBox.prototype.setPAR=function(PAR){if(PAR){var params=PAR.split(/\s+/);var align=params[0];if(align=="none"){this.alignX="none";this.alignY="none";}else{this.alignX=align.substring(1,4);this.alignY=align.substring(5,9);}
if(params.length==2){this.meetOrSlice=params[1];}else{this.meetOrSlice="meet";}}else{this.align="xMidYMid";this.alignX="Mid";this.alignY="Mid";this.meetOrSlice="meet";}};var svgNS="http://www.w3.org/2000/svg";var xlinkNS="http://www.w3.org/1999/xlink";var cartoNS="http://www.carto.net/attrib";var attribNS="http://www.carto.net/attrib";var batikNS="http://xml.apache.org/batik/ext";function toPolarDir(xdiff,ydiff){var direction=(Math.atan2(ydiff,xdiff));return(direction);}
function toPolarDist(xdiff,ydiff){var distance=Math.sqrt(xdiff*xdiff+ydiff*ydiff);return(distance);}
function toRectX(direction,distance){var x=distance*Math.cos(direction);return(x);}
function toRectY(direction,distance){y=distance*Math.sin(direction);return(y);}
function DegToRad(deg){return(deg/180.0*Math.PI);}
function RadToDeg(rad){return(rad/Math.PI*180.0);}
function dd2dms(dd){var minutes=(Math.abs(dd)-Math.floor(Math.abs(dd)))*60;var seconds=(minutes-Math.floor(minutes))*60;var minutes=Math.floor(minutes);if(dd>=0){var degrees=Math.floor(dd);}
else{var degrees=Math.ceil(dd);}
return{deg:degrees,min:minutes,sec:seconds};}
function dms2dd(deg,min,sec){if(deg<0){return deg-(min/60)-(sec/3600);}
else{return deg+(min/60)+(sec/3600);}}
function log(x,b){if(b==null)b=Math.E;return Math.log(x)/Math.log(b);}
function intBilinear(za,zb,zc,zd,xpos,ypos,ax,ay,cellsize){var e=(xpos-ax)/cellsize;var f=(ypos-ay)/cellsize;var wa=(1-e)*(1-f);var wb=e*(1-f);var wc=e*f;var wd=f*(1-e);var interpol_value=wa*zc+wb*zd+wc*za+wd*zb;return interpol_value;}
function leftOfTest(pointx,pointy,linex1,liney1,linex2,liney2){var result=(liney1-pointy)*(linex2-linex1)-(linex1-pointx)*(liney2-liney1);if(result<0){var leftof=1;}
else{var leftof=0;}
return leftof;}
function distFromLine(xpoint,ypoint,linex1,liney1,linex2,liney2){var dx=linex2-linex1;var dy=liney2-liney1;var distance=(dy*(xpoint-linex1)-dx*(ypoint-liney1))/Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2));return distance;}
function angleBetwTwoLines(ax,ay,bx,by){var angle=Math.acos((ax*bx+ay*by)/(Math.sqrt(Math.pow(ax,2)+Math.pow(ay,2))*Math.sqrt(Math.pow(bx,2)+Math.pow(by,2))));return angle;}
function calcBisectorVector(ax,ay,bx,by){var betraga=Math.sqrt(Math.pow(ax,2)+Math.pow(ay,2));var betragb=Math.sqrt(Math.pow(bx,2)+Math.pow(by,2));var c=new Array();c[0]=ax/betraga+bx/betragb;c[1]=ay/betraga+by/betragb;return c;}
function calcBisectorAngle(ax,ay,bx,by){var betraga=Math.sqrt(Math.pow(ax,2)+Math.pow(ay,2));var betragb=Math.sqrt(Math.pow(bx,2)+Math.pow(by,2));var c1=ax/betraga+bx/betragb;var c2=ay/betraga+by/betragb;var angle=toPolarDir(c1,c2);return angle;}
function intersect2lines(line1x1,line1y1,line1x2,line1y2,line2x1,line2y1,line2x2,line2y2){var interSectPoint=new Object();var denominator=(line2y2-line2y1)*(line1x2-line1x1)-(line2x2-line2x1)*(line1y2-line1y1);if(denominator==0){alert("lines are parallel");}
else{var ua=((line2x2-line2x1)*(line1y1-line2y1)-(line2y2-line2y1)*(line1x1-line2x1))/denominator;var ub=((line1x2-line1x1)*(line1y1-line2y1)-(line1y2-line1y1)*(line1x1-line2x1))/denominator;}
interSectPoint["x"]=line1x1+ua*(line1x2-line1x1);interSectPoint["y"]=line1y1+ua*(line1y2-line1y1);return interSectPoint;}
function formatNumberString(inputNumber,separator){if(typeof(inputNumber)=="Number"){var myTempString=inputNumber.toString();}
else{var myTempString=inputNumber;}
var newString="";var splitResults=myTempString.split(".");var myCounter=splitResults[0].length;if(myCounter>3){while(myCounter>0){if(myCounter>3){newString=separator+splitResults[0].substr(myCounter-3,3)+newString;}
else{newString=splitResults[0].substr(0,myCounter)+newString;}
myCounter-=3;}}
else{newString=splitResults[0];}
if(splitResults[1]){newString=newString+"."+splitResults[1];}
return newString;}
function statusChange(statusText){document.getElementById("statusText").firstChild.nodeValue="Statusbar: "+statusText;}
function scaleObject(evt,factor){var element=evt.currentTarget;var myX=element.getAttributeNS(null,"x");var myY=element.getAttributeNS(null,"y");var newtransform="scale("+factor+") translate("+(myX*1/factor-myX)+" "+(myY*1/factor-myY)+")";element.setAttributeNS(null,'transform',newtransform);}
function getTransformToRootElement(node){try{var CTM=node.getTransformToElement(document.documentElement);}
catch(ex){var CTM=node.getCTM();while((node=node.parentNode)!=document){CTM=node.getCTM().multiply(CTM);}}
return CTM;}
function getTransformToElement(node,targetNode){try{var CTM=node.getTransformToElement(targetNode);}
catch(ex){var CTM=node.getCTM();while((node=node.parentNode)!=targetNode){CTM=node.getCTM().multiply(CTM);}}
return CTM;}
function hsv2rgb(hue,sat,val){var rgbArr=new Object();if(sat==0){rgbArr["red"]=Math.round(val*255);rgbArr["green"]=Math.round(val*255);rgbArr["blue"]=Math.round(val*255);}
else{var h=hue/60;var i=Math.floor(h);var f=h-i;if(i%2==0){f=1-f;}
var m=val*(1-sat);var n=val*(1-sat*f);switch(i){case 0:rgbArr["red"]=val;rgbArr["green"]=n;rgbArr["blue"]=m;break;case 1:rgbArr["red"]=n;rgbArr["green"]=val;rgbArr["blue"]=m;break;case 2:rgbArr["red"]=m;rgbArr["green"]=val;rgbArr["blue"]=n;break;case 3:rgbArr["red"]=m;rgbArr["green"]=n;rgbArr["blue"]=val;break;case 4:rgbArr["red"]=n;rgbArr["green"]=m;rgbArr["blue"]=val;break;case 5:rgbArr["red"]=val;rgbArr["green"]=m;rgbArr["blue"]=n;break;case 6:rgbArr["red"]=val;rgbArr["green"]=n;rgbArr["blue"]=m;break;}
rgbArr["red"]=Math.round(rgbArr["red"]*255);rgbArr["green"]=Math.round(rgbArr["green"]*255);rgbArr["blue"]=Math.round(rgbArr["blue"]*255);}
return rgbArr;}
function rgb2hsv(red,green,blue){var hsvArr=new Object();red=red/255;green=green/255;blue=blue/255;myMax=Math.max(red,Math.max(green,blue));myMin=Math.min(red,Math.min(green,blue));v=myMax;if(myMax>0){s=(myMax-myMin)/myMax;}
else{s=0;}
if(s>0){myDiff=myMax-myMin;rc=(myMax-red)/myDiff;gc=(myMax-green)/myDiff;bc=(myMax-blue)/myDiff;if(red==myMax){h=(bc-gc)/6;}
if(green==myMax){h=(2+rc-bc)/6;}
if(blue==myMax){h=(4+gc-rc)/6;}}
else{h=0;}
if(h<0){h+=1;}
hsvArr["hue"]=Math.round(h*360);hsvArr["sat"]=s;hsvArr["val"]=v;return hsvArr;}
function arrayPopulate(arrayKeys,arrayValues){var returnArray=new Array();if(arrayKeys.length!=arrayValues.length){alert("error: arrays do not have the same length!");}
else{for(i=0;i<arrayKeys.length;i++){returnArray[arrayKeys[i]]=arrayValues[i];}}
return returnArray;}
function getData(url,callBackFunction,returnFormat,method,postText,additionalParams){this.url=url;this.callBackFunction=callBackFunction;this.returnFormat=returnFormat;this.method=method;this.additionalParams=additionalParams;if(method!="get"&&method!="post"){alert("Error in network request: parameter 'method' must be 'get' or 'post'");}
this.postText=postText;this.xmlRequest=null;}
getData.prototype.getData=function(){if(window.getURL){if(this.method=="get"){getURL(this.url,this);}
if(this.method=="post"){postURL(this.url,this.postText,this);}}
else if(window.XMLHttpRequest){var _this=this;this.xmlRequest=new XMLHttpRequest();if(this.method=="get"){if(this.returnFormat=="xml"){this.xmlRequest.overrideMimeType("text/xml");}
this.xmlRequest.open("GET",this.url,true);}
if(this.method=="post"){this.xmlRequest.open("POST",this.url,true);}
this.xmlRequest.onreadystatechange=function(){_this.handleEvent()};if(this.method=="get"){this.xmlRequest.send(null);}
if(this.method=="post"){var reallyPost=true;if(!this.postText){reallyPost=false;alert("Error in network post request: missing parameter 'postText'!");}
if(typeof(this.postText)!="string"){reallyPost=false;alert("Error in network post request: parameter 'postText' has to be of type 'string')");}
if(reallyPost){this.xmlRequest.send(this.postText);}}}
else{alert("your browser/svg viewer neither supports window.getURL nor window.XMLHttpRequest!");}}
getData.prototype.operationComplete=function(data){if(data.success){if(this.returnFormat=="xml"){var node=parseXML(data.content,document);if(typeof(this.callBackFunction)=="function"){this.callBackFunction(node.firstChild,this.additionalParams);}
if(typeof(this.callBackFunction)=="object"){this.callBackFunction.receiveData(node.firstChild,this.additionalParams);}}
if(this.returnFormat=="json"){if(typeof(this.callBackFunction)=="function"){this.callBackFunction(data.content,this.additionalParams);}
if(typeof(this.callBackFunction)=="object"){this.callBackFunction.receiveData(data.content,this.additionalParams);}}}
else{alert("something went wrong with dynamic loading of geometry!");}}
getData.prototype.handleEvent=function(){if(this.xmlRequest.readyState==4){if(this.returnFormat=="xml"){var importedNode=document.importNode(this.xmlRequest.responseXML.documentElement,true);if(typeof(this.callBackFunction)=="function"){this.callBackFunction(importedNode,this.additionalParams);}
if(typeof(this.callBackFunction)=="object"){this.callBackFunction.receiveData(importedNode,this.additionalParams);}}
if(this.returnFormat=="json"){if(typeof(this.callBackFunction)=="function"){this.callBackFunction(this.xmlRequest.responseText,this.additionalParams);}
if(typeof(this.callBackFunction)=="object"){this.callBackFunction.receiveData(this.xmlRequest.responseText,this.additionalParams);}}}}
function serializeNode(node){if(typeof XMLSerializer!='undefined'){return new XMLSerializer().serializeToString(node);}
else if(typeof node.xml!='undefined'){return node.xml;}
else if(typeof printNode!='undefined'){return printNode(node);}
else if(typeof Packages!='undefined'){try{var stringWriter=new java.io.StringWriter();Packages.org.apache.batik.dom.util.DOMUtilities.writeNode(node,stringWriter);return stringWriter.toString();}
catch(e){alert("Sorry, your SVG viewer does not support the printNode/serialize function.");return'';}}
else{alert("Sorry, your SVG viewer does not support the printNode/serialize function.");return'';}}
function startAnimation(id){document.getElementById(id).beginElement();}
function Timer(){this.obj=(arguments.length)?arguments[0]:window;return this;}
Timer.prototype.setInterval=function(func,msec){var i=Timer.getNew();var t=Timer.buildCall(this.obj,i,arguments);Timer.set[i].timer=window.setInterval(t,msec);return i;}
Timer.prototype.setTimeout=function(func,msec){var i=Timer.getNew();Timer.buildCall(this.obj,i,arguments);Timer.set[i].timer=window.setTimeout("Timer.callOnce("+i+");",msec);return i;}
Timer.prototype.clearInterval=function(i){if(!Timer.set[i])return;window.clearInterval(Timer.set[i].timer);Timer.set[i]=null;}
Timer.prototype.clearTimeout=function(i){if(!Timer.set[i])return;window.clearTimeout(Timer.set[i].timer);Timer.set[i]=null;}
Timer.set=new Array();Timer.buildCall=function(obj,i,args){var t="";Timer.set[i]=new Array();if(obj!=window){Timer.set[i].obj=obj;t="Timer.set["+i+"].obj.";}
t+=args[0]+"(";if(args.length>2){Timer.set[i][0]=args[2];t+="Timer.set["+i+"][0]";for(var j=1;(j+2)<args.length;j++){Timer.set[i][j]=args[j+2];t+=", Timer.set["+i+"]["+j+"]";}}
t+=");";Timer.set[i].call=t;return t;}
Timer.callOnce=function(i){if(!Timer.set[i])return;eval(Timer.set[i].call);Timer.set[i]=null;}
Timer.getNew=function(){var i=0;while(Timer.set[i])i++;return i;}
function scrollbar(id,parentNode,x,y,width,height,startValue,endValue,initialHeightPerc,initialOffset,scrollStep,scrollButtonLocations,scrollbarStyles,scrollerStyles,triangleStyles,highlightStyles,functionToCall){var nrArguments=17;var createScrollbar=true;if(arguments.length==nrArguments){this.id=id;this.parentNode=parentNode;this.x=x;this.y=y;this.width=width;this.height=height;this.startValue=startValue;this.endValue=endValue;this.initialHeightPerc=initialHeightPerc;this.initialOffset=initialOffset;this.scrollStep=scrollStep;this.scrollButtonLocations=scrollButtonLocations;if(this.scrollButtonLocations!="bottom_bottom"&&this.scrollButtonLocations!="top_bottom"&&this.scrollButtonLocations&&"top_top"&&this.scrollButtonLocations!="none_none"){createScrollbar=false;alert("Error: parameter 'scrollButtonLocations' can only be of the following values: 'bottom_bottom' || 'top_top' || 'top_bottom' || 'none_none'.");}
this.scrollbarStyles=scrollbarStyles;this.scrollerStyles=scrollerStyles;this.triangleStyles=triangleStyles;this.highlightStyles=highlightStyles;this.functionToCall=functionToCall;this.horizOrVertical="vertical";this.cellHeight=this.width;this.scrollStatus=false;this.buttonScrollActive=false;this.scrollbarScrollActive=false;}
else{createScrollbar=false;alert("Error ("+id+"): wrong nr of arguments! You have to pass over "+nrArguments+" parameters.");}
if(createScrollbar){var result=this.testParent();if(result){this.timer=new Timer(this);this.timerMs=200;this.createScrollbar();}
else{alert("could not create or reference 'parentNode' of scrollbar with id '"+this.id+"'");}}
else{alert("Could not create scrollbar with id '"+id+"' due to errors in the constructor parameters");}}
scrollbar.prototype.testParent=function(){var nodeValid=false;this.parentGroup=document.createElementNS(svgNS,"g");if(typeof(this.parentNode)=="object"){if(this.parentNode.nodeName=="svg"||this.parentNode.nodeName=="g"||this.parentNode.nodeName=="svg:svg"||this.parentNode.nodeName=="svg:g"){this.parentNode.appendChild(this.parentGroup);nodeValid=true;}}
else if(typeof(this.parentNode)=="string"){if(!document.getElementById(this.parentNode)){this.parentGroup.setAttributeNS(null,"id",this.parentNode);document.documentElement.appendChild(this.parentGroup);nodeValid=true;}
else{document.getElementById(this.parentNode).appendChild(this.parentGroup);nodeValid=true;}}
return nodeValid;}
scrollbar.prototype.createScrollbar=function(){if(this.width>this.height){this.horizOrVertical="horizontal";this.cellHeight=this.height;}
this.triangleFourth=Math.round(this.cellHeight/4);if(this.scrollButtonLocations!="none_none"){this.scrollUpperRect=document.createElementNS(svgNS,"rect");this.scrollLowerRect=document.createElementNS(svgNS,"rect");this.scrollUpperTriangle=document.createElementNS(svgNS,"path");this.scrollLowerTriangle=document.createElementNS(svgNS,"path");}
if(this.horizOrVertical=="vertical"){this.scrollUpperRectX=this.x;this.scrollLowerRectX=this.x;switch(this.scrollButtonLocations){case"top_top":this.scrollbarX=this.x;this.scrollbarY=this.y+(2*this.cellHeight);this.scrollbarWidth=this.width;this.scrollbarHeight=this.height-(2*this.cellHeight);this.scrollUpperRectY=this.y;this.scrollLowerRectY=this.y+this.cellHeight;break;case"bottom_bottom":this.scrollbarX=this.x;this.scrollbarY=this.y;this.scrollbarWidth=this.width;this.scrollbarHeight=this.height-(2*this.cellHeight);this.scrollUpperRectY=this.y+this.height-(2*this.cellHeight);this.scrollLowerRectY=this.y+this.height-this.cellHeight;break;case"top_bottom":this.scrollbarX=this.x;this.scrollbarY=this.y+this.cellHeight;this.scrollbarWidth=this.width;this.scrollbarHeight=this.height-(2*this.cellHeight);this.scrollUpperRectY=this.y;this.scrollLowerRectY=this.y+this.height-this.cellHeight;break;default:this.scrollbarX=this.x;this.scrollbarY=this.y;this.scrollbarWidth=this.width;this.scrollbarHeight=this.height;break;}
var myUpperTriPath="M"+(this.scrollUpperRectX+this.cellHeight*0.5)+" "+(this.scrollUpperRectY+this.triangleFourth)+" L"+(this.scrollUpperRectX+3*this.triangleFourth)+" "+(this.scrollUpperRectY+3*this.triangleFourth)+" L"+(this.scrollUpperRectX+this.triangleFourth)+" "+(this.scrollUpperRectY+3*this.triangleFourth)+" Z";var myLowerTriPath="M"+(this.scrollLowerRectX+this.cellHeight*0.5)+" "+(this.scrollLowerRectY+3*this.triangleFourth)+" L"+(this.scrollLowerRectX+this.triangleFourth)+" "+(this.scrollLowerRectY+this.triangleFourth)+" L"+(this.scrollLowerRectX+this.triangleFourth*3)+" "+(this.scrollLowerRectY+this.triangleFourth)+" Z";}
if(this.horizOrVertical=="horizontal"){this.scrollUpperRectY=this.y;this.scrollLowerRectY=this.y;switch(this.scrollButtonLocations){case"top_top":this.scrollbarX=this.x+(2*this.cellHeight);this.scrollbarY=this.y;this.scrollbarWidth=this.width-(2*this.cellHeight);this.scrollbarHeight=this.height;this.scrollUpperRectX=this.x;this.scrollLowerRectX=this.x+this.cellHeight;break;case"bottom_bottom":this.scrollbarX=this.x;this.scrollbarY=this.y;this.scrollbarWidth=this.width-(2*this.cellHeight);this.scrollbarHeight=this.height;this.scrollUpperRectX=this.x+this.width-(2*this.cellHeight);this.scrollLowerRectX=this.x+this.width-this.cellHeight;break;case"top_bottom":this.scrollbarX=this.x+this.cellHeight;this.scrollbarY=this.y;this.scrollbarWidth=this.width-(2*this.cellHeight);this.scrollbarHeight=this.height;this.scrollUpperRectX=this.x;this.scrollLowerRectX=this.x+this.width-this.cellHeight;break;default:this.scrollbarX=this.x;this.scrollbarY=this.y;this.scrollbarWidth=this.width;this.scrollbarHeight=this.height;break;}
var myUpperTriPath="M"+(this.scrollUpperRectX+this.triangleFourth)+" "+(this.scrollUpperRectY+this.triangleFourth*2)+" L"+(this.scrollUpperRectX+3*this.triangleFourth)+" "+(this.scrollUpperRectY+this.triangleFourth)+" L"+(this.scrollUpperRectX+3*this.triangleFourth)+" "+(this.scrollUpperRectY+3*this.triangleFourth)+" Z";var myLowerTriPath="M"+(this.scrollLowerRectX+this.triangleFourth*3)+" "+(this.scrollLowerRectY+2*this.triangleFourth)+" L"+(this.scrollLowerRectX+this.triangleFourth)+" "+(this.scrollLowerRectY+this.triangleFourth*3)+" L"+(this.scrollLowerRectX+this.triangleFourth)+" "+(this.scrollLowerRectY+this.triangleFourth)+" Z";}
this.scrollbar=document.createElementNS(svgNS,"rect");this.scrollbar.setAttributeNS(null,"x",this.scrollbarX);this.scrollbar.setAttributeNS(null,"y",this.scrollbarY);this.scrollbar.setAttributeNS(null,"width",this.scrollbarWidth);this.scrollbar.setAttributeNS(null,"height",this.scrollbarHeight);this.scrollbar.setAttributeNS(null,"id","scrollbar_"+this.id);for(var attrib in this.scrollbarStyles){this.scrollbar.setAttributeNS(null,attrib,this.scrollbarStyles[attrib]);}
this.scrollbar.addEventListener("mousedown",this,false);this.parentGroup.appendChild(this.scrollbar);this.scroller=document.createElementNS(svgNS,"rect");if(this.horizOrVertical=="vertical"){this.scroller.setAttributeNS(null,"x",this.scrollbarX);this.scrollerY=this.scrollbarY+(this.scrollbarHeight-this.scrollbarHeight*this.initialHeightPerc)*this.initialOffset;this.scroller.setAttributeNS(null,"y",this.scrollerY);this.scroller.setAttributeNS(null,"width",this.scrollbarWidth);this.scrollerHeight=this.scrollbarHeight*this.initialHeightPerc;this.scroller.setAttributeNS(null,"height",this.scrollerHeight);}
if(this.horizOrVertical=="horizontal"){this.scrollerX=this.scrollbarX+(this.scrollbarWidth-this.scrollbarWidth*this.initialHeightPerc)*this.initialOffset;this.scroller.setAttributeNS(null,"x",this.scrollerX);this.scroller.setAttributeNS(null,"y",this.scrollbarY);this.scrollerWidth=this.scrollbarWidth*this.initialHeightPerc;this.scroller.setAttributeNS(null,"width",this.scrollerWidth);this.scroller.setAttributeNS(null,"height",this.scrollbarHeight);}
for(var attrib in this.scrollerStyles){this.scroller.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
this.scroller.setAttributeNS(null,"id","scroller_"+this.id);this.scroller.addEventListener("mousedown",this,false);this.parentGroup.appendChild(this.scroller);if(this.scrollButtonLocations!="none_none"){for(var attrib in this.scrollerStyles){this.scrollUpperRect.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
this.scrollUpperRect.setAttributeNS(null,"x",this.scrollUpperRectX);this.scrollUpperRect.setAttributeNS(null,"y",this.scrollUpperRectY);this.scrollUpperRect.setAttributeNS(null,"width",this.cellHeight);this.scrollUpperRect.setAttributeNS(null,"height",this.cellHeight);this.scrollUpperRect.addEventListener("mousedown",this,false);this.scrollUpperRect.setAttributeNS(null,"id","scrollUpperRect_"+this.id);this.parentGroup.appendChild(this.scrollUpperRect);for(var attrib in this.scrollerStyles){this.scrollLowerRect.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
this.scrollLowerRect.setAttributeNS(null,"x",this.scrollLowerRectX);this.scrollLowerRect.setAttributeNS(null,"y",this.scrollLowerRectY);this.scrollLowerRect.setAttributeNS(null,"width",this.cellHeight);this.scrollLowerRect.setAttributeNS(null,"height",this.cellHeight);this.scrollLowerRect.addEventListener("mousedown",this,false);this.scrollLowerRect.setAttributeNS(null,"id","scrollLowerRect_"+this.id);this.parentGroup.appendChild(this.scrollLowerRect);this.scrollUpperTriangle.setAttributeNS(null,"d",myUpperTriPath);this.scrollUpperTriangle.setAttributeNS(null,"pointer-events","none");for(var attrib in this.triangleStyles){this.scrollUpperTriangle.setAttributeNS(null,attrib,this.triangleStyles[attrib]);}
this.parentGroup.appendChild(this.scrollUpperTriangle);this.scrollLowerTriangle.setAttributeNS(null,"d",myLowerTriPath);this.scrollLowerTriangle.setAttributeNS(null,"pointer-events","none");for(var attrib in this.triangleStyles){this.scrollLowerTriangle.setAttributeNS(null,attrib,this.triangleStyles[attrib]);}
this.parentGroup.appendChild(this.scrollLowerTriangle);}}
scrollbar.prototype.handleEvent=function(evt){var el=evt.target;var callerId=el.getAttributeNS(null,"id");if(evt.type=="mousedown"){if(callerId=="scroller_"+this.id){this.scroll(evt);}
if(callerId=="scrollLowerRect_"+this.id||callerId=="scrollUpperRect_"+this.id){this.buttonScrollActive=true;this.scrollDir="down";this.currentScrollButton=evt.target;this.currentScrollTriangle=this.scrollLowerTriangle;if(callerId=="scrollUpperRect_"+this.id){this.scrollDir="up";this.currentScrollTriangle=this.scrollUpperTriangle;}
document.documentElement.addEventListener("mouseup",this,false);for(var attrib in this.scrollerStyles){this.currentScrollButton.removeAttributeNS(null,attrib);}
for(var attrib in this.highlightStyles){this.currentScrollButton.setAttributeNS(null,attrib,this.highlightStyles[attrib]);}
for(var attrib in this.triangleStyles){this.currentScrollTriangle.removeAttributeNS(null,attrib);}
for(var attrib in this.scrollerStyles){this.currentScrollTriangle.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
this.scrollPercent(this.scrollDir,this.scrollStep);this.timer.setTimeout("scrollPerButton",400);}
if(callerId=="scrollbar_"+this.id){var coords=myMapApp.calcCoord(evt,this.scrollbar);this.scrollbarScrollActive=true;this.scrollDir="down";if(this.horizOrVertical=="vertical"){if(coords.y<this.scrollerY){this.scrollDir="up";}}
if(this.horizOrVertical=="horizontal"){if(coords.x<this.scrollerX){this.scrollDir="up";}}
document.documentElement.addEventListener("mouseup",this,false);for(var attrib in this.scrollerStyles){this.scroller.removeAttributeNS(null,attrib);}
for(var attrib in this.highlightStyles){this.scroller.setAttributeNS(null,attrib,this.highlightStyles[attrib]);}
this.scrollPercent(this.scrollDir,this.scrollStep*10);this.timer.setTimeout("scrollPerScrollbar",400);}}
if(evt.type=="mousemove"&&this.scrollStatus){this.scroll(evt);}
if(evt.type=="mouseup"){if(this.scrollStatus){this.scroll(evt);}
if(this.buttonScrollActive){this.buttonScrollActive=false;document.documentElement.removeEventListener("mouseup",this,false);for(var attrib in this.highlightStyles){this.currentScrollButton.removeAttributeNS(null,attrib);}
for(var attrib in this.scrollerStyles){this.currentScrollButton.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
for(var attrib in this.scrollerStyles){this.currentScrollTriangle.removeAttributeNS(null,attrib);}
for(var attrib in this.triangleStyles){this.currentScrollTriangle.setAttributeNS(null,attrib,this.triangleStyles[attrib]);}
this.currentScrollButton=undefined;this.currentScrollTriangle=undefined;}
if(this.scrollbarScrollActive){this.scrollbarScrollActive=false;document.documentElement.removeEventListener("mouseup",this,false);for(var attrib in this.highlightStyles){this.scroller.removeAttributeNS(null,attrib);}
for(var attrib in this.scrollerStyles){this.scroller.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}}}}
scrollbar.prototype.scroll=function(evt){var coords=myMapApp.calcCoord(evt,this.scrollbar);if(evt.type=="mousedown"){document.documentElement.addEventListener("mousemove",this,false);document.documentElement.addEventListener("mouseup",this,false);this.scrollStatus=true;this.panCoords=coords;this.fireFunction("scrollStart");for(var attrib in this.scrollerStyles){this.scroller.removeAttributeNS(null,attrib);}
for(var attrib in this.highlightStyles){this.scroller.setAttributeNS(null,attrib,this.highlightStyles[attrib]);}}
if(evt.type=="mousemove"){var diffX=coords.x-this.panCoords.x;var diffY=coords.y-this.panCoords.y;var scrollerDiff=false;if(this.horizOrVertical=="vertical"){var scrollerOrigY=this.scrollerY;this.scrollerY+=diffY;if(this.scrollerY<this.scrollbarY){this.scrollerY=this.scrollbarY;}
if((this.scrollerY+this.scrollerHeight)>(this.scrollbarY+this.scrollbarHeight)){this.scrollerY=this.scrollbarY+this.scrollbarHeight-this.scrollerHeight;}
this.scroller.setAttributeNS(null,"y",this.scrollerY);if(scrollerOrigY!=this.scrollerY){scrollerDiff=true;}}
if(this.horizOrVertical=="horizontal"){var scrollerOrigX=this.scrollerX;this.scrollerX+=diffX;if(this.scrollerX<this.scrollbarX){this.scrollerX=this.scrollbarX;}
if((this.scrollerX+this.scrollerWidth)>(this.scrollbarX+this.scrollbarWidth)){this.scrollerX=this.scrollbarX+this.scrollbarWidth-this.scrollerWidth;}
this.scroller.setAttributeNS(null,"x",this.scrollerX);if(scrollerOrigX!=this.scrollerX){scrollerDiff=true;}}
if(scrollerDiff){this.fireFunction("scrollChange");}
this.panCoords=coords;}
if(evt.type=="mouseup"){this.scrollStatus=false;document.documentElement.removeEventListener("mousemove",this,false);document.documentElement.removeEventListener("mouseup",this,false);for(var attrib in this.highlightStyles){this.scroller.removeAttributeNS(null,attrib);}
for(var attrib in this.scrollerStyles){this.scroller.setAttributeNS(null,attrib,this.scrollerStyles[attrib]);}
this.fireFunction("scrollEnd");}}
scrollbar.prototype.scrollPercent=function(direction,increment){var currentValues=this.getValue();if(direction=="up"){increment=increment*-1;}
var newPercent=currentValues.perc+increment;if(newPercent<0){newPercent=0;}
if(newPercent>1){newPercent=1;}
this.scrollToPercent(newPercent);}
scrollbar.prototype.scrollToPercent=function(percValue){if(percValue>=0&&percValue<=1){if(this.horizOrVertical=="vertical"){var newY=this.scrollbarY+(this.scrollbarHeight-this.scrollerHeight)*percValue;this.scrollerY=newY;this.scroller.setAttributeNS(null,"y",newY);}
if(this.horizOrVertical=="horizontal"){var newX=this.scrollbarX+(this.scrollbarWidth-this.scrollerWidth)*percValue;this.scrollerX=newX;this.scroller.setAttributeNS(null,"x",newX);}
this.fireFunction("scrolledStep");}
else{alert("error in method '.scrollToPercent()' of scrollbar with id '"+this.id+"'. Value out of range. Value needs to be in range 0 <= value <= 1.");}}
scrollbar.prototype.scrollPerButton=function(){if(this.buttonScrollActive){this.scrollPercent(this.scrollDir,this.scrollStep);this.timer.setTimeout("scrollPerButton",150);}}
scrollbar.prototype.scrollPerScrollbar=function(){if(this.scrollbarScrollActive){this.scrollPercent(this.scrollDir,this.scrollStep*5);this.timer.setTimeout("scrollPerScrollbar",150);}}
scrollbar.prototype.scrollToValue=function(value){if((value>=this.startValue&&value<=this.endValue)||(value<=this.startValue&&value>=this.endValue)){var percValue=value/(this.endValue-this.startValue);this.scrollToPercent(percValue);}
else{alert("Error in scrollbar with id '"+this.id+"': the provided value '"+value+"' is out of range. The valid range is between '"+this.startValue+"' and '"+this.endValue+"'");}}
scrollbar.prototype.getValue=function(){var perc;if(this.horizOrVertical=="vertical"){perc=(this.scrollerY-this.scrollbarY)/(this.scrollbarHeight-this.scrollerHeight);}
if(this.horizOrVertical=="horizontal"){perc=(this.scrollerX-this.scrollbarX)/(this.scrollbarWidth-this.scrollerWidth);}
var abs=this.startValue+(this.endValue-this.startValue)*perc;return{"abs":abs,"perc":perc};}
scrollbar.prototype.fireFunction=function(changeType){var values=this.getValue();if(typeof(this.functionToCall)=="function"){this.functionToCall(this.id,changeType,values.abs,values.perc);}
if(typeof(this.functionToCall)=="object"){this.functionToCall.scrollbarChanged(this.id,changeType,values.abs,values.perc);}
if(typeof(this.functionToCall)==undefined){return;}}
scrollbar.prototype.hide=function(){this.parentGroup.setAttributeNS(null,"display","none");}
scrollbar.prototype.show=function(){this.parentGroup.setAttributeNS(null,"display","inherit");}
scrollbar.prototype.remove=function(){this.parentGroup.parentNode.removeChild(this.parentGroup);}

function BarChart(){BaseChart.call(this);this.chartHeight=240;this.chartWidth=396;this.eleWidth=20;this.spaceWidth=20;this.barElements=new Array();this.barEleValues=new Array();this.barEleNames=new Array();this.values=new Array();this.names=new Array();this.chartEleGroup=null;this.maxSize=0;this.totalSize=0;this.angleFactor=Math.pow(2,0.5);}
BarChart.prototype=new BaseChart();BarChart.prototype.initSvg=function(){this.coordType=1;this.showScrool=true;this.drawSvg();this.chartEleGroup=this.getDoc().getElementById("bars");}
BarChart.prototype.drawSvg=function(){var parentChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(parentChart);parentChart.setAttribute("id","parentChart");var bars=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(bars);bars.setAttribute("id","bars");bars.setAttribute("style","filter:url(#DropShadowFilter)");var labels=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(labels);labels.setAttribute("id","labels");labels.setAttribute("transform","translate(6, 12)");var barvalues=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(barvalues);barvalues.setAttribute("id","barvalues");barvalues.setAttribute("transform","translate(10, -300)");}
BarChart.prototype.addChartItem=function(hasLegend,value,name,repress,count,index){value=value*1;if((value<0)||(isNaN(value))){alert("Negative, textual or null values are not allowed");return;}
this.values.push(value);var color=this.getColor();var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:middle;font-weight:bold;font-size:13;visibility:hidden");eleValue.appendChild(this.getDoc().createTextNode(value+""));this.getDoc().getElementById("barvalues").appendChild(eleValue);this.barEleValues.push(eleValue);var eleName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleName.setAttribute("transform","rotate(45)");eleName.setAttribute("font-family","SimSun");eleName.setAttribute("font-size","11");eleName.appendChild(this.getDoc().createTextNode(name+""));this.getDoc().getElementById("labels").appendChild(eleName);this.barEleNames.push(eleName);var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path');ele.setAttribute("id","barEle"+index);if(value==0){ele.setAttribute("style","stroke:white;fill:none");}else{ele.setAttribute("style","stroke:white;fill:"+color);}
if(window.navigator.appName.match(/Adobe/gi)){ele.setAttribute("onmouseover","window["+this.id+"].barEleValues["+index+"].style.setProperty('visibility', 'show')");ele.setAttribute("onmouseout","window["+this.id+"].barEleValues["+index+"].style.setProperty('visibility', 'hidden')");}
if(window.navigator.appName.match(/Netscape/gi)){ele.setAttribute("onmouseover","window["+this.id+"].barEleValues["+index+"].style.visibility='visible'");ele.setAttribute("onmouseout","window["+this.id+"].barEleValues["+index+"].style.visibility='hidden'");}
this.chartEleGroup.appendChild(ele);this.barElements.push(ele);if(hasLegend){this.createDesList("deslist","destext",index,name,color);}
if(value>this.maxSize){this.maxSize=value;}
this.totalSize+=value;if(this.totalSize>0&&this.values.length==count){var barStart=0;var totalGrad=this.getTotalGrad(this.maxSize);for(var I=0;I<this.values.length;I++){barStart=this.drawBarSegment(barStart,this.values[I]/totalGrad,this.barElements[I],this.barEleNames[I],this.barEleValues[I]);}}}
BarChart.prototype.drawBarSegment=function(Start,Height,Element,Label,Value){var XOffset3D=8;var YOffset3D=5;var PathData="M"+(Start+this.eleWidth)+",0"
PathData=PathData+"h"+(this.eleWidth*-1)
PathData=PathData+"v"+(Height*this.chartHeight*-1)
PathData=PathData+"l"+XOffset3D+",-"+YOffset3D
PathData=PathData+"h"+this.eleWidth
PathData=PathData+"v"+(Height*this.chartHeight)
PathData=PathData+"l-"+XOffset3D+","+YOffset3D
PathData=PathData+"v"+(Height*this.chartHeight*-1)
PathData=PathData+"h"+(this.eleWidth*-1)
PathData=PathData+"h"+this.eleWidth
PathData=PathData+"l"+XOffset3D+",-"+YOffset3D
PathData=PathData+"l-"+XOffset3D+","+YOffset3D
Element.setAttribute("d",PathData);Label.setAttribute("x",Start/this.angleFactor)
Label.setAttribute("y",Start*-1/this.angleFactor)
Value.setAttribute("x",Start);Value.setAttribute("y",(285-this.chartHeight*Height));return Start+this.eleWidth+this.spaceWidth;}

function ComboBarChart(){BaseChart.call(this);this.chartHeight=240;this.chartWidth=396;this.eleWidth=26;this.groupNames=new Array();this.comboNames=new Array();this.sumValues=new Array();this.values=new Array();this.desList=new Array();this.chartEleGroup=null;this.maxSize=0;this.angleFactor=Math.pow(2,0.5);this.startList=new Array();}
ComboBarChart.prototype=new BaseChart();ComboBarChart.prototype.initSvg=function(){this.coordType=3;this.showScrool=true;this.drawSvg();this.chartEleGroup=this.getDoc().getElementById("parentChart");}
ComboBarChart.prototype.drawSvg=function(){var comboBarChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(comboBarChart);comboBarChart.setAttribute("id","comboBarChart");var parentChart=document.createElementNS("http://www.w3.org/2000/svg","g");comboBarChart.appendChild(parentChart);parentChart.setAttribute("id","parentChart");var labels=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(labels);labels.setAttribute("id","labels");labels.setAttribute("transform","translate(6, 12)");var stacks=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(stacks);stacks.setAttribute("id","stacks");var stacksValue=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(stacksValue);stacksValue.setAttribute("id","stacksValue");}
ComboBarChart.prototype.addChartItem=function(hasLegend,value,comboName,groupName,repress,count,index){var eleName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleName.setAttribute("y","40");eleName.setAttribute("style","font-family:SimSun;text-anchor:start;font-size:14");eleName.appendChild(this.getDoc().createTextNode(comboName+""));this.getDoc().getElementById("labels").appendChild(eleName);this.comboNames.push(eleName);for(var g=0;g<value.length;g++){var eleNameG=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleNameG.setAttribute("transform","rotate(45)");eleNameG.setAttribute("style","font-family:SimSun;text-anchor:start;font-size:14");eleNameG.appendChild(this.getDoc().createTextNode(groupName[g]+""));this.getDoc().getElementById("labels").appendChild(eleNameG);this.groupNames.push(eleNameG);var groupValue=value[g];var sumValue=0;for(var i=0;i<groupValue.length;i++){sumValue+=groupValue[i];}
this.sumValues.push(sumValue);this.values.push(groupValue);if(sumValue>this.maxSize){this.maxSize=sumValue;}
var eleCount=count*value.length;if(this.sumValues.length==eleCount){var barStart=0;var totalGrad=this.getTotalGrad(this.maxSize);for(var I=0;I<this.sumValues.length;I++){barStart=this.drawBarSegment(this.groupNames[I],this.values[I],this.sumValues[I],barStart,this.sumValues[I]/totalGrad,this.comboNames,I,value.length);if(I%value.length==0){this.startList.push(barStart-this.eleWidth-this.spaceWidth);}}
var desList=this.getStackDesList();for(var d=0;d<desList.length;d++){this.createDesList("deslist","destext",d,desList[d],this.getColor(value.length*this.values[0].length));}
for(ii=0;ii<this.startList.length;ii++){this.comboNames[ii].setAttribute("x",this.startList[ii])}}}}
ComboBarChart.prototype.drawBarSegment=function(groupName,value,sum,Start,Height,Labels,index,count){if((index+1)%count==0){this.spaceWidth=30;}else{this.spaceWidth=10;}
var subHeightPer=0;var y=0;var x=0;for(var i=0;i<value.length;i++){this.setLinearGrad(index+""+i,this.getColor(value.length*count));subHeightPer=value[i]/sum;var h=this.chartHeight*Height*subHeightPer;x=Start;y=y-h;var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');ele.setAttribute("x",x);ele.setAttribute("y",y);ele.setAttribute("width",this.eleWidth);ele.setAttribute("height",h);ele.setAttribute("style","stroke:none;fill:"+"url(#linearGrad"+index+""+i+")");this.getDoc().getElementById("stacks").appendChild(ele);var barValue=value[i];ele.setAttribute("onmouseover","window["+this.id+"].displayValue(evt,'"+barValue+"')");ele.setAttribute("onmouseout","window["+this.id+"].hiddenValue()");}
groupName.setAttribute("x",Start/this.angleFactor)
groupName.setAttribute("y",Start*-1/this.angleFactor)
return Start+this.eleWidth+this.spaceWidth;}
ComboBarChart.prototype.displayValue=function(evt,value){var objet=evt.target;var x=Number(objet.getAttribute("x"));var y=Number(objet.getAttribute("y"));var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:start;font-weight:bold;text-anchor:middle;font-size:13;visibility:show");eleValue.appendChild(this.getDoc().createTextNode(value));eleValue.setAttribute("x",x+this.eleWidth/2);eleValue.setAttribute("y",y+12);this.getDoc().getElementById("stacksValue").appendChild(eleValue);}
ComboBarChart.prototype.hiddenValue=function(){var svChildren=this.getDoc().getElementById("stacksValue").childNodes;for(var i=0;i<svChildren.length;i++){this.getDoc().getElementById("stacksValue").removeChild(svChildren.item(i));}}
ComboBarChart.prototype.setStackDesList=function(desList){this.desList=desList;}
ComboBarChart.prototype.getStackDesList=function(){return this.desList;}

function DualAxisChart(){BaseChart.call(this);this.rightYAxisTitle="";}
DualAxisChart.prototype=new BaseChart();DualAxisChart.prototype.setRightYAxisTitle=function(rightYAxisTitle){this.rightYAxisTitle=rightYAxisTitle;}
DualAxisChart.prototype.drawAsixCoord=function(){var dualAsixGroup=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(dualAsixGroup);dualAsixGroup.setAttribute("id","asixGroup");var dualAxis=document.createElementNS("http://www.w3.org/2000/svg","path");dualAsixGroup.appendChild(dualAxis);dualAxis.setAttribute("d","M0,0V -250V 0H 396V-250");dualAxis.setAttribute("style","fill:none;stroke:black");var gradLeft=document.createElementNS("http://www.w3.org/2000/svg","g");dualAsixGroup.appendChild(gradLeft);gradLeft.setAttribute("id","gradLeft");gradLeft.setAttribute("transform","translate(-30, -236)");var gradRight=document.createElementNS("http://www.w3.org/2000/svg","g");dualAsixGroup.appendChild(gradRight);gradRight.setAttribute("id","gradRight");this.createGraduation();}
DualAxisChart.prototype.createGraduation=function(){var gradGroup=this.doc.getElementById("gradLeft");var gradUnit=this.chartHeight/10;for(var i=10;i>=0;i--){var gradValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradValue.appendChild(this.getDoc().createTextNode(this.getTotalGrad(this.maxSizeLeft)-this.getTotalGrad(this.maxSizeLeft)/10*i));gradValue.setAttribute("transform","translate(0,"+gradUnit*i+")");gradGroup.appendChild(gradValue);var gradLeftLine=this.getDoc().createElementNS('http://www.w3.org/2000/svg','line');gradLeftLine.setAttribute("x1","30");gradLeftLine.setAttribute("y1",-4+gradUnit*i);gradLeftLine.setAttribute("x2","34");gradLeftLine.setAttribute("y2",-4+gradUnit*i);gradLeftLine.setAttribute("stroke","black");gradGroup.appendChild(gradLeftLine);var gradValueRight=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradValueRight.appendChild(this.getDoc().createTextNode(this.getMaxGrad(this.maxSizeRight)-this.diffGrad*i+"%"));gradValueRight.setAttribute("transform","translate(432,"+gradUnit*i+")");gradGroup.appendChild(gradValueRight);var gradRightLine=this.getDoc().createElementNS('http://www.w3.org/2000/svg','line');gradRightLine.setAttribute("x1","422");gradRightLine.setAttribute("y1",-4+gradUnit*i);gradRightLine.setAttribute("x2","426");gradRightLine.setAttribute("y2",-4+gradUnit*i);gradRightLine.setAttribute("stroke","black");gradGroup.appendChild(gradRightLine);}
var gradXAsixName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradXAsixName.appendChild(this.getDoc().createTextNode(this.xAxisTitle));gradXAsixName.setAttribute("style","text-anchor:middle;font-weight:normal;font-size:14");gradXAsixName.setAttribute("transform","translate(10,270)");gradGroup.appendChild(gradXAsixName);var gradLeftName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradLeftName.appendChild(this.getDoc().createTextNode(this.yAxisTitle));gradLeftName.setAttribute("style","text-anchor:middle;font-weight:normal;font-size:14");gradLeftName.setAttribute("transform","translate(0,-20)");gradGroup.appendChild(gradLeftName);var gradRightName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');gradRightName.appendChild(this.getDoc().createTextNode(this.rightYAxisTitle));gradRightName.setAttribute("style","text-anchor:middle;font-weight:normal;font-size:14");gradRightName.setAttribute("transform","translate(456,-20)");gradGroup.appendChild(gradRightName);}
DualAxisChart.prototype.getMaxGrad=function(maxValue){var b=maxValue%10;var maxGrad=0;if((b>0)&&(b<10)){maxGrad=maxValue+(10-maxValue%10);}else if(b==0){maxGrad=maxValue;}else if((b<0)&&(b>-10)){maxGrad=maxValue-(maxValue%10);}
return maxGrad;}
DualAxisChart.prototype.getMinValue=function(minValue){var b=minValue%10;if((b>0)&&(b<10)){minValue=minValue-minValue%10;}else if(b==0){minValue=minValue;}else if((b<0)&&(b>-10)){minValue=minValue+(-10-minValue%10);}
return minValue;}
DualAxisChart.prototype.getDiffGrad=function(maxTempGrad,minTempGrad){var diffGrad=(maxTempGrad-minTempGrad)/10;var b=diffGrad%5;if((b>0)&&(b<5)){diffGrad=diffGrad+(5-diffGrad%5);}else if(b==0){diffGrad=diffGrad;}
return diffGrad;}
DualAxisChart.prototype.getMinGrad=function(maxGrad,diffGrad){var totalGrad=diffGrad*10;var minGrad=maxGrad-diffGrad*10;return minGrad;}
DualAxisChart.prototype.createDualAxisDes=function(){var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');ele.setAttribute("width","13");ele.setAttribute("height","13");ele.setAttribute("style","stroke:white;fill:"+this.getColorLeft());this.getDoc().getElementById("deslist").appendChild(ele);var ele2=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');ele2.appendChild(this.getDoc().createTextNode(this.yAxisTitle));this.getDoc().getElementById("destext").appendChild(ele2);var ele3=this.getDoc().createElementNS('http://www.w3.org/2000/svg','circle');ele3.setAttribute("transform","translate(5,50)");ele3.setAttribute("r","5");ele3.setAttribute("style","stroke:white;fill:"+this.getColorRight());this.getDoc().getElementById("deslist").appendChild(ele3);var ele4=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');ele4.setAttribute("transform","translate(0,45)");ele4.appendChild(this.getDoc().createTextNode(this.rightYAxisTitle));this.getDoc().getElementById("destext").appendChild(ele4);}
DualAxisChart.prototype.getColorLeft=function(){var color=this.leftColors[this.leftCurrentColor];this.leftCurrentColor++;if(this.leftCurrentColor>=this.leftColors.length){this.leftCurrentColor=0;}
return color;}
DualAxisChart.prototype.setColorsLeft=function(colors){this.leftColors=colors;}
DualAxisChart.prototype.getColorRight=function(){return this.rightColor;}
DualAxisChart.prototype.setColorRight=function(color){this.rightColor=color;}
DualAxisChart.prototype.setColors=function(colors){this.rightColors=colors;this.leftColors=colors;}
DualAxisChart.prototype.addEvent=function(group,evtName,func){var evtGroup="";if(group=="l"){evtGroup=this.leftGroup;}else if(group=="r"){evtGroup=this.rightGroup;}
var EleList=evtGroup.childNodes;for(var i=0;i<EleList.length;i++){objet=EleList.item(i);var pre=objet.getAttribute(evtName);if(!pre){objet.setAttribute(evtName,func);}else{objet.setAttribute(evtName,pre+";"+func);}}}
DualAxisChart.prototype.modifyEvent=function(group,evtName,func){var evtGroup="";if(group=="l"){evtGroup=this.leftGroup;}else if(group=="r"){evtGroup=this.rightGroup;}
var EleList=evtGroup.childNodes;for(var i=0;i<EleList.length;i++){objet=EleList.item(i);objet.setAttribute(evtName,func);}}

function PieChart(){BaseChart.call(this);this.moveDistance=40;this.values=new Array();this.names=new Array();this.chartEleGroup=null;this.maxSize=0;this.totalSize=0;this.pieEvt="";this.chartHeight=240;this.chartWidth=396;this.pieTopEles=new Array();this.pieSideEles=new Array();this.pieBottomEles=new Array();this.topPiePaths=new Array();this.topColors=new Array();this.startValues=new Array();this.sizeValues=new Array();}
PieChart.prototype=new BaseChart();PieChart.prototype.initSvg=function(){this.drawSvg();this.chartEleGroup=this.getDoc().getElementById("slices");}
PieChart.prototype.drawSvg=function(){var pieChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(pieChart);pieChart.setAttribute("id","pieChart");pieChart.setAttribute("transform","translate(200, -100) scale(1, 0.5)");pieChart.setAttribute("style","filter:url(#DropShadowFilter)");var chartPies=document.createElementNS("http://www.w3.org/2000/svg","g");pieChart.appendChild(chartPies);chartPies.setAttribute("id","slices");var pieitemlabel=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(pieitemlabel);pieitemlabel.setAttribute("id","pieitemlabel");pieitemlabel.setAttribute("transform","translate(200, -300)");var labelitem=document.createElementNS("http://www.w3.org/2000/svg","text");pieitemlabel.appendChild(labelitem);labelitem.setAttribute("id","labelitem");labelitem.setAttribute("font-family","SimSun");labelitem.setAttribute("transform","translate(-10, 330)");labelitem.setAttribute("style","text-anchor:end;font-size:13");var labelcolon=document.createElementNS("http://www.w3.org/2000/svg","text");pieitemlabel.appendChild(labelcolon);labelcolon.setAttribute("id","labelcolon");labelcolon.setAttribute("transform","translate(0, 330)");labelcolon.setAttribute("style","text-anchor:middle;font-size:13");var labelamount=document.createElementNS("http://www.w3.org/2000/svg","text");pieitemlabel.appendChild(labelamount);labelamount.setAttribute("id","labelamount");labelamount.setAttribute("transform","translate(10, 330)");labelamount.setAttribute("style","text-anchor:begin;font-size:13");}
PieChart.prototype.addPieClickEvt=function(func){this.pieEvt=func;}
PieChart.prototype.getPieClickEvt=function(){return this.pieEvt;}
PieChart.prototype.drawChart=function(showLegend,showTime){this.setTextNodeValue("title",this.title);if(this.coordType==0){var data=this.getChartData();this.count=data.length;this.setCoordBack();this.drawCoordLines();for(i=0;i<data.length;i++){var dataName=data[i].name;var dataValue=Number(data[i].value);this.addChartItem(showLegend,dataValue,dataName,false,this.count,i);}
this.coverTop(data);}
if(showTime){this.refeshDateTime();}}
PieChart.prototype.addChartItem=function(hasLegend,value,name,repress,count,index){value=value*1;if((value<0)||(isNaN(value))){alert("Negative, textual or null values are not allowed");return;}
this.values.push(value);var color=this.getColor(index);var eleGroup=this.getDoc().createElementNS('http://www.w3.org/2000/svg','g');eleGroup.setAttribute("id","elegroup"+index);this.chartEleGroup.appendChild(eleGroup);var eleTop0=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path')
eleTop0.setAttribute("id","pieEle_"+index);eleTop0.setAttribute("style","stroke:none;fill:"+"none");var eleBottom=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path')
eleBottom.setAttribute("id","pieBottom_"+index);eleBottom.setAttribute("style","stroke:white;fill:"+"none");var eleSide=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path')
eleSide.setAttribute("id","pieSide_"+index);eleSide.setAttribute("style","stroke:white;fill:"+color);eleSide.setAttribute("onmouseover","window["+this.id+"].displayInfo(evt,'"+name+"', '"+value+"')");eleSide.setAttribute("onmouseout","window["+this.id+"].displayInfo(evt,' ', ' ')");this.topColors.push(color);eleGroup.appendChild(eleTop0);eleGroup.appendChild(eleSide);eleGroup.appendChild(eleBottom);this.pieTopEles.push(eleTop0);this.pieSideEles.push(eleBottom);this.pieBottomEles.push(eleSide);if(hasLegend){this.createDesList("deslist","destext",index,name,color);}
if(value>this.maxSize){this.maxSize=value;}
this.totalSize+=value;if(this.totalSize>0&&this.values.length==count){var PieStart=0;for(var I=0;I<this.values.length;I++){PieStart=this.drawPieSegment(PieStart,this.values[I]/this.totalSize,this.pieTopEles[I],this.pieSideEles[I],this.pieBottomEles[I],I);}}}
PieChart.prototype.drawPieSegment=function(Start,Size,EleTop,EleBottom,ElemSide,ID){this.startValues.push(Start);this.sizeValues.push(Size);var PieChartSize=140;var pathBottom="M0,0L";var pathTop="M0,-50L";var pathSide="M";pathBottom=pathBottom+PieChartSize*Math.sin(Start*Math.PI*2)+","+PieChartSize*Math.cos(Start*Math.PI*2);pathTop=pathTop+PieChartSize*Math.sin(Start*Math.PI*2)+","+(PieChartSize*Math.cos(Start*Math.PI*2)-50);pathSide=pathSide+PieChartSize*Math.sin(Start*Math.PI*2)+","+(PieChartSize*Math.cos(Start*Math.PI*2)-50);if(Size>.5){pathBottom=pathBottom+"A"+PieChartSize+" "+PieChartSize
+" 1 1 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+PieChartSize*Math.cos((Start+Size)*Math.PI*2);pathTop=pathTop+"A"+PieChartSize+" "+PieChartSize
+" 1 1 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+(PieChartSize*Math.cos((Start+Size)*Math.PI*2)-50);pathSide=pathSide+"A"+PieChartSize+" "+PieChartSize
+" 1 1 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+(PieChartSize*Math.cos((Start+Size)*Math.PI*2)-50)
+"L"+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+PieChartSize*Math.cos((Start+Size)*Math.PI*2)
+"A"+PieChartSize+" "+PieChartSize
+" 1 1 1 "+PieChartSize*Math.sin(Start*Math.PI*2)+","+PieChartSize*Math.cos(Start*Math.PI*2);}else{pathBottom=pathBottom+"A"+PieChartSize+" "+PieChartSize
+" 0 0 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+PieChartSize*Math.cos((Start+Size)*Math.PI*2);pathTop=pathTop+"A"+PieChartSize+" "+PieChartSize
+" 0 0 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+(PieChartSize*Math.cos((Start+Size)*Math.PI*2)-50);pathSide=pathSide+"A"+PieChartSize+" "+PieChartSize
+" 0 0 0 "+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+(PieChartSize*Math.cos((Start+Size)*Math.PI*2)-50)
+"L"+PieChartSize*Math.sin((Start+Size)*Math.PI*2)+","+PieChartSize*Math.cos((Start+Size)*Math.PI*2)
+"A"+PieChartSize+" "+PieChartSize
+" 0 0 1 "+PieChartSize*Math.sin(Start*Math.PI*2)+","+PieChartSize*Math.cos(Start*Math.PI*2);}
pathBottom=pathBottom+"z";EleTop.setAttribute("d",pathBottom);pathTop=pathTop+"z";EleBottom.setAttribute("d",pathTop);this.topPiePaths.push(pathTop);pathSide=pathSide+"z";ElemSide.setAttribute("d",pathSide);if(Start>0){EleBottom.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(Start+Size/2)+", true, "+ID+")");ElemSide.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(Start+Size/2)+", true, "+ID+")");}else{var Angle=Start+Size/2;X=this.moveDistance*Math.sin(Angle*2*Math.PI);Y=this.moveDistance*Math.cos(Angle*2*Math.PI);EleBottom.setAttribute("transform","translate("+X+","+Y+")");ElemSide.setAttribute("transform","translate("+X+","+Y+")");EleBottom.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+((Start+Size/2)*-1)+", false, "+ID+")");ElemSide.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+((Start+Size/2)*-1)+", false, "+ID+")");}
return Start+Size;}
PieChart.prototype.coverTop=function(data){for(i=0;i<data.length;i++){var eleTop=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path');eleTop.setAttribute("d",this.topPiePaths[i]);eleTop.setAttribute("style","stroke:white;fill:"+this.topColors[i]);eleTop.setAttribute("id","pieTop_"+i);this.chartEleGroup.appendChild(eleTop);eleTop.setAttribute("onmouseover","window["+this.id+"].displayInfo(evt,'"+data[i].name+"', '"+data[i].value+"')");eleTop.setAttribute("onmouseout","window["+this.id+"].displayInfo(evt,' ', ' ')");if(this.startValues[i]>0){eleTop.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(this.startValues[i]+this.sizeValues[i]/2)+", true, "+i+")");}else{var Angle=this.startValues[i]+this.sizeValues[i]/2;X=this.moveDistance*Math.sin(Angle*2*Math.PI);Y=this.moveDistance*Math.cos(Angle*2*Math.PI);eleTop.setAttribute("transform","translate("+X+","+Y+")");eleTop.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+((this.startValues[i]+this.sizeValues[i]/2)*-1)+", false, "+i+")");}}}
PieChart.prototype.displayInfo=function(MouseEvent,Text,Value){if(Text!=" "){Percent=" ("+Math.round(Value/this.totalSize*10000)/100+"%)";}else{Percent="";}
this.setTextNodeValue("labelamount",Value+Percent);this.setTextNodeValue("labelitem",Text+"");if(Text+Value=="  "){s=" ";}else{s=":";}
this.setTextNodeValue("labelcolon",s);}
PieChart.prototype.moveSegment=function(MouseEvent,Angle,CanBeDeleted,ID){var ele=MouseEvent.target;if(Angle<0){X=0
Y=0}else{X=this.moveDistance*Math.sin(Angle*2*Math.PI);Y=this.moveDistance*Math.cos(Angle*2*Math.PI);}
if(CanBeDeleted){eval(this.getPieClickEvt());}
var svgdoc=MouseEvent.target.ownerDocument;var id=MouseEvent.target.id.toString().substr(MouseEvent.target.id.toString().indexOf("_")+1);var pieSide=svgdoc.getElementById("pieSide_"+id);var pieTop=svgdoc.getElementById("pieTop_"+id);var pieBottom=svgdoc.getElementById("pieBottom_"+id);pieSide.setAttribute("transform","translate("+X+","+Y+")");pieTop.setAttribute("transform","translate("+X+","+Y+")");pieBottom.setAttribute("transform","translate("+X+","+Y+")");pieSide.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(Angle*-1)+", "+(!CanBeDeleted)+", "+ID+")");pieTop.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(Angle*-1)+", "+(!CanBeDeleted)+", "+ID+")");pieBottom.setAttribute("onclick","window["+this.id+"].moveSegment(evt, "+(Angle*-1)+", "+(!CanBeDeleted)+", "+ID+")");}
PieChart.prototype.createDesList=function(DesListGroup,DesTextGroup,EleID,EleName,EleColor){var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','path');var size=10;var path="M 0 ";path=path+18*EleID+" L "+(size*Math.sin(Math.PI/6)*-1)+","+(size*Math.cos(Math.PI/6)+18*EleID);path=path+" A "+size+" "+size+" 0 0 0 "+size*Math.sin(Math.PI/6)+","+(size*Math.cos(Math.PI/6)+18*EleID)+" z";ele.setAttribute("d",path);ele.setAttribute("style","stroke:none;fill:"+EleColor);this.desList.push(ele);this.getDoc().getElementById(DesListGroup).appendChild(ele);var ele2=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');ele2.setAttribute("transform","translate(0,"+18*EleID+")");ele2.appendChild(this.getDoc().createTextNode(EleName));this.desTextList.push(ele2);this.getDoc().getElementById(DesTextGroup).appendChild(ele2);}

function DualBarPolylineChart(){DualAxisChart.call(this);this.chartHeight=240;this.chartWidth=396;this.eleWidth=34;this.spaceWidth=32;this.leftColors=["#8B008B"];this.colorsL=new Array();this.leftCurrentColor=0;this.leftGroup=new Array();this.leftElements=new Array();this.leftEleValues=new Array();this.leftEleNames=new Array();this.valuesLeft=new Array();this.maxSizeLeft=0;this.rightColor="red";this.colorsR=new Array();this.rightCurrentColor=0;this.rightGroup=new Array();this.lineColor="red";this.rightElements=new Array();this.rightEleValues=new Array();this.valuesRight=new Array();this.maxSizeRight=0;this.minSizeRight=0;this.diffGradRight=0;this.names=new Array();this.angleFactor=Math.pow(2,0.5);}
DualBarPolylineChart.prototype=new DualAxisChart();DualBarPolylineChart.prototype.initSvg=function(){this.coordType=2;this.showScrool=true;this.drawSvg();this.leftGroup=this.getDoc().getElementById("leftShapeGroup");this.rightGroup=this.getDoc().getElementById("rightShapeGroup");}
DualBarPolylineChart.prototype.drawSvg=function(){var dualAxisChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(dualAxisChart);dualAxisChart.setAttribute("id","dualAxisChart");var parentChart=document.createElementNS("http://www.w3.org/2000/svg","g");dualAxisChart.appendChild(parentChart);parentChart.setAttribute("id","parentChart");var chartLeft=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(chartLeft);chartLeft.setAttribute("id","chartleft");var leftShapeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");chartLeft.appendChild(leftShapeGroup);leftShapeGroup.setAttribute("id","leftShapeGroup");var leftLabels=document.createElementNS("http://www.w3.org/2000/svg","g");chartLeft.appendChild(leftLabels);leftLabels.setAttribute("id","leftLabels");leftLabels.setAttribute("transform","translate(16, 12)");var leftValues=document.createElementNS("http://www.w3.org/2000/svg","g");chartLeft.appendChild(leftValues);leftValues.setAttribute("id","leftValues");var chartRight=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(chartRight);chartRight.setAttribute("id","chartRight");var rightLine=document.createElementNS("http://www.w3.org/2000/svg","g");chartRight.appendChild(rightLine);rightLine.setAttribute("id","rightLine");var rightShapeGroup=document.createElementNS("http://www.w3.org/2000/svg","g");chartRight.appendChild(rightShapeGroup);rightShapeGroup.setAttribute("id","rightShapeGroup");var rightValues=document.createElementNS("http://www.w3.org/2000/svg","g");chartRight.appendChild(rightValues);rightValues.setAttribute("id","rightValues");rightValues.setAttribute("transform","translate(10, -52)");}
DualBarPolylineChart.prototype.addChartItemLeft=function(hasLegend,value,name,repress,count,index){value=value*1;if((value<0)||(isNaN(value))){alert("Negative, textual or null values are not allowed");return;}
this.valuesLeft.push(value);var color=this.getColorLeft();this.colorsL.push(color);var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:middle;font-weight:bold;font-size:13");eleValue.appendChild(this.getDoc().createTextNode(value+""));this.getDoc().getElementById("leftValues").appendChild(eleValue);this.leftEleValues.push(eleValue);var eleName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleName.setAttribute("transform","rotate(45)");eleName.setAttribute("font-family","SimSun");eleName.setAttribute("font-size","14");eleName.appendChild(this.getDoc().createTextNode(name+""));this.getDoc().getElementById("leftLabels").appendChild(eleName);this.leftEleNames.push(eleName);var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');ele.setAttribute("id","barEle"+index);ele.setAttribute("style","stroke:none;fill:"+color);this.leftGroup.appendChild(ele);this.leftElements.push(ele);if((this.leftColors.length>1)&&(hasLegend)){this.createDesList("deslist","destext",index,name,color);}
if(value>this.maxSizeLeft){this.maxSizeLeft=value;}
if(this.valuesLeft.length==count){var barStart=0;var totalGrad=this.getTotalGrad(this.maxSizeLeft);for(var I=0;I<this.valuesLeft.length;I++){barStart=this.drawBarSegment(barStart,this.valuesLeft[I]/totalGrad,this.leftElements[I],this.leftEleNames[I],this.leftEleValues[I],count,I,this.colorsL[I]);}}}
DualBarPolylineChart.prototype.addChartItemRight=function(hasLegend,value,repress,count,index){value=value*1;if((isNaN(value))){alert("Negative, textual or null values are not allowed");return;}
this.valuesRight.push(value);var color=this.getColorRight();this.colorsR.push(color);var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:middle;font-weight:bold;font-size:13");eleValue.setAttribute("style","stroke:"+this.lineColor);eleValue.appendChild(this.getDoc().createTextNode(value+"%"));this.getDoc().getElementById("rightValues").appendChild(eleValue);this.rightEleValues.push(eleValue);var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','circle');ele.setAttribute("style","stroke:none;fill:"+color);ele.setAttribute("r","4");this.getDoc().getElementById("rightShapeGroup").appendChild(ele);this.rightElements.push(ele);var polyLine=this.getDoc().createElementNS('http://www.w3.org/2000/svg','polyline');polyLine.setAttribute("style","fill:none;stroke:"+this.lineColor);this.getDoc().getElementById("rightLine").appendChild(polyLine);if(value>this.maxSizeRight){this.maxSizeRight=value;}
if(value<this.minSizeRight){this.minSizeRight=value;}
if(this.valuesRight.length==count){var pointStart=0;var maxGrad=this.getMaxGrad(this.maxSizeRight);var minGrad=this.getMinValue(this.minSizeRight);this.diffGrad=this.getDiffGrad(maxGrad,minGrad);var totalGrad=this.diffGrad*10;minGrad=this.getMinGrad(maxGrad,this.diffGrad);for(var I=0;I<this.valuesRight.length;I++){pointStart=this.drawPolys(count,pointStart,(this.valuesRight[I]-minGrad)/totalGrad,this.rightElements[I],this.rightEleValues[I],I,this.colorsR[I]);}
var pointsStr=this.getPolylinePath(this.rightElements);polyLine.setAttribute("points",pointsStr);}}
DualBarPolylineChart.prototype.getPolylinePath=function(polys){var points="";for(var I=0;I<polys.length;I++){points=points+polys[I].getAttribute("cx")+", "+polys[I].getAttribute("cy")+" ";}
return points;}
DualBarPolylineChart.prototype.drawPolys=function(count,Start,Height,Element,Value,index,color){var h=this.chartHeight*Height;var x=Start+this.spaceWidth/2;var y=-h;this.setLinearGrad(index+"l",color);Element.setAttribute("cx",x);Element.setAttribute("cy",y);Element.setAttribute("style","stroke:none;fill:"+"url(#linearGrad"+index+"l"+")");Value.setAttribute("x",x-this.spaceWidth/2);Value.setAttribute("y",y+70);return Start+this.eleWidth+this.spaceWidth;}
DualBarPolylineChart.prototype.drawBarSegment=function(Start,Height,Element,Label,Value,count,index,color){var h=this.chartHeight*Height;var x=Start+this.spaceWidth/2;var y=-h;this.setLinearGrad(index+"r",color);Element.setAttribute("x",x);Element.setAttribute("y",y);Element.setAttribute("width",this.eleWidth);Element.setAttribute("height",h);Element.setAttribute("style","stroke:none;fill:"+"url(#linearGrad"+index+"r"+")");Label.setAttribute("x",Start/this.angleFactor)
Label.setAttribute("y",Start*-1/this.angleFactor)
Value.setAttribute("x",x+this.eleWidth/2);Value.setAttribute("y",y-6);return Start+this.eleWidth+this.spaceWidth;}
DualBarPolylineChart.prototype.getLineColor=function(){return this.lineColor;}
DualBarPolylineChart.prototype.setLineColor=function(color){this.lineColor=color;}

function PolylineChart(){BaseChart.call(this);this.chartHeight=240;this.chartWidth=396;this.polyElements=new Array();this.polyEleValues=new Array();this.polyEleNames=new Array();this.values=new Array();this.names=new Array();this.chartEleGroup=null;this.maxSize=0;this.totalSize=0;this.angleFactor=Math.pow(2,0.5);}
PolylineChart.prototype=new BaseChart();PolylineChart.prototype.initSvg=function(){this.coordType=1;this.drawSvg();this.chartEleGroup=this.getDoc().getElementById("points");}
PolylineChart.prototype.drawSvg=function(){var polylineChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(polylineChart);polylineChart.setAttribute("id","polylineChart");var chartPolys=document.createElementNS("http://www.w3.org/2000/svg","g");polylineChart.appendChild(chartPolys);chartPolys.setAttribute("id","polys");chartPolys.setAttribute("style","filter:url(#DropShadowFilter)");var line=document.createElementNS("http://www.w3.org/2000/svg","g");chartPolys.appendChild(line);line.setAttribute("id","line");line.setAttribute("style","fill:none;stroke:black");var points=document.createElementNS("http://www.w3.org/2000/svg","g");chartPolys.appendChild(points);points.setAttribute("id","points");var pointvalues=document.createElementNS("http://www.w3.org/2000/svg","g");polylineChart.appendChild(pointvalues);pointvalues.setAttribute("id","pointvalues");pointvalues.setAttribute("transform","translate(8, -30)");var labels=document.createElementNS("http://www.w3.org/2000/svg","g");polylineChart.appendChild(labels);labels.setAttribute("id","labels");labels.setAttribute("transform","translate(6, 12)");}
PolylineChart.prototype.addChartItem=function(hasLegend,value,name,repress,count,index){value=value*1;if((value<0)||(isNaN(value))){alert("Negative, textual or null values are not allowed");return;}
this.values[this.values.length]=value;var color=this.getColor();var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:middle;font-weight:bold;font-size:13;visibility:hidden");eleValue.appendChild(this.getDoc().createTextNode(name+": "+value+""));this.getDoc().getElementById("pointvalues").appendChild(eleValue);this.polyEleValues.push(eleValue);var eleName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleName.setAttribute("transform","rotate(45)");eleName.setAttribute("font-family","SimSun");eleName.setAttribute("font-size","11");eleName.appendChild(this.getDoc().createTextNode(name+""));this.getDoc().getElementById("labels").appendChild(eleName);this.polyEleNames.push(eleName);if(count<=15){if(window.navigator.appName.match(/Adobe/gi)){eleName.style.setProperty('visibility','show');}
if(window.navigator.appName.match(/Netscape/gi)){eleName.style.visibility='visible';}}else{if(window.navigator.appName.match(/Adobe/gi)){eleName.style.setProperty('visibility','hidden');}
if(window.navigator.appName.match(/Netscape/gi)){eleName.style.visibility='hidden';}}
var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','circle');ele.setAttribute("id","barEle"+index);ele.setAttribute("style","stroke:white;fill:"+color);ele.setAttribute("r","4");if(window.navigator.appName.match(/Adobe/gi)){ele.setAttribute("onmouseover","window["+this.id+"].polyEleValues["+index+"].style.setProperty('visibility', 'show')");ele.setAttribute("onmouseout","window["+this.id+"].polyEleValues["+index+"].style.setProperty('visibility', 'hidden')");}
if(window.navigator.appName.match(/Netscape/gi)){ele.setAttribute("onmouseover","window["+this.id+"].polyEleValues["+index+"].style.visibility='visible'");ele.setAttribute("onmouseout","window["+this.id+"].polyEleValues["+index+"].style.visibility='hidden'");}
this.getDoc().getElementById("points").appendChild(ele);this.polyElements.push(ele);var polyLine=this.getDoc().createElementNS('http://www.w3.org/2000/svg','polyline');this.getDoc().getElementById("line").appendChild(polyLine);if(hasLegend){this.createDesList("deslist","destext",index,name,color);}
if(value>this.maxSize){this.maxSize=value;}
this.totalSize+=value;if(this.totalSize>0&&this.values.length==count){var pointStart=-10;var totalGrad=this.getTotalGrad(this.maxSize);for(var I=0;I<this.values.length;I++){pointStart=this.drawPolys(count,pointStart,this.values[I]/totalGrad,this.polyElements[I],this.polyEleNames[I],this.polyEleValues[I],I);}
var pointsStr=this.getPolylinePath(this.polyElements);polyLine.setAttribute("points",pointsStr);}}
PolylineChart.prototype.getPolylinePath=function(polys){var points="";for(var I=0;I<polys.length;I++){points=points+polys[I].getAttribute("cx")+", "+polys[I].getAttribute("cy")+" ";}
return points;}
PolylineChart.prototype.drawPolys=function(count,Start,Height,Element,Label,Value,I){var cx=this.chartWidth/(count-1)*I;var cy=-this.chartHeight*Height;Element.setAttribute("cx",cx);Element.setAttribute("cy",cy);Label.setAttribute("x",Start/this.angleFactor)
Label.setAttribute("y",Start*-1/this.angleFactor)
Value.setAttribute("x",Start);Value.setAttribute("y",(-this.chartHeight*Height));return Start+this.chartWidth/(count-1);}
PolylineChart.prototype.createDesList=function(DesListGroup,DesTextGroup,EleID,EleName,EleColor){var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','circle');ele.setAttribute("transform","translate(0,4)");ele.setAttribute("cx","0");ele.setAttribute("cy",18*EleID);ele.setAttribute("r","5");ele.setAttribute("style","stroke:white;fill:"+EleColor);this.desList.push(ele);this.getDoc().getElementById(DesListGroup).appendChild(ele);var ele2=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');ele2.setAttribute("transform","translate(0,"+18*EleID+")");ele2.appendChild(this.getDoc().createTextNode(EleName));this.desTextList.push(ele2);this.getDoc().getElementById(DesTextGroup).appendChild(ele2);}

function StackedBarChart(){BaseChart.call(this);this.chartHeight=240;this.chartWidth=396;this.eleWidth=26;this.spaceWidth=15;this.chartEleGroup=null;this.barEleNames=new Array();this.sumValues=new Array();this.values=new Array();this.stackDesList=new Array();this.eventGroup=null;this.maxSize=0;this.angleFactor=Math.pow(2,0.5);}
StackedBarChart.prototype=new BaseChart();StackedBarChart.prototype.initSvg=function(){this.coordType=1;this.showScrool=true;this.drawSvg();this.chartEleGroup=this.getDoc().getElementById("parentChart");}
StackedBarChart.prototype.drawSvg=function(){var stackedBarChart=document.createElementNS("http://www.w3.org/2000/svg","g");chart.appendChild(stackedBarChart);stackedBarChart.setAttribute("id","stackedBarChart");var parentChart=document.createElementNS("http://www.w3.org/2000/svg","g");stackedBarChart.appendChild(parentChart);parentChart.setAttribute("id","parentChart");var labels=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(labels);labels.setAttribute("id","labels");labels.setAttribute("transform","translate(6, 12)");var stacks=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(stacks);stacks.setAttribute("id","stacks");var stacksValue=document.createElementNS("http://www.w3.org/2000/svg","g");parentChart.appendChild(stacksValue);stacksValue.setAttribute("id","stacksValue");}
StackedBarChart.prototype.addChartItem=function(hasLegend,value,name,repress,count,index){var sumValue=0;for(var i=0;i<value.length;i++){sumValue+=value[i];}
this.sumValues.push(sumValue);this.values.push(value);var eleName=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleName.setAttribute("transform","rotate(45)");eleName.setAttribute("font-family","SimSun");eleName.setAttribute("font-size","14");eleName.appendChild(this.getDoc().createTextNode(name+""));this.getDoc().getElementById("labels").appendChild(eleName);this.barEleNames.push(eleName);if(sumValue>this.maxSize){this.maxSize=sumValue;}
if(this.sumValues.length==count){var barStart=0;var totalGrad=this.getTotalGrad(this.maxSize);for(var I=0;I<this.sumValues.length;I++){barStart=this.drawBarSegment(this.values[I],this.sumValues[I],barStart,this.sumValues[I]/totalGrad,this.barEleNames[I]);}
var desList=this.getStackDesList();for(var d=0;d<desList.length;d++){this.createDesList("deslist","destext",d,desList[d],this.getColor(value.length));}}}
StackedBarChart.prototype.drawBarSegment=function(value,sum,Start,Height,Label){var subHeightPer=0;var y=0;var x=0;for(var i=0;i<value.length;i++){this.setLinearGrad(i,this.getColor(value.length));subHeightPer=value[i]/sum;var h=this.chartHeight*Height*subHeightPer;x=Start;y=y-h;var ele=this.getDoc().createElementNS('http://www.w3.org/2000/svg','rect');ele.setAttribute("x",x);ele.setAttribute("y",y);ele.setAttribute("width",this.eleWidth);ele.setAttribute("height",h);ele.setAttribute("style","stroke:none;fill:"+"url(#linearGrad"+i+")");this.getDoc().getElementById("stacks").appendChild(ele);var barValue=value[i];ele.setAttribute("onmouseover","window["+this.id+"].displayValue(evt,'"+barValue+"')");ele.setAttribute("onmouseout","window["+this.id+"].hiddenValue()");}
Label.setAttribute("x",Start/this.angleFactor)
Label.setAttribute("y",Start*-1/this.angleFactor)
return Start+this.eleWidth+this.spaceWidth;}
StackedBarChart.prototype.setStackDesList=function(desList){this.stackDesList=desList;}
StackedBarChart.prototype.getStackDesList=function(){return this.stackDesList;}
StackedBarChart.prototype.displayValue=function(evt,value){var objet=evt.target;var x=Number(objet.getAttribute("x"));var y=Number(objet.getAttribute("y"));var eleValue=this.getDoc().createElementNS('http://www.w3.org/2000/svg','text');eleValue.setAttribute("style","text-anchor:start;font-weight:bold;font-size:13;visibility:show");eleValue.appendChild(this.getDoc().createTextNode(value));eleValue.setAttribute("x",x+this.eleWidth/3);eleValue.setAttribute("y",y+10);this.getDoc().getElementById("stacksValue").appendChild(eleValue);}
StackedBarChart.prototype.hiddenValue=function(){var svChildren=this.getDoc().getElementById("stacksValue").childNodes;for(var i=0;i<svChildren.length;i++){this.getDoc().getElementById("stacksValue").removeChild(svChildren.item(i));}}
