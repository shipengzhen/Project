
L5.lib.Anim=function(){}
L5.lib.Anim.scroll=function(el,args,duration,easing,cb,scope){return this.run(el,args,duration,easing,cb,scope,L5.lib.Scroll);};L5.lib.Anim.motion=function(el,args,duration,easing,cb,scope){return this.run(el,args,duration,easing,cb,scope,L5.lib.Motion);};L5.lib.Anim.color=function(el,args,duration,easing,cb,scope){return this.run(el,args,duration,easing,cb,scope,L5.lib.ColorAnim);};L5.lib.Anim.run=function(el,args,duration,easing,cb,scope,type){type=type||L5.lib.AnimBase;if(typeof easing=="string"){easing=L5.lib.Easing[easing];}
var anim=new type(el,args,duration,easing);anim.animateX(function(){L5.callback(cb,scope);});return anim;};L5.lib.AnimBase=function(el,attributes,duration,method){if(el){this.init(el,attributes,duration,method);}};L5.lib.AnimBase.prototype={toString:function(){var el=this.getEl();var id=el.id||el.tagName;return("Anim "+id);},patterns:{noNegatives:/width|height|opacity|padding/i,offsetAttribute:/^((width|height)|(top|left))$/,defaultUnit:/width|height|top$|bottom$|left$|right$/i,offsetUnit:/\d+(em|%|en|ex|pt|in|cm|mm|pc)$/i},doMethod:function(attr,start,end){return this.method(this.currentFrame,start,end-start,this.totalFrames);},setAttribute:function(attr,val,unit){if(this.patterns.noNegatives.test(attr)){val=(val>0)?val:0;}
L5.fly(this.getEl(),'_anim').setStyle(attr,val+unit);},getAttribute:function(attr){var el=this.getEl();var val=L5.lib.Dom.fly(el).getStyle(attr);if(val!=='auto'&&!this.patterns.offsetUnit.test(val)){return parseFloat(val);}
var a=this.patterns.offsetAttribute.exec(attr)||[];var pos=!!(a[3]);var box=!!(a[2]);if(box||(L5.lib.Dom.fly(el).getStyle('position')=='absolute'&&pos)){val=el['offset'+a[0].charAt(0).toUpperCase()+a[0].substr(1)];}else{val=0;}
return val;},getDefaultUnit:function(attr){if(this.patterns.defaultUnit.test(attr)){return'px';}
return'';},animateX:function(callback,scope){var f=function(){this.onComplete.removeListener(f);if(typeof callback=="function"){callback.call(scope||this,this);}};this.onComplete.addListener(f,this);this.animate();},setRuntimeAttribute:function(attr){var start;var end;var attributes=this.attributes;this.runtimeAttributes[attr]={};var isset=function(prop){return(typeof prop!=='undefined');};if(!isset(attributes[attr]['to'])&&!isset(attributes[attr]['by'])){return false;}
start=(isset(attributes[attr]['from']))?attributes[attr]['from']:this.getAttribute(attr);if(isset(attributes[attr]['to'])){end=attributes[attr]['to'];}else if(isset(attributes[attr]['by'])){if(start.constructor==Array){end=[];for(var i=0,len=start.length;i<len;++i){end[i]=start[i]+attributes[attr]['by'][i];}}else{end=start+attributes[attr]['by'];}}
this.runtimeAttributes[attr].start=start;this.runtimeAttributes[attr].end=end;this.runtimeAttributes[attr].unit=(isset(attributes[attr].unit))?attributes[attr]['unit']:this.getDefaultUnit(attr);},init:function(el,attributes,duration,method){var isAnimated=false;var startTime=null;var actualFrames=0;el=L5.getDom(el);this.attributes=attributes||{};this.duration=duration||1;this.method=method||L5.lib.Easing.easeNone;this.useSeconds=true;this.currentFrame=0;this.totalFrames=L5.lib.AnimMgr.fps;this.getEl=function(){return el;};this.isAnimated=function(){return isAnimated;};this.getStartTime=function(){return startTime;};this.runtimeAttributes={};this.animate=function(){if(this.isAnimated()){return false;}
this.currentFrame=0;this.totalFrames=(this.useSeconds)?Math.ceil(L5.lib.AnimMgr.fps*this.duration):this.duration;L5.lib.AnimMgr.registerElement(this);};this.stop=function(finish){if(finish){this.currentFrame=this.totalFrames;this._onTween.fire();}
L5.lib.AnimMgr.stop(this);};var onStart=function(){this.onStart.fire();this.runtimeAttributes={};for(var attr in this.attributes){this.setRuntimeAttribute(attr);}
isAnimated=true;actualFrames=0;startTime=new Date();};var onTween=function(){var data={duration:new Date()-this.getStartTime(),currentFrame:this.currentFrame};data.toString=function(){return('duration: '+data.duration+', currentFrame: '+data.currentFrame);};this.onTween.fire(data);var runtimeAttributes=this.runtimeAttributes;for(var attr in runtimeAttributes){this.setAttribute(attr,this.doMethod(attr,runtimeAttributes[attr].start,runtimeAttributes[attr].end),runtimeAttributes[attr].unit);}
actualFrames+=1;};var onComplete=function(){var actual_duration=(new Date()-startTime)/1000;var data={duration:actual_duration,frames:actualFrames,fps:actualFrames/actual_duration};data.toString=function(){return('duration: '+data.duration+', frames: '
+data.frames+', fps: '+data.fps);};isAnimated=false;actualFrames=0;this.onComplete.fire(data);};this._onStart=new L5.util.Event(this);this.onStart=new L5.util.Event(this);this.onTween=new L5.util.Event(this);this._onTween=new L5.util.Event(this);this.onComplete=new L5.util.Event(this);this._onComplete=new L5.util.Event(this);this._onStart.addListener(onStart);this._onTween.addListener(onTween);this._onComplete.addListener(onComplete);}};L5.lib.AnimMgr=function(){};(function(){var thread=null;var queue=[];var tweenCount=0;var getIndex=function(anim){for(var i=0,len=queue.length;i<len;++i){if(queue[i]==anim){return i;}}
return-1;};var correctFrame=function(tween){var frames=tween.totalFrames;var frame=tween.currentFrame;var expected=(tween.currentFrame*tween.duration*1000/tween.totalFrames);var elapsed=(new Date()-tween.getStartTime());var tweak=0;if(elapsed<tween.duration*1000){tweak=Math.round((elapsed/expected-1)*tween.currentFrame);}else{tweak=frames-(frame+1);}
if(tweak>0&&isFinite(tweak)){if(tween.currentFrame+tweak>=frames){tweak=frames-(frame+1);}
tween.currentFrame+=tweak;}};L5.lib.AnimMgr.fps=1000;L5.lib.AnimMgr.delay=1;L5.lib.AnimMgr.registerElement=function(tween){queue[queue.length]=tween;tweenCount+=1;tween._onStart.fire();this.start();};L5.lib.AnimMgr.unRegister=function(tween,index){tween._onComplete.fire();index=index||getIndex(tween);if(index!=-1){queue.splice(index,1);}
tweenCount-=1;if(tweenCount<=0){this.stop();}};L5.lib.AnimMgr.start=function(){if(thread===null){thread=setInterval(this.run,this.delay);}};L5.lib.AnimMgr.stop=function(tween){if(!tween){clearInterval(thread);for(var i=0,len=queue.length;i<len;++i){if(queue[0].isAnimated()){this.unRegister(queue[0],0);}}
queue=[];thread=null;tweenCount=0;}else{this.unRegister(tween);}};L5.lib.AnimMgr.run=function(){for(var i=0,len=queue.length;i<len;++i){var tween=queue[i];if(!tween||!tween.isAnimated()){continue;}
if(tween.currentFrame<tween.totalFrames||tween.totalFrames===null){tween.currentFrame+=1;if(tween.useSeconds){correctFrame(tween);}
tween._onTween.fire();}else{L5.lib.AnimMgr.stop(tween,i);}}};})();L5.lib.Bezier=function(){};L5.lib.Bezier.getPosition=function(points,t){var n=points.length;var tmp=[];for(var i=0;i<n;++i){tmp[i]=[points[i][0],points[i][1]];}
for(var j=1;j<n;++j){for(i=0;i<n-j;++i){tmp[i][0]=(1-t)*tmp[i][0]+t*tmp[parseInt(i+1,10)][0];tmp[i][1]=(1-t)*tmp[i][1]+t*tmp[parseInt(i+1,10)][1];}}
return[tmp[0][0],tmp[0][1]];};L5.lib.Easing=function(){};L5.lib.Easing.easeNone=function(t,b,c,d){return c*t/d+b;};L5.lib.Easing.easeIn=function(t,b,c,d){return c*(t/=d)*t+b;};L5.lib.Easing.easeOut=function(t,b,c,d){return-c*(t/=d)*(t-2)+b;};L5.lib.Easing.easeBoth=function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b;}
return-c/2*((--t)*(t-2)-1)+b;};L5.lib.Easing.easeInStrong=function(t,b,c,d){return c*(t/=d)*t*t*t+b;};L5.lib.Easing.easeOutStrong=function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b;};L5.lib.Easing.easeBothStrong=function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b;}
return-c/2*((t-=2)*t*t*t-2)+b;};L5.lib.Easing.elasticIn=function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d)==1){return b+c;}
if(!p){p=d*.3;}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}
return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))
+b;};L5.lib.Easing.elasticOut=function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d)==1){return b+c;}
if(!p){p=d*.3;}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}
return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)
+c+b;};L5.lib.Easing.elasticBoth=function(t,b,c,d,a,p){if(t==0){return b;}
if((t/=d/2)==2){return b+c;}
if(!p){p=d*(.3*1.5);}
if(!a||a<Math.abs(c)){a=c;var s=p/4;}else{var s=p/(2*Math.PI)*Math.asin(c/a);}
if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;}
return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;};L5.lib.Easing.backIn=function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
return c*(t/=d)*t*((s+1)*t-s)+b;};L5.lib.Easing.backOut=function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;};L5.lib.Easing.backBoth=function(t,b,c,d,s){if(typeof s=='undefined'){s=1.70158;}
if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;}
return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;};L5.lib.Easing.bounceIn=function(t,b,c,d){return c-L5.lib.Easing.bounceOut(d-t,0,c,d)+b;};L5.lib.Easing.bounceOut=function(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}
return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;};L5.lib.Easing.bounceBoth=function(t,b,c,d){if(t<d/2){return L5.lib.Easing.bounceIn(t*2,0,c,d)*.5+b;}
return L5.lib.Easing.bounceOut(t*2-d,0,c,d)*.5+c*.5+b;};L5.lib.ColorAnim=function(el,attributes,duration,method){L5.lib.ColorAnim.superclass.constructor.call(this,el,attributes,duration,method);};L5.extend(L5.lib.ColorAnim,L5.lib.AnimBase);(function(){var superclass=L5.lib.ColorAnim.superclass;var proto=L5.lib.ColorAnim.prototype;L5.lib.ColorAnim.prototype.toString=function(){var el=this.getEl();var id=el.id||el.tagName;return("ColorAnim "+id);};proto.patterns.color=/color$/i;proto.patterns.rgb=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i;proto.patterns.hex=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i;proto.patterns.hex3=/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;proto.patterns.transparent=/^transparent|rgba\(0, 0, 0, 0\)$/;L5.lib.ColorAnim.prototype.parseColor=function(s){if(s.length==3){return s;}
var c=this.patterns.hex.exec(s);if(c&&c.length==4){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];}
c=this.patterns.rgb.exec(s);if(c&&c.length==4){return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];}
c=this.patterns.hex3.exec(s);if(c&&c.length==4){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)];}
return null;};L5.lib.ColorAnim.prototype.getAttribute=function(attr){var el=this.getEl();if(this.patterns.color.test(attr)){var val=L5.lib.Dom.fly(el).getStyle(attr);if(this.patterns.transparent.test(val)){var parent=el.parentNode;val=L5.lib.Dom.fly(parent).getStyle(attr);while(parent&&this.patterns.transparent.test(val)){parent=parent.parentNode;val=L5.lib.Dom.fly(parent).getStyle(attr);if(parent.tagName.toUpperCase()=='HTML'){val='#fff';}}}}else{val=superclass.getAttribute.call(this,attr);}
return val;};L5.lib.ColorAnim.prototype.doMethod=function(attr,start,end){var val;if(this.patterns.color.test(attr)){val=[];for(var i=0,len=start.length;i<len;++i){val[i]=superclass.doMethod.call(this,attr,start[i],end[i]);}
val='rgb('+Math.floor(val[0])+','+Math.floor(val[1])+','
+Math.floor(val[2])+')';}else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};L5.lib.ColorAnim.prototype.setRuntimeAttribute=function(attr){superclass.setRuntimeAttribute.call(this,attr);if(this.patterns.color.test(attr)){var attributes=this.attributes;var start=this.parseColor(this.runtimeAttributes[attr].start);var end=this.parseColor(this.runtimeAttributes[attr].end);if(typeof attributes[attr]['to']==='undefined'&&typeof attributes[attr]['by']!=='undefined'){end=this.parseColor(attributes[attr].by);for(var i=0,len=start.length;i<len;++i){end[i]=start[i]+end[i];}}
this.runtimeAttributes[attr].start=start;this.runtimeAttributes[attr].end=end;}};})();L5.lib.Motion=function(el,attributes,duration,method){if(el){L5.lib.Motion.superclass.constructor.call(this,el,attributes,duration,method);}};L5.extend(L5.lib.Motion,L5.lib.ColorAnim);(function(){var superclass=L5.lib.Motion.superclass;var translateValues=function(val,start){var pageXY=L5.lib.Dom.getXY(this.getEl());val=[val[0]-pageXY[0]+start[0],val[1]-pageXY[1]+start[1]];return val;};var isset=function(prop){return(typeof prop!=='undefined');};L5.lib.Motion.prototype.toString=function(){var el=this.getEl();var id=el.id||el.tagName;return("Motion "+id);};L5.lib.Motion.prototype.patterns.points=/^points$/i;L5.lib.Motion.prototype.setAttribute=function(attr,val,unit){if(this.patterns.points.test(attr)){unit=unit||'px';superclass.setAttribute.call(this,'left',val[0],unit);superclass.setAttribute.call(this,'top',val[1],unit);}else{superclass.setAttribute.call(this,attr,val,unit);}};L5.lib.Motion.prototype.getAttribute=function(attr){if(this.patterns.points.test(attr)){var val=[superclass.getAttribute.call(this,'left'),superclass.getAttribute.call(this,'top')];}else{val=superclass.getAttribute.call(this,attr);}
return val;};L5.lib.Motion.prototype.doMethod=function(attr,start,end){var val=null;if(this.patterns.points.test(attr)){var t=this.method(this.currentFrame,0,100,this.totalFrames)/100;val=L5.lib.Bezier.getPosition(this.runtimeAttributes[attr],t);}else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};L5.lib.Motion.prototype.setRuntimeAttribute=function(attr){if(this.patterns.points.test(attr)){var el=this.getEl();var attributes=this.attributes;var start;var control=attributes['points']['control']||[];var end;var i,len;if(control.length>0&&!L5.isArray(control[0])){control=[control];}else{var tmp=[];for(i=0,len=control.length;i<len;++i){tmp[i]=control[i];}
control=tmp;}
L5.fly(el,'_anim').position();if(isset(attributes['points']['from'])){L5.lib.Dom.setXY(el,attributes['points']['from']);}else{L5.lib.Dom.setXY(el,L5.lib.Dom.getXY(el));}
start=this.getAttribute('points');if(isset(attributes['points']['to'])){end=translateValues.call(this,attributes['points']['to'],start);var pageXY=L5.lib.Dom.getXY(this.getEl());for(i=0,len=control.length;i<len;++i){control[i]=translateValues.call(this,control[i],start);}}else if(isset(attributes['points']['by'])){end=[start[0]+attributes['points']['by'][0],start[1]+attributes['points']['by'][1]];for(i=0,len=control.length;i<len;++i){control[i]=[start[0]+control[i][0],start[1]+control[i][1]];}}
this.runtimeAttributes[attr]=[start];if(control.length>0){this.runtimeAttributes[attr]=this.runtimeAttributes[attr].concat(control);}
this.runtimeAttributes[attr][this.runtimeAttributes[attr].length]=end;}else{superclass.setRuntimeAttribute.call(this,attr);}};})();L5.lib.Scroll=function(el,attributes,duration,method){if(el){L5.lib.Scroll.superclass.constructor.call(this,el,attributes,duration,method);}};L5.extend(L5.lib.Scroll,L5.lib.ColorAnim);(function(){var superclass=L5.lib.Scroll.superclass;L5.lib.Scroll.prototype.toString=function(){var el=this.getEl();var id=el.id||el.tagName;return("Scroll "+id);};L5.lib.Scroll.prototype.doMethod=function(attr,start,end){var val=null;if(attr=='scroll'){val=[this.method(this.currentFrame,start[0],end[0]-start[0],this.totalFrames),this.method(this.currentFrame,start[1],end[1]-start[1],this.totalFrames)];}else{val=superclass.doMethod.call(this,attr,start,end);}
return val;};L5.lib.Scroll.prototype.getAttribute=function(attr){var val=null;var el=this.getEl();if(attr=='scroll'){val=[el.scrollLeft,el.scrollTop];}else{val=superclass.getAttribute.call(this,attr);}
return val;};L5.lib.Scroll.prototype.setAttribute=function(attr,val,unit){var el=this.getEl();if(attr=='scroll'){el.scrollLeft=val[0];el.scrollTop=val[1];}else{superclass.setAttribute.call(this,attr,val,unit);}};})();

L5.enableFx=true;L5.Element.prototype.slideIn=function(anchor,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){anchor=anchor||"t";this.fixDisplay();var r=this.getFxRestore();var b=this.getBox();this.setSize(b);var wrap=this.fxWrap(r.pos,o,"hidden");var st=this.dom.style;st.visibility="visible";st.position="absolute";var after=function(){el.fxUnwrap(wrap,r.pos,o);st.width=r.width;st.height=r.height;el.afterFx(o);};var a,pt={to:[b.x,b.y]},bw={to:b.width},bh={to:b.height};switch(anchor.toLowerCase()){case"t":wrap.setSize(b.width,0);st.left=st.bottom="0";a={height:bh};break;case"l":wrap.setSize(0,b.height);st.right=st.top="0";a={width:bw};break;case"r":wrap.setSize(0,b.height);wrap.setX(b.right);st.left=st.top="0";a={width:bw,points:pt};break;case"b":wrap.setSize(b.width,0);wrap.setY(b.bottom);st.left=st.top="0";a={height:bh,points:pt};break;case"tl":wrap.setSize(0,0);st.right=st.bottom="0";a={width:bw,height:bh};break;case"bl":wrap.setSize(0,0);wrap.setY(b.y+b.height);st.right=st.top="0";a={width:bw,height:bh,points:pt};break;case"br":wrap.setSize(0,0);wrap.setXY([b.right,b.bottom]);st.left=st.top="0";a={width:bw,height:bh,points:pt};break;case"tr":wrap.setSize(0,0);wrap.setX(b.x+b.width);st.left=st.bottom="0";a={width:bw,height:bh,points:pt};break;}
this.dom.style.visibility="visible";wrap.show();arguments.callee.anim=wrap.fxanim(a,o,'motion',.5,'easeOut',after);});return this;};L5.Element.prototype.slideOut=function(anchor,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){anchor=anchor||"t";var r=this.getFxRestore();var b=this.getBox();this.setSize(b);var wrap=this.fxWrap(r.pos,o,"visible");var st=this.dom.style;st.visibility="visible";st.position="absolute";wrap.setSize(b);var after=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}
el.fxUnwrap(wrap,r.pos,o);st.width=r.width;st.height=r.height;el.afterFx(o);};var a,zero={to:0};switch(anchor.toLowerCase()){case"t":st.left=st.bottom="0";a={height:zero};break;case"l":st.right=st.top="0";a={width:zero};break;case"r":st.left=st.top="0";a={width:zero,points:{to:[b.right,b.y]}};break;case"b":st.left=st.top="0";a={height:zero,points:{to:[b.x,b.bottom]}};break;case"tl":st.right=st.bottom="0";a={width:zero,height:zero};break;case"bl":st.right=st.top="0";a={width:zero,height:zero,points:{to:[b.x,b.bottom]}};break;case"br":st.left=st.top="0";a={width:zero,height:zero,points:{to:[b.x+b.width,b.bottom]}};break;case"tr":st.left=st.bottom="0";a={width:zero,height:zero,points:{to:[b.right,b.y]}};break;}
arguments.callee.anim=wrap.fxanim(a,o,'motion',.5,"easeOut",after);});return this;};L5.Element.prototype.puff=function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.clearOpacity();this.show();var r=this.getFxRestore();var st=this.dom.style;var after=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}
el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;st.fontSize='';el.afterFx(o);};var width=this.getWidth();var height=this.getHeight();arguments.callee.anim=this.fxanim({width:{to:this.adjustWidth(width*2)},height:{to:this.adjustHeight(height*2)},points:{by:[-(width*.5),-(height*.5)]},opacity:{to:0},fontSize:{to:200,unit:"%"}},o,'motion',.5,"easeOut",after);});return this;};L5.Element.prototype.switchOff=function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.clearOpacity();this.clip();var r=this.getFxRestore();var st=this.dom.style;var after=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}
el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;el.afterFx(o);};this.fxanim({opacity:{to:0.3}},null,null,.1,null,function(){this.clearOpacity();(function(){this.fxanim({height:{to:1},points:{by:[0,this.getHeight()*.5]}},o,'motion',0.3,'easeIn',after);}).defer(100,this);});});return this;};L5.Element.prototype.highlight=function(color,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){color=color||"ffff9c";var attr=o.attr||"backgroundColor";this.clearOpacity();this.show();var origColor=this.getColor(attr);var restoreColor=this.dom.style[attr];var endColor=(o.endColor||origColor)||"ffffff";var after=function(){el.dom.style[attr]=restoreColor;el.afterFx(o);};var a={};a[attr]={from:color,to:endColor};arguments.callee.anim=this.fxanim(a,o,'color',1,'easeIn',after);});return this;};L5.Element.prototype.frame=function(color,count,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){color=color||"#C3DAF9";if(color.length==6){color="#"+color;}
count=count||1;var duration=o.duration||1;this.show();var b=this.getBox();var animFn=function(){var proxy=L5.getBody().createChild({style:{visbility:"hidden",position:"absolute","z-index":"35000",border:"0px solid "+color}});var scale=L5.isBorderBox?2:1;proxy.animate({top:{from:b.y,to:b.y-20},left:{from:b.x,to:b.x-20},borderWidth:{from:0,to:10},opacity:{from:1,to:0},height:{from:b.height,to:(b.height+(20*scale))},width:{from:b.width,to:(b.width+(20*scale))}},duration,function(){proxy.remove();if(--count>0){animFn();}else{el.afterFx(o);}});};animFn.call(this);});return this;};L5.Element.prototype.pause=function(seconds){var el=this.getFxEl();var o={};el.queueFx(o,function(){setTimeout(function(){el.afterFx(o);},seconds*1000);});return this;};L5.Element.prototype.fadeIn=function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){this.setOpacity(0);this.fixDisplay();this.dom.style.visibility='visible';var to=o.endOpacity||1;arguments.callee.anim=this.fxanim({opacity:{to:to}},o,null,.5,"easeOut",function(){if(to==1){this.clearOpacity();}
el.afterFx(o);});});return this;};L5.Element.prototype.fadeOut=function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){var to=o.endOpacity||0;arguments.callee.anim=this.fxanim({opacity:{to:to}},o,null,.5,"easeOut",function(){if(to===0){if(this.visibilityMode==L5.Element.DISPLAY||o.useDisplay){this.dom.style.display="none";}else{this.dom.style.visibility="hidden";}
this.clearOpacity();}
el.afterFx(o);});});return this;};L5.Element.prototype.scale=function(w,h,o){this.shift(L5.apply({},o,{width:w,height:h}));return this;};L5.Element.prototype.shift=function(o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){var a={},w=o.width,h=o.height,x=o.x,y=o.y,op=o.opacity;if(w!==undefined){a.width={to:this.adjustWidth(w)};}
if(h!==undefined){a.height={to:this.adjustHeight(h)};}
if(o.left!==undefined){a.left={to:o.left};}
if(o.top!==undefined){a.top={to:o.top};}
if(o.right!==undefined){a.right={to:o.right};}
if(o.bottom!==undefined){a.bottom={to:o.bottom};}
if(x!==undefined||y!==undefined){a.points={to:[x!==undefined?x:this.getX(),y!==undefined?y:this.getY()]};}
if(op!==undefined){a.opacity={to:op};}
if(o.xy!==undefined){a.points={to:o.xy};}
arguments.callee.anim=this.fxanim(a,o,'motion',.35,"easeOut",function(){el.afterFx(o);});});return this;};L5.Element.prototype.ghost=function(anchor,o){var el=this.getFxEl();o=o||{};el.queueFx(o,function(){anchor=anchor||"b";var r=this.getFxRestore();var w=this.getWidth(),h=this.getHeight();var st=this.dom.style;var after=function(){if(o.useDisplay){el.setDisplayed(false);}else{el.hide();}
el.clearOpacity();el.setPositioning(r.pos);st.width=r.width;st.height=r.height;el.afterFx(o);};var a={opacity:{to:0},points:{}},pt=a.points;switch(anchor.toLowerCase()){case"t":pt.by=[0,-h];break;case"l":pt.by=[-w,0];break;case"r":pt.by=[w,0];break;case"b":pt.by=[0,h];break;case"tl":pt.by=[-w,-h];break;case"bl":pt.by=[-w,h];break;case"br":pt.by=[w,h];break;case"tr":pt.by=[w,-h];break;}
arguments.callee.anim=this.fxanim(a,o,'motion',.5,"easeOut",after);});return this;};L5.Element.prototype.syncFx=function(){this.fxDefaults=L5.apply(this.fxDefaults||{},{block:false,concurrent:true,stopFx:false});return this;};L5.Element.prototype.sequenceFx=function(){this.fxDefaults=L5.apply(this.fxDefaults||{},{block:false,concurrent:false,stopFx:false});return this;};L5.Element.prototype.nextFx=function(){var ef=this.fxQueue[0];if(ef){ef.call(this);}};L5.Element.prototype.hasActiveFx=function(){return this.fxQueue&&this.fxQueue[0];};L5.Element.prototype.stopFx=function(){if(this.hasActiveFx()){var cur=this.fxQueue[0];if(cur&&cur.anim&&cur.anim.isAnimated()){this.fxQueue=[cur];cur.anim.stop(true);}}
return this;};L5.Element.prototype.beforeFx=function(o){if(this.hasActiveFx()&&!o.concurrent){if(o.stopFx){this.stopFx();return true;}
return false;}
return true;};L5.Element.prototype.hasFxBlock=function(){var q=this.fxQueue;return q&&q[0]&&q[0].block;};L5.Element.prototype.queueFx=function(o,fn){if(!this.fxQueue){this.fxQueue=[];}
if(!this.hasFxBlock()){L5.applyIf(o,this.fxDefaults);if(!o.concurrent){var run=this.beforeFx(o);fn.block=o.block;this.fxQueue.push(fn);if(run){this.nextFx();}}else{fn.call(this);}}
return this;};L5.Element.prototype.fxWrap=function(pos,o,vis){var wrap;if(!o.wrap||!(wrap=L5.get(o.wrap))){var wrapXY;if(o.fixPosition){wrapXY=this.getXY();}
var div=document.createElement("div");div.style.visibility=vis;wrap=L5.get(this.dom.parentNode.insertBefore(div,this.dom));wrap.setPositioning(pos);if(wrap.getStyle("position")=="static"){wrap.position("relative");}
this.clearPositioning('auto');wrap.clip();wrap.dom.appendChild(this.dom);if(wrapXY){wrap.setXY(wrapXY);}}
return wrap;};L5.Element.prototype.fxUnwrap=function(wrap,pos,o){this.clearPositioning();this.setPositioning(pos);if(!o.wrap){wrap.dom.parentNode.insertBefore(this.dom,wrap.dom);wrap.remove();}},L5.Element.prototype.getFxRestore=function(){var st=this.dom.style;return{pos:this.getPositioning(),width:st.width,height:st.height};};L5.Element.prototype.afterFx=function(o){if(o.afterStyle){this.applyStyles(o.afterStyle);}
if(o.afterCls){this.addClass(o.afterCls);}
if(o.remove===true){this.remove();}
L5.callback(o.callback,o.scope,[this]);if(!o.concurrent){this.fxQueue.shift();this.nextFx();}};L5.Element.prototype.getFxEl=function(){return L5.get(this.dom);};L5.Element.prototype.fxanim=function(args,opt,animType,defaultDur,defaultEase,cb){animType=animType||'run';opt=opt||{};var anim=L5.lib.Anim[animType](this.dom,args,(opt.duration||defaultDur)||.35,(opt.easing||defaultEase)||'easeOut',function(){L5.callback(cb,this);},this);opt.anim=anim;return anim;};L5.Element.prototype.animate=function(args,duration,onComplete,easing,animType){this.anim(args,{duration:duration,callback:onComplete,easing:easing},animType);return this;};L5.Element.prototype.anim=function(args,opt,animType,defaultDur,defaultEase,cb){animType=animType||'run';opt=opt||{};var anim=L5.lib.Anim[animType](this.dom,args,(opt.duration||defaultDur)||.35,(opt.easing||defaultEase)||'easeOut',function(){L5.callback(cb,this);L5.callback(opt.callback,opt.scope||this,[this,opt]);},this);opt.anim=anim;return anim;};L5.Element.prototype.preanim=function(a,i){return!a[i]?false:(typeof a[i]=="object"?a[i]:{duration:a[i+1],callback:a[i+2],easing:a[i+3]});};

(function(){var Event=L5.EventManager;var Dom=L5.lib.Dom;L5.dd.DragDrop=function(id,sGroup,config){if(id){this.init(id,sGroup,config);}};L5.dd.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true;},moveOnly:false,unlock:function(){this.locked=false;},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},onInvalidDrop:function(e){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(constrainTo,pad,inContent){if(typeof pad=="number"){pad={left:pad,right:pad,top:pad,bottom:pad};}
pad=pad||this.defaultPadding;var b=L5.get(this.getEl()).getBox();var ce=L5.get(constrainTo);var s=ce.getScroll();var c,cd=ce.dom;if(cd==document.body){c={x:s.left,y:s.top,width:L5.lib.Dom.getViewWidth(),height:L5.lib.Dom.getViewHeight()};}else{var xy=ce.getXY();c={x:xy[0]+s.left,y:xy[1]+s.top,width:cd.clientWidth,height:cd.clientHeight};}
var topSpace=b.y-c.y;var leftSpace=b.x-c.x;this.resetConstraints();this.setXConstraint(leftSpace-(pad.left||0),c.width-leftSpace-b.width-(pad.right||0),this.xTickSize);this.setYConstraint(topSpace-(pad.top||0),c.height-topSpace-b.height-(pad.bottom||0),this.yTickSize);},getEl:function(){if(!this._domRef){this._domRef=L5.getDom(this.id);}
return this._domRef;},getDragEl:function(){return L5.getDom(this.dragElId);},init:function(id,sGroup,config){this.initTarget(id,sGroup,config);Event.on(this.id,"mousedown",this.handleMouseDown,this);},initTarget:function(id,sGroup,config){this.config=config||{};this.DDM=L5.dd.DDM;this.groups={};if(typeof id!=="string"){id=L5.id(id);}
this.id=id;this.addToGroup((sGroup)?sGroup:"default");this.handleElId=id;this.setDragElId(id);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable();},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false);},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable();},setPadding:function(iTop,iRight,iBot,iLeft){if(!iRight&&0!==iRight){this.padding=[iTop,iTop,iTop,iTop];}else if(!iBot&&0!==iBot){this.padding=[iTop,iRight,iTop,iRight];}else{this.padding=[iTop,iRight,iBot,iLeft];}},setInitPosition:function(diffX,diffY){var el=this.getEl();if(!this.DDM.verifyEl(el)){return;}
var dx=diffX||0;var dy=diffY||0;var p=Dom.getXY(el);this.initPageX=p[0]-dx;this.initPageY=p[1]-dy;this.lastPageX=p[0];this.lastPageY=p[1];this.setStartPosition(p);},setStartPosition:function(pos){var p=pos||Dom.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=p[0];this.startPageY=p[1];},addToGroup:function(sGroup){this.groups[sGroup]=true;this.DDM.regDragDrop(this,sGroup);},removeFromGroup:function(sGroup){if(this.groups[sGroup]){delete this.groups[sGroup];}
this.DDM.removeDDFromGroup(this,sGroup);},setDragElId:function(id){this.dragElId=id;},setHandleElId:function(id){if(typeof id!=="string"){id=L5.id(id);}
this.handleElId=id;this.DDM.regHandle(this.id,id);},setOuterHandleElId:function(id){if(typeof id!=="string"){id=L5.id(id);}
Event.on(id,"mousedown",this.handleMouseDown,this);this.setHandleElId(id);this.hasOuterHandles=true;},unreg:function(){Event.un(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this);},destroy:function(){this.unreg();},isLocked:function(){return(this.DDM.isLocked()||this.locked);},handleMouseDown:function(e,oDD){if(this.primaryButtonOnly&&e.button!=0){return;}
if(this.isLocked()){return;}
this.DDM.refreshCache(this.groups);var pt=new L5.lib.Point(L5.lib.Event.getPageX(e),L5.lib.Event.getPageY(e));if(!this.hasOuterHandles&&!this.DDM.isOverTarget(pt,this)){}else{if(this.clickValidator(e)){this.setStartPosition();this.b4MouseDown(e);this.onMouseDown(e);this.DDM.handleMouseDown(e,this);this.DDM.stopEvent(e);}else{}}},clickValidator:function(e){var target=e.getTarget();return(this.isValidHandleChild(target)&&(this.id==this.handleElId||this.DDM.handleWasClicked(target,this.id)));},addInvalidHandleType:function(tagName){var type=tagName.toUpperCase();this.invalidHandleTypes[type]=type;},addInvalidHandleId:function(id){if(typeof id!=="string"){id=L5.id(id);}
this.invalidHandleIds[id]=id;},addInvalidHandleClass:function(cssClass){this.invalidHandleClasses.push(cssClass);},removeInvalidHandleType:function(tagName){var type=tagName.toUpperCase();delete this.invalidHandleTypes[type];},removeInvalidHandleId:function(id){if(typeof id!=="string"){id=L5.id(id);}
delete this.invalidHandleIds[id];},removeInvalidHandleClass:function(cssClass){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i){if(this.invalidHandleClasses[i]==cssClass){delete this.invalidHandleClasses[i];}}},isValidHandleChild:function(node){var valid=true;var nodeName;try{nodeName=node.nodeName.toUpperCase();}catch(e){nodeName=node.nodeName;}
valid=valid&&!this.invalidHandleTypes[nodeName];valid=valid&&!this.invalidHandleIds[node.id];for(var i=0,len=this.invalidHandleClasses.length;valid&&i<len;++i){valid=!L5.fly(node).hasClass(this.invalidHandleClasses[i]);}
return valid;},setXTicks:function(iStartX,iTickSize){this.xTicks=[];this.xTickSize=iTickSize;var tickMap={};for(var i=this.initPageX;i>=this.minX;i=i-iTickSize){if(!tickMap[i]){this.xTicks[this.xTicks.length]=i;tickMap[i]=true;}}
for(i=this.initPageX;i<=this.maxX;i=i+iTickSize){if(!tickMap[i]){this.xTicks[this.xTicks.length]=i;tickMap[i]=true;}}
this.xTicks.sort(this.DDM.numericSort);},setYTicks:function(iStartY,iTickSize){this.yTicks=[];this.yTickSize=iTickSize;var tickMap={};for(var i=this.initPageY;i>=this.minY;i=i-iTickSize){if(!tickMap[i]){this.yTicks[this.yTicks.length]=i;tickMap[i]=true;}}
for(i=this.initPageY;i<=this.maxY;i=i+iTickSize){if(!tickMap[i]){this.yTicks[this.yTicks.length]=i;tickMap[i]=true;}}
this.yTicks.sort(this.DDM.numericSort);},setXConstraint:function(iLeft,iRight,iTickSize){this.leftConstraint=iLeft;this.rightConstraint=iRight;this.minX=this.initPageX-iLeft;this.maxX=this.initPageX+iRight;if(iTickSize){this.setXTicks(this.initPageX,iTickSize);}
this.constrainX=true;},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks();},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0;},setYConstraint:function(iUp,iDown,iTickSize){this.topConstraint=iUp;this.bottomConstraint=iDown;this.minY=this.initPageY-iUp;this.maxY=this.initPageY+iDown;if(iTickSize){this.setYTicks(this.initPageY,iTickSize);}
this.constrainY=true;},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var dx=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var dy=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy);}else{this.setInitPosition();}
if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);}
if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize);}},getTick:function(val,tickArray){if(!tickArray){return val;}else if(tickArray[0]>=val){return tickArray[0];}else{for(var i=0,len=tickArray.length;i<len;++i){var next=i+1;if(tickArray[next]&&tickArray[next]>=val){var diff1=val-tickArray[i];var diff2=tickArray[next]-val;return(diff2>diff1)?tickArray[i]:tickArray[next];}}
return tickArray[tickArray.length-1];}},toString:function(){return("DragDrop "+this.id);}};})();if(!L5.dd.DragDropMgr){L5.dd.DragDropMgr=function(){var Event=L5.EventManager;return{ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initialized:false,locked:false,init:function(){this.initialized=true;},POINT:0,INTERSECT:1,mode:0,_execOnAll:function(sMethod,args){for(var i in this.ids){for(var j in this.ids[i]){var oDD=this.ids[i][j];if(!this.isTypeOfDD(oDD)){continue;}
oDD[sMethod].apply(oDD,args);}}},_onLoad:function(){this.init();Event.on(document,"mouseup",this.handleMouseUp,this,true);Event.on(document,"mousemove",this.handleMouseMove,this,true);Event.on(window,"unload",this._onUnload,this,true);Event.on(window,"resize",this._onResize,this,true);},_onResize:function(e){this._execOnAll("resetConstraints",[]);},lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isLocked:function(){return this.locked;},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,regDragDrop:function(oDD,sGroup){if(!this.initialized){this.init();}
if(!this.ids[sGroup]){this.ids[sGroup]={};}
this.ids[sGroup][oDD.id]=oDD;},removeDDFromGroup:function(oDD,sGroup){if(!this.ids[sGroup]){this.ids[sGroup]={};}
var obj=this.ids[sGroup];if(obj&&obj[oDD.id]){delete obj[oDD.id];}},_remove:function(oDD){for(var g in oDD.groups){if(g&&this.ids[g]&&this.ids[g][oDD.id]){delete this.ids[g][oDD.id];}}
delete this.handleIds[oDD.id];},regHandle:function(sDDId,sHandleId){if(!this.handleIds[sDDId]){this.handleIds[sDDId]={};}
this.handleIds[sDDId][sHandleId]=sHandleId;},isDragDrop:function(id){return(this.getDDById(id))?true:false;},getRelated:function(p_oDD,bTargetsOnly){var oDDs=[];for(var i in p_oDD.groups){for(j in this.ids[i]){var dd=this.ids[i][j];if(!this.isTypeOfDD(dd)){continue;}
if(!bTargetsOnly||dd.isTarget){oDDs[oDDs.length]=dd;}}}
return oDDs;},isLegalTarget:function(oDD,oTargetDD){var targets=this.getRelated(oDD,true);for(var i=0,len=targets.length;i<len;++i){if(targets[i].id==oTargetDD.id){return true;}}
return false;},isTypeOfDD:function(oDD){return(oDD&&oDD.__ygDragDrop);},isHandle:function(sDDId,sHandleId){return(this.handleIds[sDDId]&&this.handleIds[sDDId][sHandleId]);},getDDById:function(id){for(var i in this.ids){if(this.ids[i][id]){return this.ids[i][id];}}
return null;},handleMouseDown:function(e,oDD){if(L5.QuickTips){L5.QuickTips.disable();}
if(this.dragCurrent){this.handleMouseUp(e);}
this.currentTarget=e.getTarget();this.dragCurrent=oDD;var el=oDD.getEl();this.startX=e.getPageX();this.startY=e.getPageY();this.deltaX=this.startX-el.offsetLeft;this.deltaY=this.startY-el.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var DDM=L5.dd.DDM;DDM.startDrag(DDM.startX,DDM.startY);},this.clickTimeThresh);},startDrag:function(x,y){clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(x,y);this.dragCurrent.startDrag(x,y);}
this.dragThreshMet=true;},handleMouseUp:function(e){if(L5.QuickTips){L5.QuickTips.enable();}
if(!this.dragCurrent){return;}
clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.fireEvents(e,true);}else{}
this.stopDrag(e);this.stopEvent(e);},stopEvent:function(e){if(this.stopPropagation){e.stopPropagation();}
if(this.preventDefault){e.preventDefault();}},stopDrag:function(e){if(this.dragCurrent){if(this.dragThreshMet){this.dragCurrent.b4EndDrag(e);this.dragCurrent.endDrag(e);}
this.dragCurrent.onMouseUp(e);}
this.dragCurrent=null;this.dragOvers={};},handleMouseMove:function(e){if(!this.dragCurrent){return true;}
if(L5.isIE&&(e.button!==0&&e.button!==1&&e.button!==2)){this.stopEvent(e);return this.handleMouseUp(e);}
if(!this.dragThreshMet){var diffX=Math.abs(this.startX-e.getPageX());var diffY=Math.abs(this.startY-e.getPageY());if(diffX>this.clickPixelThresh||diffY>this.clickPixelThresh){this.startDrag(this.startX,this.startY);}}
if(this.dragThreshMet){this.dragCurrent.b4Drag(e);this.dragCurrent.onDrag(e);if(!this.dragCurrent.moveOnly){this.fireEvents(e,false);}}
this.stopEvent(e);return true;},fireEvents:function(e,isDrop){var dc=this.dragCurrent;if(!dc||dc.isLocked()){return;}
var pt=e.getPoint();var oldOvers=[];var outEvts=[];var overEvts=[];var dropEvts=[];var enterEvts=[];for(var i in this.dragOvers){var ddo=this.dragOvers[i];if(!this.isTypeOfDD(ddo)){continue;}
if(!this.isOverTarget(pt,ddo,this.mode)){outEvts.push(ddo);}
oldOvers[i]=true;delete this.dragOvers[i];}
for(var sGroup in dc.groups){if("string"!=typeof sGroup){continue;}
for(i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(!this.isTypeOfDD(oDD)){continue;}
if(oDD.isTarget&&!oDD.isLocked()&&oDD!=dc){if(this.isOverTarget(pt,oDD,this.mode)){if(isDrop){dropEvts.push(oDD);}else{if(!oldOvers[oDD.id]){enterEvts.push(oDD);}else{overEvts.push(oDD);}
this.dragOvers[oDD.id]=oDD;}}}}}
if(this.mode){if(outEvts.length){dc.b4DragOut(e,outEvts);dc.onDragOut(e,outEvts);}
if(enterEvts.length){dc.onDragEnter(e,enterEvts);}
if(overEvts.length){dc.b4DragOver(e,overEvts);dc.onDragOver(e,overEvts);}
if(dropEvts.length){dc.b4DragDrop(e,dropEvts);dc.onDragDrop(e,dropEvts);}}else{var len=0;for(i=0,len=outEvts.length;i<len;++i){dc.b4DragOut(e,outEvts[i].id);dc.onDragOut(e,outEvts[i].id);}
for(i=0,len=enterEvts.length;i<len;++i){dc.onDragEnter(e,enterEvts[i].id);}
for(i=0,len=overEvts.length;i<len;++i){dc.b4DragOver(e,overEvts[i].id);dc.onDragOver(e,overEvts[i].id);}
for(i=0,len=dropEvts.length;i<len;++i){dc.b4DragDrop(e,dropEvts[i].id);dc.onDragDrop(e,dropEvts[i].id);}}
if(isDrop&&!dropEvts.length){dc.onInvalidDrop(e);}},getBestMatch:function(dds){var winner=null;var len=dds.length;if(len==1){winner=dds[0];}else{for(var i=0;i<len;++i){var dd=dds[i];if(dd.cursorIsOver){winner=dd;break;}else{if(!winner||winner.overlap.getArea()<dd.overlap.getArea()){winner=dd;}}}}
return winner;},refreshCache:function(groups){for(var sGroup in groups){if("string"!=typeof sGroup){continue;}
for(var i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(this.isTypeOfDD(oDD)){var loc=this.getLocation(oDD);if(loc){this.locationCache[oDD.id]=loc;}else{delete this.locationCache[oDD.id];}}}}},verifyEl:function(el){if(el){var parent;if(L5.isIE){try{parent=el.offsetParent;}catch(e){}}else{parent=el.offsetParent;}
if(parent){return true;}}
return false;},getLocation:function(oDD){if(!this.isTypeOfDD(oDD)){return null;}
var el=oDD.getEl(),pos,x1,x2,y1,y2,t,r,b,l;try{pos=L5.lib.Dom.getXY(el);}catch(e){}
if(!pos){return null;}
x1=pos[0];x2=x1+el.offsetWidth;y1=pos[1];y2=y1+el.offsetHeight;t=y1-oDD.padding[0];r=x2+oDD.padding[1];b=y2+oDD.padding[2];l=x1-oDD.padding[3];return new L5.lib.Region(t,r,b,l);},isOverTarget:function(pt,oTarget,intersect){var loc=this.locationCache[oTarget.id];if(!loc||!this.useCache){loc=this.getLocation(oTarget);this.locationCache[oTarget.id]=loc;}
if(!loc){return false;}
oTarget.cursorIsOver=loc.contains(pt);var dc=this.dragCurrent;if(!dc||!dc.getTargetCoord||(!intersect&&!dc.constrainX&&!dc.constrainY)){return oTarget.cursorIsOver;}
oTarget.overlap=null;var pos=dc.getTargetCoord(pt.x,pt.y);var el=dc.getDragEl();var curRegion=new L5.lib.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x);var overlap=curRegion.intersect(loc);if(overlap){oTarget.overlap=overlap;return(intersect)?true:oTarget.cursorIsOver;}else{return false;}},_onUnload:function(e,me){L5.dd.DragDropMgr.unregAll();},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null;}
this._execOnAll("unreg",[]);for(var i in this.elementCache){delete this.elementCache[i];}
this.elementCache={};this.ids={};},elementCache:{},getElWrapper:function(id){var oWrapper=this.elementCache[id];if(!oWrapper||!oWrapper.el){oWrapper=this.elementCache[id]=new this.ElementWrapper(L5.getDom(id));}
return oWrapper;},getElement:function(id){return L5.getDom(id);},getCss:function(id){var el=L5.getDom(id);return(el)?el.style:null;},ElementWrapper:function(el){this.el=el||null;this.id=this.el&&el.id;this.css=this.el&&el.style;},getPosX:function(el){return L5.lib.Dom.getX(el);},getPosY:function(el){return L5.lib.Dom.getY(el);},swapNode:function(n1,n2){if(n1.swapNode){n1.swapNode(n2);}else{var p=n2.parentNode;var s=n2.nextSibling;if(s==n1){p.insertBefore(n1,n2);}else if(n2==n1.nextSibling){p.insertBefore(n2,n1);}else{n1.parentNode.replaceChild(n2,n1);p.insertBefore(n1,s);}}},getScroll:function(){var t,l,dde=document.documentElement,db=document.body;if(dde&&(dde.scrollTop||dde.scrollLeft)){t=dde.scrollTop;l=dde.scrollLeft;}else if(db){t=db.scrollTop;l=db.scrollLeft;}else{}
return{top:t,left:l};},getStyle:function(el,styleProp){return L5.fly(el).getStyle(styleProp);},getScrollTop:function(){return this.getScroll().top;},getScrollLeft:function(){return this.getScroll().left;},moveToEl:function(moveEl,targetEl){var aCoord=L5.lib.Dom.getXY(targetEl);L5.lib.Dom.setXY(moveEl,aCoord);},numericSort:function(a,b){return(a-b);},_timeoutCount:0,_addListeners:function(){var DDM=L5.dd.DDM;if(L5.lib.Event&&document){DDM._onLoad();}else{if(DDM._timeoutCount>2000){}else{setTimeout(DDM._addListeners,10);if(document&&document.body){DDM._timeoutCount+=1;}}}},handleWasClicked:function(node,id){if(this.isHandle(id,node.id)){return true;}else{var p=node.parentNode;while(p){if(this.isHandle(id,p.id)){return true;}else{p=p.parentNode;}}}
return false;}};}();L5.dd.DDM=L5.dd.DragDropMgr;L5.dd.DDM._addListeners();}
L5.dd.DD=function(id,sGroup,config){if(id){this.init(id,sGroup,config);}};L5.extend(L5.dd.DD,L5.dd.DragDrop,{scroll:true,autoOffset:function(iPageX,iPageY){var x=iPageX-this.startPageX;var y=iPageY-this.startPageY;this.setDelta(x,y);},setDelta:function(iDeltaX,iDeltaY){this.deltaX=iDeltaX;this.deltaY=iDeltaY;},setDragElPos:function(iPageX,iPageY){var el=this.getDragEl();this.alignElWithMouse(el,iPageX,iPageY);},alignElWithMouse:function(el,iPageX,iPageY){var oCoord=this.getTargetCoord(iPageX,iPageY);var fly=el.dom?el:L5.fly(el,'_dd');if(!this.deltaSetXY){var aCoord=[oCoord.x,oCoord.y];fly.setXY(aCoord);var newLeft=fly.getLeft(true);var newTop=fly.getTop(true);this.deltaSetXY=[newLeft-oCoord.x,newTop-oCoord.y];}else{fly.setLeftTop(oCoord.x+this.deltaSetXY[0],oCoord.y+this.deltaSetXY[1]);}
this.cachePosition(oCoord.x,oCoord.y);this.autoScroll(oCoord.x,oCoord.y,el.offsetHeight,el.offsetWidth);return oCoord;},cachePosition:function(iPageX,iPageY){if(iPageX){this.lastPageX=iPageX;this.lastPageY=iPageY;}else{var aCoord=L5.lib.Dom.getXY(this.getEl());this.lastPageX=aCoord[0];this.lastPageY=aCoord[1];}},autoScroll:function(x,y,h,w){if(this.scroll){var clientH=L5.lib.Dom.getViewHeight();var clientW=L5.lib.Dom.getViewWidth();var st=this.DDM.getScrollTop();var sl=this.DDM.getScrollLeft();var bot=h+y;var right=w+x;var toBot=(clientH+st-y-this.deltaY);var toRight=(clientW+sl-x-this.deltaX);var thresh=40;var scrAmt=(document.all)?80:30;if(bot>clientH&&toBot<thresh){window.scrollTo(sl,st+scrAmt);}
if(y<st&&st>0&&y-st<thresh){window.scrollTo(sl,st-scrAmt);}
if(right>clientW&&toRight<thresh){window.scrollTo(sl+scrAmt,st);}
if(x<sl&&sl>0&&x-sl<thresh){window.scrollTo(sl-scrAmt,st);}}},getTargetCoord:function(iPageX,iPageY){var x=iPageX-this.deltaX;var y=iPageY-this.deltaY;if(this.constrainX){if(x<this.minX){x=this.minX;}
if(x>this.maxX){x=this.maxX;}}
if(this.constrainY){if(y<this.minY){y=this.minY;}
if(y>this.maxY){y=this.maxY;}}
x=this.getTick(x,this.xTicks);y=this.getTick(y,this.yTicks);return{x:x,y:y};},applyConfig:function(){L5.dd.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false);},b4MouseDown:function(e){this.autoOffset(e.getPageX(),e.getPageY());},b4Drag:function(e){this.setDragElPos(e.getPageX(),e.getPageY());},toString:function(){return("DD "+this.id);}});L5.dd.DDProxy=function(id,sGroup,config){if(id){this.init(id,sGroup,config);this.initFrame();}};L5.dd.DDProxy.dragElId="ygddfdiv";L5.extend(L5.dd.DDProxy,L5.dd.DD,{resizeFrame:true,centerFrame:false,createFrame:function(){var self=this;var body=document.body;if(!body||!body.firstChild){setTimeout(function(){self.createFrame();},50);return;}
var div=this.getDragEl();if(!div){div=document.createElement("div");div.id=this.dragElId;var s=div.style;s.position="absolute";s.visibility="hidden";s.cursor="move";s.border="2px solid #aaa";s.zIndex=999;body.insertBefore(div,body.firstChild);}},initFrame:function(){this.createFrame();},applyConfig:function(){L5.dd.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||L5.dd.DDProxy.dragElId);},showFrame:function(iPageX,iPageY){var el=this.getEl();var dragEl=this.getDragEl();var s=dragEl.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2));}
this.setDragElPos(iPageX,iPageY);L5.fly(dragEl).show();},_resizeProxy:function(){if(this.resizeFrame){var el=this.getEl();L5.fly(this.getDragEl()).setSize(el.offsetWidth,el.offsetHeight);}},b4MouseDown:function(e){var x=e.getPageX();var y=e.getPageY();this.autoOffset(x,y);this.setDragElPos(x,y);},b4StartDrag:function(x,y){this.showFrame(x,y);},b4EndDrag:function(e){L5.fly(this.getDragEl()).hide();},endDrag:function(e){var lel=this.getEl();var del=this.getDragEl();del.style.visibility="";this.beforeMove();lel.style.visibility="hidden";L5.dd.DDM.moveToEl(lel,del);del.style.visibility="hidden";lel.style.visibility="";this.afterDrag();},beforeMove:function(){},afterDrag:function(){},toString:function(){return("DDProxy "+this.id);}});L5.dd.DDTarget=function(id,sGroup,config){if(id){this.initTarget(id,sGroup,config);}};L5.extend(L5.dd.DDTarget,L5.dd.DragDrop,{toString:function(){return("DDTarget "+this.id);}});

L5.dd.DragTracker=function(config){L5.apply(this,config);this.addEvents('mousedown','mouseup','mousemove','dragstart','dragend','drag');this.dragRegion=new L5.lib.Region(0,0,0,0);if(this.el){this.initEl(this.el);}}
L5.extend(L5.dd.DragTracker,L5.util.Observable,{active:false,tolerance:5,autoStart:false,initEl:function(el){this.el=L5.get(el);el.on('mousedown',this.onMouseDown,this,this.delegate?{delegate:this.delegate}:undefined);},destroy:function(){this.el.un('mousedown',this.onMouseDown,this);},onMouseDown:function(e,target){if(this.fireEvent('mousedown',this,e)!==false&&this.onBeforeStart(e)!==false){this.startXY=this.lastXY=e.getXY();this.dragTarget=this.delegate?target:this.el.dom;e.preventDefault();var doc=L5.getDoc();doc.on('mouseup',this.onMouseUp,this);doc.on('mousemove',this.onMouseMove,this);doc.on('selectstart',this.stopSelect,this);if(this.autoStart){this.timer=this.triggerStart.defer(this.autoStart===true?1000:this.autoStart,this);}}},onMouseMove:function(e,target){e.preventDefault();var xy=e.getXY(),s=this.startXY;this.lastXY=xy;if(!this.active){if(Math.abs(s[0]-xy[0])>this.tolerance||Math.abs(s[1]-xy[1])>this.tolerance){this.triggerStart();}else{return;}}
this.fireEvent('mousemove',this,e);this.onDrag(e);this.fireEvent('drag',this,e);},onMouseUp:function(e){var doc=L5.getDoc();doc.un('mousemove',this.onMouseMove,this);doc.un('mouseup',this.onMouseUp,this);doc.un('selectstart',this.stopSelect,this);e.preventDefault();this.clearStart();this.active=false;delete this.elRegion;this.fireEvent('mouseup',this,e);this.onEnd(e);this.fireEvent('dragend',this,e);},triggerStart:function(isTimer){this.clearStart();this.active=true;this.onStart(this.startXY);this.fireEvent('dragstart',this,this.startXY);},clearStart:function(){if(this.timer){clearTimeout(this.timer);delete this.timer;}},stopSelect:function(e){e.stopEvent();return false;},onBeforeStart:function(e){},onStart:function(xy){},onDrag:function(e){},onEnd:function(e){},getDragTarget:function(){return this.dragTarget;},getDragCt:function(){return this.el;},getXY:function(constrain){return constrain?this.constrainModes[constrain].call(this,this.lastXY):this.lastXY;},getOffset:function(constrain){var xy=this.getXY(constrain);var s=this.startXY;return[s[0]-xy[0],s[1]-xy[1]];},constrainModes:{'point':function(xy){if(!this.elRegion){this.elRegion=this.getDragCt().getRegion();}
var dr=this.dragRegion;dr.left=xy[0];dr.top=xy[1];dr.right=xy[0];dr.bottom=xy[1];dr.constrainTo(this.elRegion);return[dr.left,dr.top];}}});

L5.dd.ScrollManager=function(){var ddm=L5.dd.DragDropMgr;var els={};var dragEl=null;var proc={};var onStop=function(e){dragEl=null;clearProc();};var triggerRefresh=function(){if(ddm.dragCurrent){ddm.refreshCache(ddm.dragCurrent.groups);}};var doScroll=function(){if(ddm.dragCurrent){var dds=L5.dd.ScrollManager;var inc=proc.el.ddScrollConfig?proc.el.ddScrollConfig.increment:dds.increment;if(!dds.animate){if(proc.el.scroll(proc.dir,inc)){triggerRefresh();}}else{proc.el.scroll(proc.dir,inc,true,dds.animDuration,triggerRefresh);}}};var clearProc=function(){if(proc.id){clearInterval(proc.id);}
proc.id=0;proc.el=null;proc.dir="";};var startProc=function(el,dir){clearProc();proc.el=el;proc.dir=dir;var freq=(el.ddScrollConfig&&el.ddScrollConfig.frequency)?el.ddScrollConfig.frequency:L5.dd.ScrollManager.frequency;proc.id=setInterval(doScroll,freq);};var onFire=function(e,isDrop){if(isDrop||!ddm.dragCurrent){return;}
var dds=L5.dd.ScrollManager;if(!dragEl||dragEl!=ddm.dragCurrent){dragEl=ddm.dragCurrent;dds.refreshCache();}
var xy=L5.lib.Event.getXY(e);var pt=new L5.lib.Point(xy[0],xy[1]);for(var id in els){var el=els[id],r=el._region;var c=el.ddScrollConfig?el.ddScrollConfig:dds;if(r&&r.contains(pt)&&el.isScrollable()){if(r.bottom-pt.y<=c.vthresh){if(proc.el!=el){startProc(el,"down");}
return;}else if(r.right-pt.x<=c.hthresh){if(proc.el!=el){startProc(el,"left");}
return;}else if(pt.y-r.top<=c.vthresh){if(proc.el!=el){startProc(el,"up");}
return;}else if(pt.x-r.left<=c.hthresh){if(proc.el!=el){startProc(el,"right");}
return;}}}
clearProc();};ddm.fireEvents=ddm.fireEvents.createSequence(onFire,ddm);ddm.stopDrag=ddm.stopDrag.createSequence(onStop,ddm);return{register:function(el){if(L5.isArray(el)){for(var i=0,len=el.length;i<len;i++){this.register(el[i]);}}else{el=L5.get(el);els[el.id]=el;}},unregister:function(el){if(L5.isArray(el)){for(var i=0,len=el.length;i<len;i++){this.unregister(el[i]);}}else{el=L5.get(el);delete els[el.id];}},vthresh:25,hthresh:25,increment:100,frequency:500,animate:true,animDuration:.4,refreshCache:function(){for(var id in els){if(typeof els[id]=='object'){els[id]._region=els[id].getRegion();}}}};}();

L5.dd.Registry=function(){var elements={};var handles={};var autoIdSeed=0;var getId=function(el,autogen){if(typeof el=="string"){return el;}
var id=el.id;if(!id&&autogen!==false){id="L5dd-"+(++autoIdSeed);el.id=id;}
return id;};return{register:function(el,data){data=data||{};if(typeof el=="string"){el=document.getElementById(el);}
data.ddel=el;elements[getId(el)]=data;if(data.isHandle!==false){handles[data.ddel.id]=data;}
if(data.handles){var hs=data.handles;for(var i=0,len=hs.length;i<len;i++){handles[getId(hs[i])]=data;}}},unregister:function(el){var id=getId(el,false);var data=elements[id];if(data){delete elements[id];if(data.handles){var hs=data.handles;for(var i=0,len=hs.length;i<len;i++){delete handles[getId(hs[i],false)];}}}},getHandle:function(id){if(typeof id!="string"){id=id.id;}
return handles[id];},getHandleFromEvent:function(e){var t=L5.lib.Event.getTarget(e);return t?handles[t.id]:null;},getTarget:function(id){if(typeof id!="string"){id=id.id;}
return elements[id];},getTargetFromEvent:function(e){var t=L5.lib.Event.getTarget(e);return t?elements[t.id]||handles[t.id]:null;}};}();

L5.dd.StatusProxy=function(config){L5.apply(this,config);this.id=this.id||L5.id();this.el=new L5.Layer({dh:{id:this.id,tag:"div",cls:"l-dd-drag-proxy "+this.dropNotAllowed,children:[{tag:"div",cls:"l-dd-drop-icon"},{tag:"div",cls:"l-dd-drag-ghost"}]},shadow:!config||config.shadow!==false});this.ghost=L5.get(this.el.dom.childNodes[1]);this.dropStatus=this.dropNotAllowed;};L5.dd.StatusProxy.prototype={dropAllowed:"l-dd-drop-ok",dropNotAllowed:"l-dd-drop-nodrop",setStatus:function(cssClass){cssClass=cssClass||this.dropNotAllowed;if(this.dropStatus!=cssClass){this.el.replaceClass(this.dropStatus,cssClass);this.dropStatus=cssClass;}},reset:function(clearGhost){this.el.dom.className="l-dd-drag-proxy "+this.dropNotAllowed;this.dropStatus=this.dropNotAllowed;if(clearGhost){this.ghost.update("");}},update:function(html){if(typeof html=="string"){this.ghost.update(html);}else{this.ghost.update("");html.style.margin="0";this.ghost.dom.appendChild(html);}
var el=this.ghost.dom.firstChild;if(el){L5.fly(el).setStyle(L5.isIE?'styleFloat':'cssFloat','none');}},getEl:function(){return this.el;},getGhost:function(){return this.ghost;},hide:function(clear){this.el.hide();if(clear){this.reset(true);}},stop:function(){if(this.anim&&this.anim.isAnimated&&this.anim.isAnimated()){this.anim.stop();}},show:function(){this.el.show();},sync:function(){this.el.sync();},repair:function(xy,callback,scope){this.callback=callback;this.scope=scope;if(xy&&this.animRepair!==false){this.el.addClass("l-dd-drag-repair");this.el.hideUnders(true);this.anim=this.el.shift({duration:this.repairDuration||.5,easing:'easeOut',xy:xy,stopFx:true,callback:this.afterRepair,scope:this});}else{this.afterRepair();}},afterRepair:function(){this.hide(true);if(typeof this.callback=="function"){this.callback.call(this.scope||this);}
this.callback=null;this.scope=null;}};

L5.dd.DragSource=function(el,config){this.el=L5.get(el);if(!this.dragData){this.dragData={};}
L5.apply(this,config);if(!this.proxy){this.proxy=new L5.dd.StatusProxy();}
L5.dd.DragSource.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true});this.dragging=false;};L5.extend(L5.dd.DragSource,L5.dd.DDProxy,{dropAllowed:"l-dd-drop-ok",dropNotAllowed:"l-dd-drop-nodrop",getDragData:function(e){return this.dragData;},onDragEnter:function(e,id){var target=L5.dd.DragDropMgr.getDDById(id);this.cachedTarget=target;if(this.beforeDragEnter(target,e,id)!==false){if(target.isNotifyTarget){var status=target.notifyEnter(this,e,this.dragData);this.proxy.setStatus(status);}else{this.proxy.setStatus(this.dropAllowed);}
if(this.afterDragEnter){this.afterDragEnter(target,e,id);}}},beforeDragEnter:function(target,e,id){return true;},alignElWithMouse:function(){L5.dd.DragSource.superclass.alignElWithMouse.apply(this,arguments);this.proxy.sync();},onDragOver:function(e,id){var target=this.cachedTarget||L5.dd.DragDropMgr.getDDById(id);if(this.beforeDragOver(target,e,id)!==false){if(target.isNotifyTarget){var status=target.notifyOver(this,e,this.dragData);this.proxy.setStatus(status);}
if(this.afterDragOver){this.afterDragOver(target,e,id);}}},beforeDragOver:function(target,e,id){return true;},onDragOut:function(e,id){var target=this.cachedTarget||L5.dd.DragDropMgr.getDDById(id);if(this.beforeDragOut(target,e,id)!==false){if(target.isNotifyTarget){target.notifyOut(this,e,this.dragData);}
this.proxy.reset();if(this.afterDragOut){this.afterDragOut(target,e,id);}}
this.cachedTarget=null;},beforeDragOut:function(target,e,id){return true;},onDragDrop:function(e,id){var target=this.cachedTarget||L5.dd.DragDropMgr.getDDById(id);if(this.beforeDragDrop(target,e,id)!==false){if(target.isNotifyTarget){if(target.notifyDrop(this,e,this.dragData)){this.onValidDrop(target,e,id);}else{this.onInvalidDrop(target,e,id);}}else{this.onValidDrop(target,e,id);}
if(this.afterDragDrop){this.afterDragDrop(target,e,id);}}
delete this.cachedTarget;},beforeDragDrop:function(target,e,id){return true;},onValidDrop:function(target,e,id){this.hideProxy();if(this.afterValidDrop){this.afterValidDrop(target,e,id);}},getRepairXY:function(e,data){return this.el.getXY();},onInvalidDrop:function(target,e,id){this.beforeInvalidDrop(target,e,id);if(this.cachedTarget){if(this.cachedTarget.isNotifyTarget){this.cachedTarget.notifyOut(this,e,this.dragData);}
this.cacheTarget=null;}
this.proxy.repair(this.getRepairXY(e,this.dragData),this.afterRepair,this);if(this.afterInvalidDrop){this.afterInvalidDrop(e,id);}},afterRepair:function(){if(L5.enableFx){this.el.highlight(this.hlColor||"c3daf9");}
this.dragging=false;},beforeInvalidDrop:function(target,e,id){return true;},handleMouseDown:function(e){if(this.dragging){return;}
var data=this.getDragData(e);if(data&&this.onBeforeDrag(data,e)!==false){this.dragData=data;this.proxy.stop();L5.dd.DragSource.superclass.handleMouseDown.apply(this,arguments);}},onBeforeDrag:function(data,e){return true;},onStartDrag:L5.emptyFn,startDrag:function(x,y){this.proxy.reset();this.dragging=true;this.proxy.update("");this.onInitDrag(x,y);this.proxy.show();},onInitDrag:function(x,y){var clone=this.el.dom.cloneNode(true);clone.id=L5.id();this.proxy.update(clone);this.onStartDrag(x,y);return true;},getProxy:function(){return this.proxy;},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false;},triggerCacheRefresh:function(){L5.dd.DDM.refreshCache(this.groups);},b4EndDrag:function(e){},endDrag:function(e){this.onEndDrag(this.dragData,e);},onEndDrag:function(data,e){},autoOffset:function(x,y){this.setDelta(-12,-20);}});

L5.dd.DropTarget=function(el,config){this.el=L5.get(el);L5.apply(this,config);if(this.containerScroll){L5.dd.ScrollManager.register(this.el);}
L5.dd.DropTarget.superclass.constructor.call(this,this.el.dom,this.ddGroup||this.group,{isTarget:true});};L5.extend(L5.dd.DropTarget,L5.dd.DDTarget,{dropAllowed:"l-dd-drop-ok",dropNotAllowed:"l-dd-drop-nodrop",isTarget:true,isNotifyTarget:true,notifyEnter:function(dd,e,data){if(this.overClass){this.el.addClass(this.overClass);}
return this.dropAllowed;},notifyOver:function(dd,e,data){return this.dropAllowed;},notifyOut:function(dd,e,data){if(this.overClass){this.el.removeClass(this.overClass);}},notifyDrop:function(dd,e,data){return false;}});

L5.dd.DragZone=function(el,config){L5.dd.DragZone.superclass.constructor.call(this,el,config);if(this.containerScroll){L5.dd.ScrollManager.register(this.el);}};L5.extend(L5.dd.DragZone,L5.dd.DragSource,{getDragData:function(e){return L5.dd.Registry.getHandleFromEvent(e);},onInitDrag:function(x,y){this.proxy.update(this.dragData.ddel.cloneNode(true));this.onStartDrag(x,y);return true;},afterRepair:function(){if(L5.enableFx){L5.Element.fly(this.dragData.ddel).highlight(this.hlColor||"c3daf9");}
this.dragging=false;},getRepairXY:function(e){return L5.Element.fly(this.dragData.ddel).getXY();}});

L5.dd.DropZone=function(el,config){L5.dd.DropZone.superclass.constructor.call(this,el,config);};L5.extend(L5.dd.DropZone,L5.dd.DropTarget,{getTargetFromEvent:function(e){return L5.dd.Registry.getTargetFromEvent(e);},onNodeEnter:function(n,dd,e,data){},onNodeOver:function(n,dd,e,data){return this.dropAllowed;},onNodeOut:function(n,dd,e,data){},onNodeDrop:function(n,dd,e,data){return false;},onContainerOver:function(dd,e,data){return this.dropNotAllowed;},onContainerDrop:function(dd,e,data){return false;},notifyEnter:function(dd,e,data){return this.dropNotAllowed;},notifyOver:function(dd,e,data){var n=this.getTargetFromEvent(e);if(!n){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,data);this.lastOverNode=null;}
return this.onContainerOver(dd,e,data);}
if(this.lastOverNode!=n){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,data);}
this.onNodeEnter(n,dd,e,data);this.lastOverNode=n;}
return this.onNodeOver(n,dd,e,data);},notifyOut:function(dd,e,data){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,data);this.lastOverNode=null;}},notifyDrop:function(dd,e,data){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,dd,e,data);this.lastOverNode=null;}
var n=this.getTargetFromEvent(e);return n?this.onNodeDrop(n,dd,e,data):this.onContainerDrop(dd,e,data);},triggerCacheRefresh:function(){L5.dd.DDM.refreshCache(this.groups);}});

L5.Element.prototype.initDD=function(group,config,overrides){var dd=new L5.dd.DD(L5.id(this.dom),group,config);return L5.apply(dd,overrides);};L5.Element.prototype.initDDProxy=function(group,config,overrides){var dd=new L5.dd.DDProxy(L5.id(this.dom),group,config);return L5.apply(dd,overrides);};L5.Element.prototype.initDDTarget=function(group,config,overrides){var dd=new L5.dd.DDTarget(L5.id(this.dom),group,config);return L5.apply(dd,overrides);};

L5.ComponentMgr=function(){var all=new L5.util.MixedCollection();var types={};return{register:function(c){all.add(c);},unregister:function(c){all.remove(c);},get:function(id){return all.get(id);},onAvailable:function(id,fn,scope){all.on("add",function(index,o){if(o.id==id){fn.call(scope||o,o);all.un("add",fn,scope);}});},all:all,registerType:function(xtype,cls){types[xtype]=cls;cls.xtype=xtype;},create:function(config,defaultType){return new types[config.xtype||defaultType](config);}};}();L5.reg=L5.ComponentMgr.registerType;

L5.Component=function(config){config=config||{};if(config.initialConfig){if(config.isAction){this.baseAction=config;}
config=config.initialConfig;}else if(config.tagName||config.dom||typeof config=="string"){config={applyTo:config,id:config.id||config};}
this.initialConfig=config;L5.apply(this,config);this.addEvents('disable','enable','beforeshow','show','beforehide','hide','beforerender','render','beforedestroy','destroy','beforestaterestore','staterestore','beforestatesave','statesave');this.getId();L5.ComponentMgr.register(this);L5.Component.superclass.constructor.call(this);if(this.baseAction){this.baseAction.addComponent(this);}
this.initComponent();if(this.plugins){if(L5.isArray(this.plugins)){for(var i=0,len=this.plugins.length;i<len;i++){this.plugins[i]=this.initPlugin(this.plugins[i]);}}else{this.plugins=this.initPlugin(this.plugins);}}
if(this.stateful!==false){this.initState(config);}
if(this.applyTo){this.applyToMarkup(this.applyTo);delete this.applyTo;}else if(this.renderTo){this.render(this.renderTo);delete this.renderTo;}};L5.Component.AUTO_ID=1000;L5.extend(L5.Component,L5.util.Observable,{disabledClass:"l-item-disabled",allowDomMove:true,autoShow:false,hideMode:'display',hideParent:false,hidden:false,disabled:false,rendered:false,ctype:"L5.Component",actionMode:"el",getActionEl:function(){return this[this.actionMode];},initPlugin:function(p){p.init(this);return p;},initComponent:L5.emptyFn,render:function(container,position){if(!this.rendered&&this.fireEvent("beforerender",this)!==false){if(!container&&this.el){this.el=L5.get(this.el);container=this.el.dom.parentNode;this.allowDomMove=false;}
this.container=L5.get(container);if(this.ctCls){this.container.addClass(this.ctCls);}
this.rendered=true;if(position!==undefined){if(typeof position=='number'){position=this.container.dom.childNodes[position];}else{position=L5.getDom(position);}}
this.onRender(this.container,position||null);if(this.autoShow){this.el.removeClass(['l-hidden','l-hide-'+this.hideMode]);}
if(this.cls){this.el.addClass(this.cls);delete this.cls;}
if(this.style){this.el.applyStyles(this.style);delete this.style;}
if(this.overCls){this.el.addClassOnOver(this.overCls);}
this.fireEvent("render",this);this.afterRender(this.container);if(this.hidden){this.hide();}
if(this.disabled){this.disable();}
if(this.stateful!==false){this.initStateEvents();}}
return this;},initState:function(config){if(L5.state.Manager){var id=this.getStateId();if(id){var state=L5.state.Manager.get(id);if(state){if(this.fireEvent('beforestaterestore',this,state)!==false){this.applyState(state);this.fireEvent('staterestore',this,state);}}}}},getStateId:function(){return this.stateId||((this.id.indexOf('L5-comp-')==0||this.id.indexOf('L5-gen')==0)?null:this.id);},initStateEvents:function(){if(this.stateEvents){for(var i=0,e;e=this.stateEvents[i];i++){this.on(e,this.saveState,this,{delay:100});}}},applyState:function(state,config){if(state){L5.apply(this,state);}},getState:function(){return null;},saveState:function(){if(L5.state.Manager){var id=this.getStateId();if(id){var state=this.getState();if(this.fireEvent('beforestatesave',this,state)!==false){L5.state.Manager.set(id,state);this.fireEvent('statesave',this,state);}}}},applyToMarkup:function(el){this.allowDomMove=false;this.el=L5.get(el);this.render(this.el.dom.parentNode);},addClass:function(cls){if(this.el){this.el.addClass(cls);}else{this.cls=this.cls?this.cls+' '+cls:cls;}},removeClass:function(cls){if(this.el){this.el.removeClass(cls);}else if(this.cls){this.cls=this.cls.split(' ').remove(cls).join(' ');}},onRender:function(ct,position){if(this.autoEl){if(typeof this.autoEl=='string'){this.el=document.createElement(this.autoEl);}else{var div=document.createElement('div');L5.DomHelper.overwrite(div,this.autoEl);this.el=div.firstChild;}
if(!this.el.id){this.el.id=this.getId();}}
if(this.el){this.el=L5.get(this.el);if(this.allowDomMove!==false){ct.dom.insertBefore(this.el.dom,position);}}},getAutoCreate:function(){var cfg=typeof this.autoCreate=="object"?this.autoCreate:L5.apply({},this.defaultAutoCreate);if(this.id&&!cfg.id){cfg.id=this.id;}
return cfg;},afterRender:L5.emptyFn,destroy:function(){if(this.fireEvent("beforedestroy",this)!==false){this.beforeDestroy();if(this.rendered){this.el.removeAllListeners();this.el.remove();if(this.actionMode=="container"){this.container.remove();}}
this.onDestroy();L5.ComponentMgr.unregister(this);this.fireEvent("destroy",this);this.purgeListeners();}},beforeDestroy:L5.emptyFn,onDestroy:L5.emptyFn,getEl:function(){return this.el;},getId:function(){return this.id||(this.id="L5-comp-"+(++L5.Component.AUTO_ID));},getItemId:function(){return this.itemId||this.getId();},focus:function(selectText,delay){if(delay){this.focus.defer(typeof delay=='number'?delay:10,this,[selectText,false]);return;}
if(this.rendered){this.el.focus();if(selectText===true){this.el.dom.select();}}
return this;},blur:function(){if(this.rendered){this.el.blur();}
return this;},disable:function(){if(this.rendered){this.onDisable();}
this.disabled=true;this.fireEvent("disable",this);return this;},onDisable:function(){this.getActionEl().addClass(this.disabledClass);this.el.dom.disabled=true;},enable:function(){if(this.rendered){this.onEnable();}
this.disabled=false;this.fireEvent("enable",this);return this;},onEnable:function(){this.getActionEl().removeClass(this.disabledClass);this.el.dom.disabled=false;},setDisabled:function(disabled){this[disabled?"disable":"enable"]();},show:function(){if(this.fireEvent("beforeshow",this)!==false){this.hidden=false;if(this.autoRender){this.render(typeof this.autoRender=='boolean'?L5.getBody():this.autoRender);}
if(this.rendered){this.onShow();}
this.fireEvent("show",this);}
return this;},onShow:function(){if(this.hideParent){this.container.removeClass('l-hide-'+this.hideMode);}else{this.getActionEl().removeClass('l-hide-'+this.hideMode);if(this.onWinResize)
this.onWinResize();}},hide:function(){if(this.fireEvent("beforehide",this)!==false){this.hidden=true;if(this.rendered){this.onHide();}
this.fireEvent("hide",this);}
return this;},onHide:function(){if(this.hideParent){this.container.addClass('l-hide-'+this.hideMode);}else{this.getActionEl().addClass('l-hide-'+this.hideMode);}},setVisible:function(visible){if(visible){this.show();}else{this.hide();}
return this;},isVisible:function(){return this.rendered&&this.getActionEl().isVisible();},cloneConfig:function(overrides){overrides=overrides||{};var id=overrides.id||L5.id();var cfg=L5.applyIf(overrides,this.initialConfig);cfg.id=id;return new this.constructor(cfg);},getXType:function(){return this.constructor.xtype;},isXType:function(xtype,shallow){if(typeof xtype=='function'){xtype=xtype.xtype;}else if(typeof xtype=='object'){xtype=xtype.constructor.xtype;}
return!shallow?('/'+this.getXTypes()+'/').indexOf('/'+xtype+'/')!=-1:this.constructor.xtype==xtype;},getXTypes:function(){var tc=this.constructor;if(!tc.xtypes){var c=[],sc=this;while(sc&&sc.constructor.xtype){c.unshift(sc.constructor.xtype);sc=sc.constructor.superclass;}
tc.xtypeChain=c;tc.xtypes=c.join('/');}
return tc.xtypes;},findParentBy:function(fn){for(var p=this.ownerCt;(p!=null)&&!fn(p,this);p=p.ownerCt);return p||null;},findParentByType:function(xtype){return typeof xtype=='function'?this.findParentBy(function(p){return p.constructor===xtype;}):this.findParentBy(function(p){return p.constructor.xtype===xtype;});},mon:function(item,ename,fn,scope,opt){if(!this.mons){this.mons=[];this.on('beforedestroy',function(){for(var i=0,len=this.mons.length;i<len;i++){var m=this.mons[i];m.item.un(m.ename,m.fn,m.scope);}},this);}
this.mons.push({item:item,ename:ename,fn:fn,scope:scope});item.on(ename,fn,scope,opt);}});L5.reg('component',L5.Component);

L5.Action=function(config){this.initialConfig=config;this.items=[];}
L5.Action.prototype={isAction:true,setText:function(text){this.initialConfig.text=text;this.callEach('setText',[text]);},getText:function(){return this.initialConfig.text;},setIconClass:function(cls){this.initialConfig.iconCls=cls;this.callEach('setIconClass',[cls]);},getIconClass:function(){return this.initialConfig.iconCls;},setDisabled:function(v){this.initialConfig.disabled=v;this.callEach('setDisabled',[v]);},enable:function(){this.setDisabled(false);},disable:function(){this.setDisabled(true);},isDisabled:function(){return this.initialConfig.disabled;},setHidden:function(v){this.initialConfig.hidden=v;this.callEach('setVisible',[!v]);},show:function(){this.setHidden(false);},hide:function(){this.setHidden(true);},isHidden:function(){return this.initialConfig.hidden;},setHandler:function(fn,scope){this.initialConfig.handler=fn;this.initialConfig.scope=scope;this.callEach('setHandler',[fn,scope]);},each:function(fn,scope){L5.each(this.items,fn,scope);},callEach:function(fnName,args){var cs=this.items;for(var i=0,len=cs.length;i<len;i++){cs[i][fnName].apply(cs[i],args);}},addComponent:function(comp){this.items.push(comp);comp.on('destroy',this.removeComponent,this);},removeComponent:function(comp){this.items.remove(comp);},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||window,arguments);}};

(function(){L5.Layer=function(config,existingEl){config=config||{};var dh=L5.DomHelper;var cp=config.parentEl,pel=cp?L5.getDom(cp):document.body;if(existingEl){this.dom=L5.getDom(existingEl);}
if(!this.dom){var o=config.dh||{tag:"div",cls:"l-layer"};this.dom=dh.append(pel,o);}
if(config.cls){this.addClass(config.cls);}
this.constrain=config.constrain!==false;this.visibilityMode=L5.Element.VISIBILITY;if(config.id){this.id=this.dom.id=config.id;}else{this.id=L5.id(this.dom);}
this.zindex=config.zindex||this.getZIndex();this.position("absolute",this.zindex);if(config.shadow){this.shadowOffset=config.shadowOffset||4;this.shadow=new L5.Shadow({offset:this.shadowOffset,mode:config.shadow});}else{this.shadowOffset=0;}
this.useShim=config.shim!==false&&L5.useShims;this.useDisplay=config.useDisplay;this.hide();};var supr=L5.Element.prototype;var shims=[];L5.extend(L5.Layer,L5.Element,{getZIndex:function(){return this.zindex||parseInt(this.getStyle("z-index"),10)||11000;},getShim:function(){if(!this.useShim){return null;}
if(this.shim){return this.shim;}
var shim=shims.shift();if(!shim){shim=this.createShim();shim.enableDisplayMode('block');shim.dom.style.display='none';shim.dom.style.visibility='visible';}
var pn=this.dom.parentNode;if(shim.dom.parentNode!=pn){pn.insertBefore(shim.dom,this.dom);}
shim.setStyle('z-index',this.getZIndex()-2);this.shim=shim;return shim;},hideShim:function(){if(this.shim){this.shim.setDisplayed(false);shims.push(this.shim);delete this.shim;}},disableShadow:function(){if(this.shadow){this.shadowDisabled=true;this.shadow.hide();this.lastShadowOffset=this.shadowOffset;this.shadowOffset=0;}},enableShadow:function(show){if(this.shadow){this.shadowDisabled=false;this.shadowOffset=this.lastShadowOffset;delete this.lastShadowOffset;if(show){this.sync(true);}}},sync:function(doShow){var sw=this.shadow;if(!this.updating&&this.isVisible()&&(sw||this.useShim)){var sh=this.getShim();var w=this.getWidth(),h=this.getHeight();var l=this.getLeft(true),t=this.getTop(true);if(sw&&!this.shadowDisabled){if(doShow&&!sw.isVisible()){sw.show(this);}else{sw.realign(l,t,w,h);}
if(sh){if(doShow){sh.show();}
var a=sw.adjusts,s=sh.dom.style;s.left=(Math.min(l,l+a.l))+"px";s.top=(Math.min(t,t+a.t))+"px";s.width=(w+a.w+8)+"px";s.height=(h+a.h+8)+"px";}}else if(sh){if(doShow){sh.show();}
sh.setSize(w,h);sh.setLeftTop(l,t);}}},destroy:function(){this.hideShim();if(this.shadow){this.shadow.hide();}
this.removeAllListeners();L5.removeNode(this.dom);L5.Element.uncache(this.id);},remove:function(){this.destroy();},beginUpdate:function(){this.updating=true;},endUpdate:function(){this.updating=false;this.sync(true);},hideUnders:function(negOffset){if(this.shadow){this.shadow.hide();}
this.hideShim();},constrainXY:function(){if(this.constrain){var vw=L5.lib.Dom.getViewWidth(),vh=L5.lib.Dom.getViewHeight();var s=L5.getDoc().getScroll();var xy=this.getXY();var x=xy[0],y=xy[1];var w=this.dom.offsetWidth+this.shadowOffset,h=this.dom.offsetHeight+this.shadowOffset;var moved=false;if((x+w)>vw+s.left){x=vw-w-this.shadowOffset;moved=true;}
if((y+h)>vh+s.top){y=vh-h-this.shadowOffset;moved=true;}
if(x<s.left){x=s.left;moved=true;}
if(y<s.top){y=s.top;moved=true;}
if(moved){if(this.avoidY){var ay=this.avoidY;if(y<=ay&&(y+h)>=ay){y=ay-h-5;}}
xy=[x,y];this.storeXY(xy);supr.setXY.call(this,xy);this.sync();}}},isVisible:function(){return this.visible;},showAction:function(){this.visible=true;if(this.useDisplay===true){this.setDisplayed("");}else if(this.lastXY){supr.setXY.call(this,this.lastXY);}else if(this.lastLT){supr.setLeftTop.call(this,this.lastLT[0],this.lastLT[1]);}},hideAction:function(){this.visible=false;if(this.useDisplay===true){this.setDisplayed(false);}else{this.setLeftTop(-10000,-10000);}},setVisible:function(v,a,d,c,e){if(v){this.showAction();}
if(a&&v){var cb=function(){this.sync(true);if(c){c();}}.createDelegate(this);supr.setVisible.call(this,true,true,d,cb,e);}else{if(!v){this.hideUnders(true);}
var cb=c;if(a){cb=function(){this.hideAction();if(c){c();}}.createDelegate(this);}
supr.setVisible.call(this,v,a,d,cb,e);if(v){this.sync(true);}else if(!a){this.hideAction();}}},storeXY:function(xy){delete this.lastLT;this.lastXY=xy;},storeLeftTop:function(left,top){delete this.lastXY;this.lastLT=[left,top];},beforeFx:function(){this.beforeAction();return L5.Layer.superclass.beforeFx.apply(this,arguments);},afterFx:function(){L5.Layer.superclass.afterFx.apply(this,arguments);this.sync(this.isVisible());},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide();}},setLeft:function(left){this.storeLeftTop(left,this.getTop(true));supr.setLeft.apply(this,arguments);this.sync();},setTop:function(top){this.storeLeftTop(this.getLeft(true),top);supr.setTop.apply(this,arguments);this.sync();},setLeftTop:function(left,top){this.storeLeftTop(left,top);supr.setLeftTop.apply(this,arguments);this.sync();},setXY:function(xy,a,d,c,e){this.fixDisplay();this.beforeAction();this.storeXY(xy);var cb=this.createCB(c);supr.setXY.call(this,xy,a,d,cb,e);if(!a){cb();}},createCB:function(c){var el=this;return function(){el.constrainXY();el.sync(true);if(c){c();}};},setX:function(x,a,d,c,e){this.setXY([x,this.getY()],a,d,c,e);},setY:function(y,a,d,c,e){this.setXY([this.getX(),y],a,d,c,e);},setSize:function(w,h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);supr.setSize.call(this,w,h,a,d,cb,e);if(!a){cb();}},setWidth:function(w,a,d,c,e){this.beforeAction();var cb=this.createCB(c);supr.setWidth.call(this,w,a,d,cb,e);if(!a){cb();}},setHeight:function(h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);supr.setHeight.call(this,h,a,d,cb,e);if(!a){cb();}},setBounds:function(x,y,w,h,a,d,c,e){this.beforeAction();var cb=this.createCB(c);if(!a){this.storeXY([x,y]);supr.setXY.call(this,[x,y]);supr.setSize.call(this,w,h,a,d,cb,e);cb();}else{supr.setBounds.call(this,x,y,w,h,a,d,cb,e);}
return this;},setZIndex:function(zindex){this.zindex=zindex;this.setStyle("z-index",zindex+2);if(this.shadow){this.shadow.setZIndex(zindex+1);}
if(this.shim){this.shim.setStyle("z-index",zindex);}}});})();

L5.Shadow=function(config){L5.apply(this,config);if(typeof this.mode!="string"){this.mode=this.defaultMode;}
var o=this.offset,a={h:0};var rad=Math.floor(this.offset/2);switch(this.mode.toLowerCase()){case"drop":a.w=0;a.l=a.t=o;a.t-=1;if(L5.isIE){a.l-=this.offset+rad;a.t-=this.offset+rad;a.w-=rad;a.h-=rad;a.t+=1;}
break;case"sides":a.w=(o*2);a.l=-o;a.t=o-1;if(L5.isIE){a.l-=(this.offset-rad);a.t-=this.offset+rad;a.l+=1;a.w-=(this.offset-rad)*2;a.w-=rad+1;a.h-=1;}
break;case"frame":a.w=a.h=(o*2);a.l=a.t=-o;a.t+=1;a.h-=2;if(L5.isIE){a.l-=(this.offset-rad);a.t-=(this.offset-rad);a.l+=1;a.w-=(this.offset+rad+1);a.h-=(this.offset+rad);a.h+=1;}
break;};this.adjusts=a;};L5.Shadow.prototype={offset:4,defaultMode:"drop",show:function(target){target=L5.get(target);if(!this.el){this.el=L5.Shadow.Pool.pull();if(this.el.dom.nextSibling!=target.dom){this.el.insertBefore(target);}}
this.el.setStyle("z-index",this.zIndex||parseInt(target.getStyle("z-index"),10)-1);if(L5.isIE){this.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity=50) progid:DXImageTransform.Microsoft.Blur(pixelradius="+(this.offset)+")";}
this.realign(target.getLeft(true),target.getTop(true),target.getWidth(),target.getHeight());this.el.dom.style.display="block";},isVisible:function(){return this.el?true:false;},realign:function(l,t,w,h){if(!this.el){return;}
var a=this.adjusts,d=this.el.dom,s=d.style;var iea=0;s.left=(l+a.l)+"px";s.top=(t+a.t)+"px";var sw=(w+a.w),sh=(h+a.h),sws=sw+"px",shs=sh+"px";if(s.width!=sws||s.height!=shs){s.width=sws;s.height=shs;if(!L5.isIE){var cn=d.childNodes;var sww=Math.max(0,(sw-12))+"px";cn[0].childNodes[1].style.width=sww;cn[1].childNodes[1].style.width=sww;cn[2].childNodes[1].style.width=sww;cn[1].style.height=Math.max(0,(sh-12))+"px";}}},hide:function(){if(this.el){this.el.dom.style.display="none";L5.Shadow.Pool.push(this.el);delete this.el;}},setZIndex:function(z){this.zIndex=z;if(this.el){this.el.setStyle("z-index",z);}}};L5.Shadow.Pool=function(){var p=[];var markup=L5.isIE?'<div class="l-ie-shadow"></div>':'<div class="l-shadow"><div class="xst"><div class="xstl"></div><div class="xstc"></div><div class="xstr"></div></div><div class="xsc"><div class="xsml"></div><div class="xsmc"></div><div class="xsmr"></div></div><div class="xsb"><div class="xsbl"></div><div class="xsbc"></div><div class="xsbr"></div></div></div>';return{pull:function(){var sh=p.shift();if(!sh){sh=L5.get(L5.DomHelper.insertHtml("beforeBegin",document.body.firstChild,markup));sh.autoBoxAdjust=false;}
return sh;},push:function(sh){p.push(sh);}};}();

L5.BoxComponent=L5.extend(L5.Component,{initComponent:function(){L5.BoxComponent.superclass.initComponent.call(this);this.oldHeight=this.height;this.oldWidth=this.width;this.addEvents('resize','move');},boxReady:false,deferHeight:false,setSize:function(w,h){if(typeof w=='object'&&w!=null){h=w.height;w=w.width;}
if(!this.boxReady){this.width=w;this.height=h;return this;}
if(this.lastSize&&this.lastSize.width==w&&this.lastSize.height==h){return this;}
this.lastSize={width:w,height:h};var adj=this.adjustSize(w,h);var aw=adj.width,ah=adj.height;if(aw!==undefined||ah!==undefined){var rz=this.getResizeEl();if(!this.deferHeight&&aw!==undefined&&ah!==undefined){rz.setSize(aw,ah);}else if(!this.deferHeight&&ah!==undefined){rz.setHeight(ah);}else if(aw!==undefined){rz.setWidth(aw);}
this.onResize(aw,ah,w,h);this.fireEvent('resize',this,aw,ah,w,h);}
return this;},setWidth:function(width){if(typeof width=="string"&&width.indexOf("%")>0){this.oldWidth=width;this.onWinResize();return this;}else{return this.setSize(width);}},setHeight:function(height){if(typeof height=="string"&&height.indexOf("%")>0){this.oldHeight=height;this.onWinResize();return this;}else{return this.setSize(undefined,height);}},getSize:function(){return this.el.getSize();},getPosition:function(local){if(local===true){return[this.el.getLeft(true),this.el.getTop(true)];}
return this.xy||this.el.getXY();},getBox:function(local){var s=this.el.getSize();if(local===true){s.x=this.el.getLeft(true);s.y=this.el.getTop(true);}else{var xy=this.xy||this.el.getXY();s.x=xy[0];s.y=xy[1];}
return s;},updateBox:function(box){this.setSize(box.width,box.height);this.setPagePosition(box.x,box.y);return this;},getResizeEl:function(){return this.resizeEl||this.el;},getPositionEl:function(){return this.positionEl||this.el;},setPosition:function(x,y){if(x&&typeof x[1]=='number'){y=x[1];x=x[0];}
this.x=x;this.y=y;if(!this.boxReady){return this;}
var adj=this.adjustPosition(x,y);var ax=adj.x,ay=adj.y;var el=this.getPositionEl();if(ax!==undefined||ay!==undefined){if(ax!==undefined&&ay!==undefined){el.setLeftTop(ax,ay);}else if(ax!==undefined){el.setLeft(ax);}else if(ay!==undefined){el.setTop(ay);}
this.onPosition(ax,ay);this.fireEvent('move',this,ax,ay);}
return this;},setPagePosition:function(x,y){if(x&&typeof x[1]=='number'){y=x[1];x=x[0];}
this.pageX=x;this.pageY=y;if(!this.boxReady){return;}
if(x===undefined||y===undefined){return;}
var p=this.el.translatePoints(x,y);this.setPosition(p.left,p.top);return this;},onRender:function(ct,position){L5.BoxComponent.superclass.onRender.call(this,ct,position);if(this.resizeEl){this.resizeEl=L5.get(this.resizeEl);}
if(this.positionEl){this.positionEl=L5.get(this.positionEl);}},onWinResize:function(w,h){if(!this.el)return;var height;var width;if((L5.type(this.oldHeight)=="string")&&(this.oldHeight.indexOf("%")>0)){if(this.ownerCt&&this.ownerCt.oldHeight&&this.oldHeight!="100%"){height=this.ownerCt.getSize().height;}else{height=L5.getBody().getHeight()-this.el.getOffsetsTo(L5.getBody())[1];}
var tempHeight=this.oldHeight.substring(0,(this.oldHeight.indexOf("%")))/100;height=height*tempHeight-2;}
if((L5.type(this.oldWidth)=="string")&&(this.oldWidth.indexOf("%")>0)){if(this.ownerCt&&this.ownerCt.oldWidth){width=this.ownerCt.getSize().width;}else{width=L5.getBody().getWidth()-this.el.getOffsetsTo(L5.getBody())[0];}
var tempWidth=this.oldWidth.substring(0,(this.oldWidth.indexOf("%")))/100;width=width*tempWidth-2;}
this.setSize(width?width:this.width,height?height:this.height);},afterRender:function(){L5.BoxComponent.superclass.afterRender.call(this);this.boxReady=true;var height;var width;if(!this.ownerCt){this.onWinResize();}
if(this.x||this.y){this.setPosition(this.x,this.y);}else if(this.pageX||this.pageY){this.setPagePosition(this.pageX,this.pageY);}
L5.EventManager.removeResizeListener(this.onWinResize,this);if(!this.ownerCt)
L5.EventManager.onWindowResize(this.onWinResize,this);},syncSize:function(){delete this.lastSize;this.setSize(this.autoWidth?undefined:this.el.getWidth(),this.autoHeight?undefined:this.el.getHeight());return this;},onResize:function(adjWidth,adjHeight,rawWidth,rawHeight){},onPosition:function(x,y){},adjustSize:function(w,h){if(this.autoWidth){w='auto';}
if(this.autoHeight){h='auto';}
return{width:w,height:h};},adjustPosition:function(x,y){return{x:x,y:y};}});L5.reg('box',L5.BoxComponent);

L5.SplitBar=function(dragElement,resizingElement,orientation,placement,existingProxy){this.el=L5.get(dragElement,true);this.el.dom.unselectable="on";this.resizingEl=L5.get(resizingElement,true);this.orientation=orientation||L5.SplitBar.HORIZONTAL;this.minSize=0;this.maxSize=2000;this.animate=false;this.useShim=false;this.shim=null;if(!existingProxy){this.proxy=L5.SplitBar.createProxy(this.orientation);}else{this.proxy=L5.get(existingProxy).dom;}
this.dd=new L5.dd.DDProxy(this.el.dom.id,"XSplitBars",{dragElId:this.proxy.id});this.dd.b4StartDrag=this.onStartProxyDrag.createDelegate(this);this.dd.endDrag=this.onEndProxyDrag.createDelegate(this);this.dragSpecs={};this.adapter=new L5.SplitBar.BasicLayoutAdapter();this.adapter.init(this);if(this.orientation==L5.SplitBar.HORIZONTAL){this.placement=placement||(this.el.getX()>this.resizingEl.getX()?L5.SplitBar.LEFT:L5.SplitBar.RIGHT);this.el.addClass("l-splitbar-h");}else{this.placement=placement||(this.el.getY()>this.resizingEl.getY()?L5.SplitBar.TOP:L5.SplitBar.BOTTOM);this.el.addClass("l-splitbar-v");}
this.addEvents("resize","moved","beforeresize","beforeapply");L5.SplitBar.superclass.constructor.call(this);};L5.extend(L5.SplitBar,L5.util.Observable,{onStartProxyDrag:function(x,y){this.fireEvent("beforeresize",this);this.overlay=L5.DomHelper.append(document.body,{cls:"l-drag-overlay",html:"&#160;"},true);this.overlay.unselectable();this.overlay.setSize(L5.lib.Dom.getViewWidth(true),L5.lib.Dom.getViewHeight(true));this.overlay.show();L5.get(this.proxy).setDisplayed("block");var size=this.adapter.getElementSize(this);this.activeMinSize=this.getMinimumSize();this.activeMaxSize=this.getMaximumSize();var c1=size-this.activeMinSize;var c2=Math.max(this.activeMaxSize-size,0);if(this.orientation==L5.SplitBar.HORIZONTAL){this.dd.resetConstraints();this.dd.setXConstraint(this.placement==L5.SplitBar.LEFT?c1:c2,this.placement==L5.SplitBar.LEFT?c2:c1);this.dd.setYConstraint(0,0);}else{this.dd.resetConstraints();this.dd.setXConstraint(0,0);this.dd.setYConstraint(this.placement==L5.SplitBar.TOP?c1:c2,this.placement==L5.SplitBar.TOP?c2:c1);}
this.dragSpecs.startSize=size;this.dragSpecs.startPoint=[x,y];L5.dd.DDProxy.prototype.b4StartDrag.call(this.dd,x,y);},onEndProxyDrag:function(e){L5.get(this.proxy).setDisplayed(false);var endPoint=L5.lib.Event.getXY(e);if(this.overlay){L5.destroy(this.overlay);delete this.overlay;}
var newSize;if(this.orientation==L5.SplitBar.HORIZONTAL){newSize=this.dragSpecs.startSize+
(this.placement==L5.SplitBar.LEFT?endPoint[0]-this.dragSpecs.startPoint[0]:this.dragSpecs.startPoint[0]-endPoint[0]);}else{newSize=this.dragSpecs.startSize+
(this.placement==L5.SplitBar.TOP?endPoint[1]-this.dragSpecs.startPoint[1]:this.dragSpecs.startPoint[1]-endPoint[1]);}
newSize=Math.min(Math.max(newSize,this.activeMinSize),this.activeMaxSize);if(newSize!=this.dragSpecs.startSize){if(this.fireEvent('beforeapply',this,newSize)!==false){this.adapter.setElementSize(this,newSize);this.fireEvent("moved",this,newSize);this.fireEvent("resize",this,newSize);}}},getAdapter:function(){return this.adapter;},setAdapter:function(adapter){this.adapter=adapter;this.adapter.init(this);},getMinimumSize:function(){return this.minSize;},setMinimumSize:function(minSize){this.minSize=minSize;},getMaximumSize:function(){return this.maxSize;},setMaximumSize:function(maxSize){this.maxSize=maxSize;},setCurrentSize:function(size){var oldAnimate=this.animate;this.animate=false;this.adapter.setElementSize(this,size);this.animate=oldAnimate;},destroy:function(removeEl){if(this.shim){this.shim.remove();}
this.dd.unreg();L5.destroy(L5.get(this.proxy));if(removeEl){this.el.remove();}}});L5.SplitBar.createProxy=function(dir){var proxy=new L5.Element(document.createElement("div"));proxy.unselectable();var cls='l-splitbar-proxy';proxy.addClass(cls+' '+(dir==L5.SplitBar.HORIZONTAL?cls+'-h':cls+'-v'));document.body.appendChild(proxy.dom);return proxy.dom;};L5.SplitBar.BasicLayoutAdapter=function(){};L5.SplitBar.BasicLayoutAdapter.prototype={init:function(s){},getElementSize:function(s){if(s.orientation==L5.SplitBar.HORIZONTAL){return s.resizingEl.getWidth();}else{return s.resizingEl.getHeight();}},setElementSize:function(s,newSize,onComplete){if(s.orientation==L5.SplitBar.HORIZONTAL){if(!s.animate){s.resizingEl.setWidth(newSize);if(onComplete){onComplete(s,newSize);}}else{s.resizingEl.setWidth(newSize,true,.1,onComplete,'easeOut');}}else{if(!s.animate){s.resizingEl.setHeight(newSize);if(onComplete){onComplete(s,newSize);}}else{s.resizingEl.setHeight(newSize,true,.1,onComplete,'easeOut');}}}};L5.SplitBar.AbsoluteLayoutAdapter=function(container){this.basic=new L5.SplitBar.BasicLayoutAdapter();this.container=L5.get(container);};L5.SplitBar.AbsoluteLayoutAdapter.prototype={init:function(s){this.basic.init(s);},getElementSize:function(s){return this.basic.getElementSize(s);},setElementSize:function(s,newSize,onComplete){this.basic.setElementSize(s,newSize,this.moveSplitter.createDelegate(this,[s]));},moveSplitter:function(s){var yes=L5.SplitBar;switch(s.placement){case yes.LEFT:s.el.setX(s.resizingEl.getRight());break;case yes.RIGHT:s.el.setStyle("right",(this.container.getWidth()-s.resizingEl.getLeft())+"px");break;case yes.TOP:s.el.setY(s.resizingEl.getBottom());break;case yes.BOTTOM:s.el.setY(s.resizingEl.getTop()-s.el.getHeight());break;}}};L5.SplitBar.VERTICAL=1;L5.SplitBar.HORIZONTAL=2;L5.SplitBar.LEFT=1;L5.SplitBar.RIGHT=2;L5.SplitBar.TOP=3;L5.SplitBar.BOTTOM=4;

L5.Container=L5.extend(L5.BoxComponent,{autoDestroy:true,defaultType:'panel',initComponent:function(){L5.Container.superclass.initComponent.call(this);this.addEvents('afterlayout','beforeadd','beforeremove','add','remove');var items=this.items;if(items){delete this.items;if(L5.isArray(items)&&items.length>0){this.add.apply(this,items);}else{this.add(items);}}},initItems:function(){if(!this.items){this.items=new L5.util.MixedCollection(false,this.getComponentId);this.getLayout();}},setLayout:function(layout){if(this.layout&&this.layout!=layout){this.layout.setContainer(null);}
this.initItems();this.layout=layout;layout.setContainer(this);},render:function(){L5.Container.superclass.render.apply(this,arguments);if(this.layout){if(typeof this.layout=='string'){this.layout=new L5.Container.LAYOUTS[this.layout.toLowerCase()](this.layoutConfig);}
this.setLayout(this.layout);if(this.activeItem!==undefined){var item=this.activeItem;delete this.activeItem;this.layout.setActiveItem(item);return;}}
if(!this.ownerCt){this.doLayout();}
if(this.monitorResize===true){L5.EventManager.onWindowResize(this.doLayout,this,[false]);}},getLayoutTarget:function(){return this.el;},getComponentId:function(comp){return comp.itemId||comp.id;},add:function(comp){if(!this.items){this.initItems();}
var a=arguments,len=a.length;if(len>1){for(var i=0;i<len;i++){this.add(a[i]);}
return;}
var c=this.lookupComponent(this.applyDefaults(comp));var pos=this.items.length;if(this.fireEvent('beforeadd',this,c,pos)!==false&&this.onBeforeAdd(c)!==false){this.items.add(c);c.ownerCt=this;this.fireEvent('add',this,c,pos);}
return c;},insert:function(index,comp){if(!this.items){this.initItems();}
var a=arguments,len=a.length;if(len>2){for(var i=len-1;i>=1;--i){this.insert(index,a[i]);}
return;}
var c=this.lookupComponent(this.applyDefaults(comp));if(c.ownerCt==this&&this.items.indexOf(c)<index){--index;}
if(this.fireEvent('beforeadd',this,c,index)!==false&&this.onBeforeAdd(c)!==false){this.items.insert(index,c);c.ownerCt=this;this.fireEvent('add',this,c,index);}
return c;},applyDefaults:function(c){if(this.defaults){if(typeof c=='string'){c=L5.ComponentMgr.get(c);L5.apply(c,this.defaults);}else if(!c.events){L5.applyIf(c,this.defaults);}else{L5.apply(c,this.defaults);}}
return c;},onBeforeAdd:function(item){if(item.ownerCt){item.ownerCt.remove(item,false);}
if(this.hideBorders===true){item.border=(item.border===true);}},remove:function(comp,autoDestroy){var c=this.getComponent(comp);if(c&&this.fireEvent('beforeremove',this,c)!==false){this.items.remove(c);delete c.ownerCt;if(autoDestroy===true||(autoDestroy!==false&&this.autoDestroy)){c.destroy();}
if(this.layout&&this.layout.activeItem==c){delete this.layout.activeItem;}
this.fireEvent('remove',this,c);}
return c;},removeAll:function(autoDestroy){var item,items=[];while((item=this.items.last())){items.unshift(this.remove(item,autoDestroy));}
return items;},getComponent:function(comp){if(typeof comp=='object'){return comp;}
return this.items.get(comp);},lookupComponent:function(comp){if(typeof comp=='string'){return L5.ComponentMgr.get(comp);}else if(!comp.events){return this.createComponent(comp);}
return comp;},createComponent:function(config){return L5.ComponentMgr.create(config,this.defaultType);},doLayout:function(shallow){if(this.rendered&&this.layout){this.layout.layout();}
if(shallow!==false&&this.items){var cs=this.items.items;for(var i=0,len=cs.length;i<len;i++){var c=cs[i];if(c.doLayout){c.doLayout();}}}},getLayout:function(){if(!this.layout){var layout=new L5.layout.ContainerLayout(this.layoutConfig);this.setLayout(layout);}
return this.layout;},beforeDestroy:function(){if(this.items){L5.destroy.apply(L5,this.items.items);}
if(this.monitorResize){L5.EventManager.removeResizeListener(this.doLayout,this);}
if(this.layout&&this.layout.destroy){this.layout.destroy();}
L5.Container.superclass.beforeDestroy.call(this);},bubble:function(fn,scope,args){var p=this;while(p){if(fn.apply(scope||p,args||[p])===false){break;}
p=p.ownerCt;}},cascade:function(fn,scope,args){if(fn.apply(scope||this,args||[this])!==false){if(this.items){var cs=this.items.items;for(var i=0,len=cs.length;i<len;i++){if(cs[i].cascade){cs[i].cascade(fn,scope,args);}else{fn.apply(scope||cs[i],args||[cs[i]]);}}}}},findById:function(id){var m,ct=this;this.cascade(function(c){if(ct!=c&&c.id===id){m=c;return false;}});return m||null;},findByType:function(xtype,shallow){return this.findBy(function(c){return c.isXType(xtype,shallow);});},find:function(prop,value){return this.findBy(function(c){return c[prop]===value;});},findBy:function(fn,scope){var m=[],ct=this;this.cascade(function(c){if(ct!=c&&fn.call(scope||c,c,ct)===true){m.push(c);}});return m;}});L5.Container.LAYOUTS={};L5.reg('container',L5.Container);

L5.layout.ContainerLayout=function(config){L5.apply(this,config);};L5.layout.ContainerLayout.prototype={monitorResize:true,activeItem:null,layout:function(){var target=this.container.getLayoutTarget();this.onLayout(this.container,target);this.container.fireEvent('afterlayout',this.container,this);},onLayout:function(ct,target){this.renderAll(ct,target);var items=ct.items.items;for(var i=0,len=items.length;i<len;i++){var c=items[i];if(c.onWinResize){c.onWinResize();}}},isValidParent:function(c,target){var el=c.getPositionEl?c.getPositionEl():c.getEl();return el.dom.parentNode==target.dom;},renderAll:function(ct,target){var items=ct.items.items;for(var i=0,len=items.length;i<len;i++){var c=items[i];if(c&&(!c.rendered||!this.isValidParent(c,target))){this.renderItem(c,i,target);}}},renderItem:function(c,position,target){if(c&&!c.rendered){c.render(target,position);if(this.extraCls){var t=c.getPositionEl?c.getPositionEl():c;t.addClass(this.extraCls);}
if(this.renderHidden&&c!=this.activeItem){c.hide();}}else if(c&&!this.isValidParent(c,target)){if(this.extraCls){var t=c.getPositionEl?c.getPositionEl():c;t.addClass(this.extraCls);}
if(typeof position=='number'){position=target.dom.childNodes[position];}
target.dom.insertBefore(c.getEl().dom,position||null);if(this.renderHidden&&c!=this.activeItem){c.hide();}}},onResize:function(){if(this.container.collapsed){return;}
var b=this.container.bufferResize;if(b){if(!this.resizeTask){this.resizeTask=new L5.util.DelayedTask(this.layout,this);this.resizeBuffer=typeof b=='number'?b:100;}
this.resizeTask.delay(this.resizeBuffer);}else{this.layout();}},setContainer:function(ct){if(this.monitorResize&&ct!=this.container){if(this.container){this.container.un('resize',this.onResize,this);}
if(ct){ct.on('resize',this.onResize,this);}}
this.container=ct;},parseMargins:function(v){var ms=v.split(' ');var len=ms.length;if(len==1){ms[1]=ms[0];ms[2]=ms[0];ms[3]=ms[0];}
if(len==2){ms[2]=ms[0];ms[3]=ms[1];}
return{top:parseInt(ms[0],10)||0,right:parseInt(ms[1],10)||0,bottom:parseInt(ms[2],10)||0,left:parseInt(ms[3],10)||0};},destroy:L5.emptyFn};L5.Container.LAYOUTS['auto']=L5.layout.ContainerLayout;

L5.layout.FitLayout=L5.extend(L5.layout.ContainerLayout,{monitorResize:true,onLayout:function(ct,target){L5.layout.FitLayout.superclass.onLayout.call(this,ct,target);if(!this.container.collapsed){this.setItemSize(this.activeItem||ct.items.itemAt(0),target.getStyleSize());}},setItemSize:function(item,size){if(item&&size.height>0){item.setSize(size);}}});L5.Container.LAYOUTS['fit']=L5.layout.FitLayout;

L5.layout.CardLayout=L5.extend(L5.layout.FitLayout,{deferredRender:false,renderHidden:true,setActiveItem:function(item){item=this.container.getComponent(item);if(this.activeItem!=item){if(this.activeItem){this.activeItem.hide();}
this.activeItem=item;item.show();this.layout();}},renderAll:function(ct,target){if(this.deferredRender){this.renderItem(this.activeItem,undefined,target);}else{L5.layout.CardLayout.superclass.renderAll.call(this,ct,target);}}});L5.Container.LAYOUTS['card']=L5.layout.CardLayout;

L5.layout.AnchorLayout=L5.extend(L5.layout.ContainerLayout,{monitorResize:true,getAnchorViewSize:function(ct,target){return target.dom==document.body?target.getViewSize():target.getStyleSize();},onLayout:function(ct,target){L5.layout.AnchorLayout.superclass.onLayout.call(this,ct,target);var size=this.getAnchorViewSize(ct,target);var w=size.width,h=size.height;if(w<20||h<20){return;}
var aw,ah;if(ct.anchorSize){if(typeof ct.anchorSize=='number'){aw=ct.anchorSize;}else{aw=ct.anchorSize.width;ah=ct.anchorSize.height;}}else{aw=ct.initialConfig.width;ah=ct.initialConfig.height;}
var cs=ct.items.items,len=cs.length,i,c,a,cw,ch;for(i=0;i<len;i++){c=cs[i];if(c.anchor){a=c.anchorSpec;if(!a){var vs=c.anchor.split(' ');c.anchorSpec=a={right:this.parseAnchor(vs[0],c.initialConfig.width,aw),bottom:this.parseAnchor(vs[1],c.initialConfig.height,ah)};}
cw=a.right?this.adjustWidthAnchor(a.right(w),c):undefined;ch=a.bottom?this.adjustHeightAnchor(a.bottom(h),c):undefined;if(cw||ch){c.setSize(cw||undefined,ch||undefined);}}}},parseAnchor:function(a,start,cstart){if(a&&a!='none'){var last;if(/^(r|right|b|bottom)$/i.test(a)){var diff=cstart-start;return function(v){if(v!==last){last=v;return v-diff;}}}else if(a.indexOf('%')!=-1){var ratio=parseFloat(a.replace('%',''))*.01;return function(v){if(v!==last){last=v;return Math.floor(v*ratio);}}}else{a=parseInt(a,10);if(!isNaN(a)){return function(v){if(v!==last){last=v;return v+a;}}}}}
return false;},adjustWidthAnchor:function(value,comp){return value;},adjustHeightAnchor:function(value,comp){return value;}});L5.Container.LAYOUTS['anchor']=L5.layout.AnchorLayout;

L5.layout.ColumnLayout=L5.extend(L5.layout.ContainerLayout,{monitorResize:true,extraCls:'l-column',scrollOffset:0,isValidParent:function(c,target){return(c.getPositionEl?c.getPositionEl():c.getEl()).dom.parentNode==this.innerCt.dom;},onLayout:function(ct,target){var cs=ct.items.items,len=cs.length,c,i;if(!this.innerCt){target.addClass('l-column-layout-ct');this.innerCt=target.createChild({cls:'l-column-inner'});this.innerCt.createChild({cls:'l-clear'});}
this.renderAll(ct,this.innerCt);var size=L5.isIE&&target.dom!=L5.getBody().dom?target.getStyleSize():target.getViewSize();if(size.width<1&&size.height<1){return;}
var w=size.width-target.getPadding('lr')-this.scrollOffset,h=size.height-target.getPadding('tb'),pw=w;this.innerCt.setWidth(w);for(i=0;i<len;i++){c=cs[i];if(!c.columnWidth){pw-=(c.getSize().width+c.getEl().getMargins('lr'));}}
pw=pw<0?0:pw;for(i=0;i<len;i++){c=cs[i];if(c.columnWidth){c.setSize(Math.floor(c.columnWidth*pw)-c.getEl().getMargins('lr'));}}
for(i=0;i<len;i++){c=cs[i];if(c.onWinResize){c.onWinResize();}}}});L5.Container.LAYOUTS['column']=L5.layout.ColumnLayout;

L5.layout.BorderLayout=L5.extend(L5.layout.ContainerLayout,{monitorResize:true,rendered:false,onLayout:function(ct,target){var collapsed;if(!this.rendered){target.position();target.addClass('l-border-layout-ct');var items=ct.items.items;collapsed=[];for(var i=0,len=items.length;i<len;i++){var c=items[i];var pos=c.region;if(c.collapsed){collapsed.push(c);}
c.collapsed=false;if(!c.rendered){c.cls=c.cls?c.cls+' l-border-panel':'l-border-panel';c.render(target,i);}
this[pos]=pos!='center'&&c.split?new L5.layout.BorderLayout.SplitRegion(this,c.initialConfig,pos):new L5.layout.BorderLayout.Region(this,c.initialConfig,pos);this[pos].render(target,c);if(c.onWinResize)
L5.EventManager.removeResizeListener(c.onWinResize,c);}
this.rendered=true;}
var size=target.getViewSize();if(size.width<20||size.height<20){if(collapsed){this.restoreCollapsed=collapsed;}
return;}else if(this.restoreCollapsed){collapsed=this.restoreCollapsed;delete this.restoreCollapsed;}
var w=size.width,h=size.height;var centerW=w,centerH=h,centerY=0,centerX=0;var n=this.north,s=this.south,west=this.west,e=this.east,c=this.center;if(!c&&L5.layout.BorderLayout.WARN!==false){throw'No center region defined in BorderLayout '+ct.id;}
if(n&&n.isVisible()){n.panel.onWinResize();var b=n.getSize();var m=n.getMargins();b.width=w-(m.left+m.right);b.x=m.left;b.y=m.top;centerY=b.height+b.y+m.bottom;centerH-=centerY;n.applyLayout(b);}
if(s&&s.isVisible()){s.panel.onWinResize();var b=s.getSize();var m=s.getMargins();b.width=w-(m.left+m.right);b.x=m.left;var totalHeight=(b.height+m.top+m.bottom);b.y=h-totalHeight+m.top;centerH-=totalHeight;s.applyLayout(b);}
if(west&&west.isVisible()){west.panel.onWinResize();var b=west.getSize();var m=west.getMargins();b.height=centerH-(m.top+m.bottom);b.x=m.left;b.y=centerY+m.top;var totalWidth=(b.width+m.left+m.right);centerX+=totalWidth;centerW-=totalWidth;west.applyLayout(b);}
if(e&&e.isVisible()){e.panel.onWinResize();var b=e.getSize();var m=e.getMargins();b.height=centerH-(m.top+m.bottom);var totalWidth=(b.width+m.left+m.right);b.x=w-totalWidth+m.left;b.y=centerY+m.top;centerW-=totalWidth;e.applyLayout(b);}
if(c){c.panel.onWinResize();var m=c.getMargins();var centerBox={x:centerX+m.left,y:centerY+m.top,width:centerW-(m.left+m.right),height:centerH-(m.top+m.bottom)};c.applyLayout(centerBox);}
if(collapsed){for(var i=0,len=collapsed.length;i<len;i++){collapsed[i].collapse(false);}}
if(L5.isIE&&L5.isStrict){target.repaint();}},destroy:function(){var r=['north','south','east','west'];for(var i=0;i<r.length;i++){var region=this[r[i]];if(region){if(region.destroy){region.destroy();}else if(region.split){region.split.destroy(true);}}}
L5.layout.BorderLayout.superclass.destroy.call(this);}});L5.layout.BorderLayout.Region=function(layout,config,pos){L5.apply(this,config);this.layout=layout;this.position=pos;this.state={};if(typeof this.margins=='string'){this.margins=this.layout.parseMargins(this.margins);}
this.margins=L5.applyIf(this.margins||{},this.defaultMargins);if(this.collapsible){if(typeof this.cmargins=='string'){this.cmargins=this.layout.parseMargins(this.cmargins);}
if(this.collapseMode=='mini'&&!this.cmargins){this.cmargins={left:0,top:0,right:0,bottom:0};}else{this.cmargins=L5.applyIf(this.cmargins||{},pos=='north'||pos=='south'?this.defaultNSCMargins:this.defaultEWCMargins);}}};L5.layout.BorderLayout.Region.prototype={collapsible:false,split:false,floatable:true,minWidth:50,minHeight:50,defaultMargins:{left:0,top:0,right:0,bottom:0},defaultNSCMargins:{left:5,top:5,right:5,bottom:5},defaultEWCMargins:{left:5,top:0,right:5,bottom:0},baseToggleCls:"l-tool",isCollapsed:false,render:function(ct,p){this.panel=p;p.el.enableDisplayMode();this.targetEl=ct;this.el=p.el;var gs=p.getState,ps=this.position;p.getState=function(){return L5.apply(gs.call(p)||{},this.state);}.createDelegate(this);if(ps!='center'){p.allowQueuedExpand=false;p.on({beforecollapse:this.beforeCollapse,collapse:this.onCollapse,beforeexpand:this.beforeExpand,expand:this.onExpand,hide:this.onHide,show:this.onShow,scope:this});if(this.collapsible){p.collapseEl='el';p.slideAnchor=this.getSlideAnchor();}
if(p.tools&&p.tools.toggle){if(this.baseToggleCls!="l-tool"){p.tools.toggle.removeClass("l-tool-toggle");p.tools.toggle.dom.style.backgroundPosition="0px 0px";}
p.tools.toggle.addClass(this.baseToggleCls+'-collapse-'+ps);p.tools.toggle.addClassOnOver(this.baseToggleCls+'-collapse-'+ps+'-over');}}},getCollapsedEl:function(){if(!this.collapsedEl){if(!this.toolTemplate){var tt=new L5.Template('<div class="l-tool '+this.baseToggleCls+'-{id}">&#160;</div>');tt.disableFormats=true;tt.compile();L5.layout.BorderLayout.Region.prototype.toolTemplate=tt;}
this.collapsedEl=this.targetEl.createChild({cls:"l-layout-collapsed l-layout-collapsed-"+this.position,id:this.panel.id+'-xcollapsed'});this.collapsedEl.enableDisplayMode('block');if(this.collapseMode=='mini'){this.collapsedEl.addClass('l-layout-cmini-'+this.position);this.miniCollapsedEl=this.collapsedEl.createChild({cls:"l-layout-mini l-layout-mini-"+this.position,html:"&#160;"});this.miniCollapsedEl.addClassOnOver('l-layout-mini-over');this.collapsedEl.addClassOnOver("l-layout-collapsed-over");this.collapsedEl.on('click',this.onExpandClick,this,{stopEvent:true});}else{var t=this.toolTemplate.append(this.collapsedEl.dom,{id:'expand-'+this.position},true);if(this.title)
t.parent().createChild('<span style="font:bold 12px/15px tahoma, arial, verdana, sans-serif;color:#15428b">'+this.title+'</span>');t.addClassOnOver(this.baseToggleCls+'-expand-'+this.position+'-over');t.on('click',this.onExpandClick,this,{stopEvent:true});if(this.floatable!==false){this.collapsedEl.addClassOnOver("l-layout-collapsed-over");this.collapsedEl.on("click",this.collapseClick,this);}
this.collapsedEl.on("dblclick",this.onExpandClick,this,{stopEvent:true});}}
return this.collapsedEl;},onExpandClick:function(e){if(this.isSlid){this.afterSlideIn();this.panel.expand(false);}else{this.panel.expand();}},onCollapseClick:function(e){this.panel.collapse();},beforeCollapse:function(p,animate){this.lastAnim=animate;if(this.splitEl){this.splitEl.hide();}
this.getCollapsedEl().show();this.panel.el.setStyle('z-index',100);this.isCollapsed=true;this.layout.layout();},onCollapse:function(animate){this.panel.el.setStyle('z-index',1);if(this.lastAnim===false||this.panel.animCollapse===false){this.getCollapsedEl().dom.style.visibility='visible';}else{this.getCollapsedEl().slideIn(this.panel.slideAnchor,{duration:.2});}
this.state.collapsed=true;this.panel.saveState();},beforeExpand:function(animate){var c=this.getCollapsedEl();this.el.show();if(this.position=='east'||this.position=='west'){this.panel.setSize(undefined,c.getHeight());}else{this.panel.setSize(c.getWidth(),undefined);}
c.hide();c.dom.style.visibility='hidden';this.panel.el.setStyle('z-index',100);},onExpand:function(){this.isCollapsed=false;if(this.splitEl){this.splitEl.show();}
this.layout.layout();this.panel.el.setStyle('z-index',1);this.state.collapsed=false;this.panel.saveState();},collapseClick:function(e){if(this.isSlid){e.stopPropagation();this.slideIn();}else{e.stopPropagation();this.slideOut();}},onHide:function(){if(this.isCollapsed){this.getCollapsedEl().hide();}else if(this.splitEl){this.splitEl.hide();}},onShow:function(){if(this.isCollapsed){this.getCollapsedEl().show();}else if(this.splitEl){this.splitEl.show();}},isVisible:function(){return!this.panel.hidden;},getMargins:function(){return this.isCollapsed&&this.cmargins?this.cmargins:this.margins;},getSize:function(){return this.isCollapsed?this.getCollapsedEl().getSize():this.panel.getSize();},setPanel:function(panel){this.panel=panel;},getMinWidth:function(){return this.minWidth;},getMinHeight:function(){return this.minHeight;},applyLayoutCollapsed:function(box){var ce=this.getCollapsedEl();ce.setLeftTop(box.x,box.y);ce.setSize(box.width,box.height);},applyLayout:function(box){if(this.isCollapsed){this.applyLayoutCollapsed(box);}else{this.panel.setPosition(box.x,box.y);this.panel.setSize(box.width,box.height);}},beforeSlide:function(){this.panel.beforeEffect();},afterSlide:function(){this.panel.afterEffect();},initAutoHide:function(){if(this.autoHide!==false){if(!this.autoHideHd){var st=new L5.util.DelayedTask(this.slideIn,this);this.autoHideHd={"mouseout":function(e){if(!e.within(this.el,true)){st.delay(500);}},"mouseover":function(e){st.cancel();},scope:this};}
this.el.on(this.autoHideHd);}},clearAutoHide:function(){if(this.autoHide!==false){if(this.autoHideHd&&this.autoHideHd.mouseout&&this.autoHideHd.mouseover){this.el.un("mouseout",this.autoHideHd.mouseout);this.el.un("mouseover",this.autoHideHd.mouseover);}}},clearMonitor:function(){L5.getDoc().un("click",this.slideInIf,this);},slideOut:function(){if(this.isSlid||this.el.hasActiveFx()){return;}
if(this.collapsedEl&&this.collapsedEl.child("span"))
this.collapsedEl.child("span").dom.innerHTML="";this.isSlid=true;var ts=this.panel.tools;if(ts&&ts.toggle){ts.toggle.hide();}
this.el.show();if(this.position=='east'||this.position=='west'){this.panel.setSize(undefined,this.collapsedEl.getHeight());}else{this.panel.setSize(this.collapsedEl.getWidth(),undefined);}
this.restoreLT=[this.el.dom.style.left,this.el.dom.style.top];this.el.alignTo(this.collapsedEl,this.getCollapseAnchor());this.el.setStyle("z-index",102);this.panel.el.replaceClass('l-panel-collapsed','l-panel-floating');if(this.animFloat!==false){this.beforeSlide();this.el.slideIn(this.getSlideAnchor(),{callback:function(){this.afterSlide();this.initAutoHide();L5.getDoc().on("click",this.slideInIf,this);},scope:this,block:true});}else{this.initAutoHide();L5.getDoc().on("click",this.slideInIf,this);}},afterSlideIn:function(){this.clearAutoHide();this.isSlid=false;this.clearMonitor();this.el.setStyle("z-index","");this.panel.el.replaceClass('l-panel-floating','l-panel-collapsed');this.el.dom.style.left=this.restoreLT[0];this.el.dom.style.top=this.restoreLT[1];var ts=this.panel.tools;if(ts&&ts.toggle){ts.toggle.show();}},slideIn:function(cb){if(!this.isSlid||this.el.hasActiveFx()){L5.callback(cb);return;}
if(this.collapsedEl&&this.collapsedEl.child("span"))
this.collapsedEl.child("span").dom.innerHTML=this.title?this.title:"";this.isSlid=false;if(this.animFloat!==false){this.beforeSlide();this.el.slideOut(this.getSlideAnchor(),{callback:function(){this.el.hide();this.afterSlide();this.afterSlideIn();L5.callback(cb);},scope:this,block:true});}else{this.el.hide();this.afterSlideIn();}},slideInIf:function(e){if(!e.within(this.el)){this.slideIn();}},anchors:{"west":"left","east":"right","north":"top","south":"bottom"},sanchors:{"west":"l","east":"r","north":"t","south":"b"},canchors:{"west":"tl-tr","east":"tr-tl","north":"tl-bl","south":"bl-tl"},getAnchor:function(){return this.anchors[this.position];},getCollapseAnchor:function(){return this.canchors[this.position];},getSlideAnchor:function(){return this.sanchors[this.position];},getAlignAdj:function(){var cm=this.cmargins;switch(this.position){case"west":return[0,0];break;case"east":return[0,0];break;case"north":return[0,0];break;case"south":return[0,0];break;}},getExpandAdj:function(){var c=this.collapsedEl,cm=this.cmargins;switch(this.position){case"west":return[-(cm.right+c.getWidth()+cm.left),0];break;case"east":return[cm.right+c.getWidth()+cm.left,0];break;case"north":return[0,-(cm.top+cm.bottom+c.getHeight())];break;case"south":return[0,cm.top+cm.bottom+c.getHeight()];break;}}};L5.layout.BorderLayout.SplitRegion=function(layout,config,pos){L5.layout.BorderLayout.SplitRegion.superclass.constructor.call(this,layout,config,pos);this.applyLayout=this.applyFns[pos];};L5.extend(L5.layout.BorderLayout.SplitRegion,L5.layout.BorderLayout.Region,{splitTip:"Drag to resize.",collapsibleSplitTip:"Drag to resize. Double click to hide.",useSplitTips:false,splitSettings:{north:{orientation:L5.SplitBar.VERTICAL,placement:L5.SplitBar.TOP,maxFn:'getVMaxSize',minProp:'minHeight',maxProp:'maxHeight'},south:{orientation:L5.SplitBar.VERTICAL,placement:L5.SplitBar.BOTTOM,maxFn:'getVMaxSize',minProp:'minHeight',maxProp:'maxHeight'},east:{orientation:L5.SplitBar.HORIZONTAL,placement:L5.SplitBar.RIGHT,maxFn:'getHMaxSize',minProp:'minWidth',maxProp:'maxWidth'},west:{orientation:L5.SplitBar.HORIZONTAL,placement:L5.SplitBar.LEFT,maxFn:'getHMaxSize',minProp:'minWidth',maxProp:'maxWidth'}},applyFns:{west:function(box){if(this.isCollapsed){return this.applyLayoutCollapsed(box);}
var sd=this.splitEl.dom,s=sd.style;this.panel.setPosition(box.x,box.y);var sw=sd.offsetWidth;s.left=(box.x+box.width-sw)+'px';s.top=(box.y)+'px';s.height=Math.max(0,box.height)+'px';this.panel.setSize(box.width-sw,box.height);},east:function(box){if(this.isCollapsed){return this.applyLayoutCollapsed(box);}
var sd=this.splitEl.dom,s=sd.style;var sw=sd.offsetWidth;this.panel.setPosition(box.x+sw,box.y);s.left=(box.x)+'px';s.top=(box.y)+'px';s.height=Math.max(0,box.height)+'px';this.panel.setSize(box.width-sw,box.height);},north:function(box){if(this.isCollapsed){return this.applyLayoutCollapsed(box);}
var sd=this.splitEl.dom,s=sd.style;var sh=sd.offsetHeight;this.panel.setPosition(box.x,box.y);s.left=(box.x)+'px';s.top=(box.y+box.height-sh)+'px';s.width=Math.max(0,box.width)+'px';this.panel.setSize(box.width,box.height-sh);},south:function(box){if(this.isCollapsed){return this.applyLayoutCollapsed(box);}
var sd=this.splitEl.dom,s=sd.style;var sh=sd.offsetHeight;this.panel.setPosition(box.x,box.y+sh);s.left=(box.x)+'px';s.top=(box.y)+'px';s.width=Math.max(0,box.width)+'px';this.panel.setSize(box.width,box.height-sh);}},render:function(ct,p){L5.layout.BorderLayout.SplitRegion.superclass.render.call(this,ct,p);var ps=this.position;this.splitEl=ct.createChild({cls:"l-layout-split l-layout-split-"+ps,html:"&#160;",id:this.panel.id+'-xsplit'});if(this.collapseMode=='mini'){this.miniSplitEl=this.splitEl.createChild({cls:"l-layout-mini l-layout-mini-"+ps,html:"&#160;"});this.miniSplitEl.addClassOnOver('l-layout-mini-over');this.miniSplitEl.on('click',this.onCollapseClick,this,{stopEvent:true});}
var s=this.splitSettings[ps];this.split=new L5.SplitBar(this.splitEl.dom,p.el,s.orientation);this.split.placement=s.placement;this.split.getMaximumSize=this[s.maxFn].createDelegate(this);this.split.minSize=this.minSize||this[s.minProp];this.split.on("beforeapply",this.onSplitMove,this);this.split.useShim=this.useShim===true;this.maxSize=this.maxSize||this[s.maxProp];if(p.hidden){this.splitEl.hide();}
if(this.useSplitTips){this.splitEl.dom.title=this.collapsible?this.collapsibleSplitTip:this.splitTip;}
if(this.collapsible){this.splitEl.on("dblclick",this.onCollapseClick,this);}},getSize:function(){if(this.isCollapsed){return this.collapsedEl.getSize();}
var s=this.panel.getSize();if(this.position=='north'||this.position=='south'){s.height+=this.splitEl.dom.offsetHeight;}else{s.width+=this.splitEl.dom.offsetWidth;}
return s;},getHMaxSize:function(){var cmax=this.maxSize||10000;var center=this.layout.center;return Math.min(cmax,(this.el.getWidth()+center.el.getWidth())-center.getMinWidth());},getVMaxSize:function(){var cmax=this.maxSize||10000;var center=this.layout.center;return Math.min(cmax,(this.el.getHeight()+center.el.getHeight())-center.getMinHeight());},onSplitMove:function(split,newSize){var s=this.panel.getSize();this.lastSplitSize=newSize;if(this.position=='north'||this.position=='south'){var ownerCt=this.panel.ownerCt;var newH=(newSize/ownerCt.getEl().getHeight()).toString();if(newH.length<4){newH+="00000";}
newSize=newH.toString().substring(2,4)+"%";this.panel.setHeight(newSize);this.state.height=newSize;}else{var ownerCt=this.panel.ownerCt;var newW=(newSize/ownerCt.getEl().getWidth()).toString();if(newW.length<4){newW+="00000";}
newSize=newW.toString().substring(2,4)+"%";this.panel.setWidth(newSize);this.state.width=newSize;}
this.layout.layout();this.panel.saveState();return false;},getSplitBar:function(){return this.split;},destroy:function(){L5.destroy(this.miniSplitEl,this.split,this.splitEl);}});L5.Container.LAYOUTS['border']=L5.layout.BorderLayout;

L5.layout.FormLayout=L5.extend(L5.layout.AnchorLayout,{labelSeparator:':',getAnchorViewSize:function(ct,target){return(ct.body||ct.el).getStyleSize();},setContainer:function(ct){L5.layout.FormLayout.superclass.setContainer.call(this,ct);if(ct.labelAlign){ct.addClass('l-form-label-'+ct.labelAlign);}
if(ct.hideLabels){this.labelStyle="display:none";this.elementStyle="padding-left:0;";this.labelAdjust=0;}else{this.labelSeparator=ct.labelSeparator||this.labelSeparator;ct.labelWidth=ct.labelWidth||100;if(typeof ct.labelWidth=='number'){var pad=(typeof ct.labelPad=='number'?ct.labelPad:5);this.labelAdjust=ct.labelWidth+pad;this.labelStyle="width:"+ct.labelWidth+"px;";this.elementStyle="padding-left:"+(ct.labelWidth+pad)+'px';}
if(ct.labelAlign=='top'){this.labelStyle="width:auto;";this.labelAdjust=0;this.elementStyle="padding-left:0;";}}
if(!this.fieldTpl){var t=new L5.Template('<div class="l-form-item {5}" tabIndex="-1">','<label for="{0}" style="{2}" class="l-form-item-label">{1}{4}</label>','<div class="l-form-element" id="l-form-el-{0}" style="{3}">','</div><div class="{6}"></div>','</div>');t.disableFormats=true;t.compile();L5.layout.FormLayout.prototype.fieldTpl=t;}},getLabelStyle:function(s){var ls='',items=[this.labelStyle,s];for(var i=0,len=items.length;i<len;++i){if(items[i]){ls+=items[i];if(ls.substr(-1,1)!=';'){ls+=';'}}}
return ls;},renderItem:function(c,position,target){if(c&&!c.rendered&&c.isFormField&&c.inputType!='hidden'){var args=[c.id,c.fieldLabel,this.getLabelStyle(c.labelStyle),this.elementStyle||'',typeof c.labelSeparator=='undefined'?this.labelSeparator:c.labelSeparator,(c.itemCls||this.container.itemCls||'')+(c.hideLabel?' l-hide-label':''),c.clearCls||'l-form-clear-left'];if(typeof position=='number'){position=target.dom.childNodes[position]||null;}
if(position){this.fieldTpl.insertBefore(position,args);}else{this.fieldTpl.append(target,args);}
c.render('l-form-el-'+c.id);}else{L5.layout.FormLayout.superclass.renderItem.apply(this,arguments);}},adjustWidthAnchor:function(value,comp){return value-(comp.isFormField?(comp.hideLabel?0:this.labelAdjust):0);},isValidParent:function(c,target){return true;}});L5.Container.LAYOUTS['form']=L5.layout.FormLayout;

L5.layout.Accordion=L5.extend(L5.layout.FitLayout,{fill:true,autoWidth:true,titleCollapse:true,hideCollapseTool:false,collapseFirst:false,animate:false,sequence:false,activeOnTop:false,renderItem:function(c){if(this.animate===false){c.animCollapse=false;}
c.collapsible=true;if(this.autoWidth){c.autoWidth=true;}
if(this.titleCollapse){c.titleCollapse=true;}
if(this.hideCollapseTool){c.hideCollapseTool=true;}
if(this.collapseFirst!==undefined){c.collapseFirst=this.collapseFirst;}
if(!this.activeItem&&!c.collapsed){this.activeItem=c;}else if(this.activeItem){c.collapsed=true;}
L5.layout.Accordion.superclass.renderItem.apply(this,arguments);c.header.addClass('l-accordion-hd');c.on('beforeexpand',this.beforeExpand,this);},beforeExpand:function(p,anim){var ai=this.activeItem;if(ai){if(this.sequence){delete this.activeItem;if(!ai.collapsed){ai.collapse({callback:function(){p.expand(anim||true);},scope:this});return false;}}else{ai.collapse(this.animate);}}
this.activeItem=p;if(this.activeOnTop){p.el.dom.parentNode.insertBefore(p.el.dom,p.el.dom.parentNode.firstChild);}
this.layout();},setItemSize:function(item,size){if(this.fill&&item){var items=this.container.items.items;var hh=0;for(var i=0,len=items.length;i<len;i++){var p=items[i];if(p!=item){hh+=(p.getSize().height-p.bwrap.getHeight());}}
size.height-=hh;item.setSize(size);}}});L5.Container.LAYOUTS['accordion']=L5.layout.Accordion;

L5.layout.TableLayout=L5.extend(L5.layout.ContainerLayout,{monitorResize:false,setContainer:function(ct){L5.layout.TableLayout.superclass.setContainer.call(this,ct);this.currentRow=0;this.currentColumn=0;this.cells=[];},onLayout:function(ct,target){var cs=ct.items.items,len=cs.length,c,i;if(!this.table){target.addClass('l-table-layout-ct');this.table=target.createChild({tag:'table',cls:'l-table-layout',cellspacing:0,cn:{tag:'tbody'}},null,true);this.renderAll(ct,target);}
var items=ct.items.items;for(var i=0,len=items.length;i<len;i++){var c=items[i];if(c.onWinResize){c.onWinResize();}}},renderItem:function(c,position,target){if(c&&!c.rendered){c.render(this.getNextCell(c));if(this.extraCls){var t=c.getPositionEl?c.getPositionEl():c;t.addClass(this.extraCls);}}},getNextCell:function(c){var cell=this.getNextNonSpan(this.currentColumn,this.currentRow);var curCol=this.currentColumn=cell[0],curRow=this.currentRow=cell[1];for(var rowIndex=curRow;rowIndex<curRow+(c.rowspan||1);rowIndex++){if(!this.cells[rowIndex]){this.cells[rowIndex]=[];}
for(var colIndex=curCol;colIndex<curCol+(c.colspan||1);colIndex++){this.cells[rowIndex][colIndex]=true;}}
var td=document.createElement('td');if(c.cellId){td.id=c.cellId;}
var cls='l-table-layout-cell';if(c.cellCls){cls+=' '+c.cellCls;}
td.className=cls;if(c.colspan){td.colSpan=c.colspan;}
if(c.rowspan){td.rowSpan=c.rowspan;}
this.getRow(curRow).appendChild(td);return td;},getRow:function(index){var row=this.table.tBodies[0].childNodes[index];if(!row){row=document.createElement('tr');this.table.tBodies[0].appendChild(row);}
return row;},getNextNonSpan:function(colIndex,rowIndex){var cols=this.columns;while((cols&&colIndex>=cols)||(this.cells[rowIndex]&&this.cells[rowIndex][colIndex])){if(cols&&colIndex>=cols){rowIndex++;colIndex=0;}else{colIndex++;}}
return[colIndex,rowIndex];},isValidParent:function(c,target){return true;}});L5.Container.LAYOUTS['table']=L5.layout.TableLayout;

L5.layout.AbsoluteLayout=L5.extend(L5.layout.AnchorLayout,{extraCls:'l-abs-layout-item',isForm:false,setContainer:function(ct){L5.layout.AbsoluteLayout.superclass.setContainer.call(this,ct);if(ct.isXType('form')){this.isForm=true;}},onLayout:function(ct,target){if(this.isForm){ct.body.position();}else{target.position();}
L5.layout.AbsoluteLayout.superclass.onLayout.call(this,ct,target);},getAnchorViewSize:function(ct,target){return this.isForm?ct.body.getStyleSize():L5.layout.AbsoluteLayout.superclass.getAnchorViewSize.call(this,ct,target);},isValidParent:function(c,target){return this.isForm?true:L5.layout.AbsoluteLayout.superclass.isValidParent.call(this,c,target);},adjustWidthAnchor:function(value,comp){return value?value-comp.getPosition(true)[0]:value;},adjustHeightAnchor:function(value,comp){return value?value-comp.getPosition(true)[1]:value;}});L5.Container.LAYOUTS['absolute']=L5.layout.AbsoluteLayout;

L5.Viewport=L5.extend(L5.Container,{initComponent:function(){L5.Viewport.superclass.initComponent.call(this);document.getElementsByTagName('html')[0].className+=' l-viewport';this.el=L5.getBody();this.el.setHeight=L5.emptyFn;this.el.setWidth=L5.emptyFn;this.el.setSize=L5.emptyFn;this.el.dom.scroll='no';this.allowDomMove=false;this.autoWidth=true;this.autoHeight=true;L5.EventManager.onWindowResize(this.fireResize,this);this.renderTo=this.el;},fireResize:function(w,h){this.fireEvent('resize',this,w,h,w,h);}});L5.reg('viewport',L5.Viewport);

L5.Panel=L5.extend(L5.Container,{baseCls:'l-panel',collapsedCls:'l-panel-collapsed',maskDisabled:true,animCollapse:L5.enableFx,headerAsText:true,buttonAlign:'right',collapsed:false,collapseFirst:true,minButtonWidth:75,elements:'body',toolTarget:'header',collapseEl:'bwrap',slideAnchor:'t',disabledClass:'',autoScroll:false,deferHeight:true,expandDefaults:{duration:.25},collapseDefaults:{duration:.25},toggleIconCls:"l-tool",enableFloat:false,toolBarY:0,initComponent:function(){L5.Panel.superclass.initComponent.call(this);this.addEvents('bodyresize','titlechange','iconchange','collapse','expand','beforecollapse','beforeexpand','beforeclose','close','activate','deactivate','beforebinding','paramchange','message');if(this.tbar){this.elements+=',tbar';if(typeof this.tbar=='object'){this.topToolbar=this.tbar;}
delete this.tbar;}
if(this.bbar){this.elements+=',bbar';if(typeof this.bbar=='object'){this.bottomToolbar=this.bbar;}
delete this.bbar;}
if(this.header===true){this.elements+=',header';delete this.header;}else if(this.title&&this.header!==false){this.elements+=',header';}
if(this.footer===true){this.elements+=',footer';delete this.footer;}
if(this.buttons){var btns=this.buttons;this.buttons=[];for(var i=0,len=btns.length;i<len;i++){if(btns[i].render){btns[i].ownerCt=this;this.buttons.push(btns[i]);}else{this.addButton(btns[i]);}}}
if(this.autoLoad){this.on('render',this.doAutoLoad,this,{delay:10});}},createElement:function(name,pnode){if(this[name]){pnode.appendChild(this[name].dom);return;}
if(name==='bwrap'||this.elements.indexOf(name)!=-1){if(this[name+'Cfg']){this[name]=L5.fly(pnode).createChild(this[name+'Cfg']);}else{var el=document.createElement('div');el.className=this[name+'Cls'];this[name]=L5.get(pnode.appendChild(el));}
if(this[name+'CssClass']){this[name].addClass(this[name+'CssClass']);}
if(this[name+'Style']){this[name].applyStyles(this[name+'Style']);}}},onRender:function(ct,position){L5.Panel.superclass.onRender.call(this,ct,position);this.createClasses();if(this.el){this.el.addClass(this.baseCls);this.header=this.el.down('.'+this.headerCls);this.bwrap=this.el.down('.'+this.bwrapCls);var cp=this.bwrap?this.bwrap:this.el;this.tbar=cp.down('.'+this.tbarCls);this.body=cp.down('.'+this.bodyCls);this.bbar=cp.down('.'+this.bbarCls);this.footer=cp.down('.'+this.footerCls);this.fromMarkup=true;}else{this.el=ct.createChild({id:this.id,cls:this.baseCls},position);}
var el=this.el,d=el.dom;if(this.cls){this.el.addClass(this.cls);}
if(this.buttons){this.elements+=',footer';}
if(this.frame){el.insertHtml('afterBegin',String.format(L5.Element.boxMarkup,this.baseCls));this.createElement('header',d.firstChild.firstChild.firstChild);this.createElement('bwrap',d);var bw=this.bwrap.dom;var ml=d.childNodes[1],bl=d.childNodes[2];bw.appendChild(ml);bw.appendChild(bl);var mc=bw.firstChild.firstChild.firstChild;this.createElement('tbar',mc);this.createElement('body',mc);this.createElement('bbar',mc);this.createElement('footer',bw.lastChild.firstChild.firstChild);if(!this.footer){this.bwrap.dom.lastChild.className+=' l-panel-nofooter';}}else{this.createElement('header',d);this.createElement('bwrap',d);var bw=this.bwrap.dom;this.createElement('tbar',bw);this.createElement('body',bw);this.createElement('bbar',bw);this.createElement('footer',bw);if(!this.header){this.body.addClass(this.bodyCls+'-noheader');if(this.tbar){this.tbar.addClass(this.tbarCls+'-noheader');}}}
if(this.border===false){this.el.addClass(this.baseCls+'-noborder');this.body.addClass(this.bodyCls+'-noborder');if(this.header){this.header.addClass(this.headerCls+'-noborder');}
if(this.footer){this.footer.addClass(this.footerCls+'-noborder');}
if(this.tbar){this.tbar.addClass(this.tbarCls+'-noborder');}
if(this.bbar){this.bbar.addClass(this.bbarCls+'-noborder');}}
if(this.bodyBorder===false){this.body.addClass(this.bodyCls+'-noborder');}
this.bwrap.enableDisplayMode('block');if(this.header){this.header.unselectable();this.header.dom.align="left";if(this.headerAsText){this.header.dom.innerHTML='<span class="'+this.headerTextCls+'">'+this.header.dom.innerHTML+'</span>';if(this.iconCls){this.setIconClass(this.iconCls);}}}
if(this.floating){this.makeFloating(this.floating);}
if(this.collapsible){this.tools=this.tools?this.tools.slice(0):[];if(!this.hideCollapseTool){this.tools[this.collapseFirst?'unshift':'push']({id:'toggle',handler:this.toggleCollapse,scope:this});}
if(this.titleCollapse&&this.header){this.header.on('click',this.toggleCollapse,this);this.header.setStyle('cursor','pointer');}}
if(this.tools){var ts=this.tools;this.tools={};this.addTool.apply(this,ts);}else{this.tools={};}
if(this.buttons&&this.buttons.length>0){var tb=this.footer.createChild({cls:'l-panel-btns-ct',cn:{cls:"l-panel-btns l-panel-btns-"+this.buttonAlign,html:'<table cellspacing="0"><tbody><tr></tr></tbody></table><div class="l-clear"></div>'}},null,true);var tr=tb.getElementsByTagName('tr')[0];for(var i=0,len=this.buttons.length;i<len;i++){var b=this.buttons[i];var td=document.createElement('td');td.className='l-panel-btn-td';b.render(tr.appendChild(td));}}
if(this.tbar&&this.topToolbar){if(L5.isArray(this.topToolbar)){this.topToolbar=new L5.Toolbar(this.topToolbar);}
this.topToolbar.render(this.tbar);this.topToolbar.ownerCt=this;}
if(this.bbar&&this.bottomToolbar){if(L5.isArray(this.bottomToolbar)){this.bottomToolbar=new L5.Toolbar(this.bottomToolbar);}
if(!this.isGrid){this.bottomToolbar.render(this.bbar);this.bottomToolbar.ownerCt=this;}}
if(this.enableFloat){this.toolBarY=this.tbar.getY();L5.fly(window).on('scroll',this.enableFloatForButton.createDelegate(this,[this.tbar]));}},setIconClass:function(cls){var old=this.iconCls;this.iconCls=cls;if(this.rendered&&this.header){if(this.frame){this.header.addClass('l-panel-icon');this.header.replaceClass(old,this.iconCls);}else{var hd=this.header.dom;var img=hd.firstChild&&String(hd.firstChild.tagName).toLowerCase()=='img'?hd.firstChild:null;if(img){L5.fly(img).replaceClass(old,this.iconCls);}else{L5.DomHelper.insertBefore(hd.firstChild,{tag:'img',src:L5.BLANK_IMAGE_URL,cls:'l-panel-inline-icon '+this.iconCls});}}}
this.fireEvent('iconchange',this,cls,old);},makeFloating:function(cfg){this.floating=true;this.el=new L5.Layer(typeof cfg=='object'?cfg:{shadow:this.shadow!==undefined?this.shadow:'sides',shadowOffset:this.shadowOffset,constrain:false,shim:this.shim===false?false:undefined},this.el);},getTopToolbar:function(){return this.topToolbar;},getBottomToolbar:function(){return this.bottomToolbar;},addButton:function(config,handler,scope){var bc={handler:handler,scope:scope,minWidth:this.minButtonWidth,hideParent:true};if(typeof config=="string"){bc.text=config;}else{L5.apply(bc,config);}
var btn=new L5.Button(bc);btn.ownerCt=this;if(!this.buttons){this.buttons=[];}
this.buttons.push(btn);return btn;},addTool:function(){if(!this[this.toolTarget]){return;}
if(!this.toolTemplate){var tt=new L5.Template('<div class="l-tool '+this.toggleIconCls+'-{id}">&#160;</div>');tt.disableFormats=true;tt.compile();L5.Panel.prototype.toolTemplate=tt;}
for(var i=0,a=arguments,len=a.length;i<len;i++){var tc=a[i];if(!this.tools[tc.id]){var overCls=this.toggleIconCls+'-'+tc.id+'-over';var t=this.toolTemplate.insertFirst((tc.align!=='left')?this[this.toolTarget]:this[this.toolTarget].child('span'),tc,true);this.tools[tc.id]=t;t.enableDisplayMode('block');t.on('click',this.createToolHandler(t,tc,overCls,this));if(tc.on){t.on(tc.on);}
if(tc.hidden){t.hide();}
if(tc.qtip){if(typeof tc.qtip=='object'){L5.QuickTips.register(L5.apply({target:t.id},tc.qtip));}else{t.dom.qtip=tc.qtip;}}
t.addClassOnOver(overCls);}}},onShow:function(){if(this.floating){return this.el.show();}
L5.Panel.superclass.onShow.call(this);},onHide:function(){if(this.floating){return this.el.hide();}
L5.Panel.superclass.onHide.call(this);},createToolHandler:function(t,tc,overCls,panel){return function(e){t.removeClass(overCls);e.stopEvent();if(tc.handler){tc.handler.call(tc.scope||t,e,t,panel);}};},afterRender:function(){if(this.fromMarkup&&this.height===undefined&&!this.autoHeight){this.height=this.el.getHeight();}
if(this.floating&&!this.hidden&&!this.initHidden){this.el.show();}
if(this.title){this.setTitle(this.title);}
this.setAutoScroll();if(this.html){this.body.update(typeof this.html=='object'?L5.DomHelper.markup(this.html):this.html);this.fireEvent('beforebinding',this.body.dom,this);var dom=this.body.dom;if(L5.DomQuery.selectNode("*[@dataset]",dom)!=null){L5.bindingdata(dom);}
delete this.html;}
if(this.contentEl){var ce=L5.getDom(this.contentEl);L5.fly(ce).removeClass(['l-hidden','l-hide-display']);this.body.dom.appendChild(ce);}
if(this.collapsed){this.collapsed=false;this.collapse(false);}
L5.Panel.superclass.afterRender.call(this);this.initEvents();},setAutoScroll:function(){if(this.rendered&&this.autoScroll){var el=this.body||this.el;if(el){el.setOverflow('auto');}}},getKeyMap:function(){if(!this.keyMap){this.keyMap=new L5.KeyMap(this.el,this.keys);}
return this.keyMap;},initEvents:function(){if(this.keys){this.getKeyMap();}
if(this.draggable){this.initDraggable();}},initDraggable:function(){this.dd=new L5.Panel.DD(this,typeof this.draggable=='boolean'?null:this.draggable);},beforeEffect:function(){if(this.floating){this.el.beforeAction();}
this.el.addClass('l-panel-animated');},afterEffect:function(){this.syncShadow();this.el.removeClass('l-panel-animated');},createEffect:function(a,cb,scope){var o={scope:scope,block:true};if(a===true){o.callback=cb;return o;}else if(!a.callback){o.callback=cb;}else{o.callback=function(){cb.call(scope);L5.callback(a.callback,a.scope);};}
return L5.applyIf(o,a);},collapse:function(animate){if(this.collapsed||this.el.hasFxBlock()||this.fireEvent('beforecollapse',this,animate)===false){return;}
var doAnim=animate===true||(animate!==false&&this.animCollapse);this.beforeEffect();this.onCollapse(doAnim,animate);return this;},onCollapse:function(doAnim,animArg){if(doAnim){this[this.collapseEl].slideOut(this.slideAnchor,L5.apply(this.createEffect(animArg||true,this.afterCollapse,this),this.collapseDefaults));}else{this[this.collapseEl].hide();this.afterCollapse();}},afterCollapse:function(){this.collapsed=true;this.el.addClass(this.collapsedCls);this.afterEffect();this.fireEvent('collapse',this);},expand:function(animate){if(!this.collapsed||this.el.hasFxBlock()||this.fireEvent('beforeexpand',this,animate)===false){return;}
var doAnim=animate===true||(animate!==false&&this.animCollapse);this.el.removeClass(this.collapsedCls);this.beforeEffect();this.onExpand(doAnim,animate);return this;},onExpand:function(doAnim,animArg){if(doAnim){this[this.collapseEl].slideIn(this.slideAnchor,L5.apply(this.createEffect(animArg||true,this.afterExpand,this),this.expandDefaults));}else{this[this.collapseEl].show();this.afterExpand();}},afterExpand:function(){this.collapsed=false;this.afterEffect();this.fireEvent('expand',this);},toggleCollapse:function(animate){this[this.collapsed?'expand':'collapse'](animate);return this;},onDisable:function(){if(this.rendered&&this.maskDisabled){this.el.mask();}
L5.Panel.superclass.onDisable.call(this);},onEnable:function(){if(this.rendered&&this.maskDisabled){this.el.unmask();}
L5.Panel.superclass.onEnable.call(this);},onResize:function(w,h){if(w!==undefined||h!==undefined){if(!this.collapsed){if(typeof w=='number'){this.body.setWidth(this.adjustBodyWidth(w-this.getFrameWidth()));}else if(w=='auto'){this.body.setWidth(w);}
if(typeof h=='number'){this.body.setHeight(this.adjustBodyHeight(h-this.getFrameHeight()));}else if(h=='auto'){this.body.setHeight(h);}
if(this.disabled&&this.el._mask){this.el._mask.setSize(this.el.dom.clientWidth,this.el.getHeight());}}else{this.queuedBodySize={width:w,height:h};if(!this.queuedExpand&&this.allowQueuedExpand!==false){this.queuedExpand=true;this.on('expand',function(){delete this.queuedExpand;this.onResize(this.queuedBodySize.width,this.queuedBodySize.height);this.doLayout();},this,{single:true});}}
this.fireEvent('bodyresize',this,w,h);}
this.syncShadow();},adjustBodyHeight:function(h){return h;},adjustBodyWidth:function(w){return w;},onPosition:function(){this.syncShadow();},getFrameWidth:function(){var w=this.el.getFrameWidth('lr');if(this.frame){var l=this.bwrap.dom.firstChild;w+=(L5.fly(l).getFrameWidth('l')+L5.fly(l.firstChild).getFrameWidth('r'));var mc=this.bwrap.dom.firstChild.firstChild.firstChild;w+=L5.fly(mc).getFrameWidth('lr');}
return w;},getFrameHeight:function(){var h=this.el.getFrameWidth('tb');h+=(this.tbar?this.tbar.getHeight():0)+
(this.bbar?this.bbar.getHeight():0);if(this.frame){var hd=this.el.dom.firstChild;var ft=this.bwrap.dom.lastChild;h+=(hd.offsetHeight+ft.offsetHeight);var mc=this.bwrap.dom.firstChild.firstChild.firstChild;h+=L5.fly(mc).getFrameWidth('tb');}else{h+=(this.header?this.header.getHeight():0)+
(this.footer?this.footer.getHeight():0);}
return h;},getInnerWidth:function(){return this.getSize().width-this.getFrameWidth();},getInnerHeight:function(){return this.getSize().height-this.getFrameHeight();},syncShadow:function(){if(this.floating){this.el.sync(true);}},getLayoutTarget:function(){return this.body;},setTitle:function(title,iconCls){this.title=title;if(this.header&&this.headerAsText){this.header.child('span').update(title);}
if(iconCls){this.setIconClass(iconCls);}
this.fireEvent('titlechange',this,title);return this;},getUpdater:function(){return this.body.getUpdater();},load:function(){var um=this.body.getUpdater();um.update.apply(um,arguments);return this;},beforeDestroy:function(){if(this.header){this.header.removeAllListeners();if(this.headerAsText){L5.Element.uncache(this.header.child('span'));}}
if(this.body)
L5.releaseIframe(this.body.dom);L5.Element.uncache(this.header,this.tbar,this.bbar,this.footer,this.body,this.bwrap);if(this.tools){for(var k in this.tools){L5.destroy(this.tools[k]);}}
if(this.buttons){for(var b in this.buttons){L5.destroy(this.buttons[b]);}}
L5.destroy(this.topToolbar,this.bottomToolbar);L5.Panel.superclass.beforeDestroy.call(this);},createClasses:function(){this.headerCls=this.baseCls+'-header';this.headerTextCls=this.baseCls+'-header-text';this.bwrapCls=this.baseCls+'-bwrap';this.tbarCls=this.baseCls+'-tbar';this.bodyCls=this.baseCls+'-body';this.bbarCls=this.baseCls+'-bbar';this.footerCls=this.baseCls+'-footer';},createGhost:function(cls,useShim,appendTo){var el=document.createElement('div');el.className='l-panel-ghost '+(cls?cls:'');if(this.header){el.appendChild(this.el.dom.firstChild.cloneNode(true));}
L5.fly(el.appendChild(document.createElement('ul'))).setHeight(this.bwrap.getHeight());el.style.width=this.el.dom.offsetWidth+'px';;if(!appendTo){this.container.dom.appendChild(el);}else{L5.getDom(appendTo).appendChild(el);}
if(useShim!==false&&this.el.useShim!==false){var layer=new L5.Layer({shadow:false,useDisplay:true,constrain:false},el);layer.show();return layer;}else{return new L5.Element(el);}},doAutoLoad:function(){this.body.load(typeof this.autoLoad=='object'?this.autoLoad:{url:this.autoLoad});},getTool:function(id){return this.tools[id];},enableFloatForButton:function(divObj){if(divObj!=null){var divObjHeight=divObj.getHeight();var hiddenWhenY=this.toolBarY+this.height-divObjHeight;var scrollY=document.body.scrollTop||window.pageYOffset||document.documentElement.scrollTop||0;var ghostDiv=divObj.dom;if(this.toolBarY>=scrollY||scrollY>=hiddenWhenY){ghostDiv.style.position="static";ghostDiv.style.top=this.toolBarY;}else{ghostDiv.style.zIndex=1000000;ghostDiv.style.display="block";if(ghostDiv.style.position!="fixed"){ghostDiv.style.position="fixed";ghostDiv.style.top=0;}
ghostDiv.style.width=ghostDiv.parentNode.parentNode.style.width;if(L5.isGecko)
this.changeDomForFF(ghostDiv);}}},changeDomForFF:function(ghostDiv){ghostDiv.style.width="100%";var childNodes=ghostDiv.childNodes;var nodeLength=childNodes.length;for(var i=0;i<nodeLength;i++){var classNam=childNodes[i].className;if(classNam=="ytb-spacer"){var parentNode=childNodes[i].parentNode;parentNode.removeChild(childNodes[i]);break;}
this.changeDomForFF(childNodes[i]);}}});L5.reg('panel',L5.Panel);

L5.Window=L5.extend(L5.Panel,{baseCls:'l-window',resizable:true,draggable:true,closable:true,constrain:false,constrainHeader:false,plain:false,minimizable:false,maximizable:false,minHeight:100,minWidth:200,expandOnShow:true,closeAction:'close',elements:'header,body',collapsible:false,initHidden:true,monitorResize:true,frame:true,floating:true,initComponent:function(){L5.Window.superclass.initComponent.call(this);this.addEvents('resize','maximize','minimize','restore');},getState:function(){return L5.apply(L5.Window.superclass.getState.call(this)||{},this.getBox());},onRender:function(ct,position){L5.Window.superclass.onRender.call(this,ct,position);if(this.plain){this.el.addClass('l-window-plain');}
this.focusEl=this.el.createChild({tag:"a",href:"#",cls:"l-dlg-focus",tabIndex:"-1",html:"&#160;"});this.focusEl.swallowEvent('click',true);this.proxy=this.el.createProxy("l-window-proxy");this.proxy.enableDisplayMode('block');if(this.modal){this.mask=this.container.createChild({cls:"L5-el-mask"},this.el.dom);this.mask.enableDisplayMode("block");this.mask.hide();this.mask.on('click',this.focus,this);}},initEvents:function(){L5.Window.superclass.initEvents.call(this);if(this.animateTarget){this.setAnimateTarget(this.animateTarget);}
if(this.resizable){this.resizer=new L5.Resizable(this.el,{minWidth:this.minWidth,minHeight:this.minHeight,handles:this.resizeHandles||"all",pinned:true,resizeElement:this.resizerAction});this.resizer.window=this;this.resizer.on("beforeresize",this.beforeResize,this);}
if(this.draggable){this.header.addClass("l-window-draggable");}
this.initTools();this.el.on("mousedown",this.toFront,this);this.manager=this.manager||L5.WindowMgr;this.manager.register(this);this.hidden=true;if(this.maximized){this.maximized=false;this.maximize();}
if(this.collapsed){this.collapsed=false;this.minimize();}
if(this.closable){var km=this.getKeyMap();km.on(27,this.onEsc,this);km.disable();}},initDraggable:function(){this.dd=new L5.Window.DD(this);},onEsc:function(){this[this.closeAction]();},beforeDestroy:function(){this.hide();if(this.doAnchor){L5.EventManager.removeResizeListener(this.doAnchor,this);L5.EventManager.un(window,'scroll',this.doAnchor,this);}
L5.destroy(this.focusEl,this.resizer,this.dd,this.proxy,this.mask);L5.Window.superclass.beforeDestroy.call(this);},onDestroy:function(){if(this.manager){this.manager.unregister(this);}
L5.Window.superclass.onDestroy.call(this);},initTools:function(){if(this.minimizable){this.addTool({id:'minimize',handler:this.minimize.createDelegate(this,[])});}
if(this.maximizable){this.addTool({id:'maximize',handler:this.maximize.createDelegate(this,[])});this.addTool({id:'restore',handler:this.restore.createDelegate(this,[]),hidden:true});this.header.on('dblclick',this.toggleMaximize,this);}
if(this.closable){this.addTool({id:'close',handler:this[this.closeAction].createDelegate(this,[])});}},resizerAction:function(){var box=this.proxy.getBox();this.proxy.hide();this.window.handleResize(box);return box;},beforeResize:function(){this.resizer.minHeight=Math.max(this.minHeight,this.getFrameHeight()+40);this.resizer.minWidth=Math.max(this.minWidth,this.getFrameWidth()+40);this.resizeBox=this.el.getBox();},updateHandles:function(){if(L5.isIE&&this.resizer){this.resizer.syncHandleHeight();this.el.repaint();}},handleResize:function(box){var rz=this.resizeBox;if(rz.x!=box.x||rz.y!=box.y){this.updateBox(box);}else{this.setSize(box);}
this.focus();this.updateHandles();this.saveState();if(this.layout){this.doLayout();}
this.fireEvent("resize",this,box.width,box.height);},focus:function(){var f=this.focusEl,db=this.defaultButton,t=typeof db;if(t!='undefined'){if(t=='number'){f=this.buttons[db];}else if(t=='string'){f=L5.getCmp(db);}else{f=db;}}
f.focus.defer(10,f);},setAnimateTarget:function(el){el=L5.get(el);this.animateTarget=el;},beforeShow:function(){delete this.el.lastXY;delete this.el.lastLT;if(this.x===undefined||this.y===undefined){var xy=this.el.getCenterXY();var pos=this.el.translatePoints(xy[0],xy[1]);this.x=this.x===undefined?pos.left:this.x;this.y=this.y===undefined?pos.top:this.y;}
this.el.setLeftTop(this.x,this.y);if(this.expandOnShow){this.expand(false);}
if(this.modal){L5.getBody().addClass("l-body-masked");this.mask.setSize(L5.lib.Dom.getViewWidth(true),L5.lib.Dom.getViewHeight(true));this.mask.show();}},show:function(animateTarget,cb,scope){if(!this.rendered){this.render(L5.getBody());}
if(this.hidden===false){this.toFront();return;}
if(this.fireEvent("beforeshow",this)===false){return;}
if(cb){this.on('show',cb,scope,{single:true});}
this.hidden=false;if(animateTarget!==undefined){this.setAnimateTarget(animateTarget);}
this.beforeShow();if(this.animateTarget){this.animShow();}else{this.afterShow();}},afterShow:function(){this.proxy.hide();this.el.setStyle('display','block');this.el.show();if(this.maximized){this.fitContainer();}
if(L5.isMac&&L5.isGecko){this.cascade(this.setAutoScroll);}
if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){L5.EventManager.onWindowResize(this.onWindowResize,this);}
this.doConstrain();if(this.layout){this.doLayout();}
if(this.keyMap){this.keyMap.enable();}
this.toFront();this.updateHandles();this.fireEvent("show",this);},animShow:function(){this.proxy.show();this.proxy.setBox(this.animateTarget.getBox());this.proxy.setOpacity(0);var b=this.getBox(false);b.callback=this.afterShow;b.scope=this;b.duration=.25;b.easing='easeNone';b.opacity=.5;b.block=true;this.el.setStyle('display','none');this.proxy.shift(b);},hide:function(animateTarget,cb,scope){if(this.activeGhost){this.hide.defer(100,this,[animateTarget,cb,scope]);return;}
if(this.hidden||this.fireEvent("beforehide",this)===false){return;}
if(cb){this.on('hide',cb,scope,{single:true});}
this.hidden=true;if(animateTarget!==undefined){this.setAnimateTarget(animateTarget);}
if(this.animateTarget){this.animHide();}else{this.el.hide();this.afterHide();}},afterHide:function(){this.proxy.hide();if(this.monitorResize||this.modal||this.constrain||this.constrainHeader){L5.EventManager.removeResizeListener(this.onWindowResize,this);}
if(this.modal){this.mask.hide();L5.getBody().removeClass("l-body-masked");}
if(this.keyMap){this.keyMap.disable();}
this.fireEvent("hide",this);},animHide:function(){this.proxy.setOpacity(.5);this.proxy.show();var tb=this.getBox(false);this.proxy.setBox(tb);this.el.hide();var b=this.animateTarget.getBox();b.callback=this.afterHide;b.scope=this;b.duration=.25;b.easing='easeNone';b.block=true;b.opacity=0;this.proxy.shift(b);},onWindowResize:function(){if(this.maximized){this.fitContainer();}
if(this.modal){this.mask.setSize('100%','100%');var force=this.mask.dom.offsetHeight;this.mask.setSize(L5.lib.Dom.getViewWidth(true),L5.lib.Dom.getViewHeight(true));}
this.doConstrain();},doConstrain:function(){if(this.constrain||this.constrainHeader){var offsets;if(this.constrain){offsets={right:this.el.shadowOffset,left:this.el.shadowOffset,bottom:this.el.shadowOffset};}else{var s=this.getSize();offsets={right:-(s.width-100),bottom:-(s.height-25)};}
var xy=this.el.getConstrainToXY(this.container,true,offsets);if(xy){this.setPosition(xy[0],xy[1]);}}},ghost:function(cls){var ghost=this.createGhost(cls);var box=this.getBox(true);ghost.setLeftTop(box.x,box.y);ghost.setWidth(box.width);this.el.hide();this.activeGhost=ghost;return ghost;},unghost:function(show,matchPosition){if(show!==false){this.el.show();this.focus();if(L5.isMac&&L5.isGecko){this.cascade(this.setAutoScroll);}}
if(matchPosition!==false){this.setPosition(this.activeGhost.getLeft(true),this.activeGhost.getTop(true));}
this.activeGhost.hide();this.activeGhost.remove();delete this.activeGhost;},minimize:function(){if(!this.collapsed){if(this.maximized){this.el.removeClass('l-window-maximized');this.container.removeClass('l-window-maximized-ct');this.maximized=false;}else{this.restoreSize=this.getSize();this.restorePos=this.getPosition(true);}
this.setSize(this.restoreSize.width,this.restoreSize.height);this.collapse(false);if(this.minimizable){this.tools.minimize.hide();this.tools.maximize.show();this.tools.restore.show();}
this.collapsed=true;this.el.disableShadow();if(this.dd){this.dd.unlock();}
if(this.collapsible){this.tools.toggle.hide();}
this.setPosition(0,0);this.fireEvent('minimize',this);}},close:function(){if(this.fireEvent("beforeclose",this)!==false){this.hide(null,function(){this.fireEvent('close',this);this.destroy();},this);}},maximize:function(){if(!this.maximized){if(!this.collapsed){this.restorePos=this.getPosition(true);}
this.expand(false);this.restoreSize=this.getSize();if(this.maximizable){this.tools.maximize.hide();this.tools.minimize.show();this.tools.restore.show();}
this.maximized=true;this.el.disableShadow();if(this.dd){this.dd.lock();}
if(this.collapsible){this.tools.toggle.hide();}
this.el.addClass('l-window-maximized');this.container.addClass('l-window-maximized-ct');this.setPosition(0,0);this.fitContainer();this.fireEvent('maximize',this);}},restore:function(){if(this.maximized){this.el.removeClass('l-window-maximized');this.tools.restore.hide();this.tools.maximize.show();this.tools.minimize.show();this.setPosition(this.restorePos[0],this.restorePos[1]);this.setSize(this.restoreSize.width,this.restoreSize.height);delete this.restorePos;delete this.restoreSize;this.maximized=false;this.el.enableShadow(true);if(this.dd){this.dd.unlock();}
if(this.collapsible){this.tools.toggle.show();}
this.container.removeClass('l-window-maximized-ct');this.doConstrain();this.fireEvent('restore',this);}else if(this.collapsed){this.tools.restore.hide();this.tools.minimize.show();this.tools.maximize.show();this.setPosition(this.restorePos[0],this.restorePos[1]);this.setSize(this.restoreSize.width,this.restoreSize.height);delete this.restorePos;delete this.restoreSize;this.collapsed=false;this.el.enableShadow(true);if(this.dd){this.dd.unlock();}
if(this.collapsible){this.tools.toggle.show();}
this[this.collapseEl].show();this.doConstrain();this.fireEvent('restore',this);}},toggleMaximize:function(){this[this.maximized?'restore':'maximize']();},fitContainer:function(){var vs=this.container.getViewSize();this.setSize(vs.width,vs.height);},setZIndex:function(index){if(this.modal){this.mask.setStyle("z-index",index);}
this.el.setZIndex(++index);index+=5;if(this.resizer){this.resizer.proxy.setStyle("z-index",++index);}
this.lastZIndex=index;},alignTo:function(element,position,offsets){var xy=this.el.getAlignToXY(element,position,offsets);this.setPagePosition(xy[0],xy[1]);return this;},anchorTo:function(el,alignment,offsets,monitorScroll){if(this.doAnchor){L5.EventManager.removeResizeListener(this.doAnchor,this);L5.EventManager.un(window,'scroll',this.doAnchor,this);}
this.doAnchor=function(){this.alignTo(el,alignment,offsets);};L5.EventManager.onWindowResize(this.doAnchor,this);var tm=typeof monitorScroll;if(tm!='undefined'){L5.EventManager.on(window,'scroll',this.doAnchor,this,{buffer:tm=='number'?monitorScroll:50});}
this.doAnchor();return this;},toFront:function(e){if(this.manager.bringToFront(this)){if(!e||!e.getTarget().focus){this.focus();}}
return this;},setActive:function(active){if(active){if(!this.maximized){this.el.enableShadow(true);}
this.fireEvent('activate',this);}else{this.el.disableShadow();this.fireEvent('deactivate',this);}},toBack:function(){this.manager.sendToBack(this);return this;},center:function(){var xy=this.el.getAlignToXY(this.container,'c-c');this.setPagePosition(xy[0],xy[1]);return this;}});L5.reg('window',L5.Window);L5.Window.DD=function(win){this.win=win;L5.Window.DD.superclass.constructor.call(this,win.el.id,'WindowDD-'+win.id);this.setHandleElId(win.header.id);this.scroll=false;};L5.extend(L5.Window.DD,L5.dd.DD,{moveOnly:true,headerOffsets:[100,25],startDrag:function(){var w=this.win;this.proxy=w.ghost();if(w.constrain!==false){var so=w.el.shadowOffset;this.constrainTo(w.container,{right:so,left:so,bottom:so});}else if(w.constrainHeader!==false){var s=this.proxy.getSize();this.constrainTo(w.container,{right:-(s.width-this.headerOffsets[0]),bottom:-(s.height-this.headerOffsets[1])});}},b4Drag:L5.emptyFn,onDrag:function(e){this.alignElWithMouse(this.proxy,e.getPageX(),e.getPageY());},endDrag:function(e){this.win.unghost();this.win.saveState();}});

L5.WindowGroup=function(){var list={};var accessList=[];var front=null;var sortWindows=function(d1,d2){return(!d1._lastAccess||d1._lastAccess<d2._lastAccess)?-1:1;};var orderWindows=function(){var a=accessList,len=a.length;if(len>0){a.sort(sortWindows);var seed=a[0].manager.zseed;for(var i=0;i<len;i++){var win=a[i];if(win&&!win.hidden){win.setZIndex(seed+(i*10));}}}
activateLast();};var setActiveWin=function(win){if(win!=front){if(front){front.setActive(false);}
front=win;if(win){win.setActive(true);}}};var activateLast=function(){for(var i=accessList.length-1;i>=0;--i){if(!accessList[i].hidden){setActiveWin(accessList[i]);return;}}
setActiveWin(null);};return{zseed:9000,register:function(win){list[win.id]=win;accessList.push(win);win.on('hide',activateLast);},unregister:function(win){delete list[win.id];win.un('hide',activateLast);accessList.remove(win);},get:function(id){return typeof id=="object"?id:list[id];},bringToFront:function(win){win=this.get(win);if(win!=front){win._lastAccess=new Date().getTime();orderWindows();return true;}
return false;},sendToBack:function(win){win=this.get(win);win._lastAccess=-(new Date().getTime());orderWindows();return win;},hideAll:function(){for(var id in list){if(list[id]&&typeof list[id]!="function"&&list[id].isVisible()){list[id].hide();}}},getActive:function(){return front;},getBy:function(fn,scope){var r=[];for(var i=accessList.length-1;i>=0;--i){var win=accessList[i];if(fn.call(scope||win,win)!==false){r.push(win);}}
return r;},each:function(fn,scope){for(var id in list){if(list[id]&&typeof list[id]!="function"){if(fn.call(scope||list[id],list[id])===false){return;}}}}};};L5.WindowMgr=new L5.WindowGroup();

L5.dd.PanelProxy=function(panel,config){this.panel=panel;this.id=this.panel.id+'-ddproxy';L5.apply(this,config);};L5.dd.PanelProxy.prototype={insertProxy:true,setStatus:L5.emptyFn,reset:L5.emptyFn,update:L5.emptyFn,stop:L5.emptyFn,sync:L5.emptyFn,getEl:function(){return this.ghost;},getGhost:function(){return this.ghost;},getProxy:function(){return this.proxy;},hide:function(){if(this.ghost){if(this.proxy){this.proxy.remove();delete this.proxy;}
this.panel.el.dom.style.display='';this.ghost.remove();delete this.ghost;}},show:function(){if(!this.ghost){this.ghost=this.panel.createGhost(undefined,undefined,L5.getBody());this.ghost.setXY(this.panel.el.getXY())
if(this.insertProxy){this.proxy=this.panel.el.insertSibling({cls:'l-panel-dd-spacer'});this.proxy.setSize(this.panel.getSize());}
this.panel.el.dom.style.display='none';}},repair:function(xy,callback,scope){this.hide();if(typeof callback=="function"){callback.call(scope||this);}},moveProxy:function(parentNode,before){if(this.proxy){parentNode.insertBefore(this.proxy.dom,before);}}};L5.Panel.DD=function(panel,cfg){this.panel=panel;this.dragData={panel:panel};this.proxy=new L5.dd.PanelProxy(panel,cfg);L5.Panel.DD.superclass.constructor.call(this,panel.el,cfg);var h=panel.header;if(h){this.setHandleElId(h.id);}
(h?h:this.panel.body).setStyle('cursor','move');this.scroll=false;};L5.extend(L5.Panel.DD,L5.dd.DragSource,{showFrame:L5.emptyFn,startDrag:L5.emptyFn,b4StartDrag:function(x,y){this.proxy.show();},b4MouseDown:function(e){var x=e.getPageX();var y=e.getPageY();this.autoOffset(x,y);},onInitDrag:function(x,y){this.onStartDrag(x,y);return true;},createFrame:L5.emptyFn,getDragEl:function(e){return this.proxy.ghost.dom;},endDrag:function(e){this.proxy.hide();this.panel.saveState();},autoOffset:function(x,y){x-=this.startPageX;y-=this.startPageY;this.setDelta(x,y);}});

L5.DataView=L5.extend(L5.BoxComponent,{selectedClass:"l-view-selected",emptyText:"",deferEmptyText:true,trackOver:false,last:false,initComponent:function(){L5.DataView.superclass.initComponent.call(this);if(typeof this.tpl=="string"){this.tpl=new L5.XTemplate(this.tpl);}
this.addEvents("beforeclick","click","mouseenter","mouseleave","containerclick","dblclick","contextmenu","selectionchange","beforeselect");this.all=new L5.CompositeElementLite();this.selected=new L5.CompositeElementLite();},onRender:function(){if(!this.el){this.el=document.createElement('div');this.el.id=this.id;}
L5.DataView.superclass.onRender.apply(this,arguments);},afterRender:function(){L5.DataView.superclass.afterRender.call(this);this.el.on({"click":this.onClick,"dblclick":this.onDblClick,"contextmenu":this.onContextMenu,scope:this});if(this.overClass||this.trackOver){this.el.on({"mouseover":this.onMouseOver,"mouseout":this.onMouseOut,scope:this});}
if(this.dataset){this.setDataset(this.dataset,true);}},refresh:function(){this.clearSelections(false,true);this.el.update("");var records=this.dataset.getRange();if(records.length<1){if(!this.deferEmptyText||this.hasSkippedEmptyText){this.el.update(this.emptyText);}
this.hasSkippedEmptyText=true;this.all.clear();return;}
this.tpl.overwrite(this.el,this.collectData(records,0));this.all.fill(L5.query(this.itemSelector,this.el.dom));this.updateIndexes(0);},prepareData:function(data){var htmlValue=/\<|\>/;if(L5.preventScriptInjection==true&&htmlValue.test(data.text)){data.text=L5.util.Format.htmlEncode(data.text);}
return data;},collectData:function(records,startIndex){var r=[];for(var i=0,len=records.length;i<len;i++){r[r.length]=this.prepareData(records[i].data,startIndex+i,records[i]);}
return r;},bufferRender:function(records){var div=document.createElement('div');this.tpl.overwrite(div,this.collectData(records));return L5.query(this.itemSelector,div);},onUpdate:function(ds,record){var index=this.dataset.indexOf(record);var sel=this.isSelected(index);var original=this.all.elements[index];var node=this.bufferRender([record],index)[0];this.all.replaceElement(index,node,true);if(sel){this.selected.replaceElement(original,node);this.all.item(index).addClass(this.selectedClass);}
this.updateIndexes(index,index);},onAdd:function(ds,records,index){if(this.all.getCount()==0){this.refresh();return;}
var nodes=this.bufferRender(records,index),n,a=this.all.elements;if(index<this.all.getCount()){n=this.all.item(index).insertSibling(nodes,'before',true);a.splice.apply(a,[index,0].concat(nodes));}else{n=this.all.last().insertSibling(nodes,'after',true);a.push.apply(a,nodes);}
this.updateIndexes(index);},onRemove:function(ds,record,index){this.deselect(index);this.all.removeElement(index,true);this.updateIndexes(index);},refreshNode:function(index){this.onUpdate(this.dataset,this.dataset.getAt(index));},updateIndexes:function(startIndex,endIndex){var ns=this.all.elements;startIndex=startIndex||0;endIndex=endIndex||((endIndex===0)?0:(ns.length-1));for(var i=startIndex;i<=endIndex;i++){ns[i].viewIndex=i;}},getDataset:function(){return this.dataset;},setDataset:function(ds,initial){if(!initial&&this.dataset){this.dataset.un("beforeload",this.onBeforeLoad,this);this.dataset.un("datachanged",this.refresh,this);this.dataset.un("add",this.onAdd,this);this.dataset.un("remove",this.onRemove,this);this.dataset.un("update",this.onUpdate,this);this.dataset.un("clear",this.refresh,this);}
if(ds){_ds=L5.DatasetMgr.lookup(ds);_ds.on("beforeload",this.onBeforeLoad,this);_ds.on("datachanged",this.refresh,this);_ds.on("add",this.onAdd,this);_ds.on("remove",this.onRemove,this);_ds.on("update",this.onUpdate,this);_ds.on("clear",this.refresh,this);}
this.dataset=_ds;if(ds){this.refresh();}},findItemFromChild:function(node){return L5.fly(node).findParent(this.itemSelector,this.el);},onClick:function(e){var item=e.getTarget(this.itemSelector,this.el);if(item){var index=this.indexOf(item);if(this.onItemClick(item,index,e)!==false){this.fireEvent("click",this,index,item,e);}}else{if(this.fireEvent("containerclick",this,e)!==false){this.clearSelections();}}},onContextMenu:function(e){var item=e.getTarget(this.itemSelector,this.el);if(item){this.fireEvent("contextmenu",this,this.indexOf(item),item,e);}},onDblClick:function(e){var item=e.getTarget(this.itemSelector,this.el);if(item){this.fireEvent("dblclick",this,this.indexOf(item),item,e);}},onMouseOver:function(e){var item=e.getTarget(this.itemSelector,this.el);if(item&&item!==this.lastItem){this.lastItem=item;L5.fly(item).addClass(this.overClass);this.fireEvent("mouseenter",this,this.indexOf(item),item,e);}},onMouseOut:function(e){if(this.lastItem){if(!e.within(this.lastItem,true,true)){L5.fly(this.lastItem).removeClass(this.overClass);this.fireEvent("mouseleave",this,this.indexOf(this.lastItem),this.lastItem,e);delete this.lastItem;}}},onItemClick:function(item,index,e){if(this.fireEvent("beforeclick",this,index,item,e)===false){return false;}
if(this.multiSelect){this.doMultiSelection(item,index,e);e.preventDefault();}else if(this.singleSelect){this.doSingleSelection(item,index,e);e.preventDefault();}
return true;},doSingleSelection:function(item,index,e){if(e.ctrlKey&&this.isSelected(index)){this.deselect(index);}else{this.select(index,false);}},doMultiSelection:function(item,index,e){if(e.shiftKey&&this.last!==false){var last=this.last;this.selectRange(last,index,e.ctrlKey);this.last=last;}else{if((e.ctrlKey||this.simpleSelect)&&this.isSelected(index)){this.deselect(index);}else{this.select(index,e.ctrlKey||e.shiftKey||this.simpleSelect);}}},getSelectionCount:function(){return this.selected.getCount()},getSelectedNodes:function(){return this.selected.elements;},getSelectedIndexes:function(){var indexes=[],s=this.selected.elements;for(var i=0,len=s.length;i<len;i++){indexes.push(s[i].viewIndex);}
return indexes;},getSelectedRecords:function(){var r=[],s=this.selected.elements;for(var i=0,len=s.length;i<len;i++){r[r.length]=this.dataset.getAt(s[i].viewIndex);}
return r;},getRecords:function(nodes){var r=[],s=nodes;for(var i=0,len=s.length;i<len;i++){r[r.length]=this.dataset.getAt(s[i].viewIndex);}
return r;},getRecord:function(node){return this.dataset.getAt(node.viewIndex);},clearSelections:function(suppressEvent,skipUpdate){if((this.multiSelect||this.singleSelect)&&this.selected.getCount()>0){if(!skipUpdate){this.selected.removeClass(this.selectedClass);}
this.selected.clear();this.last=false;if(!suppressEvent){this.fireEvent("selectionchange",this,this.selected.elements);}}},isSelected:function(node){return this.selected.contains(this.getNode(node));},deselect:function(node){if(this.isSelected(node)){node=this.getNode(node);this.selected.removeElement(node);if(this.last==node.viewIndex){this.last=false;}
L5.fly(node).removeClass(this.selectedClass);this.fireEvent("selectionchange",this,this.selected.elements);}},select:function(nodeInfo,keepExisting,suppressEvent){if(L5.isArray(nodeInfo)){if(!keepExisting){this.clearSelections(true);}
for(var i=0,len=nodeInfo.length;i<len;i++){this.select(nodeInfo[i],true,true);}
if(!suppressEvent){this.fireEvent("selectionchange",this,this.selected.elements);}}else{var node=this.getNode(nodeInfo);if(!keepExisting){this.clearSelections(true);}
if(node&&!this.isSelected(node)){if(this.fireEvent("beforeselect",this,node,this.selected.elements)!==false){L5.fly(node).addClass(this.selectedClass);this.selected.add(node);this.last=node.viewIndex;if(!suppressEvent){this.fireEvent("selectionchange",this,this.selected.elements);}}}}},selectRange:function(start,end,keepExisting){if(!keepExisting){this.clearSelections(true);}
this.select(this.getNodes(start,end),true);},getNode:function(nodeInfo){if(typeof nodeInfo=="string"){return document.getElementById(nodeInfo);}else if(typeof nodeInfo=="number"){return this.all.elements[nodeInfo];}
return nodeInfo;},getNodes:function(start,end){var ns=this.all.elements;start=start||0;end=typeof end=="undefined"?Math.max(ns.length-1,0):end;var nodes=[],i;if(start<=end){for(i=start;i<=end&&ns[i];i++){nodes.push(ns[i]);}}else{for(i=start;i>=end&&ns[i];i--){nodes.push(ns[i]);}}
return nodes;},indexOf:function(node){node=this.getNode(node);if(typeof node.viewIndex=="number"){return node.viewIndex;}
return this.all.indexOf(node);},onBeforeLoad:function(){if(this.loadingText){this.clearSelections(false,true);this.el.update('<div class="loading-indicator">'+this.loadingText+'</div>');this.all.clear();}},onDestroy:function(){L5.DataView.superclass.onDestroy.call(this);this.setDataset(null);}});L5.reg('dataview',L5.DataView);

L5.ColorPalette=function(config){L5.ColorPalette.superclass.constructor.call(this,config);this.addEvents('select');if(this.handler){this.on("select",this.handler,this.scope,true);}};L5.extend(L5.ColorPalette,L5.Component,{itemCls:"l-color-palette",value:null,clickEvent:'click',ctype:"L5.ColorPalette",allowReselect:false,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],onRender:function(container,position){var t=this.tpl||new L5.XTemplate('<tpl for="."><a href="#" class="color-{.}" hidefocus="on"><em><span style="background:#{.}" unselectable="on">&#160;</span></em></a></tpl>');var el=document.createElement("div");el.id=this.getId();el.className=this.itemCls;t.overwrite(el,this.colors);container.dom.insertBefore(el,position);this.el=L5.get(el);this.el.on(this.clickEvent,this.handleClick,this,{delegate:"a"});if(this.clickEvent!='click'){this.el.on('click',L5.emptyFn,this,{delegate:"a",preventDefault:true});}},afterRender:function(){L5.ColorPalette.superclass.afterRender.call(this);if(this.value){var s=this.value;this.value=null;this.select(s);}},handleClick:function(e,t){e.preventDefault();if(!this.disabled){var c=t.className.match(/(?:^|\s)color-(.{6})(?:\s|$)/)[1];this.select(c.toUpperCase());}},select:function(color){color=color.replace("#","");if(color!=this.value||this.allowReselect){var el=this.el;if(this.value){el.child("a.color-"+this.value).removeClass("l-color-palette-sel");}
el.child("a.color-"+color).addClass("l-color-palette-sel");this.value=color;this.fireEvent("select",this,color);}}});L5.reg('colorpalette',L5.ColorPalette);

L5.DatePicker=L5.extend(L5.Component,{todayText:"Today",okText:"&#160;OK&#160;",cancelText:"Cancel",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",format:"m/d/y",disabledDaysText:"Disabled",disabledDatesText:"Disabled",constrainToViewport:true,monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:'Next Month (Control+Right)',prevText:'Previous Month (Control+Left)',monthYearText:'Choose a month (Control+Up/Down to move years)',startDay:0,showToday:true,initComponent:function(){L5.DatePicker.superclass.initComponent.call(this);this.value=this.value?this.value.clearTime():new Date().clearTime();this.addEvents('select','cleanDate');if(this.handler){this.on("select",this.handler,this.scope||this);this.on("cleanDate",this.handler,this.scope||this);}
this.initDisabledDays();},initDisabledDays:function(){if(!this.disabledDatesRE&&this.disabledDates){var dd=this.disabledDates;var re="(?:";for(var i=0;i<dd.length;i++){re+=dd[i];if(i!=dd.length-1)re+="|";}
this.disabledDatesRE=new RegExp(re+")");}},setDisabledDates:function(dd){if(L5.isArray(dd)){this.disabledDates=dd;this.disabledDatesRE=null;}else{this.disabledDatesRE=dd;}
this.initDisabledDays();this.update(this.value,true);},setDisabledDays:function(dd){this.disabledDays=dd;this.update(this.value,true);},setMinDate:function(dt){this.minDate=dt;this.update(this.value,true);},setMaxDate:function(dt){this.maxDate=dt;this.update(this.value,true);},setValue:function(value){var old=this.value;if(value!=""){this.value=value.clone().clearTime();}else{this.value=value;}
if(this.el){this.update(this.value);}},getValue:function(){return this.value;},focus:function(){if(this.el){this.update(this.activeDate);}},onRender:function(container,position){var m=['<table cellspacing="0">','<tr><td class="l-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="l-date-middle" align="center"></td><td class="l-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr>','<tr><td colspan="3"><table class="l-date-inner" cellspacing="0"><thead><tr>'];var dn=this.dayNames;for(var i=0;i<7;i++){var d=this.startDay+i;if(d>6){d=d-7;}
m.push("<th><span>",dn[d].substr(0,1),"</span></th>");}
m[m.length]="</tr></thead><tbody><tr>";for(var i=0;i<42;i++){if(i%7==0&&i!=0){m[m.length]="</tr><tr>";}
m[m.length]='<td><a href="#" hidefocus="on" class="l-date-date" tabIndex="1"><em><span></span></em></a></td>';}
m.push('</tr></tbody></table></td></tr>',this.showToday?'<tr><td colspan="2" class="l-date-bottom" align="center"></td><td  class="l-date-clear-bottom" align="center"></td></tr>':'','</table><div class="l-date-mp"></div>');var el=document.createElement("div");el.className="l-date-picker";el.innerHTML=m.join("");container.dom.insertBefore(el,position);this.el=L5.get(el);this.eventEl=L5.get(el.firstChild);this.leftClickRpt=new L5.util.ClickRepeater(this.el.child("td.l-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:true,stopDefault:true});this.rightClickRpt=new L5.util.ClickRepeater(this.el.child("td.l-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:true,stopDefault:true});this.eventEl.on("mousewheel",this.handleMouseWheel,this);this.monthPicker=this.el.down('div.l-date-mp');this.monthPicker.enableDisplayMode('block');var kn=new L5.KeyNav(this.eventEl,{"left":function(e){e.ctrlKey?this.showPrevMonth():this.update(this.activeDate.add("d",-1));},"right":function(e){e.ctrlKey?this.showNextMonth():this.update(this.activeDate.add("d",1));},"up":function(e){e.ctrlKey?this.showNextYear():this.update(this.activeDate.add("d",-7));},"down":function(e){e.ctrlKey?this.showPrevYear():this.update(this.activeDate.add("d",7));},"pageUp":function(e){this.showNextMonth();},"pageDown":function(e){this.showPrevMonth();},"enter":function(e){e.stopPropagation();return true;},scope:this});this.eventEl.on("click",this.handleDateClick,this,{delegate:"a.l-date-date"});this.el.unselectable();this.cells=this.el.select("table.l-date-inner tbody td");this.textNodes=this.el.query("table.l-date-inner tbody span");this.mbtn=new L5.Button({text:"&#160;",tooltip:this.monthYearText,renderTo:this.el.child("td.l-date-middle",true)});this.mbtn.on('click',this.showMonthPicker,this);this.mbtn.el.child(this.mbtn.menuClassTarget).addClass("l-btn-with-menu");if(this.showToday){this.todayKeyListener=this.eventEl.addKeyListener(L5.EventObject.SPACE,this.selectToday,this);var today=(new Date()).dateFormat(this.format);this.todayBtn=new L5.Button({renderTo:this.el.child("td.l-date-bottom",true),text:String.format(this.todayText,today),tooltip:String.format(this.todayTip,today),handler:this.selectToday,scope:this});}
this.clearBtn=new L5.Button({renderTo:this.el.child("td.l-date-clear-bottom",true),text:'清空',tooltip:'清空',handler:this.clearDate,scope:this});if(L5.isIE){this.el.repaint();}
this.update(this.value);},createMonthPicker:function(){if(!this.monthPicker.dom.firstChild){var buf=['<table border="0" cellspacing="0">'];for(var i=0;i<6;i++){buf.push('<tr><td class="l-date-mp-month"><a href="#">',this.monthNames[i].substr(0,3),'</a></td>','<td class="l-date-mp-month l-date-mp-sep"><a href="#">',this.monthNames[i+6].substr(0,3),'</a></td>',i==0?'<td class="l-date-mp-ybtn" align="center"><a class="l-date-mp-prev"></a></td><td class="l-date-mp-ybtn" align="center"><a class="l-date-mp-next"></a></td></tr>':'<td class="l-date-mp-year"><a href="#"></a></td><td class="l-date-mp-year"><a href="#"></a></td></tr>');}
buf.push('<tr class="l-date-mp-btns"><td colspan="4"><button type="button" class="l-date-mp-ok">',this.okText,'</button><button type="button" class="l-date-mp-cancel">',this.cancelText,'</button></td></tr>','</table>');this.monthPicker.update(buf.join(''));this.monthPicker.on('click',this.onMonthClick,this);this.monthPicker.on('dblclick',this.onMonthDblClick,this);this.mpMonths=this.monthPicker.select('td.l-date-mp-month');this.mpYears=this.monthPicker.select('td.l-date-mp-year');this.mpMonths.each(function(m,a,i){i+=1;if((i%2)==0){m.dom.xmonth=5+Math.round(i*.5);}else{m.dom.xmonth=Math.round((i-1)*.5);}});}},showMonthPicker:function(){this.createMonthPicker();var size=this.el.getSize();this.monthPicker.setSize(size);this.monthPicker.child('table').setSize(size);this.mpSelMonth=(this.activeDate||this.value).getMonth();this.updateMPMonth(this.mpSelMonth);this.mpSelYear=(this.activeDate||this.value).getFullYear();this.updateMPYear(this.mpSelYear);this.monthPicker.slideIn('t',{duration:.2});},updateMPYear:function(y){this.mpyear=y;var ys=this.mpYears.elements;for(var i=1;i<=10;i++){var td=ys[i-1],y2;if((i%2)==0){y2=y+Math.round(i*.5);td.firstChild.innerHTML=y2;td.xyear=y2;}else{y2=y-(5-Math.round(i*.5));td.firstChild.innerHTML=y2;td.xyear=y2;}
this.mpYears.item(i-1)[y2==this.mpSelYear?'addClass':'removeClass']('l-date-mp-sel');}},updateMPMonth:function(sm){this.mpMonths.each(function(m,a,i){m[m.dom.xmonth==sm?'addClass':'removeClass']('l-date-mp-sel');});},selectMPMonth:function(m){},onMonthClick:function(e,t){e.stopEvent();var el=new L5.Element(t),pn;if(el.is('button.l-date-mp-cancel')){this.hideMonthPicker();}
else if(el.is('button.l-date-mp-ok')){var d=new Date(this.mpSelYear,this.mpSelMonth,(this.activeDate||this.value).getDate());if(d.getMonth()!=this.mpSelMonth){d=new Date(this.mpSelYear,this.mpSelMonth,1).getLastDateOfMonth();}
this.update(d);this.hideMonthPicker();}
else if(pn=el.up('td.l-date-mp-month',2)){this.mpMonths.removeClass('l-date-mp-sel');pn.addClass('l-date-mp-sel');this.mpSelMonth=pn.dom.xmonth;}
else if(pn=el.up('td.l-date-mp-year',2)){this.mpYears.removeClass('l-date-mp-sel');pn.addClass('l-date-mp-sel');this.mpSelYear=pn.dom.xyear;}
else if(el.is('a.l-date-mp-prev')){this.updateMPYear(this.mpyear-10);}
else if(el.is('a.l-date-mp-next')){this.updateMPYear(this.mpyear+10);}},onMonthDblClick:function(e,t){e.stopEvent();var el=new L5.Element(t),pn;if(pn=el.up('td.l-date-mp-month',2)){this.update(new Date(this.mpSelYear,pn.dom.xmonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker();}
else if(pn=el.up('td.l-date-mp-year',2)){this.update(new Date(pn.dom.xyear,this.mpSelMonth,(this.activeDate||this.value).getDate()));this.hideMonthPicker();}},hideMonthPicker:function(disableAnim){if(this.monthPicker){if(disableAnim===true){this.monthPicker.hide();}else{this.monthPicker.slideOut('t',{duration:.2});}}},showPrevMonth:function(e){this.update(this.activeDate.add("mo",-1));},showNextMonth:function(e){this.update(this.activeDate.add("mo",1));},showPrevYear:function(){this.update(this.activeDate.add("y",-1));},showNextYear:function(){this.update(this.activeDate.add("y",1));},handleMouseWheel:function(e){var delta=e.getWheelDelta();if(delta>0){this.showPrevMonth();e.stopEvent();}else if(delta<0){this.showNextMonth();e.stopEvent();}},handleDateClick:function(e,t){e.stopEvent();if(t.dateValue&&!L5.fly(t.parentNode).hasClass("l-date-disabled")){this.setValue(new Date(t.dateValue));this.fireEvent("select",this,this.value);}},selectToday:function(){if(this.todayBtn&&!this.todayBtn.disabled){this.setValue(new Date().clearTime());this.fireEvent("select",this,this.value);}},clearDate:function(){this.setValue(new Date().clearTime());this.fireEvent("select",this,null);},update:function(date,forceRefresh){var vd=this.activeDate;this.activeDate=date;if(!forceRefresh&&vd&&this.el){var t=date.getTime();if(vd.getMonth()==date.getMonth()&&vd.getFullYear()==date.getFullYear()){this.cells.removeClass("l-date-selected");this.cells.each(function(c){if(c.dom.firstChild.dateValue==t){c.addClass("l-date-selected");setTimeout(function(){try{c.dom.firstChild.focus();}catch(e){}},50);return false;}});return;}}
var days=date.getDaysInMonth();var firstOfMonth=date.getFirstDateOfMonth();var startingPos=firstOfMonth.getDay()-this.startDay;if(startingPos<=this.startDay){startingPos+=7;}
var pm=date.add("mo",-1);var prevStart=pm.getDaysInMonth()-startingPos;var cells=this.cells.elements;var textEls=this.textNodes;days+=startingPos;var day=86400000;var d=(new Date(pm.getFullYear(),pm.getMonth(),prevStart)).clearTime();var today=new Date().clearTime().getTime();var sel=date.clearTime().getTime();var min=this.minDate?this.minDate.clearTime():Number.NEGATIVE_INFINITY;var max=this.maxDate?this.maxDate.clearTime():Number.POSITIVE_INFINITY;var ddMatch=this.disabledDatesRE;var ddText=this.disabledDatesText;var ddays=this.disabledDays?this.disabledDays.join(""):false;var ddaysText=this.disabledDaysText;var format=this.format;if(this.showToday){var td=new Date().clearTime();var disable=(td<min||td>max||(ddMatch&&format&&ddMatch.test(td.dateFormat(format)))||(ddays&&ddays.indexOf(td.getDay())!=-1));this.todayBtn.setDisabled(disable);this.todayKeyListener[disable?'disable':'enable']();}
var setCellClass=function(cal,cell){cell.title="";var t=d.getTime();cell.firstChild.dateValue=t;if(t==today){cell.className+=" l-date-today";cell.title=cal.todayText;}
if(t==sel){cell.className+=" l-date-selected";setTimeout(function(){try{cell.firstChild.focus();}catch(e){}},50);}
if(t<min){cell.className=" l-date-disabled";cell.title=cal.minText;return;}
if(t>max){cell.className=" l-date-disabled";cell.title=cal.maxText;return;}
if(ddays){if(ddays.indexOf(d.getDay())!=-1){cell.title=ddaysText;cell.className=" l-date-disabled";}}
if(ddMatch&&format){var fvalue=d.dateFormat(format);if(ddMatch.test(fvalue)){cell.title=ddText.replace("%0",fvalue);cell.className=" l-date-disabled";}}};var i=0;for(;i<startingPos;i++){textEls[i].innerHTML=(++prevStart);d.setDate(d.getDate()+1);cells[i].className="l-date-prevday";setCellClass(this,cells[i]);}
for(;i<days;i++){var intDay=i-startingPos+1;textEls[i].innerHTML=(intDay);d.setDate(d.getDate()+1);cells[i].className="l-date-active";setCellClass(this,cells[i]);}
var extraDays=0;for(;i<42;i++){textEls[i].innerHTML=(++extraDays);d.setDate(d.getDate()+1);cells[i].className="l-date-nextday";setCellClass(this,cells[i]);}
this.mbtn.setText(this.monthNames[date.getMonth()]+" "+date.getFullYear());if(!this.internalRender){var main=this.el.dom.firstChild;var w=main.offsetWidth;this.el.setWidth(w+this.el.getBorderWidth("lr"));L5.fly(main).setWidth(w);this.internalRender=true;if(L5.isOpera&&!this.secondPass){main.rows[0].cells[1].style.width=(w-(main.rows[0].cells[0].offsetWidth+main.rows[0].cells[2].offsetWidth))+"px";this.secondPass=true;this.update.defer(10,this,[date]);}}},beforeDestroy:function(){if(this.rendered){L5.destroy(this.leftClickRpt,this.rightClickRpt,this.monthPicker,this.eventEl,this.mbtn,this.todayBtn,this.clearBtn);}}});L5.reg('datepicker',L5.DatePicker);

L5.DatetimePicker=function(config){L5.DatetimePicker.superclass.constructor.call(this,config);};L5.extend(L5.DatetimePicker,L5.DatePicker,{defaultDatetime:null,selectToday:function(){this.setValue(new Date().clearTime());var val1=this.value;val1.setHours(this.theHours);val1.setMinutes(this.theMinutes);val1.setSeconds(new Date().getSeconds());this.fireEvent("select",this,val1);},selectConfirm:function(){var val1=this.value;val1.setHours(this.theHours);val1.setMinutes(this.theMinutes);val1.setSeconds(new Date().getSeconds());this.fireEvent("select",this,val1);},handleDateClick:function(e,t){e.stopEvent();if(t.dateValue&&!L5.fly(t.parentNode).hasClass("l-date-disabled")){this.setValue(new Date(t.dateValue));var val1=this.value;val1.setHours(this.theHours);val1.setMinutes(this.theMinutes);val1.setSeconds(new Date().getSeconds());if(this.lastSelect){L5.fly(this.lastSelect).removeClass("l-date-selected2");this.lastSelect=t.parentNode;L5.fly(this.lastSelect).addClass("l-date-selected2");}else{this.lastSelect=t.parentNode;L5.fly(this.lastSelect).addClass("l-date-selected2");}}},onRender:function(container,position){var m=['<table cellspacing="0">','<tr><td colspan="3"><table cellspacing="0" width="100%"><tr><td class="l-date-left"><a href="#" title="',this.prevText,'">&#160;</a></td><td class="l-date-middle" align="center"></td><td class="l-date-right"><a href="#" title="',this.nextText,'">&#160;</a></td></tr></table></td></tr>','<tr><td colspan="3"><table class="l-datetime-inner" width="100%" cellspacing="0"><thead><tr>'];var dn=this.dayNames;for(var i=0;i<7;i++){var d=this.startDay+i;if(d>6){d=d-7;}
m.push("<th><span>",dn[d].substr(0,1),"</span></th>");}
m[m.length]="</tr></thead><tbody><tr>";for(i=0;i<42;i++){if(i%7===0&&i!==0){m[m.length]="</tr><tr>";}
m[m.length]='<td><a href="#" hidefocus="on" class="l-date-date" tabIndex="1"><em><span></span></em></a></td>';}
m[m.length]='</tr></tbody></table></td></tr><tr><td class="minutecss"><table cellspacing="0" width="100%"><tr>';m[m.length]='<td class="l-hour-left"><a href="#" title="down"> </a></td><td class="l-hour-middle"><div class="l-datetimediv-middle"></div></td><td class="l-hour-right"><a href="#" title="up"> </a></td>';m[m.length]='<td class="l-minute-left"><a href="#" title="down"> </a></td><td class="l-minute-middle"><div class="l-datetimediv-middle"></div></td><td class="l-minute-right"><a href="#" title="up"> </a></td>';m[m.length]='</tr></table></td><td  colspan="1" class="l-date-bottom" align="center"><td  colspan="1" class="l-date-bottom" align="center"></td></tr></table><div class="l-date-mp"></div>';var el=document.createElement("div");el.className="l-date-picker";el.innerHTML=m.join("");container.dom.insertBefore(el,position);this.el=L5.get(el);this.eventEl=L5.get(el.firstChild);new L5.util.ClickRepeater(this.el.child("td.l-date-left a"),{handler:this.showPrevMonth,scope:this,preventDefault:true,stopDefault:true});new L5.util.ClickRepeater(this.el.child("td.l-date-right a"),{handler:this.showNextMonth,scope:this,preventDefault:true,stopDefault:true});new L5.util.ClickRepeater(this.el.child("td.l-hour-left a"),{handler:function(){if(this.theHours>0){this.theHours--;this.theHours=this.theHours%24;var txt='';if(this.theHours<10){txt='0'+this.theHours;}
else{txt=this.theHours;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["hour"]:"h";this.hourLabel.update(txt+uname);}}.createDelegate(this),scope:this});new L5.util.ClickRepeater(this.el.child("td.l-hour-right a"),{handler:function(){this.theHours++;this.theHours=this.theHours%24;var txt='';if(this.theHours<10){txt='0'+this.theHours;}else{txt=this.theHours;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["hour"]:"h";this.hourLabel.update(txt+uname);}.createDelegate(this),scope:this});new L5.util.ClickRepeater(this.el.child("td.l-minute-left a"),{handler:function(){if(this.theMinutes>0){this.theMinutes--;this.theMinutes=this.theMinutes%60;var txt='';if(this.theMinutes<10){txt='0'+this.theMinutes;}else{txt=this.theMinutes;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["minute"]:"m";this.minuteLabel.update(txt+uname);}}.createDelegate(this),scope:this});new L5.util.ClickRepeater(this.el.child("td.l-minute-right a"),{handler:function(){this.theMinutes++;this.theMinutes=this.theMinutes%60;var txt='';if(this.theMinutes<10){txt='0'+this.theMinutes;}else{txt=this.theMinutes;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["minute"]:"m";this.minuteLabel.update(txt+uname);}.createDelegate(this),scope:this});this.eventEl.on("mousewheel",this.handleMouseWheel,this);this.monthPicker=this.el.down('div.l-date-mp');this.monthPicker.enableDisplayMode('block');var kn=new L5.KeyNav(this.eventEl,{"left":function(e){e.ctrlKey?this.showPrevMonth():this.update(this.activeDate.add("d",-1));},"right":function(e){e.ctrlKey?this.showNextMonth():this.update(this.activeDate.add("d",1));},"up":function(e){e.ctrlKey?this.showNextYear():this.update(this.activeDate.add("d",-7));},"down":function(e){e.ctrlKey?this.showPrevYear():this.update(this.activeDate.add("d",7));},"pageUp":function(e){this.showNextMonth();},"pageDown":function(e){this.showPrevMonth();},"enter":function(e){e.stopPropagation();return true;},scope:this});this.eventEl.on("click",this.handleDateClick,this,{delegate:"a.l-date-date"});this.eventEl.addKeyListener(L5.EventObject.SPACE,this.selectToday,this);this.eventEl.addKeyListener(L5.EventObject.ENTER,this.selectConfirm,this);this.el.unselectable();this.cells=this.el.select("table.l-datetime-inner tbody td");this.textNodes=this.el.query("table.l-datetime-inner tbody span");this.mbtn=new L5.Button({text:"&#160;",tooltip:this.monthYearText,renderTo:this.el.child("td.l-date-middle",true)});this.mbtn.on('click',this.showMonthPicker,this);this.mbtn.el.child(this.mbtn.menuClassTarget).addClass("l-btn-with-menu");var dt1=new Date();if(this.defaultDatetime){dt1=this.defaultDatetime;}
var txt='';this.hourLabel=this.el.child("td.l-hour-middle").first();this.hourLabel.on("mouseover",this.showHoursSelection,this);this.theHours=dt1.getHours();if(this.theHours<10){txt='0'+this.theHours;}
else{txt=this.theHours;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["hour"]:"h";this.hourLabel.update(txt+uname);this.minuteLabel=this.el.child("td.l-minute-middle").first();this.minuteLabel.on("mouseover",this.showMinutesSelection,this);this.theMinutes=dt1.getMinutes();if(this.theMinutes<10){txt='0'+this.theMinutes;}
else{txt=this.theMinutes;}
uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["minute"]:"m";this.minuteLabel.update(txt+uname);var today=(new Date()).dateFormat(this.format);var todayBtn=new L5.Button({renderTo:L5.getDom(this.el.query("td.l-date-bottom")[1]),text:String.format(this.todayText,today),tooltip:String.format(this.todayTip,today),handler:this.selectToday,scope:this});var confirmBtn=new L5.Button({renderTo:L5.getDom(this.el.query("td.l-date-bottom")[0]),text:L5.yesText?L5.yesText:"Yes",tooltip:L5.enterToSelectText?L5.enterToSelectText:"Enter to Select",handler:this.selectConfirm,scope:this});if(L5.isIE){this.el.repaint();}
this.update(this.value);},hideHourOrminuteMenu:function(){if(this.hasHoursMenu&&this.hourMenu)
this.hourMenu.fireEvent("hide",this.hourMenu);if(this.hasMinutesMenu&&this.minutesMenu)
this.minutesMenu.fireEvent("hide",this.minutesMenu);},showHoursSelection:function(event,obj){if(this.hasMinutesMenu&&this.minutesMenu)
this.minutesMenu.fireEvent("hide",this.minutesMenu);if(this.hasHoursMenu)
return;var m=['<table class="l-datetime-inner" width="100%" cellspacing="0"><tbody><tr>'];for(i=0;i<24;i++){if(i%6===0&&i!==0){m[m.length]='</tr><tr>';}
m[m.length]='<td><a href="#" hidefocus="on" class="l-date-date" tabIndex="1"><em><span>'+i+'</span></em></a></td>';}
m[m.length]='</tr></tbody></table>';var menu=new L5.menu.Menu({cls:'l-date-menu'});this.hourMenu=menu;this.hasHoursMenu=true;var menuItem=new L5.menu.Item({itemCls:'l-menu-date-item',text:m.join("")});menu.add(menuItem);menu.render();var xy=event.xy;xy=menu.el.adjustForConstraints(xy);menu.el.setXY(xy);menu.el.show();menu.hidden=false;menu.focus();menu.on("show",this.showHoursMenuInit,this);menu.fireEvent("show",menu);menu.on("hide",this.destroyHoursMenu,this);L5.get(menuItem.el).on("click",this.showHours,this,{delegate:"a.l-date-date"});},showHoursMenuInit:function(menu){var cells=menu.el.query("table.l-datetime-inner tbody td");var hours=this.theHours;L5.get(cells).each(function(c){if((c.dom.firstChild.innerText||c.dom.firstChild.textContent)==hours){c.addClass("l-date-selected");c.addClass("l-date-today");setTimeout(function(){try{c.dom.firstChild.focus();}catch(e){}},50);return false;}});},destroyHoursMenu:function(menu){menu.destroy();this.hourMenu=undefined;this.hasHoursMenu=false;},showHours:function(e,t){this.hasHoursMenu=false;this.theHours=t.innerText||t.textContent;var txt="";if(this.theHours<10){txt='0'+this.theHours;}
else{txt=this.theHours;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["hour"]:"h";this.hourLabel.update(txt+uname);},showMinutesSelection:function(event,obj){if(this.hasHoursMenu&&this.hourMenu)
this.hourMenu.fireEvent("hide",this.hourMenu);if(this.hasMinutesMenu)
return;var m=['<table class="l-datetime-inner" width="100%" cellspacing="0"><tbody><tr>'];for(i=0;i<60;i++){if(i%10===0&&i!==0){m[m.length]='</tr><tr>';}
m[m.length]='<td><a href="#" hidefocus="on" class="l-date-date" tabIndex="1"><em><span>'+i+'</span></em></a></td>';}
m[m.length]='</tr></tbody></table>';var menu=new L5.menu.Menu({cls:'l-date-menu'});this.hasMinutesMenu=true;this.minutesMenu=menu;var menuItem=new L5.menu.Item({itemCls:'l-menu-date-item',text:m.join("")});menu.add(menuItem);menu.render();var xy=event.xy;xy=menu.el.adjustForConstraints(xy);menu.el.setXY(xy);menu.el.show();menu.hidden=false;menu.focus();menu.on("show",this.showMinutesMenuInit,this);menu.fireEvent("show",menu);menu.on("hide",this.destroyMinutesMenu,this);L5.get(menuItem.el).on("click",this.showMinutes,this,{delegate:"a.l-date-date"});},showMinutesMenuInit:function(menu){var cells=menu.el.query("table.l-datetime-inner tbody td");var minutes=this.theMinutes;L5.get(cells).each(function(c){if((c.dom.firstChild.innerText||c.dom.firstChild.textContent)==minutes){c.addClass("l-date-selected");c.addClass("l-date-today");setTimeout(function(){try{c.dom.firstChild.focus();}catch(e){}},50);return false;}});},destroyMinutesMenu:function(menu){menu.destroy();this.minutesMenu=undefined;this.hasMinutesMenu=false;},showMinutes:function(e,t){this.hasMinutesMenu=false;this.theMinutes=t.innerText||t.textContent;var txt="";if(this.theMinutes<10){txt='0'+this.theMinutes;}
else{txt=this.theMinutes;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["minute"]:"m";this.minuteLabel.update(txt+uname);},update:function(date){this.hideHourOrminuteMenu();var vd=this.activeDate;this.activeDate=date;if(vd&&this.el){var t=date.getTime();if(vd.getMonth()==date.getMonth()&&vd.getFullYear()==date.getFullYear()){this.cells.removeClass("l-date-selected");this.cells.each(function(c){if(c.dom.firstChild.dateValue==t){c.addClass("l-date-selected");setTimeout(function(){try{c.dom.firstChild.focus();}catch(e){}},50);return false;}});return;}}
var days=date.getDaysInMonth();var firstOfMonth=date.getFirstDateOfMonth();var startingPos=firstOfMonth.getDay()-this.startDay;if(startingPos<=this.startDay){startingPos+=7;}
var pm=date.add("mo",-1);var prevStart=pm.getDaysInMonth()-startingPos;var cells=this.cells.elements;var textEls=this.textNodes;days+=startingPos;var day=86400000;var d=(new Date(pm.getFullYear(),pm.getMonth(),prevStart)).clearTime();var today=new Date().clearTime().getTime();var sel=date.clearTime().getTime();var min=this.minDate?this.minDate.clearTime():Number.NEGATIVE_INFINITY;var max=this.maxDate?this.maxDate.clearTime():Number.POSITIVE_INFINITY;var ddMatch=this.disabledDatesRE;var ddText=this.disabledDatesText;var ddays=this.disabledDays?this.disabledDays.join(""):false;var ddaysText=this.disabledDaysText;var format=this.format;var setCellClass=function(cal,cell){cell.title="";var t=d.getTime();cell.firstChild.dateValue=t;if(t==today){cell.className+=" l-date-today";cell.title=cal.todayText;}
if(t==sel){cell.className+=" l-date-selected";setTimeout(function(){try{cell.firstChild.focus();}catch(e){}},50);}
if(t<min){cell.className=" l-date-disabled";cell.title=cal.minText;return;}
if(t>max){cell.className=" l-date-disabled";cell.title=cal.maxText;return;}
if(ddays){if(ddays.indexOf(d.getDay())!=-1){cell.title=ddaysText;cell.className=" l-date-disabled";}}
if(ddMatch&&format){var fvalue=d.dateFormat(format);if(ddMatch.test(fvalue)){cell.title=ddText.replace("%0",fvalue);cell.className=" l-date-disabled";}}};var i=0;for(;i<startingPos;i++){textEls[i].innerHTML=(++prevStart);d.setDate(d.getDate()+1);cells[i].className="l-date-prevday";setCellClass(this,cells[i]);}
for(;i<days;i++){intDay=i-startingPos+1;textEls[i].innerHTML=(intDay);d.setDate(d.getDate()+1);cells[i].className="l-date-active";setCellClass(this,cells[i]);}
var extraDays=0;for(;i<42;i++){textEls[i].innerHTML=(++extraDays);d.setDate(d.getDate()+1);cells[i].className="l-date-nextday";setCellClass(this,cells[i]);}
this.mbtn.setText(this.monthNames[date.getMonth()]+" "+date.getFullYear());if(this.theHours<10){txt='0'+this.theHours;}
else{txt=this.theHours;}
var uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["hour"]:"h";this.hourLabel.update(txt+uname);if(this.theMinutes<10){txt='0'+this.theMinutes;}
else{txt=this.theMinutes;}
uname=L5.Time_TimeUnitNames?L5.Time_TimeUnitNames["minute"]:"m";this.minuteLabel.update(txt+uname);if(!this.internalRender){var main=this.el.dom.firstChild;var w=main.offsetWidth;this.el.setWidth(w+this.el.getBorderWidth("lr"));L5.fly(main).setWidth(w);this.internalRender=true;if(L5.isOpera&&!this.secondPass){main.rows[0].cells[1].style.width=(w-(main.rows[0].cells[0].offsetWidth+main.rows[0].cells[2].offsetWidth))+"px";this.secondPass=true;this.update.defer(10,this,[date]);}}},nextYearText:'Next Year (Control+Up)',prevYearText:'Previous Year (Control+Down)'});

L5.TabPanel=L5.extend(L5.Panel,{monitorResize:true,deferredRender:true,tabWidth:120,minTabWidth:30,resizeTabs:false,enableTabScroll:false,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:.35,animScroll:true,tabPosition:'top',baseCls:'l-tab-panel',autoTabs:false,autoTabSelector:'div.l-tab',activeTab:0,tabMargin:2,plain:false,wheelIncrement:20,idDelimiter:'__',itemCls:'l-tab-item',elements:'body',headerAsText:false,frame:false,hideBorders:true,initComponent:function(){this.frame=false;L5.TabPanel.superclass.initComponent.call(this);this.addEvents('beforetabchange','tabchange','contextmenu');this.setLayout(new L5.layout.CardLayout({deferredRender:this.deferredRender}));if(this.tabPosition=='top'){this.elements+=',header';this.stripTarget='header';}else{this.elements+=',footer';this.stripTarget='footer';}
if(!this.stack){this.stack=L5.TabPanel.AccessStack();}
this.initItems();},render:function(){L5.TabPanel.superclass.render.apply(this,arguments);if(this.activeTab!==undefined){var item=this.activeTab;delete this.activeTab;this.setActiveTab(item);}},onRender:function(ct,position){L5.TabPanel.superclass.onRender.call(this,ct,position);if(this.plain){var pos=this.tabPosition=='top'?'header':'footer';this[pos].addClass('l-tab-panel-'+pos+'-plain');}
var st=this[this.stripTarget];this.stripWrap=st.createChild({cls:'l-tab-strip-wrap',cn:{tag:'ul',cls:'l-tab-strip l-tab-strip-'+this.tabPosition}});var beforeEl=(this.tabPosition=='bottom'?this.stripWrap:null);this.stripSpacer=st.createChild({cls:'l-tab-strip-spacer'},beforeEl);this.strip=new L5.Element(this.stripWrap.dom.firstChild);this.edge=this.strip.createChild({tag:'li',cls:'l-tab-edge'});this.strip.createChild({cls:'l-clear'});this.body.addClass('l-tab-panel-body-'+this.tabPosition);if(!this.itemTpl){var tt=new L5.Template('<li class="{cls}" id="{id}"><a class="l-tab-strip-close" onclick="return false;"></a>','<a class="l-tab-right" href="#" onclick="return false;"><em class="l-tab-left">','<span class="l-tab-strip-inner"><span class="l-tab-strip-text {iconCls}">{text}</span></span>','</em></a></li>');tt.disableFormats=true;tt.compile();L5.TabPanel.prototype.itemTpl=tt;}
this.items.each(this.initTab,this);},afterRender:function(){L5.TabPanel.superclass.afterRender.call(this);if(this.autoTabs){this.readTabs(false);}},initEvents:function(){L5.TabPanel.superclass.initEvents.call(this);this.on('add',this.onAdd,this);this.on('remove',this.onRemove,this);this.strip.on('mousedown',this.onStripMouseDown,this);this.strip.on('contextmenu',this.onStripContextMenu,this);if(this.enableTabScroll){this.strip.on('mousewheel',this.onWheel,this);}},findTargets:function(e){var item=null;var itemEl=e.getTarget('li',this.strip);if(itemEl){item=this.getComponent(itemEl.id.split(this.idDelimiter)[1]);if(item.disabled){return{close:null,item:null,el:null};}}
return{close:e.getTarget('.l-tab-strip-close',this.strip),item:item,el:itemEl};},onStripMouseDown:function(e){if(e.button!=0){return;}
e.preventDefault();var t=this.findTargets(e);if(t.close){if(t.item.fireEvent('beforeclose',t.item)!==false){t.item.fireEvent('close',t.item);this.remove(t.item);}
return;}
if(t.item&&t.item!=this.activeTab){this.setActiveTab(t.item);}},onStripContextMenu:function(e){e.preventDefault();var t=this.findTargets(e);if(t.item){this.fireEvent('contextmenu',this,t.item,e);}},readTabs:function(removeExisting){if(removeExisting===true){this.items.each(function(item){this.remove(item);},this);}
var tabs=this.el.query(this.autoTabSelector);for(var i=0,len=tabs.length;i<len;i++){var tab=tabs[i];var title=tab.getAttribute('title');tab.removeAttribute('title');this.add({title:title,el:tab});}},initTab:function(item,index){var before=this.strip.dom.childNodes[index];var cls=item.closable?'l-tab-strip-closable':'';if(item.disabled){cls+=' l-item-disabled';}
if(item.iconCls){cls+=' l-tab-with-icon';}
if(item.tabCls){cls+=' '+item.tabCls;}
var p={id:this.id+this.idDelimiter+item.getItemId(),text:item.title,cls:cls,iconCls:item.iconCls||''};var el=before?this.itemTpl.insertBefore(before,p):this.itemTpl.append(this.strip,p);L5.fly(el).addClassOnOver('l-tab-strip-over');if(item.tabTip){L5.fly(el).child('span.l-tab-strip-text',true).qtip=item.tabTip;}
item.tabEl=el;item.on('disable',this.onItemDisabled,this);item.on('enable',this.onItemEnabled,this);item.on('titlechange',this.onItemTitleChanged,this);item.on('iconchange',this.onItemIconChanged,this);item.on('beforeshow',this.onBeforeShowItem,this);},onAdd:function(tp,item,index){this.initTab(item,index);if(this.items.getCount()==1){this.syncSize();}
this.delegateUpdates();},onBeforeAdd:function(item){var existing=item.events?(this.items.containsKey(item.getItemId())?item:null):this.items.get(item);if(existing){this.setActiveTab(item);return false;}
L5.TabPanel.superclass.onBeforeAdd.apply(this,arguments);var es=item.elements;item.elements=es?es.replace(',header',''):es;item.border=(item.border===true);},onRemove:function(tp,item){L5.destroy(L5.get(this.getTabEl(item)));this.stack.remove(item);item.un('disable',this.onItemDisabled,this);item.un('enable',this.onItemEnabled,this);item.un('titlechange',this.onItemTitleChanged,this);item.un('iconchange',this.onItemIconChanged,this);item.un('beforeshow',this.onBeforeShowItem,this);if(item==this.activeTab){var next=this.stack.next();if(next){this.setActiveTab(next);}else if(this.items.getCount()>0){this.setActiveTab(0);}else{this.activeTab=null;}}
this.delegateUpdates();},onBeforeShowItem:function(item){if(item!=this.activeTab){this.setActiveTab(item);return false;}},onItemDisabled:function(item){var el=this.getTabEl(item);if(el){L5.fly(el).addClass('l-item-disabled');}
this.stack.remove(item);},onItemEnabled:function(item){var el=this.getTabEl(item);if(el){L5.fly(el).removeClass('l-item-disabled');}},onItemTitleChanged:function(item){var el=this.getTabEl(item);if(el){L5.fly(el).child('span.l-tab-strip-text',true).innerHTML=item.title;}},onItemIconChanged:function(item,iconCls,oldCls){var el=this.getTabEl(item);if(el){L5.fly(el).child('span.l-tab-strip-text').replaceClass(oldCls,iconCls);}},getTabEl:function(item){var itemId=(typeof item==='number')?this.items.items[item].getItemId():item.getItemId();return document.getElementById(this.id+this.idDelimiter+itemId);},onResize:function(){L5.TabPanel.superclass.onResize.apply(this,arguments);this.delegateUpdates();},beginUpdate:function(){this.suspendUpdates=true;},endUpdate:function(){this.suspendUpdates=false;this.delegateUpdates();},hideTabStripItem:function(item){item=this.getComponent(item);var el=this.getTabEl(item);if(el){el.style.display='none';this.delegateUpdates();}
this.stack.remove(item);},unhideTabStripItem:function(item){item=this.getComponent(item);var el=this.getTabEl(item);if(el){el.style.display='';this.delegateUpdates();}},delegateUpdates:function(){if(this.suspendUpdates){return;}
if(this.resizeTabs&&this.rendered){this.autoSizeTabs();}
if(this.enableTabScroll&&this.rendered){this.autoScrollTabs();}},autoSizeTabs:function(){var count=this.items.length;var ce=this.tabPosition!='bottom'?'header':'footer';var ow=this[ce].dom.offsetWidth;var aw=this[ce].dom.clientWidth;if(!this.resizeTabs||count<1||!aw){return;}
var each=Math.max(Math.min(Math.floor((aw-4)/count)-this.tabMargin,this.tabWidth),this.minTabWidth);this.lastTabWidth=each;var lis=this.stripWrap.dom.getElementsByTagName('li');for(var i=0,len=lis.length-1;i<len;i++){var li=lis[i];var inner=li.childNodes[1].firstChild.firstChild;var tw=li.offsetWidth;var iw=inner.offsetWidth;inner.style.width=(each-(tw-iw))+'px';}},adjustBodyWidth:function(w){if(this.header){this.header.setWidth(w);}
if(this.footer){this.footer.setWidth(w);}
return w;},setActiveTab:function(item){item=this.getComponent(item);var itemrender=item.rendered;if(!item||this.fireEvent('beforetabchange',this,item,this.activeTab)===false){return;}
if(!this.rendered){this.activeTab=item;return;}
if(this.activeTab!=item){if(this.activeTab){var oldEl=this.getTabEl(this.activeTab);if(oldEl){L5.fly(oldEl).removeClass('l-tab-strip-active');}
this.activeTab.fireEvent('deactivate',this.activeTab);}
var el=this.getTabEl(item);L5.fly(el).addClass('l-tab-strip-active');this.activeTab=item;this.stack.add(item);this.layout.setActiveItem(item);if((this.layoutOnTabChange||!itemrender)&&item.doLayout){item.doLayout();}
if(this.scrolling){this.scrollToTab(item,this.animScroll);}
item.fireEvent('activate',item);this.fireEvent('tabchange',this,item);}},getActiveTab:function(){return this.activeTab||null;},getItem:function(item){return this.getComponent(item);},autoScrollTabs:function(){this.pos=this.tabPosition=='bottom'?this.footer:this.header;var count=this.items.length;var ow=this.pos.dom.offsetWidth;var tw=this.pos.dom.clientWidth;var wrap=this.stripWrap;var wd=wrap.dom;var cw=wd.offsetWidth;var pos=this.getScrollPos();var l=this.edge.getOffsetsTo(this.stripWrap)[0]+pos;if(!this.enableTabScroll||count<1||cw<20){return;}
if(l<=tw){wd.scrollLeft=0;wrap.setWidth(tw);if(this.scrolling){this.scrolling=false;this.pos.removeClass('l-tab-scrolling');this.scrollLeft.hide();this.scrollRight.hide();if(L5.isAir||L5.isSafari){wd.style.marginLeft='';wd.style.marginRight='';}}}else{if(!this.scrolling){this.pos.addClass('l-tab-scrolling');if(L5.isAir||L5.isSafari){wd.style.marginLeft='18px';wd.style.marginRight='18px';}}
tw-=wrap.getMargins('lr');wrap.setWidth(tw>20?tw:20);if(!this.scrolling){if(!this.scrollLeft){this.createScrollers();}else{this.scrollLeft.show();this.scrollRight.show();}}
this.scrolling=true;if(pos>(l-tw)){wd.scrollLeft=l-tw;}else{this.scrollToTab(this.activeTab,false);}
this.updateScrollButtons();}},createScrollers:function(){this.pos.addClass('l-tab-scrolling-'+this.tabPosition);var h=this.stripWrap.dom.offsetHeight;var sl=this.pos.insertFirst({cls:'l-tab-scroller-left'});sl.setHeight(h);sl.addClassOnOver('l-tab-scroller-left-over');this.leftRepeater=new L5.util.ClickRepeater(sl,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=sl;var sr=this.pos.insertFirst({cls:'l-tab-scroller-right'});sr.setHeight(h);sr.addClassOnOver('l-tab-scroller-right-over');this.rightRepeater=new L5.util.ClickRepeater(sr,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=sr;},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos();},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0;},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0;},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this};},getScrollIncrement:function(){return this.scrollIncrement||(this.resizeTabs?this.lastTabWidth+2:100);},scrollToTab:function(item,animate){if(!item){return;}
var el=this.getTabEl(item);var pos=this.getScrollPos(),area=this.getScrollArea();var left=L5.fly(el).getOffsetsTo(this.stripWrap)[0]+pos;var right=left+el.offsetWidth;if(left<pos){this.scrollTo(left,animate);}else if(right>(pos+area)){this.scrollTo(right-area,animate);}},scrollTo:function(pos,animate){this.stripWrap.scrollTo('left',pos,animate?this.getScrollAnim():false);if(!animate){this.updateScrollButtons();}},onWheel:function(e){var d=e.getWheelDelta()*this.wheelIncrement*-1;e.stopEvent();var pos=this.getScrollPos();var newpos=pos+d;var sw=this.getScrollWidth()-this.getScrollArea();var s=Math.max(0,Math.min(sw,newpos));if(s!=pos){this.scrollTo(s,false);}},onScrollRight:function(){var sw=this.getScrollWidth()-this.getScrollArea();var pos=this.getScrollPos();var s=Math.min(sw,pos+this.getScrollIncrement());if(s!=pos){this.scrollTo(s,this.animScroll);}},onScrollLeft:function(){var pos=this.getScrollPos();var s=Math.max(0,pos-this.getScrollIncrement());if(s!=pos){this.scrollTo(s,this.animScroll);}},updateScrollButtons:function(){var pos=this.getScrollPos();if(this.scrollLeft)
this.scrollLeft[pos==0?'addClass':'removeClass']('l-tab-scroller-left-disabled');if(this.scrollRight)
this.scrollRight[pos>=(this.getScrollWidth()-this.getScrollArea())?'addClass':'removeClass']('l-tab-scroller-right-disabled');},beforeDestroy:function(){if(this.items){this.items.each(function(item){if(item&&item.tabEl){L5.get(item.tabEl).removeAllListeners();item.tabEl=null;}},this);}
if(this.stack){this.stack.clear();}
if(this.strip){this.strip.removeAllListeners();}
L5.TabPanel.superclass.beforeDestroy.apply(this);}});L5.reg('tabpanel',L5.TabPanel);L5.TabPanel.prototype.activate=L5.TabPanel.prototype.setActiveTab;L5.TabPanel.AccessStack=function(){var items=[];return{add:function(item){items.push(item);if(items.length>10){items.shift();}},remove:function(item){var s=[];for(var i=0,len=items.length;i<len;i++){if(items[i]!=item){s.push(items[i]);}}
items=s;},clear:function(){items.length=0;},next:function(){return items.pop();}};};

L5.Button=L5.extend(L5.Component,{hidden:false,disabled:false,pressed:false,enableToggle:false,menuAlign:"tl-bl?",type:'button',menuClassTarget:'tr',clickEvent:'click',handleMouseEvents:true,tooltipType:'qtip',buttonSelector:"button:first-child",initComponent:function(){L5.Button.superclass.initComponent.call(this);this.addEvents("click","toggle",'mouseover','mouseout','menushow','menuhide','menutriggerover','menutriggerout');if(this.menu){this.menu=L5.menu.MenuMgr.get(this.menu);}
if(typeof this.toggleGroup==='string'){this.enableToggle=true;}},onRender:function(ct,position){if(!this.template){if(!L5.Button.buttonTemplate){L5.Button.buttonTemplate=new L5.Template('<table border="0" cellpadding="0" cellspacing="0" class="l-btn-wrap"><tbody><tr>','<td class="l-btn-left"><i>&#160;</i></td><td class="l-btn-center"><em unselectable="on"><button class="l-btn-text" type="{1}">{0}</button></em></td><td class="l-btn-right"><i>&#160;</i></td>',"</tr></tbody></table>");}
this.template=L5.Button.buttonTemplate;}
var btn,targs=[this.text||'&#160;',this.type];if(position){btn=this.template.insertBefore(position,targs,true);}else{btn=this.template.append(ct,targs,true);}
var btnEl=btn.child(this.buttonSelector);btnEl.on('focus',this.onFocus,this);btnEl.on('blur',this.onBlur,this);this.initButtonEl(btn,btnEl);if(this.menu){this.el.child(this.menuClassTarget).addClass("l-btn-with-menu");}
L5.ButtonToggleMgr.register(this);},initButtonEl:function(btn,btnEl){this.el=btn;btn.addClass("l-btn");if(this.id){this.el.dom.id=this.el.id=this.id;}
if(this.icon){btnEl.setStyle('background-image','url('+this.icon+')');if(!this.cls){btn.addClass(this.text?'l-btn-text-icon':'l-btn-icon');}}
if(this.iconCls){btnEl.addClass(this.iconCls);if(!this.cls){btn.addClass(this.text?'l-btn-text-icon':'l-btn-icon');}}
if(this.tabIndex!==undefined){btnEl.dom.tabIndex=this.tabIndex;}
if(this.tooltip){if(typeof this.tooltip=='object'){L5.QuickTips.register(L5.apply({target:btnEl.id},this.tooltip));}else{btnEl.dom[this.tooltipType]=this.tooltip;}}
if(this.pressed){this.el.addClass("l-btn-pressed");}
if(this.handleMouseEvents){btn.on("mouseover",this.onMouseOver,this);btn.on("mousedown",this.onMouseDown,this);}
if(this.menu){this.menu.on("show",this.onMenuShow,this);this.menu.on("hide",this.onMenuHide,this);}
if(this.repeat){var repeater=new L5.util.ClickRepeater(btn,typeof this.repeat=="object"?this.repeat:{});repeater.on("click",this.onClick,this);}
btn.on(this.clickEvent,this.onClick,this);},afterRender:function(){L5.Button.superclass.afterRender.call(this);if(L5.isIE6){this.autoWidth.defer(1,this);}else{this.autoWidth();}},setIconClass:function(cls){if(this.el){this.el.child(this.buttonSelector).replaceClass(this.iconCls,cls);}
this.iconCls=cls;},beforeDestroy:function(){if(this.rendered){var btnEl=this.el.child(this.buttonSelector);if(btnEl){if(this.tooltip){L5.QuickTips.unregister(btnEl);}
btnEl.removeAllListeners();}}
if(this.menu){L5.destroy(this.menu);}},onDestroy:function(){if(this.rendered){L5.ButtonToggleMgr.unregister(this);}},autoWidth:function(){if(this.el){this.el.setWidth("auto");if(L5.isIE7&&L5.isStrict){var ib=this.el.child(this.buttonSelector);if(ib&&ib.getWidth()>20){ib.clip();ib.setWidth(L5.util.TextMetrics.measure(ib,this.text).width+ib.getFrameWidth('lr'));}}
if(this.minWidth){if(this.el.getWidth()<this.minWidth){this.el.setWidth(this.minWidth);}}}},setHandler:function(handler,scope){this.handler=handler;this.scope=scope;},setText:function(text){this.text=text;if(this.el){this.el.child("td.l-btn-center "+this.buttonSelector).update(text);}
this.autoWidth();},getText:function(){return this.text;},toggle:function(state){state=state===undefined?!this.pressed:state;if(state!=this.pressed){if(state){this.el.addClass("l-btn-pressed");this.pressed=true;this.fireEvent("toggle",this,true);}else{this.el.removeClass("l-btn-pressed");this.pressed=false;this.fireEvent("toggle",this,false);}
if(this.toggleHandler){this.toggleHandler.call(this.scope||this,this,state);}}},focus:function(){this.el.child(this.buttonSelector).focus();},onDisable:function(){if(this.el){if(!L5.isIE6||!this.text){this.el.addClass(this.disabledClass);}
this.el.dom.disabled=true;}
this.disabled=true;},onEnable:function(){if(this.el){if(!L5.isIE6||!this.text){this.el.removeClass(this.disabledClass);}
this.el.dom.disabled=false;}
this.disabled=false;},showMenu:function(){if(this.menu){this.menu.show(this.el,this.menuAlign);}
return this;},hideMenu:function(){if(this.menu){this.menu.hide();}
return this;},hasVisibleMenu:function(){return this.menu&&this.menu.isVisible();},onClick:function(e){if(e){e.preventDefault();}
if(e.button!=0){return;}
if(!this.disabled){if(this.enableToggle&&(this.allowDepress!==false||!this.pressed)){this.toggle();}
if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu();}
this.fireEvent("click",this,e);if(this.handler){this.handler.call(this.scope||this,this,e);}}},isMenuTriggerOver:function(e,internal){return this.menu&&!internal;},isMenuTriggerOut:function(e,internal){return this.menu&&!internal;},onMouseOver:function(e){if(!this.disabled){var internal=e.within(this.el,true);if(!internal){this.el.addClass("l-btn-over");if(!this.monitoringMouseOver){L5.getDoc().on('mouseover',this.monitorMouseOver,this);this.monitoringMouseOver=true;}
this.fireEvent('mouseover',this,e);}
if(this.isMenuTriggerOver(e,internal)){this.fireEvent('menutriggerover',this,this.menu,e);}}},monitorMouseOver:function(e){if(e.target!=this.el.dom&&!e.within(this.el)){if(this.monitoringMouseOver){L5.getDoc().un('mouseover',this.monitorMouseOver,this);this.monitoringMouseOver=false;}
this.onMouseOut(e);}},onMouseOut:function(e){var internal=e.within(this.el)&&e.target!=this.el.dom;this.el.removeClass("l-btn-over");this.fireEvent('mouseout',this,e);if(this.isMenuTriggerOut(e,internal)){this.fireEvent('menutriggerout',this,this.menu,e);}},onFocus:function(e){if(!this.disabled){this.el.addClass("l-btn-focus");}},onBlur:function(e){this.el.removeClass("l-btn-focus");},getClickEl:function(e,isUp){return this.el;},onMouseDown:function(e){if(!this.disabled&&e.button==0){this.getClickEl(e).addClass("l-btn-click");L5.getDoc().on('mouseup',this.onMouseUp,this);}},onMouseUp:function(e){if(e.button==0){this.getClickEl(e,true).removeClass("l-btn-click");L5.getDoc().un('mouseup',this.onMouseUp,this);}},onMenuShow:function(e){this.ignoreNextClick=0;this.el.addClass("l-btn-menu-active");this.fireEvent('menushow',this,this.menu);},onMenuHide:function(e){this.el.removeClass("l-btn-menu-active");this.ignoreNextClick=this.restoreClick.defer(250,this);this.fireEvent('menuhide',this,this.menu);},restoreClick:function(){this.ignoreNextClick=0;}});L5.reg('button',L5.Button);L5.ButtonToggleMgr=function(){var groups={};function toggleGroup(btn,state){if(state){var g=groups[btn.toggleGroup];for(var i=0,l=g.length;i<l;i++){if(g[i]!=btn){g[i].toggle(false);}}}}
return{register:function(btn){if(!btn.toggleGroup){return;}
var g=groups[btn.toggleGroup];if(!g){g=groups[btn.toggleGroup]=[];}
g.push(btn);btn.on("toggle",toggleGroup);},unregister:function(btn){if(!btn.toggleGroup){return;}
var g=groups[btn.toggleGroup];if(g){g.remove(btn);btn.un("toggle",toggleGroup);}}};}();

L5.SplitButton=L5.extend(L5.Button,{arrowSelector:'button:last',initComponent:function(){L5.SplitButton.superclass.initComponent.call(this);this.addEvents("arrowclick");},onRender:function(ct,position){var tpl=new L5.Template('<table cellspacing="0" class="l-btn-menu-wrap l-btn"><tr><td>','<table cellspacing="0" class="l-btn-wrap l-btn-menu-text-wrap"><tbody>','<tr><td class="l-btn-left"><i>&#160;</i></td><td class="l-btn-center"><button class="l-btn-text" type="{1}">{0}</button></td></tr>',"</tbody></table></td><td>",'<table cellspacing="0" class="l-btn-wrap l-btn-menu-arrow-wrap"><tbody>','<tr><td class="l-btn-center"><button class="l-btn-menu-arrow-el" type="button">&#160;</button></td><td class="l-btn-right"><i>&#160;</i></td></tr>',"</tbody></table></td></tr></table>");var btn,targs=[this.text||'&#160;',this.type];if(position){btn=tpl.insertBefore(position,targs,true);}else{btn=tpl.append(ct,targs,true);}
var btnEl=btn.child(this.buttonSelector);this.initButtonEl(btn,btnEl);this.arrowBtnTable=btn.child("table:last");if(this.arrowTooltip){btn.child(this.arrowSelector).dom[this.tooltipType]=this.arrowTooltip;}},autoWidth:function(){if(this.el){var tbl=this.el.child("table:first");var tbl2=this.el.child("table:last");this.el.setWidth("auto");tbl.setWidth("auto");if(L5.isIE7&&L5.isStrict){var ib=this.el.child(this.buttonSelector);if(ib&&ib.getWidth()>20){ib.clip();ib.setWidth(L5.util.TextMetrics.measure(ib,this.text).width+ib.getFrameWidth('lr'));}}
if(this.minWidth){if((tbl.getWidth()+tbl2.getWidth())<this.minWidth){tbl.setWidth(this.minWidth-tbl2.getWidth());}}
this.el.setWidth(tbl.getWidth()+tbl2.getWidth());}},setArrowHandler:function(handler,scope){this.arrowHandler=handler;this.scope=scope;},onClick:function(e){e.preventDefault();if(!this.disabled){if(e.getTarget(".l-btn-menu-arrow-wrap")){if(this.menu&&!this.menu.isVisible()&&!this.ignoreNextClick){this.showMenu();}
this.fireEvent("arrowclick",this,e);if(this.arrowHandler){this.arrowHandler.call(this.scope||this,this,e);}}else{if(this.enableToggle){this.toggle();}
this.fireEvent("click",this,e);if(this.handler){this.handler.call(this.scope||this,this,e);}}}},getClickEl:function(e,isUp){if(!isUp){return(this.lastClickEl=e.getTarget("table",10,true));}
return this.lastClickEl;},onDisable:function(){if(this.el){if(!L5.isIE6){this.el.addClass("l-item-disabled");}
this.el.child(this.buttonSelector).dom.disabled=true;this.el.child(this.arrowSelector).dom.disabled=true;}
this.disabled=true;},onEnable:function(){if(this.el){if(!L5.isIE6){this.el.removeClass("l-item-disabled");}
this.el.child(this.buttonSelector).dom.disabled=false;this.el.child(this.arrowSelector).dom.disabled=false;}
this.disabled=false;},isMenuTriggerOver:function(e){return this.menu&&e.within(this.arrowBtnTable)&&!e.within(this.arrowBtnTable,true);},isMenuTriggerOut:function(e,internal){return this.menu&&!e.within(this.arrowBtnTable);},onDestroy:function(){L5.destroy(this.arrowBtnTable);L5.SplitButton.superclass.onDestroy.call(this);}});L5.MenuButton=L5.SplitButton;L5.reg('splitbutton',L5.SplitButton);

L5.Toolbar=function(config){if(L5.isArray(config)){config={buttons:config};}
L5.Toolbar.superclass.constructor.call(this,config);};(function(){var T=L5.Toolbar;L5.extend(T,L5.BoxComponent,{trackMenus:true,initComponent:function(){T.superclass.initComponent.call(this);if(this.items){this.buttons=this.items;}
this.items=new L5.util.MixedCollection(false,function(o){return o.itemId||o.id||L5.id();});},autoCreate:{cls:'l-toolbar l-small-editor',html:'<table cellspacing="0"><tr></tr></table>'},onRender:function(ct,position){this.el=ct.createChild(L5.apply({id:this.id},this.autoCreate),position);this.tr=this.el.child("tr",true);},afterRender:function(){T.superclass.afterRender.call(this);if(this.buttons){this.add.apply(this,this.buttons);delete this.buttons;}},add:function(){var a=arguments,l=a.length;for(var i=0;i<l;i++){var el=a[i];if(el.isFormField){this.addField(el);}else if(el.render){this.addItem(el);}else if(typeof el=="string"){if(el=="separator"||el=="-"){this.addSeparator();}else if(el==" "){this.addSpacer();}else if(el=="->"){this.addFill();}else{this.addText(el);}}else if(el.tagName){this.addElement(el);}else if(typeof el=="object"){if(el.xtype){this.addField(L5.ComponentMgr.create(el,'button'));}else{this.addButton(el);}}}},addSeparator:function(){return this.addItem(new T.Separator());},addSpacer:function(){return this.addItem(new T.Spacer());},addFill:function(){return this.addItem(new T.Fill());},addElement:function(el){return this.addItem(new T.Item(el));},addItem:function(item){var td=this.nextBlock();this.initMenuTracking(item);item.render(td);this.items.add(item);return item;},addButton:function(config){if(L5.isArray(config)){var buttons=[];for(var i=0,len=config.length;i<len;i++){buttons.push(this.addButton(config[i]));}
return buttons;}
var b=config;if(!(config instanceof T.Button)){b=config.split?new T.SplitButton(config):new T.Button(config);}
var td=this.nextBlock();this.initMenuTracking(b);b.render(td);this.items.add(b);return b;},initMenuTracking:function(item){if(this.trackMenus&&item.menu){item.on({'menutriggerover':this.onButtonTriggerOver,'menushow':this.onButtonMenuShow,'menuhide':this.onButtonMenuHide,scope:this})}},addText:function(text){return this.addItem(new T.TextItem(text));},insertButton:function(index,item){if(L5.isArray(item)){var buttons=[];for(var i=0,len=item.length;i<len;i++){buttons.push(this.insertButton(index+i,item[i]));}
return buttons;}
if(!(item instanceof T.Button)){item=new T.Button(item);}
var td=document.createElement("td");this.tr.insertBefore(td,this.tr.childNodes[index]);this.initMenuTracking(item);item.render(td);this.items.insert(index,item);return item;},addDom:function(config,returnEl){var td=this.nextBlock();L5.DomHelper.overwrite(td,config);var ti=new T.Item(td.firstChild);ti.render(td);this.items.add(ti);return ti;},addField:function(field){var td=this.nextBlock();field.render(td);var ti=new T.Item(td.firstChild);ti.render(td);this.items.add(field);return ti;},nextBlock:function(){var td=document.createElement("td");this.tr.appendChild(td);return td;},onDestroy:function(){L5.Toolbar.superclass.onDestroy.call(this);if(this.rendered){if(this.items){L5.destroy.apply(L5,this.items.items);}
L5.Element.uncache(this.tr);}},onDisable:function(){this.items.each(function(item){if(item.disable){item.disable();}});},onEnable:function(){this.items.each(function(item){if(item.enable){item.enable();}});},onButtonTriggerOver:function(btn){if(this.activeMenuBtn&&this.activeMenuBtn!=btn){this.activeMenuBtn.hideMenu();btn.showMenu();this.activeMenuBtn=btn;}},onButtonMenuShow:function(btn){this.activeMenuBtn=btn;},onButtonMenuHide:function(btn){delete this.activeMenuBtn;}});L5.reg('toolbar',L5.Toolbar);T.Item=function(el){this.el=L5.getDom(el);this.id=L5.id(this.el);this.hidden=false;};T.Item.prototype={getEl:function(){return this.el;},render:function(td){this.td=td;td.appendChild(this.el);},destroy:function(){if(this.el){var el=L5.get(this.el);L5.destroy(el);}
L5.removeNode(this.td);},show:function(){this.hidden=false;this.td.style.display="";},hide:function(){this.hidden=true;this.td.style.display="none";},setVisible:function(visible){if(visible){this.show();}else{this.hide();}},focus:function(){L5.fly(this.el).focus();},disable:function(){L5.fly(this.td).addClass("l-item-disabled");this.disabled=true;this.el.disabled=true;},enable:function(){L5.fly(this.td).removeClass("l-item-disabled");this.disabled=false;this.el.disabled=false;}};L5.reg('tbitem',T.Item);T.Separator=function(){var s=document.createElement("span");s.className="ytb-sep";T.Separator.superclass.constructor.call(this,s);};L5.extend(T.Separator,T.Item,{enable:L5.emptyFn,disable:L5.emptyFn,focus:L5.emptyFn});L5.reg('tbseparator',T.Separator);T.Spacer=function(){var s=document.createElement("div");s.className="ytb-spacer";T.Spacer.superclass.constructor.call(this,s);};L5.extend(T.Spacer,T.Item,{enable:L5.emptyFn,disable:L5.emptyFn,focus:L5.emptyFn});L5.reg('tbspacer',T.Spacer);T.Fill=L5.extend(T.Spacer,{render:function(td){td.style.width='100%';T.Fill.superclass.render.call(this,td);}});L5.reg('tbfill',T.Fill);T.TextItem=function(t){var s=document.createElement("span");s.className="ytb-text";s.innerHTML=t.text?t.text:t;T.TextItem.superclass.constructor.call(this,s);};L5.extend(T.TextItem,T.Item,{enable:L5.emptyFn,disable:L5.emptyFn,focus:L5.emptyFn});L5.reg('tbtext',T.TextItem);T.Button=L5.extend(L5.Button,{hideParent:true,onDestroy:function(){T.Button.superclass.onDestroy.call(this);if(this.container){this.container.remove();}}});L5.reg('tbbutton',T.Button);T.SplitButton=L5.extend(L5.SplitButton,{hideParent:true,onDestroy:function(){T.SplitButton.superclass.onDestroy.call(this);if(this.container){this.container.remove();}}});L5.reg('tbsplit',T.SplitButton);T.MenuButton=T.SplitButton;})();

L5.PagingToolbar=L5.extend(L5.Toolbar,{displayInfo:true,displayMsg:'Displaying {0} - {1} of {2}',emptyMsg:'No data to display',beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",paramNames:{start:'start',limit:'limit'},initComponent:function(){this.addEvents('change','beforechange');L5.PagingToolbar.superclass.initComponent.call(this);this.bind(this.dataset);},onRender:function(ct,position){L5.PagingToolbar.superclass.onRender.call(this,ct,position);this.first=this.addButton({tooltip:this.firstText,iconCls:"l-tbar-page-first",disabled:true,handler:this.onClick.createDelegate(this,["first"])});this.prev=this.addButton({tooltip:this.prevText,iconCls:"l-tbar-page-prev",disabled:true,handler:this.onClick.createDelegate(this,["prev"])});this.addSeparator();this.add(this.beforePageText);this.field=L5.get(this.addDom({tag:"input",type:"text",size:"3",value:"1",cls:"l-tbar-page-number"}).el);this.field.on("keydown",this.onPagingKeydown,this);this.field.on("focus",function(){this.dom.select();});this.field.on("blur",this.onPagingBlur,this);this.afterTextEl=this.addText(String.format(this.afterPageText,1));this.field.setHeight(18);this.addSeparator();this.next=this.addButton({tooltip:this.nextText,iconCls:"l-tbar-page-next",disabled:true,handler:this.onClick.createDelegate(this,["next"])});this.last=this.addButton({tooltip:this.lastText,iconCls:"l-tbar-page-last",disabled:true,handler:this.onClick.createDelegate(this,["last"])});this.addSeparator();this.loading=this.addButton({tooltip:this.refreshText,iconCls:"l-tbar-loading",handler:this.onClick.createDelegate(this,["refresh"])});if(this.displayInfo){this.displayEl=L5.fly(this.el.dom).createChild({cls:'l-paging-info'});}
if(this.dsLoaded){this.onLoad.apply(this,this.dsLoaded);}
this.addSeparator();this.add("　　");this.pageLimitField=L5.get(this.addDom({tag:"input",type:"text",size:"5",style:'width:34px',value:this.dataset.getPageSize(),cls:"l-tbar-page-number"}).el);this.pageLimitField.on("keydown",function(e){var k=e.getKey();if(k==e.RETURN){var numberReg=/^\d+$/;if(this.pageLimitField.dom.value.match(numberReg)==null){L5.Msg.alert("错误","必须输入正整数！");return;}
e.stopEvent();if(parseInt(this.pageLimitField.dom.value)>65535){this.pageLimitField.dom.value=65535;}
this.dataset.pageInfo.pageSize=parseInt(this.pageLimitField.dom.value);this.changePage(1);}},this);this.pageLimitField.on("focus",function(){this.dom.select();});this.pageLimitField.on("blur",function(e){this.pageLimitField.dom.value=this.dataset.getPageSize();},this);this.add("条/页");this.pageLimitField.setHeight(18);this.pageLimitField.setWidth(50);},updateInfo:function(){if(this.displayEl){var count=this.dataset.getCount();var cursor=this.dataset.getStartCursor();var total=this.dataset.getTotalCount();var pageSize=this.dataset.getPageSize();if(cursor+pageSize>total){total=cursor+count;}else{total=total;}
var msg=count==0?this.emptyMsg:String.format(this.displayMsg,cursor+1,cursor+count,total);this.displayEl.update(msg);}},onLoad:function(dataset,r,o){if(!this.rendered){this.dsLoaded=[dataset,r,o];return;}
var d=this.getPageData();this.afterTextEl.el.innerHTML=String.format(this.afterPageText,Math.max(d.pages,1));this.field.dom.value=d.activePage;this.first.setDisabled(this.dataset.isFirstPage());this.prev.setDisabled(this.dataset.isFirstPage());this.next.setDisabled(this.dataset.isLastPage());this.last.setDisabled(this.dataset.isLastPage());this.loading.enable();this.updateInfo();this.fireEvent('change',this,d);},getPageData:function(){return{total:this.dataset.getTotalCount(),activePage:this.dataset.getPageIndex(),pages:this.dataset.getTotalPage()};},onLoadError:function(){if(!this.rendered){return;}
this.loading.enable();},readPage:function(d){var v=this.field.dom.value,pageNum;if(!v||isNaN(pageNum=parseInt(v,10))){this.field.dom.value=d.activePage;return false;}
return pageNum;},onPagingBlur:function(e){this.field.dom.value=this.getPageData().activePage;},onPagingKeydown:function(e){var k=e.getKey(),d=this.getPageData(),pageNum;if(k==e.RETURN){e.stopEvent();pageNum=this.readPage(d);if(pageNum!==false){pageNum=Math.min(Math.max(1,pageNum),d.pages);this.changePage(pageNum);}}else if(k==e.HOME||k==e.END){e.stopEvent();pageNum=k==e.HOME?1:d.pages;this.field.dom.value=pageNum;}else if(k==e.UP||k==e.PAGEUP||k==e.DOWN||k==e.PAGEDOWN){e.stopEvent();if(pageNum=this.readPage(d)){var increment=e.shiftKey?10:1;if(k==e.DOWN||k==e.PAGEDOWN){increment*=-1;}
pageNum+=increment;if(pageNum>=1&pageNum<=d.pages){this.field.dom.value=pageNum;}}}},beforeLoad:function(){if(this.rendered&&this.loading){this.loading.disable();}},changePage:function(page){this.dataset.turnPage(page);},onClick:function(which){var ds=this.dataset;switch(which){case"first":ds.turnFirst();break;case"prev":ds.turnPrev();break;case"next":ds.turnNext();break;case"last":ds.turnLast();break;case"refresh":ds.reload();break;}},unbind:function(dataset){dataset=L5.DatasetMgr.lookup(dataset);dataset.un("beforeload",this.beforeLoad,this);dataset.un("load",this.onLoad,this);dataset.un("add",this.onLoad,this);dataset.un("remove",this.onLoad,this);dataset.un("clear",this.onLoad,this);dataset.un("datachanged",this.onLoad,this);dataset.un("loadexception",this.onLoadError,this);this.dataset=undefined;},bind:function(dataset){dataset=L5.DatasetMgr.lookup(dataset);dataset.on("beforeload",this.beforeLoad,this);dataset.on("load",this.onLoad,this);dataset.on("add",this.onLoad,this);dataset.on("remove",this.onLoad,this);dataset.on("clear",this.onLoad,this);dataset.on("datachanged",this.onLoad,this);dataset.on("loadexception",this.onLoadError,this);this.dataset=dataset;this.onLoad(this.dataset);},onDestroy:function(){if(this.dataset){this.unbind(this.dataset);}
L5.PagingToolbar.superclass.onDestroy.call(this);}});L5.reg('paging',L5.PagingToolbar);

L5.Resizable=function(el,config){this.el=L5.get(el);if(config&&config.wrap){config.resizeChild=this.el;this.el=this.el.wrap(typeof config.wrap=="object"?config.wrap:{cls:"xresizable-wrap"});this.el.id=this.el.dom.id=config.resizeChild.id+"-rzwrap";this.el.setStyle("overflow","hidden");this.el.setPositioning(config.resizeChild.getPositioning());config.resizeChild.clearPositioning();if(!config.width||!config.height){var csize=config.resizeChild.getSize();this.el.setSize(csize.width,csize.height);}
if(config.pinned&&!config.adjustments){config.adjustments="auto";}}
this.proxy=this.el.createProxy({tag:"div",cls:"l-resizable-proxy",id:this.el.id+"-rzproxy"},L5.getBody());this.proxy.unselectable();this.proxy.enableDisplayMode('block');L5.apply(this,config);if(this.pinned){this.disableTrackOver=true;this.el.addClass("l-resizable-pinned");}
var position=this.el.getStyle("position");if(position!="absolute"&&position!="fixed"){this.el.setStyle("position","relative");}
if(!this.handles){this.handles='s,e,se';if(this.multiDirectional){this.handles+=',n,w';}}
if(this.handles=="all"){this.handles="n s e w ne nw se sw";}
var hs=this.handles.split(/\s*?[,;]\s*?| /);var ps=L5.Resizable.positions;for(var i=0,len=hs.length;i<len;i++){if(hs[i]&&ps[hs[i]]){var pos=ps[hs[i]];this[pos]=new L5.Resizable.Handle(this,pos,this.disableTrackOver,this.transparent);}}
this.corner=this.southeast;if(this.handles.indexOf("n")!=-1||this.handles.indexOf("w")!=-1){this.updateBox=true;}
this.activeHandle=null;if(this.resizeChild){if(typeof this.resizeChild=="boolean"){this.resizeChild=L5.get(this.el.dom.firstChild,true);}else{this.resizeChild=L5.get(this.resizeChild,true);}}
if(this.adjustments=="auto"){var rc=this.resizeChild;var hw=this.west,he=this.east,hn=this.north,hs=this.south;if(rc&&(hw||hn)){rc.position("relative");rc.setLeft(hw?hw.el.getWidth():0);rc.setTop(hn?hn.el.getHeight():0);}
this.adjustments=[(he?-he.el.getWidth():0)+(hw?-hw.el.getWidth():0),(hn?-hn.el.getHeight():0)+(hs?-hs.el.getHeight():0)-1];}
if(this.draggable){this.dd=this.dynamic?this.el.initDD(null):this.el.initDDProxy(null,{dragElId:this.proxy.id});this.dd.setHandleElId(this.resizeChild?this.resizeChild.id:this.el.id);}
this.addEvents("beforeresize","resize");if(this.width!==null&&this.height!==null){this.resizeTo(this.width,this.height);}else{this.updateChildSize();}
if(L5.isIE){this.el.dom.style.zoom=1;}
L5.Resizable.superclass.constructor.call(this);};L5.extend(L5.Resizable,L5.util.Observable,{resizeChild:false,adjustments:[0,0],minWidth:5,minHeight:5,maxWidth:10000,maxHeight:10000,enabled:true,animate:false,duration:.35,dynamic:false,handles:false,multiDirectional:false,disableTrackOver:false,easing:'easeOutStrong',widthIncrement:0,heightIncrement:0,pinned:false,width:null,height:null,preserveRatio:false,transparent:false,minX:0,minY:0,draggable:false,resizeTo:function(width,height){this.el.setSize(width,height);this.updateChildSize();this.fireEvent("resize",this,width,height,null);},startSizing:function(e,handle){this.fireEvent("beforeresize",this,e);if(this.enabled){if(!this.overlay){this.overlay=this.el.createProxy({tag:"div",cls:"l-resizable-overlay",html:"&#160;"},L5.getBody());this.overlay.unselectable();this.overlay.enableDisplayMode("block");this.overlay.on("mousemove",this.onMouseMove,this);this.overlay.on("mouseup",this.onMouseUp,this);}
this.overlay.setStyle("cursor",handle.el.getStyle("cursor"));this.resizing=true;this.startBox=this.el.getBox();this.startPoint=e.getXY();this.offsets=[(this.startBox.x+this.startBox.width)-this.startPoint[0],(this.startBox.y+this.startBox.height)-this.startPoint[1]];this.overlay.setSize(L5.lib.Dom.getViewWidth(true),L5.lib.Dom.getViewHeight(true));this.overlay.show();if(this.constrainTo){var ct=L5.get(this.constrainTo);this.resizeRegion=ct.getRegion().adjust(ct.getFrameWidth('t'),ct.getFrameWidth('l'),-ct.getFrameWidth('b'),-ct.getFrameWidth('r'));}
this.proxy.setStyle('visibility','hidden');this.proxy.show();this.proxy.setBox(this.startBox);if(!this.dynamic){this.proxy.setStyle('visibility','visible');}}},onMouseDown:function(handle,e){if(this.enabled){e.stopEvent();this.activeHandle=handle;this.startSizing(e,handle);}},onMouseUp:function(e){var size=this.resizeElement();this.resizing=false;this.handleOut();this.overlay.hide();this.proxy.hide();this.fireEvent("resize",this,size.width,size.height,e);},updateChildSize:function(){if(this.resizeChild){var el=this.el;var child=this.resizeChild;var adj=this.adjustments;if(el.dom.offsetWidth){var b=el.getSize(true);child.setSize(b.width+adj[0],b.height+adj[1]);}
if(L5.isIE){setTimeout(function(){if(el.dom.offsetWidth){var b=el.getSize(true);child.setSize(b.width+adj[0],b.height+adj[1]);}},10);}}},snap:function(value,inc,min){if(!inc||!value)return value;var newValue=value;var m=value%inc;if(m>0){if(m>(inc/2)){newValue=value+(inc-m);}else{newValue=value-m;}}
return Math.max(min,newValue);},resizeElement:function(){var box=this.proxy.getBox();if(this.updateBox){this.el.setBox(box,false,this.animate,this.duration,null,this.easing);}else{this.el.setSize(box.width,box.height,this.animate,this.duration,null,this.easing);}
this.updateChildSize();if(!this.dynamic){this.proxy.hide();}
return box;},constrain:function(v,diff,m,mx){if(v-diff<m){diff=v-m;}else if(v-diff>mx){diff=mx-v;}
return diff;},onMouseMove:function(e){if(this.enabled){try{if(this.resizeRegion&&!this.resizeRegion.contains(e.getPoint())){return;}
var curSize=this.curSize||this.startBox;var x=this.startBox.x,y=this.startBox.y;var ox=x,oy=y;var w=curSize.width,h=curSize.height;var ow=w,oh=h;var mw=this.minWidth,mh=this.minHeight;var mxw=this.maxWidth,mxh=this.maxHeight;var wi=this.widthIncrement;var hi=this.heightIncrement;var eventXY=e.getXY();var diffX=-(this.startPoint[0]-Math.max(this.minX,eventXY[0]));var diffY=-(this.startPoint[1]-Math.max(this.minY,eventXY[1]));var pos=this.activeHandle.position;switch(pos){case"east":w+=diffX;w=Math.min(Math.max(mw,w),mxw);break;case"south":h+=diffY;h=Math.min(Math.max(mh,h),mxh);break;case"southeast":w+=diffX;h+=diffY;w=Math.min(Math.max(mw,w),mxw);h=Math.min(Math.max(mh,h),mxh);break;case"north":diffY=this.constrain(h,diffY,mh,mxh);y+=diffY;h-=diffY;break;case"west":diffX=this.constrain(w,diffX,mw,mxw);x+=diffX;w-=diffX;break;case"northeast":w+=diffX;w=Math.min(Math.max(mw,w),mxw);diffY=this.constrain(h,diffY,mh,mxh);y+=diffY;h-=diffY;break;case"northwest":diffX=this.constrain(w,diffX,mw,mxw);diffY=this.constrain(h,diffY,mh,mxh);y+=diffY;h-=diffY;x+=diffX;w-=diffX;break;case"southwest":diffX=this.constrain(w,diffX,mw,mxw);h+=diffY;h=Math.min(Math.max(mh,h),mxh);x+=diffX;w-=diffX;break;}
var sw=this.snap(w,wi,mw);var sh=this.snap(h,hi,mh);if(sw!=w||sh!=h){switch(pos){case"northeast":y-=sh-h;break;case"north":y-=sh-h;break;case"southwest":x-=sw-w;break;case"west":x-=sw-w;break;case"northwest":x-=sw-w;y-=sh-h;break;}
w=sw;h=sh;}
if(this.preserveRatio){switch(pos){case"southeast":case"east":h=oh*(w/ow);h=Math.min(Math.max(mh,h),mxh);w=ow*(h/oh);break;case"south":w=ow*(h/oh);w=Math.min(Math.max(mw,w),mxw);h=oh*(w/ow);break;case"northeast":w=ow*(h/oh);w=Math.min(Math.max(mw,w),mxw);h=oh*(w/ow);break;case"north":var tw=w;w=ow*(h/oh);w=Math.min(Math.max(mw,w),mxw);h=oh*(w/ow);x+=(tw-w)/2;break;case"southwest":h=oh*(w/ow);h=Math.min(Math.max(mh,h),mxh);var tw=w;w=ow*(h/oh);x+=tw-w;break;case"west":var th=h;h=oh*(w/ow);h=Math.min(Math.max(mh,h),mxh);y+=(th-h)/2;var tw=w;w=ow*(h/oh);x+=tw-w;break;case"northwest":var tw=w;var th=h;h=oh*(w/ow);h=Math.min(Math.max(mh,h),mxh);w=ow*(h/oh);y+=th-h;x+=tw-w;break;}}
this.proxy.setBounds(x,y,w,h);if(this.dynamic){this.resizeElement();}}catch(e){}}},handleOver:function(){if(this.enabled){this.el.addClass("l-resizable-over");}},handleOut:function(){if(!this.resizing){this.el.removeClass("l-resizable-over");}},getEl:function(){return this.el;},getResizeChild:function(){return this.resizeChild;},destroy:function(removeEl){if(this.dd){this.dd.destroy();}
if(this.overlay){L5.destroy(this.overlay);this.overlay=null;}
L5.destroy(this.proxy);this.proxy=null;var ps=L5.Resizable.positions;for(var k in ps){if(typeof ps[k]!="function"&&this[ps[k]]){this[ps[k]].destroy();}}
if(removeEl){this.el.update("");L5.destroy(this.el);this.el=null;}},syncHandleHeight:function(){var h=this.el.getHeight(true);if(this.west){this.west.el.setHeight(h);}
if(this.east){this.east.el.setHeight(h);}}});L5.Resizable.positions={n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"};L5.Resizable.Handle=function(rz,pos,disableTrackOver,transparent){if(!this.tpl){var tpl=L5.DomHelper.createTemplate({tag:"div",cls:"l-resizable-handle l-resizable-handle-{0}"});tpl.compile();L5.Resizable.Handle.prototype.tpl=tpl;}
this.position=pos;this.rz=rz;this.el=this.tpl.append(rz.el.dom,[this.position],true);this.el.unselectable();if(transparent){this.el.setOpacity(0);}
this.el.on("mousedown",this.onMouseDown,this);if(!disableTrackOver){this.el.on("mouseover",this.onMouseOver,this);this.el.on("mouseout",this.onMouseOut,this);}};L5.Resizable.Handle.prototype={afterResize:function(rz){},onMouseDown:function(e){this.rz.onMouseDown(this,e);},onMouseOver:function(e){this.rz.handleOver(this,e);},onMouseOut:function(e){this.rz.handleOut(this,e);},destroy:function(){L5.destroy(this.el);this.el=null;}};

L5.Editor=function(field,config){this.field=field;L5.Editor.superclass.constructor.call(this,config);};L5.extend(L5.Editor,L5.Component,{value:"",alignment:"c-c?",shadow:"frame",constrain:false,swallowKeys:true,completeOnEnter:false,cancelOnEsc:false,updateEl:false,rowIndex:-1,cellIndex:-1,editing:false,initComponent:function(){L5.Editor.superclass.initComponent.call(this);this.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey","contextmenu");},onRender:function(ct,position){this.el=new L5.Layer({shadow:this.shadow,cls:"l-editor",parentEl:ct,shim:this.shim,shadowOffset:4,id:this.id,constrain:this.constrain});this.el.setStyle("overflow",L5.isGecko?"auto":"");if(this.field.msgTarget!='title'){this.field.msgTarget='qtip';}
this.field.inEditor=true;this.field.render(this.el);if(L5.isGecko){this.field.el.dom.setAttribute('autocomplete','off');}
this.field.on("specialkey",this.onSpecialKey,this);if(this.swallowKeys){this.field.el.swallowEvent(['keydown','keypress']);}
this.field.show();this.field.on("blur",this.onBlur,this);if(this.field.grow){this.field.on("autosize",this.el.sync,this.el,{delay:1});}
this.field.on("contextmenu",this.onContextMenu,this);this.relayEvents(ct,"contextmenu");},onSpecialKey:function(field,e){var key=e.getKey();if(this.completeOnEnter&&key==e.ENTER){e.stopEvent();this.completeEdit();}else if(this.cancelOnEsc&&key==e.ESC){this.cancelEdit();}else{this.fireEvent('specialkey',field,e);}
if(this.field.triggerBlur&&(key==e.ENTER||key==e.ESC||key==e.TAB)){this.field.triggerBlur();}},startEdit:function(el,value){if(this.editing){this.completeEdit();}
this.boundEl=L5.get(el);var v=value!==undefined?value:this.boundEl.dom.innerHTML;if(!this.rendered){this.render(this.parentEl||document.body);}
if(this.fireEvent("beforestartedit",this,this.boundEl,v)===false){return;}
this.startValue=v;this.field.setValue(v);this.doAutoSize();this.el.alignTo(this.boundEl,this.alignment);this.editing=true;this.show();},doAutoSize:function(){if(this.autoSize){var sz=this.boundEl.getSize();switch(this.autoSize){case"width":this.setSize(sz.width,undefined);break;case"height":this.setSize(undefined,sz.height);break;default:this.setSize(sz.width,sz.height);}}},setSize:function(w,h){delete this.field.lastSize;this.field.setSize(w,h);if(this.el){if(L5.isGecko2||L5.isOpera){this.el.setSize(w,h);}
this.el.sync();}},realign:function(){this.el.alignTo(this.boundEl,this.alignment);},completeEdit:function(remainVisible){if(!this.editing){return;}
var v=this.getValue();if(this.revertInvalid!==false&&!this.field.isValid()){v=this.startValue;this.cancelEdit(true);}
if(String(v)===String(this.startValue)&&this.ignoreNoChange){this.editing=false;this.hide();return;}
if(this.fireEvent("beforecomplete",this,v,this.startValue)!==false){this.editing=false;if(this.updateEl&&this.boundEl){this.boundEl.update(v);}
if(remainVisible!==true){this.hide();}
this.fireEvent("complete",this,v,this.startValue);}},onShow:function(){this.el.show();if(this.hideEl!==false){this.boundEl.hide();}
this.field.show();if(L5.isIE&&!this.fixIEFocus){this.fixIEFocus=true;this.deferredFocus.defer(50,this);}else{this.field.focus();}
this.fireEvent("startedit",this.boundEl,this.startValue);},deferredFocus:function(){if(this.editing){this.field.focus();}},cancelEdit:function(remainVisible){if(this.editing){var v=this.getValue();this.setValue(this.startValue);if(remainVisible!==true){this.hide();}
this.fireEvent("canceledit",this,v,this.startValue);}},onBlur:function(){if(this.allowBlur!==true&&this.editing){this.completeEdit();}},onHide:function(){if(this.editing){this.completeEdit();return;}
this.field.blur();if(this.field.collapse){this.field.collapse();}
this.el.hide();if(this.hideEl!==false){this.boundEl.show();}},setValue:function(v){this.field.setValue(v);},getValue:function(){return this.field.getValue();},onContextMenu:function(name,e){if(e&&e.stopPropagation)
e.stopPropagation();else
window.event.cancelBubble=true;this.editing=false;return this.fireEvent("contextmenu",this,this.rowIndex,this.cellIndex,e);},beforeDestroy:function(){L5.destroy(this.field);this.field=null;}});L5.reg('editor',L5.Editor);

L5.MessageBox=function(){var dlg,opt,mask,waitTimer;var bodyEl,msgEl,textboxEl,textareaEl,progressBar,pp,iconEl,spacerEl;var buttons,activeTextEl,bwidth,iconCls='';var handleButton=function(button){if(dlg.isVisible()){dlg.hide();L5.callback(opt.fn,opt.scope||window,[button,activeTextEl.dom.value,opt],1);}};var handleHide=function(){if(opt&&opt.cls){dlg.el.removeClass(opt.cls);}
progressBar.reset();};var handleEsc=function(d,k,e){if(opt&&opt.closable!==false){dlg.hide();}
if(e){e.stopEvent();}};var updateButtons=function(b){var width=0;if(!b){buttons["ok"].hide();buttons["cancel"].hide();buttons["yes"].hide();buttons["no"].hide();return width;}
dlg.footer.dom.style.display='';for(var k in buttons){if(typeof buttons[k]!="function"){if(b[k]){buttons[k].show();buttons[k].setText(typeof b[k]=="string"?b[k]:L5.MessageBox.buttonText[k]);width+=buttons[k].el.getWidth()+15;}else{buttons[k].hide();}}}
return width;};return{getDialog:function(titleText){if(!dlg){dlg=new L5.Window({autoCreate:true,title:titleText,resizable:false,constrain:true,constrainHeader:true,minimizable:false,maximizable:false,stateful:false,modal:true,shim:true,buttonAlign:"center",width:400,height:100,minHeight:80,plain:true,footer:true,closable:true,close:function(){if(opt&&opt.buttons&&opt.buttons.no&&!opt.buttons.cancel){handleButton("close");}else{handleButton("close");}}});buttons={};var bt=this.buttonText;buttons["ok"]=dlg.addButton(bt["ok"],handleButton.createCallback("ok"));buttons["yes"]=dlg.addButton(bt["yes"],handleButton.createCallback("yes"));buttons["no"]=dlg.addButton(bt["no"],handleButton.createCallback("no"));buttons["cancel"]=dlg.addButton(bt["cancel"],handleButton.createCallback("cancel"));buttons["ok"].hideMode=buttons["yes"].hideMode=buttons["no"].hideMode=buttons["cancel"].hideMode='offsets';dlg.render(document.body);dlg.getEl().addClass('l-window-dlg');mask=dlg.mask;bodyEl=dlg.body.createChild({html:'<div class="L5-mb-icon"></div><div class="L5-mb-content"><span class="L5-mb-text"></span><br /><div class="L5-mb-fix-cursor"><input type="text" class="L5-mb-input" /><textarea class="L5-mb-textarea"></textarea></div></div>'});iconEl=L5.get(bodyEl.dom.firstChild);var contentEl=bodyEl.dom.childNodes[1];msgEl=L5.get(contentEl.firstChild);textboxEl=L5.get(contentEl.childNodes[2].firstChild);textboxEl.enableDisplayMode();textboxEl.addKeyListener([10,13],function(){if(dlg.isVisible()&&opt&&opt.buttons){if(opt.buttons.ok){handleButton("ok");}else if(opt.buttons.yes){handleButton("yes");}}});textareaEl=L5.get(contentEl.childNodes[2].childNodes[1]);textareaEl.enableDisplayMode();progressBar=new L5.ProgressBar({renderTo:bodyEl});bodyEl.createChild({cls:'l-clear'});}
return dlg;},updateText:function(text){if(text&&text.replace){text=text.replace(/\n/g,"<br>");if((text.lastIndexOf("<br>")+4)==text.length){text=text.substring(0,text.lastIndexOf("<br>"));}}
if(!dlg.isVisible()&&!opt.width){dlg.setSize(this.maxWidth,100);}
msgEl.update(text||'&#160;');var iw=iconCls!=''?(iconEl.getWidth()+iconEl.getMargins('lr')):0;var mw=msgEl.getWidth()+msgEl.getMargins('lr');var fw=dlg.getFrameWidth('lr');var bw=dlg.body.getFrameWidth('lr');if(L5.isIE&&iw>0){iw+=3;}
var w=Math.max(Math.min(opt.width||iw+mw+fw+bw,this.maxWidth),Math.max(opt.minWidth||this.minWidth,bwidth||0));if(opt.prompt===true){activeTextEl.setWidth(w-iw-fw-bw);}
if(opt.progress===true||opt.wait===true){progressBar.setSize(w-iw-fw-bw);}
if(L5.isIE&&w==bwidth){w+=4;}
dlg.setSize(w,'auto').center();return this;},updateProgress:function(value,progressText,msg){if(value||value==0){progressBar.updateProgress(value);}
if(progressText)
progressBar.updateText(progressText);if(msg){this.updateText(msg);}
return this;},isVisible:function(){return dlg&&dlg.isVisible();},hide:function(){var proxy=dlg.activeGhost;if(this.isVisible()||proxy){dlg.hide();handleHide();if(proxy){proxy.hide();}}
return this;},show:function(options){if(this.isVisible()){this.hide();}
opt=options;var d=this.getDialog(opt.title||"&#160;");d.setTitle(opt.title||"&#160;");var allowClose=(opt.closable!==false&&opt.progress!==true&&opt.wait!==true);d.tools.close.setDisplayed(allowClose);activeTextEl=textboxEl;opt.prompt=opt.prompt||(opt.multiline?true:false);if(opt.prompt){if(opt.multiline){textboxEl.hide();textareaEl.show();textareaEl.setHeight(typeof opt.multiline=="number"?opt.multiline:this.defaultTextHeight);activeTextEl=textareaEl;}else{textboxEl.show();textareaEl.hide();}}else{textboxEl.hide();textareaEl.hide();}
activeTextEl.dom.value=opt.value||"";if(opt.prompt){d.focusEl=activeTextEl;}else{var bs=opt.buttons;var db=null;if(bs&&bs.ok){db=buttons["ok"];}else if(bs&&bs.yes){db=buttons["yes"];}
if(db){d.focusEl=db;}}
if(opt.iconCls){d.setIconClass(opt.iconCls);}
this.setIcon(opt.icon);bwidth=updateButtons(opt.buttons);progressBar.setVisible(opt.progress===true||opt.wait===true);this.updateProgress(0,opt.progressText);this.updateText(opt.msg);if(opt.cls){d.el.addClass(opt.cls);}
d.proxyDrag=opt.proxyDrag===true;d.modal=opt.modal!==false;d.mask=opt.modal!==false?mask:false;if(!d.isVisible()){document.body.appendChild(dlg.el.dom);d.setAnimateTarget(opt.animEl);d.show(opt.animEl);}
d.on('show',function(){if(allowClose===true){d.keyMap.enable();}else{d.keyMap.disable();}},this,{single:true});if(opt.wait===true){progressBar.wait(opt.waitConfig);}
return this;},setIcon:function(icon){if(icon&&icon!=''){iconEl.removeClass('l-hidden');iconEl.replaceClass(iconCls,icon);iconCls=icon;}else{iconEl.replaceClass(iconCls,'l-hidden');iconCls='';}
return this;},progress:function(title,msg,progressText){this.show({title:title,msg:msg,buttons:false,progress:true,closable:false,minWidth:this.minProgressWidth,progressText:progressText});return this;},wait:function(msg,title,config){this.show({title:title,msg:msg,buttons:false,closable:false,wait:true,modal:true,minWidth:this.minProgressWidth,waitConfig:config});return this;},alert:function(title,msg,fn,scope){this.show({title:title,msg:msg,buttons:this.OK,fn:fn,minWidth:130,scope:scope});return this;},confirm:function(title,msg,fn,scope){this.show({title:title,msg:msg,buttons:this.YESNO,fn:fn,scope:scope,icon:this.QUESTION});return this;},showMsg:function(title,msg,seconds){this.show({title:title,msg:msg,modal:true,minWidth:130});seconds=seconds||1500;(function(){L5.Msg.hide();}).defer(seconds,this);return this;},prompt:function(title,msg,fn,scope,multiline,value){this.show({title:title,msg:msg,buttons:this.OKCANCEL,fn:fn,minWidth:250,scope:scope,prompt:true,multiline:multiline,value:value});return this;},OK:{ok:true},CANCEL:{cancel:true},OKCANCEL:{ok:true,cancel:true},YESNO:{yes:true,no:true},YESNOCANCEL:{yes:true,no:true,cancel:true},INFO:'L5-mb-info',WARNING:'L5-mb-warning',QUESTION:'L5-mb-question',ERROR:'L5-mb-error',defaultTextHeight:75,maxWidth:600,minWidth:100,minProgressWidth:250,buttonText:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"}};}();L5.Msg=L5.MessageBox;

L5.Tip=L5.extend(L5.Panel,{minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"tl-bl?",autoRender:true,quickShowInterval:250,frame:true,hidden:true,baseCls:'l-tip',floating:{shadow:true,shim:true,useDisplay:true,constrain:false},autoHeight:true,initComponent:function(){L5.Tip.superclass.initComponent.call(this);if(this.closable&&!this.title){this.elements+=',header';}},afterRender:function(){L5.Tip.superclass.afterRender.call(this);if(this.closable){this.addTool({id:'close',handler:this.hide,scope:this});}},showAt:function(xy){L5.Tip.superclass.show.call(this);if(this.measureWidth!==false&&(!this.initialConfig||typeof this.initialConfig.width!='number')){this.doAutoWidth();}
if(this.constrainPosition){xy=this.el.adjustForConstraints(xy);}
this.setPagePosition(xy[0],xy[1]);},doAutoWidth:function(){var bw=this.body.getTextWidth();if(this.title){bw=Math.max(bw,this.header.child('span').getTextWidth(this.title));}
bw+=this.getFrameWidth()+(this.closable?20:0)+this.body.getPadding("lr");this.setWidth(bw.constrain(this.minWidth,this.maxWidth));if(L5.isIE7&&!this.repainted){this.el.repaint();this.repainted=true;}},showBy:function(el,pos){if(!this.rendered){this.render(L5.getBody());}
this.showAt(this.el.getAlignToXY(el,pos||this.defaultAlign));},initDraggable:function(){this.dd=new L5.Tip.DD(this,typeof this.draggable=='boolean'?null:this.draggable);this.header.addClass('l-tip-draggable');}});L5.Tip.DD=function(tip,config){L5.apply(this,config);this.tip=tip;L5.Tip.DD.superclass.constructor.call(this,tip.el.id,'WindowDD-'+tip.id);this.setHandleElId(tip.header.id);this.scroll=false;};L5.extend(L5.Tip.DD,L5.dd.DD,{moveOnly:true,scroll:false,headerOffsets:[100,25],startDrag:function(){this.tip.el.disableShadow();},endDrag:function(e){this.tip.el.enableShadow(true);}});

L5.ToolTip=L5.extend(L5.Tip,{showDelay:500,hideDelay:200,dismissDelay:5000,mouseOffset:[15,18],trackMouse:false,constrainPosition:true,initComponent:function(){L5.ToolTip.superclass.initComponent.call(this);this.lastActive=new Date();this.initTarget();},initTarget:function(){if(this.target){this.target=L5.get(this.target);this.target.on('mouseover',this.onTargetOver,this);this.target.on('mouseout',this.onTargetOut,this);this.target.on('mousemove',this.onMouseMove,this);}},onMouseMove:function(e){this.targetXY=e.getXY();if(!this.hidden&&this.trackMouse){this.setPagePosition(this.getTargetXY());}},getTargetXY:function(){return[this.targetXY[0]+this.mouseOffset[0],this.targetXY[1]+this.mouseOffset[1]];},onTargetOver:function(e){if(this.disabled||e.within(this.target.dom,true)){return;}
this.clearTimer('hide');this.targetXY=e.getXY();this.delayShow();},delayShow:function(){if(this.hidden&&!this.showTimer){if(this.lastActive.getElapsed()<this.quickShowInterval){this.show();}else{this.showTimer=this.show.defer(this.showDelay,this);}}else if(!this.hidden&&this.autoHide!==false){this.show();}},onTargetOut:function(e){if(this.disabled||e.within(this.target.dom,true)){return;}
this.clearTimer('show');if(this.autoHide!==false){this.delayHide();}},delayHide:function(){if(!this.hidden&&!this.hideTimer){this.hideTimer=this.hide.defer(this.hideDelay,this);}},hide:function(){this.clearTimer('dismiss');this.lastActive=new Date();L5.ToolTip.superclass.hide.call(this);},show:function(){this.showAt(this.getTargetXY());},showAt:function(xy){this.lastActive=new Date();this.clearTimers();L5.ToolTip.superclass.showAt.call(this,xy);if(this.dismissDelay&&this.autoHide!==false){this.dismissTimer=this.hide.defer(this.dismissDelay,this);}},clearTimer:function(name){name=name+'Timer';clearTimeout(this[name]);delete this[name];},clearTimers:function(){this.clearTimer('show');this.clearTimer('dismiss');this.clearTimer('hide');},onShow:function(){L5.ToolTip.superclass.onShow.call(this);L5.getDoc().on('mousedown',this.onDocMouseDown,this);},onHide:function(){L5.ToolTip.superclass.onHide.call(this);L5.getDoc().un('mousedown',this.onDocMouseDown,this);},onDocMouseDown:function(e){if(this.autoHide!==false&&!e.within(this.el.dom)){this.disable();this.enable.defer(100,this);}},onDisable:function(){this.clearTimers();this.hide();},adjustPosition:function(x,y){var ay=this.targetXY[1],h=this.getSize().height;if(this.constrainPosition&&y<=ay&&(y+h)>=ay){y=ay-h-5;}
return{x:x,y:y};},onDestroy:function(){L5.ToolTip.superclass.onDestroy.call(this);if(this.target){this.target.un('mouseover',this.onTargetOver,this);this.target.un('mouseout',this.onTargetOut,this);this.target.un('mousemove',this.onMouseMove,this);}}});

L5.QuickTip=L5.extend(L5.ToolTip,{interceptTitles:false,tagConfig:{namespace:"L5",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign"},initComponent:function(){this.target=this.target||L5.getDoc();this.targets=this.targets||{};L5.QuickTip.superclass.initComponent.call(this);},register:function(config){var cs=L5.isArray(config)?config:arguments;for(var i=0,len=cs.length;i<len;i++){var c=cs[i];var target=c.target;if(target){if(L5.isArray(target)){for(var j=0,jlen=target.length;j<jlen;j++){this.targets[L5.id(target[j])]=c;}}else{this.targets[L5.id(target)]=c;}}}},unregister:function(el){delete this.targets[L5.id(el)];},onTargetOver:function(e){if(this.disabled){return;}
this.targetXY=e.getXY();var t=e.getTarget();if(!t||t.nodeType!==1||t==document||t==document.body){return;}
if(this.activeTarget&&t==this.activeTarget.el){this.clearTimer('hide');this.show();return;}
if(t&&this.targets[t.id]){this.activeTarget=this.targets[t.id];this.activeTarget.el=t;this.delayShow();return;}
var ttp,et=L5.fly(t),cfg=this.tagConfig;var ns=cfg.namespace;if(this.interceptTitles&&t.title){ttp=t.title;t.qtip=ttp;t.removeAttribute("title");e.preventDefault();}else{ttp=t.qtip||et.getAttributeNS(ns,cfg.attribute);}
if(ttp){var autoHide=et.getAttributeNS(ns,cfg.hide);this.activeTarget={el:t,text:ttp,width:et.getAttributeNS(ns,cfg.width),autoHide:autoHide!="user"&&autoHide!=='false',title:et.getAttributeNS(ns,cfg.title),cls:et.getAttributeNS(ns,cfg.cls),align:et.getAttributeNS(ns,cfg.align)};this.delayShow();}},onTargetOut:function(e){this.clearTimer('show');if(this.autoHide!==false){this.delayHide();}},showAt:function(xy){var t=this.activeTarget;if(t){if(!this.rendered){this.render(L5.getBody());this.activeTarget=t;}
if(t.width){this.setWidth(t.width);this.body.setWidth(this.adjustBodyWidth(t.width-this.getFrameWidth()));this.measureWidth=false;}else{this.measureWidth=true;}
this.setTitle(t.title||'');this.body.update(t.text);this.autoHide=t.autoHide;this.dismissDelay=t.dismissDelay||this.dismissDelay;if(this.lastCls){this.el.removeClass(this.lastCls);delete this.lastCls;}
if(t.cls){this.el.addClass(t.cls);this.lastCls=t.cls;}
if(t.align){xy=this.el.getAlignToXY(t.el,t.align);this.constrainPosition=false;}else{this.constrainPosition=true;}}
L5.QuickTip.superclass.showAt.call(this,xy);},hide:function(){delete this.activeTarget;L5.QuickTip.superclass.hide.call(this);}});

L5.QuickTips=function(){var tip,locks=[];return{init:function(autoRender){if(!tip){if(!L5.isReady){L5.onReady(function(){L5.QuickTips.init(autoRender);});return;}
tip=new L5.QuickTip({elements:'header,body'});if(autoRender!==false){tip.render(L5.getBody());}}},enable:function(){if(tip){locks.pop();if(locks.length<1){tip.enable();}}},disable:function(){if(tip){tip.disable();}
locks.push(1);},isEnabled:function(){return tip!==undefined&&!tip.disabled;},getQuickTip:function(){return tip;},register:function(){tip.register.apply(tip,arguments);},unregister:function(){tip.unregister.apply(tip,arguments);},tips:function(){tip.register.apply(tip,arguments);}}}();

L5.menu.Menu=function(config){if(L5.isArray(config)){config={items:config};}
L5.apply(this,config);this.id=this.id||L5.id();this.addEvents('beforeshow','beforehide','show','hide','click','mouseover','mouseout','itemclick','contextmenu','add','remove');L5.menu.MenuMgr.register(this);L5.menu.Menu.superclass.constructor.call(this);var mis=this.items;this.items=new L5.util.MixedCollection();if(mis){this.add.apply(this,mis);}};L5.extend(L5.menu.Menu,L5.util.Observable,{minWidth:120,shadow:"sides",subMenuAlign:"tl-tr?",defaultAlign:"tl-bl?",allowOtherMenus:false,ignoreParentClicks:false,hidden:true,autoScroll:false,maxItemNum:5,createEl:function(){return new L5.Layer({cls:"l-menu",shadow:this.shadow,constrain:false,parentEl:this.parentEl||document.body,zindex:15000});},render:function(){if(this.el){return;}
var el=this.el=this.createEl();if(!this.keyNav){this.keyNav=new L5.menu.MenuNav(this);}
if(this.plain){el.addClass("l-menu-plain");}
if(this.cls){el.addClass(this.cls);}
this.focusEl=el.createChild({tag:"a",cls:"l-menu-focus",href:"#",onclick:"return false;",tabIndex:"-1"});var ul=el.createChild({tag:"ul",cls:"l-menu-list"});ul.on("contextmenu",this.contextmenu,this);ul.on("click",this.onClick,this);ul.on("mouseover",this.onMouseOver,this);ul.on("mouseout",this.onMouseOut,this);this.items.each(function(item){var li=document.createElement("li");li.className="l-menu-list-item";ul.dom.appendChild(li);item.render(li,this);},this);this.ul=ul;this.autoWidth();if(this.autoScroll){if(this.items.length>this.maxItemNum){this.ul.parent().dom.style.height=this.maxItemNum*23+"px";this.ul.parent().dom.style.overflowY="scroll";}}
this.on("add",this.setAutoScroll,this);this.on("remove",this.setAutoScroll,this);},setAutoScroll:function(){if(this.autoScroll){if(this.items.length>this.maxItemNum){this.ul.parent().dom.style.height=this.maxItemNum*23+"px";this.ul.parent().dom.style.overflowY="scroll";}else{this.ul.parent().dom.style.height=this.items.length*23+"px";this.ul.parent().dom.style.overflowY="hidden";}}},autoWidth:function(){var el=this.el,ul=this.ul;if(!el){return;}
var w=this.width;if(w){el.setWidth(w);}else if(L5.isIE){el.setWidth(this.minWidth);var t=el.dom.offsetWidth;el.setWidth(ul.getWidth()+el.getFrameWidth("lr"));}},delayAutoWidth:function(){if(this.el){if(!this.awTask){this.awTask=new L5.util.DelayedTask(this.autoWidth,this);}
this.awTask.delay(20);}},findTargetItem:function(e){var t=e.getTarget(".l-menu-list-item",this.ul,true);if(t&&t.menuItemId){return this.items.get(t.menuItemId);}},onClick:function(e){var t;if(t=this.findTargetItem(e)){if(t.menu&&this.ignoreParentClicks){t.expandMenu();}else{t.onClick(e);this.fireEvent("click",this,t,e);}}},nocontextmenu:function(e){if(document.all)
window.event.returnValue=false;else
e.preventDefault();return false;},contextmenu:function(e){if(window.Event)
e=window.Event||e;document.oncontextmenu=this.nocontextmenu;},setActiveItem:function(item,autoExpand){if(item!=this.activeItem){if(this.activeItem){this.activeItem.deactivate();}
this.activeItem=item;item.activate(autoExpand);}else if(autoExpand){item.expandMenu();}},tryActivate:function(start,step){var items=this.items;for(var i=start,len=items.length;i>=0&&i<len;i+=step){var item=items.get(i);if(!item.disabled&&item.canActivate){this.setActiveItem(item,false);return item;}}
return false;},onMouseOver:function(e){var t;if(t=this.findTargetItem(e)){if(t.canActivate&&!t.disabled){this.setActiveItem(t,true);}}
this.over=true;this.fireEvent("mouseover",this,e,t);},onMouseOut:function(e){var t;if(t=this.findTargetItem(e)){if(t==this.activeItem&&t.shouldDeactivate(e)){this.activeItem.deactivate();delete this.activeItem;}}
this.over=false;this.fireEvent("mouseout",this,e,t);},isVisible:function(){return this.el&&!this.hidden;},show:function(el,pos,parentMenu){this.parentMenu=parentMenu;if(!this.el){this.render();}
this.fireEvent("beforeshow",this);this.showAt(this.el.getAlignToXY(el,pos||this.defaultAlign),parentMenu,false);},showAt:function(xy,parentMenu,_e){this.parentMenu=parentMenu;if(!this.el){this.render();}
if(_e!==false){this.fireEvent("beforeshow",this);xy=this.el.adjustForConstraints(xy);}
this.el.setXY(xy);this.el.show();this.hidden=false;this.focus();this.fireEvent("show",this);},focus:function(){if(!this.hidden){this.doFocus.defer(50,this);}},doFocus:function(){if(!this.hidden){this.focusEl.focus();}},hide:function(deep){if(this.el&&this.isVisible()){this.fireEvent("beforehide",this);if(this.activeItem){this.activeItem.deactivate();this.activeItem=null;}
this.el.hide();this.hidden=true;this.fireEvent("hide",this);}
if(deep===true&&this.parentMenu){this.parentMenu.hide(true);}},add:function(){var a=arguments,l=a.length,item;for(var i=0;i<l;i++){var el=a[i];if(el.render){item=this.addItem(el);}else if(typeof el=="string"){if(el=="separator"||el=="-"){item=this.addSeparator();}else{item=this.addText(el);}}else if(el.tagName||el.el){item=this.addElement(el);}else if(typeof el=="object"){L5.applyIf(el,this.defaults);item=this.addMenuItem(el);}}
return item;},getEl:function(){if(!this.el){this.render();}
return this.el;},addSeparator:function(){return this.addItem(new L5.menu.Separator());},addElement:function(el){return this.addItem(new L5.menu.BaseItem(el));},addItem:function(item){this.items.add(item);if(this.ul){var li=document.createElement("li");li.className="l-menu-list-item";this.ul.dom.appendChild(li);item.render(li,this);this.delayAutoWidth();}
this.fireEvent("add",this,item);return item;},addMenuItem:function(config){if(!(config instanceof L5.menu.Item)){if(typeof config.checked=="boolean"){config=new L5.menu.CheckItem(config);}else{config=new L5.menu.Item(config);}}
return this.addItem(config);},addText:function(text){return this.addItem(new L5.menu.TextItem(text));},insert:function(index,item){this.items.insert(index,item);if(this.ul){var li=document.createElement("li");li.className="l-menu-list-item";this.ul.dom.insertBefore(li,this.ul.dom.childNodes[index]);item.render(li,this);this.delayAutoWidth();}
this.fireEvent("add",this,item,index);return item;},remove:function(item){this.items.removeKey(item.id);item.destroy();this.fireEvent("remove",this,item);},removeAll:function(){if(this.items){var f;while(f=this.items.first()){this.remove(f);}}},destroy:function(){this.beforeDestroy();L5.menu.MenuMgr.unregister(this);if(this.keyNav){this.keyNav.disable();}
this.removeAll();if(this.ul){this.ul.removeAllListeners();}
if(this.el){this.el.destroy();}},beforeDestroy:L5.emptyFn});L5.menu.MenuNav=function(menu){L5.menu.MenuNav.superclass.constructor.call(this,menu.el);this.scope=this.menu=menu;};L5.extend(L5.menu.MenuNav,L5.KeyNav,{doRelay:function(e,h){var k=e.getKey();if(!this.menu.activeItem&&e.isNavKeyPress()&&k!=e.SPACE&&k!=e.RETURN){this.menu.tryActivate(0,1);return false;}
return h.call(this.scope||this,e,this.menu);},up:function(e,m){if(!m.tryActivate(m.items.indexOf(m.activeItem)-1,-1)){m.tryActivate(m.items.length-1,-1);}},down:function(e,m){if(!m.tryActivate(m.items.indexOf(m.activeItem)+1,1)){m.tryActivate(0,1);}},right:function(e,m){if(m.activeItem){m.activeItem.expandMenu(true);}},left:function(e,m){m.hide();if(m.parentMenu&&m.parentMenu.activeItem){m.parentMenu.activeItem.activate();}},enter:function(e,m){if(m.activeItem){e.stopPropagation();m.activeItem.onClick(e);m.fireEvent("click",this,m.activeItem);return true;}}});

L5.menu.MenuMgr=function(){var menus,active,groups={},attached=false,lastShow=new Date();function init(){menus={};active=new L5.util.MixedCollection();L5.getDoc().addKeyListener(27,function(){if(active.length>0){hideAll();}});}
function hideAll(){if(active&&active.length>0){var c=active.clone();c.each(function(m){m.hide();});}}
function onHide(m){active.remove(m);if(active.length<1){L5.getDoc().un("mousedown",onMouseDown);attached=false;}}
function onShow(m){var last=active.last();lastShow=new Date();active.add(m);if(!attached){L5.getDoc().on("mousedown",onMouseDown);attached=true;}
if(m.parentMenu){m.getEl().setZIndex(parseInt(m.parentMenu.getEl().getStyle("z-index"),10)+3);m.parentMenu.activeChild=m;}else if(last&&last.isVisible()){m.getEl().setZIndex(parseInt(last.getEl().getStyle("z-index"),10)+3);}}
function onBeforeHide(m){if(m.activeChild){m.activeChild.hide();}
if(m.autoHideTimer){clearTimeout(m.autoHideTimer);delete m.autoHideTimer;}}
function onBeforeShow(m){var pm=m.parentMenu;if(!pm&&!m.allowOtherMenus){hideAll();}else if(pm&&pm.activeChild){pm.activeChild.hide();}}
function onMouseDown(e){if(lastShow.getElapsed()>50&&active.length>0&&!e.getTarget(".l-menu")){hideAll();}}
function onBeforeCheck(mi,state){if(state){var g=groups[mi.group];for(var i=0,l=g.length;i<l;i++){if(g[i]!=mi){g[i].setChecked(false);}}}}
return{hideAll:function(){hideAll();},register:function(menu){if(!menus){init();}
menus[menu.id]=menu;menu.on("beforehide",onBeforeHide);menu.on("hide",onHide);menu.on("beforeshow",onBeforeShow);menu.on("show",onShow);var g=menu.group;if(g&&menu.events["checkchange"]){if(!groups[g]){groups[g]=[];}
groups[g].push(menu);menu.on("checkchange",onCheck);}},get:function(menu){if(typeof menu=="string"){if(!menus){return null;}
return menus[menu];}else if(menu.events){return menu;}else if(typeof menu.length=='number'){return new L5.menu.Menu({items:menu});}else{return new L5.menu.Menu(menu);}},unregister:function(menu){delete menus[menu.id];menu.un("beforehide",onBeforeHide);menu.un("hide",onHide);menu.un("beforeshow",onBeforeShow);menu.un("show",onShow);var g=menu.group;if(g&&menu.events["checkchange"]){groups[g].remove(menu);menu.un("checkchange",onCheck);}},registerCheckable:function(menuItem){var g=menuItem.group;if(g){if(!groups[g]){groups[g]=[];}
groups[g].push(menuItem);menuItem.on("beforecheckchange",onBeforeCheck);}},unregisterCheckable:function(menuItem){var g=menuItem.group;if(g){groups[g].remove(menuItem);menuItem.un("beforecheckchange",onBeforeCheck);}},getCheckedItem:function(groupId){var g=groups[groupId];if(g){for(var i=0,l=g.length;i<l;i++){if(g[i].checked){return g[i];}}}
return null;},setCheckedItem:function(groupId,itemId){var g=groups[groupId];if(g){for(var i=0,l=g.length;i<l;i++){if(g[i].id==itemId){g[i].setChecked(true);}}}
return null;}};}();

L5.menu.BaseItem=function(config){L5.menu.BaseItem.superclass.constructor.call(this,config);this.addEvents('click','activate','deactivate');if(this.handler){this.on("click",this.handler,this.scope);}};L5.extend(L5.menu.BaseItem,L5.Component,{canActivate:false,activeClass:"l-menu-item-active",hideOnClick:true,hideDelay:100,ctype:"L5.menu.BaseItem",actionMode:"container",render:function(container,parentMenu){this.parentMenu=parentMenu;L5.menu.BaseItem.superclass.render.call(this,container);this.container.menuItemId=this.id;},onRender:function(container,position){this.el=L5.get(this.el);if(this.id){this.el.id=this.id;}
container.dom.appendChild(this.el.dom);},setHandler:function(handler,scope){if(this.handler){this.un("click",this.handler,this.scope);}
this.on("click",this.handler=handler,this.scope=scope);},onClick:function(e){if(!this.disabled&&this.fireEvent("click",this,e)!==false&&this.parentMenu.fireEvent("itemclick",this,e)!==false){this.handleClick(e);}else{e.stopEvent();}},activate:function(){if(this.disabled){return false;}
var li=this.container;li.addClass(this.activeClass);this.region=li.getRegion().adjust(2,2,-2,-2);this.fireEvent("activate",this);return true;},deactivate:function(){this.container.removeClass(this.activeClass);this.fireEvent("deactivate",this);},shouldDeactivate:function(e){return!this.region||!this.region.contains(e.getPoint());},handleClick:function(e){if(this.hideOnClick){this.parentMenu.hide.defer(this.hideDelay,this.parentMenu,[true]);}},expandMenu:function(autoActivate){},hideMenu:function(){}});

L5.menu.TextItem=function(cfg){if(typeof cfg=='string'){cfg={text:cfg}}
L5.menu.TextItem.superclass.constructor.call(this,cfg);};L5.extend(L5.menu.TextItem,L5.menu.BaseItem,{hideOnClick:false,itemCls:"l-menu-text",onRender:function(){var s=document.createElement("span");s.className=this.itemCls;s.innerHTML=this.text;this.el=s;L5.menu.TextItem.superclass.onRender.apply(this,arguments);}});

L5.menu.Separator=function(config){L5.menu.Separator.superclass.constructor.call(this,config);};L5.extend(L5.menu.Separator,L5.menu.BaseItem,{itemCls:"l-menu-sep",hideOnClick:false,onRender:function(li){var s=document.createElement("span");s.className=this.itemCls;s.innerHTML="&#160;";this.el=s;li.addClass("l-menu-sep-li");L5.menu.Separator.superclass.onRender.apply(this,arguments);}});

L5.menu.Item=function(config){L5.menu.Item.superclass.constructor.call(this,config);if(this.menu){this.menu=L5.menu.MenuMgr.get(this.menu);}};L5.extend(L5.menu.Item,L5.menu.BaseItem,{itemCls:"l-menu-item",canActivate:true,showDelay:200,hideDelay:200,ctype:"L5.menu.Item",onRender:function(container,position){var el=document.createElement("a");el.hideFocus=true;el.unselectable="on";el.href=this.href||"#";if(this.hrefTarget){el.target=this.hrefTarget;}
el.className=this.itemCls+(this.menu?" l-menu-item-arrow":"")+(this.cls?" "+this.cls:"");el.innerHTML=String.format('<img src="{0}" class="l-menu-item-icon {2}" />{1}',this.icon||L5.BLANK_IMAGE_URL,this.itemText||this.text,this.iconCls||'');this.el=el;L5.menu.Item.superclass.onRender.call(this,container,position);},setText:function(text){this.text=text;if(this.rendered){this.el.update(String.format('<img src="{0}" class="l-menu-item-icon {2}">{1}',this.icon||L5.BLANK_IMAGE_URL,this.text,this.iconCls||''));this.parentMenu.autoWidth();}},setIconClass:function(cls){var oldCls=this.iconCls;this.iconCls=cls;if(this.rendered){this.el.child('img.l-menu-item-icon').replaceClass(oldCls,this.iconCls);}},beforeDestroy:function(){if(this.menu){this.menu.destroy();}
L5.menu.Item.superclass.beforeDestroy.call(this);},handleClick:function(e){if(!this.href){e.stopEvent();}
L5.menu.Item.superclass.handleClick.apply(this,arguments);},activate:function(autoExpand){if(L5.menu.Item.superclass.activate.apply(this,arguments)){this.focus();if(autoExpand){this.expandMenu();}}
return true;},shouldDeactivate:function(e){if(L5.menu.Item.superclass.shouldDeactivate.call(this,e)){if(this.menu&&this.menu.isVisible()){return!this.menu.getEl().getRegion().contains(e.getPoint());}
return true;}
return false;},deactivate:function(){L5.menu.Item.superclass.deactivate.apply(this,arguments);this.hideMenu();},expandMenu:function(autoActivate){if(!this.disabled&&this.menu){clearTimeout(this.hideTimer);delete this.hideTimer;if(!this.menu.isVisible()&&!this.showTimer){this.showTimer=this.deferExpand.defer(this.showDelay,this,[autoActivate]);}else if(this.menu.isVisible()&&autoActivate){this.menu.tryActivate(0,1);}}},deferExpand:function(autoActivate){delete this.showTimer;this.menu.show(this.container,this.parentMenu.subMenuAlign||"tl-tr?",this.parentMenu);if(autoActivate){this.menu.tryActivate(0,1);}},hideMenu:function(){clearTimeout(this.showTimer);delete this.showTimer;if(!this.hideTimer&&this.menu&&this.menu.isVisible()){this.hideTimer=this.deferHide.defer(this.hideDelay,this);}},deferHide:function(){delete this.hideTimer;if(this.menu.over){this.parentMenu.setActiveItem(this,false);}else{this.menu.hide();}}});

L5.menu.CheckItem=function(config){L5.menu.CheckItem.superclass.constructor.call(this,config);this.addEvents("beforecheckchange","checkchange");if(this.checkHandler){this.on('checkchange',this.checkHandler,this.scope);}
L5.menu.MenuMgr.registerCheckable(this);};L5.extend(L5.menu.CheckItem,L5.menu.Item,{itemCls:"l-menu-item l-menu-check-item",groupClass:"l-menu-group-item",checked:false,ctype:"L5.menu.CheckItem",onRender:function(c){L5.menu.CheckItem.superclass.onRender.apply(this,arguments);if(this.group){this.el.addClass(this.groupClass);}
if(this.checked){this.checked=false;this.setChecked(true,true);}},destroy:function(){L5.menu.MenuMgr.unregisterCheckable(this);L5.menu.CheckItem.superclass.destroy.apply(this,arguments);},setChecked:function(state,suppressEvent){if(this.checked!=state&&this.fireEvent("beforecheckchange",this,state)!==false){if(this.container){this.container[state?"addClass":"removeClass"]("l-menu-item-checked");}
this.checked=state;if(suppressEvent!==true){this.fireEvent("checkchange",this,state);}}},handleClick:function(e){if(!this.disabled&&!(this.checked&&this.group)){this.setChecked(!this.checked);}
L5.menu.CheckItem.superclass.handleClick.apply(this,arguments);}});

L5.menu.Adapter=function(component,config){L5.menu.Adapter.superclass.constructor.call(this,config);this.component=component;};L5.extend(L5.menu.Adapter,L5.menu.BaseItem,{canActivate:true,onRender:function(container,position){this.component.render(container);this.el=this.component.getEl();},activate:function(){if(this.disabled){return false;}
this.component.focus();this.fireEvent("activate",this);return true;},deactivate:function(){this.fireEvent("deactivate",this);},disable:function(){this.component.disable();L5.menu.Adapter.superclass.disable.call(this);},enable:function(){this.component.enable();L5.menu.Adapter.superclass.enable.call(this);}});

L5.menu.DateItem=function(config){L5.menu.DateItem.superclass.constructor.call(this,new L5.DatePicker(config),config);this.picker=this.component;this.addEvents('select');this.picker.on("render",function(picker){picker.getEl().swallowEvent("click");picker.container.addClass("l-menu-date-item");});this.picker.on("select",this.onSelect,this);};L5.extend(L5.menu.DateItem,L5.menu.Adapter,{onSelect:function(picker,date){this.fireEvent("select",this,date,picker);L5.menu.DateItem.superclass.handleClick.call(this);}});

L5.menu.DatetimeItem=function(config){L5.menu.DatetimeItem.superclass.constructor.call(this,new L5.DatetimePicker(config),config);this.picker=this.component;this.addEvents({select:true});this.picker.on("render",function(picker){picker.getEl().swallowEvent("click");picker.container.addClass("l-menu-date-item");});this.picker.on("select",this.onSelect,this);};L5.extend(L5.menu.DatetimeItem,L5.menu.Adapter,{onSelect:function(picker,date){this.fireEvent("select",this,date,picker);L5.menu.DatetimeItem.superclass.handleClick.call(this);}});

L5.menu.ColorItem=function(config){L5.menu.ColorItem.superclass.constructor.call(this,new L5.ColorPalette(config),config);this.palette=this.component;this.relayEvents(this.palette,["select"]);if(this.selectHandler){this.on('select',this.selectHandler,this.scope);}};L5.extend(L5.menu.ColorItem,L5.menu.Adapter);

L5.menu.DateMenu=function(config){L5.menu.DateMenu.superclass.constructor.call(this,config);this.plain=true;var di=new L5.menu.DateItem(config);this.add(di);this.picker=di.picker;this.relayEvents(di,["select"]);this.on('beforeshow',function(){if(this.picker){this.picker.hideMonthPicker(true);}},this);};L5.extend(L5.menu.DateMenu,L5.menu.Menu,{cls:'l-date-menu',beforeDestroy:function(){this.picker.destroy();}});

L5.menu.DatetimeMenu=function(config){L5.menu.DatetimeMenu.superclass.constructor.call(this,config);this.plain=true;var di=new L5.menu.DatetimeItem(config);this.add(di);this.picker=di.picker;this.relayEvents(di,["select"]);};L5.extend(L5.menu.DatetimeMenu,L5.menu.Menu,{cls:'l-date-menu'});

L5.menu.ColorMenu=function(config){L5.menu.ColorMenu.superclass.constructor.call(this,config);this.plain=true;var ci=new L5.menu.ColorItem(config);this.add(ci);this.palette=ci.palette;this.relayEvents(ci,["select"]);};L5.extend(L5.menu.ColorMenu,L5.menu.Menu,{beforeDestroy:function(){this.palette.destroy();}});

L5.form.Field=L5.extend(L5.BoxComponent,{invalidClass:"l-form-invalid",invalidText:"The value in this field is invalid",focusClass:"l-form-focus",validationEvent:"keyup",validateOnBlur:true,validationDelay:250,defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},fieldClass:"l-form-field",msgTarget:'qtip',msgFx:'normal',readOnly:false,disabled:false,isFormField:true,editable:true,hasFocus:false,initComponent:function(){L5.form.Field.superclass.initComponent.call(this);this.addEvents('focus','blur','specialkey','change','invalid','valid',"contextmenu");},getName:function(){return this.rendered&&this.el.dom.name?this.el.dom.name:(this.hiddenName||'');},onRender:function(ct,position){L5.form.Field.superclass.onRender.call(this,ct,position);if(!this.el){var cfg=this.getAutoCreate();if(!cfg.name){cfg.name=this.name||this.id;}
if(this.inputType){cfg.type=this.inputType;}
this.el=ct.createChild(cfg,position);}
var type=this.el.dom.type;if(type){if(type=='password'){type='text';}
this.el.addClass('l-form-'+type);}
if(this.readOnly){this.el.dom.readOnly=true;}
if(this.tabIndex!==undefined){this.el.dom.setAttribute('tabIndex',this.tabIndex);}
this.el.addClass([this.fieldClass,this.cls]);this.relayEvents(ct,"contextmenu");},initValue:function(){if(this.value!==undefined){this.setValue(this.value);}else if(this.el.dom.value.length>0&&this.el.dom.value!=this.emptyText){this.setValue(this.el.dom.value);}
this.originalValue=this.getValue();},isDirty:function(){if(this.disabled){return false;}
return String(this.getValue())!==String(this.originalValue);},afterRender:function(){L5.form.Field.superclass.afterRender.call(this);this.initEvents();this.initValue();},fireKey:function(e){if(e.isSpecialKey()){this.fireEvent("specialkey",this,e);}},reset:function(){this.setValue(this.originalValue);this.clearInvalid();},initEvents:function(){this.el.on(L5.isIE||L5.isSafari3?"keydown":"keypress",this.fireKey,this);this.el.on("focus",this.onFocus,this);this.el.on("contextmenu",this.onContextMenu,this);var o=this.inEditor&&L5.isWindows&&L5.isGecko?{buffer:10}:null;this.el.on("blur",this.onBlur,this,o);},onFocus:function(){if(this.focusClass){this.el.addClass(this.focusClass);}
if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this);}},onContextMenu:function(e,t){this.fireEvent("contextmenu",this,e);},beforeBlur:L5.emptyFn,onBlur:function(){this.beforeBlur();if(this.focusClass){this.el.removeClass(this.focusClass);}
this.hasFocus=false;if(this.validationEvent!==false&&this.validateOnBlur&&this.validationEvent!="blur"){this.validate();}
var v=this.getValue();if(String(v)!==String(this.startValue)){this.fireEvent('change',this,v,this.startValue);}
this.fireEvent("blur",this);},isValid:function(preventMark){if(this.disabled){return true;}
var restore=this.preventMark;this.preventMark=preventMark===true;var v=this.validateValue(this.processValue(this.getRawValue()));this.preventMark=restore;return v;},validate:function(){if(this.disabled||this.validateValue(this.processValue(this.getRawValue()))){this.clearInvalid();return true;}
return false;},processValue:function(value){return value;},validateValue:function(value){return true;},markInvalid:function(msg){if(!this.rendered||this.preventMark){return;}
this.el.addClass(this.invalidClass);msg=msg||this.invalidText;switch(this.msgTarget){case'qtip':this.el.dom.qtip=msg;this.el.dom.qclass='l-form-invalid-tip';if(L5.QuickTips){L5.QuickTips.enable();}
break;case'title':this.el.dom.title=msg;break;case'under':if(!this.errorEl){var elp=this.getErrorCt();if(!elp){this.el.dom.title=msg;break;}
this.errorEl=elp.createChild({cls:'l-form-invalid-msg'});this.errorEl.setWidth(elp.getWidth(true)-20);}
this.errorEl.update(msg);L5.form.Field.msgFx[this.msgFx].show(this.errorEl,this);break;case'side':if(!this.errorIcon){var elp=this.getErrorCt();if(!elp){this.el.dom.title=msg;break;}
this.errorIcon=elp.createChild({cls:'l-form-invalid-icon'});}
this.alignErrorIcon();this.errorIcon.dom.qtip=msg;this.errorIcon.dom.qclass='l-form-invalid-tip';this.errorIcon.show();this.on('resize',this.alignErrorIcon,this);break;default:var t=L5.getDom(this.msgTarget);t.innerHTML=msg;t.style.display=this.msgDisplay;break;}
this.fireEvent('invalid',this,msg);},getErrorCt:function(){return this.el.findParent('.l-form-element',5,true)||this.el.findParent('.l-form-field-wrap',5,true);},alignErrorIcon:function(){this.errorIcon.alignTo(this.el,'tl-tr',[2,0]);},clearInvalid:function(){if(!this.rendered||this.preventMark){return;}
this.el.removeClass(this.invalidClass);switch(this.msgTarget){case'qtip':this.el.dom.qtip='';break;case'title':this.el.dom.title='';break;case'under':if(this.errorEl){L5.form.Field.msgFx[this.msgFx].hide(this.errorEl,this);}
break;case'side':if(this.errorIcon){this.errorIcon.dom.qtip='';this.errorIcon.hide();this.un('resize',this.alignErrorIcon,this);}
break;default:var t=L5.getDom(this.msgTarget);t.innerHTML='';t.style.display='none';break;}
this.fireEvent('valid',this);},getRawValue:function(){var v=this.rendered?this.el.getValue():L5.value(this.value,'');if(v===this.emptyText){v='';}
return v;},getValue:function(){if(!this.rendered){return this.value;}
var v=this.el.getValue();if(v===this.emptyText||v===undefined){v='';}
return v;},setRawValue:function(v){return this.el.dom.value=(v===null||v===undefined?'':v);},setValue:function(v){this.value=v;if(this.rendered){this.el.dom.value=(v===null||v===undefined?'':v);this.validate();}},adjustSize:function(w,h){var s=L5.form.Field.superclass.adjustSize.call(this,w,h);s.width=this.adjustWidth(this.el.dom.tagName,s.width);return s;},adjustWidth:function(tag,w){tag=tag.toLowerCase();if(typeof w=='number'&&!L5.isSafari){if(L5.isIE&&(tag=='input'||tag=='textarea')){if(tag=='input'&&!L5.isStrict){return this.inEditor?w:w-3;}
if(tag=='input'&&L5.isStrict){return w-(L5.isIE6?4:1);}
if(tag=='textarea'&&L5.isStrict){return w-2;}}else if(L5.isOpera&&L5.isStrict){if(tag=='input'){return w+2;}
if(tag=='textarea'){return w-2;}}}
return w;}});L5.form.MessageTargets={'qtip':{mark:function(f){this.el.dom.qtip=msg;this.el.dom.qclass='l-form-invalid-tip';if(L5.QuickTips){L5.QuickTips.enable();}},clear:function(f){this.el.dom.qtip='';}},'title':{mark:function(f){this.el.dom.title=msg;},clear:function(f){this.el.dom.title='';}},'under':{mark:function(f){if(!this.errorEl){var elp=this.getErrorCt();if(!elp){this.el.dom.title=msg;return;}
this.errorEl=elp.createChild({cls:'l-form-invalid-msg'});this.errorEl.setWidth(elp.getWidth(true)-20);}
this.errorEl.update(msg);L5.form.Field.msgFx[this.msgFx].show(this.errorEl,this);},clear:function(f){if(this.errorEl){L5.form.Field.msgFx[this.msgFx].hide(this.errorEl,this);}else{this.el.dom.title='';}}},'side':{mark:function(f){if(!this.errorIcon){var elp=this.getErrorCt();if(!elp){this.el.dom.title=msg;return;}
this.errorIcon=elp.createChild({cls:'l-form-invalid-icon'});}
this.alignErrorIcon();this.errorIcon.dom.qtip=msg;this.errorIcon.dom.qclass='l-form-invalid-tip';this.errorIcon.show();this.on('resize',this.alignErrorIcon,this);},clear:function(f){if(this.errorIcon){this.errorIcon.dom.qtip='';this.errorIcon.hide();this.un('resize',this.alignErrorIcon,this);}else{this.el.dom.title='';}}},'around':{mark:function(f){},clear:function(f){}}};L5.form.Field.msgFx={normal:{show:function(msgEl,f){msgEl.setDisplayed('block');},hide:function(msgEl,f){msgEl.setDisplayed(false).update('');}},slide:{show:function(msgEl,f){msgEl.slideIn('t',{stopFx:true});},hide:function(msgEl,f){msgEl.slideOut('t',{stopFx:true,useDisplay:true});}},slideRight:{show:function(msgEl,f){msgEl.fixDisplay();msgEl.alignTo(f.el,'tl-tr');msgEl.slideIn('l',{stopFx:true});},hide:function(msgEl,f){msgEl.slideOut('l',{stopFx:true,useDisplay:true});}}};L5.reg('field',L5.form.Field);

L5.form.TextField=L5.extend(L5.form.Field,{grow:false,growMin:30,growMax:800,vtype:null,maskRe:null,disableKeyFilter:false,allowBlank:true,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",selectOnFocus:false,blankText:"This field is required",validator:null,regex:null,regexText:"",emptyText:null,emptyClass:'l-form-empty-field',initComponent:function(){L5.form.TextField.superclass.initComponent.call(this);this.addEvents('autosize','keydown','keyup','keypress');},initEvents:function(){L5.form.TextField.superclass.initEvents.call(this);if(this.validationEvent=='keyup'){this.validationTask=new L5.util.DelayedTask(this.validate,this);this.el.on('keyup',this.filterValidation,this);}
else if(this.validationEvent!==false){this.el.on(this.validationEvent,this.validate,this,{buffer:this.validationDelay});}
if(this.selectOnFocus||this.emptyText){this.on("focus",this.preFocus,this);this.el.on('mousedown',function(){if(!this.hasFocus){this.el.on('mouseup',function(e){e.preventDefault();},this,{single:true});}},this);if(this.emptyText){this.on('blur',this.postBlur,this);this.applyEmptyText();}}
if(this.maskRe||(this.vtype&&this.disableKeyFilter!==true&&(this.maskRe=L5.form.VTypes[this.vtype+'Mask']))){this.el.on("keypress",this.filterKeys,this);}
if(this.grow){this.el.on("keyup",this.onKeyUpBuffered,this,{buffer:50});this.el.on("click",this.autoSize,this);}
if(this.enableKeyEvents){this.el.on("keyup",this.onKeyUp,this);this.el.on("keydown",this.onKeyDown,this);this.el.on("keypress",this.onKeyPress,this);}},processValue:function(value){if(this.stripCharsRe){var newValue=value.replace(this.stripCharsRe,'');if(newValue!==value){this.setRawValue(newValue);return newValue;}}
return value;},filterValidation:function(e){if(!e.isNavKeyPress()){this.validationTask.delay(this.validationDelay);}},onDisable:function(){L5.form.TextField.superclass.onDisable.call(this);if(L5.isIE){this.el.dom.unselectable='on';}},onEnable:function(){L5.form.TextField.superclass.onEnable.call(this);if(L5.isIE){this.el.dom.unselectable='';}},onKeyUpBuffered:function(e){if(!e.isNavKeyPress()){this.autoSize();}},onKeyUp:function(e){this.fireEvent('keyup',this,e);},onKeyDown:function(e){this.fireEvent('keydown',this,e);},onKeyPress:function(e){this.fireEvent('keypress',this,e);},reset:function(){L5.form.TextField.superclass.reset.call(this);this.applyEmptyText();},applyEmptyText:function(){if(this.rendered&&this.emptyText&&this.getRawValue().length<1&&!this.hasFocus){this.setRawValue(this.emptyText);this.el.addClass(this.emptyClass);}},preFocus:function(){if(this.emptyText){if(this.el.dom.value==this.emptyText){this.setRawValue('');}
this.el.removeClass(this.emptyClass);}
if(this.selectOnFocus){this.el.dom.select();}},postBlur:function(){this.applyEmptyText();},filterKeys:function(e){if(e.ctrlKey){return;}
var k=e.getKey();if(L5.isGecko&&(e.isNavKeyPress()||k==e.BACKSPACE||(k==e.DELETE&&e.button==-1))){return;}
var c=e.getCharCode(),cc=String.fromCharCode(c);if(!L5.isGecko&&e.isSpecialKey()&&!cc){return;}
if(!this.maskRe.test(cc)){e.stopEvent();}},setValue:function(v){if(this.emptyText&&this.el&&v!==undefined&&v!==null&&v!==''){this.el.removeClass(this.emptyClass);}
L5.form.TextField.superclass.setValue.apply(this,arguments);this.applyEmptyText();this.autoSize();},validateValue:function(value){if(value.length<1||value===this.emptyText){if(this.allowBlank){this.clearInvalid();return true;}else{this.markInvalid(this.blankText);return false;}}
if(value.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false;}
if(value.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false;}
if(this.vtype){var vt=L5.form.VTypes;if(!vt[this.vtype](value,this)){this.markInvalid(this.vtypeText||vt[this.vtype+'Text']);return false;}}
if(typeof this.validator=="function"){var msg=this.validator(value);if(msg!==true){this.markInvalid(msg);return false;}}
if(this.regex&&!this.regex.test(value)){this.markInvalid(this.regexText);return false;}
return true;},selectText:function(start,end){var v=this.getRawValue();var doFocus=false;if(v.length>0){start=start===undefined?0:start;end=end===undefined?v.length:end;var d=this.el.dom;if(d.setSelectionRange){d.setSelectionRange(start,end);}else if(d.createTextRange){var range=d.createTextRange();range.moveStart("character",start);range.moveEnd("character",end-v.length);range.select();}
doFocus=L5.isGecko||L5.isOpera;}else{doFocus=true;}
if(doFocus){this.focus();}},autoSize:function(){if(!this.grow||!this.rendered){return;}
if(!this.metrics){this.metrics=L5.util.TextMetrics.createInstance(this.el);}
var el=this.el;var v=el.dom.value;var d=document.createElement('div');d.appendChild(document.createTextNode(v));v=d.innerHTML;L5.removeNode(d);d=null;v+="&#160;";var w=Math.min(this.growMax,Math.max(this.metrics.getWidth(v)+10,this.growMin));this.el.setWidth(w);this.fireEvent("autosize",this,w);}});L5.reg('textfield',L5.form.TextField);

L5.form.TriggerField=L5.extend(L5.form.TextField,{defaultAutoCreate:{tag:"input",type:"text",size:"16",autocomplete:"off"},hideTrigger:false,autoSize:L5.emptyFn,monitorTab:true,deferHeight:true,mimicing:false,onResize:function(w,h){L5.form.TriggerField.superclass.onResize.call(this,w,h);if(typeof w=='number'){this.el.setWidth(this.adjustWidth('input',w-this.trigger.getWidth()));}
this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth());},adjustSize:L5.BoxComponent.prototype.adjustSize,getResizeEl:function(){return this.wrap;},getPositionEl:function(){return this.wrap;},alignErrorIcon:function(){if(this.wrap){this.errorIcon.alignTo(this.wrap,'tl-tr',[2,0]);}},onRender:function(ct,position){L5.form.TriggerField.superclass.onRender.call(this,ct,position);this.wrap=this.el.wrap({cls:"l-form-field-wrap"});this.trigger=this.wrap.createChild(this.triggerConfig||{tag:"img",src:L5.BLANK_IMAGE_URL,cls:"l-form-trigger "+this.triggerClass});if(this.hideTrigger){this.trigger.setDisplayed(false);}
this.initTrigger();if(!this.width){this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth());}},afterRender:function(){L5.form.TriggerField.superclass.afterRender.call(this);var y;if(L5.isIE&&!this.hideTrigger&&this.el.getY()!=(y=this.trigger.getY())){this.el.position();this.el.setY(y);}},initTrigger:function(){this.trigger.on("click",this.onTriggerClick,this,{preventDefault:true});this.trigger.addClassOnOver('l-form-trigger-over');this.trigger.addClassOnClick('l-form-trigger-click');},onDestroy:function(){if(this.trigger){this.trigger.removeAllListeners();this.trigger.remove();}
if(this.wrap){this.wrap.remove();}
L5.form.TriggerField.superclass.onDestroy.call(this);},onFocus:function(){L5.form.TriggerField.superclass.onFocus.call(this);if(!this.mimicing){this.wrap.addClass('l-trigger-wrap-focus');this.mimicing=true;L5.get(L5.isIE?document.body:document).on("mousedown",this.mimicBlur,this,{delay:10});if(this.monitorTab){this.el.on("keydown",this.checkTab,this);}}},checkTab:function(e){if(e.getKey()==e.TAB){this.triggerBlur();}},onBlur:function(){},mimicBlur:function(e){if(!this.wrap.contains(e.target)&&this.validateBlur(e)){this.triggerBlur();}},triggerBlur:function(){this.mimicing=false;L5.get(L5.isIE?document.body:document).un("mousedown",this.mimicBlur,this);if(this.monitorTab&&this.el){this.el.un("keydown",this.checkTab,this);}
this.beforeBlur();if(this.wrap){this.wrap.removeClass('l-trigger-wrap-focus');}
L5.form.TriggerField.superclass.onBlur.call(this);},beforeBlur:L5.emptyFn,validateBlur:function(e){return true;},onDisable:function(){L5.form.TriggerField.superclass.onDisable.call(this);if(this.wrap){this.wrap.addClass(this.disabledClass);this.el.removeClass(this.disabledClass);}},onEnable:function(){L5.form.TriggerField.superclass.onEnable.call(this);if(this.wrap){this.wrap.removeClass(this.disabledClass);}},onShow:function(){if(this.wrap){this.wrap.dom.style.display='';this.wrap.dom.style.visibility='visible';}},onHide:function(){this.wrap.dom.style.display='none';},onTriggerClick:L5.emptyFn});L5.form.TwinTriggerField=L5.extend(L5.form.TriggerField,{initComponent:function(){L5.form.TwinTriggerField.superclass.initComponent.call(this);this.triggerConfig={tag:'span',cls:'l-form-twin-triggers',cn:[{tag:"img",src:L5.BLANK_IMAGE_URL,cls:"l-form-trigger "+this.trigger1Class},{tag:"img",src:L5.BLANK_IMAGE_URL,cls:"l-form-trigger "+this.trigger2Class}]};},getTrigger:function(index){return this.triggers[index];},initTrigger:function(){var ts=this.trigger.select('.l-form-trigger',true);this.wrap.setStyle('overflow','hidden');var triggerField=this;ts.each(function(t,all,index){t.hide=function(){var w=triggerField.wrap.getWidth();this.dom.style.display='none';triggerField.el.setWidth(w-triggerField.trigger.getWidth());};t.show=function(){var w=triggerField.wrap.getWidth();this.dom.style.display='';triggerField.el.setWidth(w-triggerField.trigger.getWidth());};var triggerIndex='Trigger'+(index+1);if(this['hide'+triggerIndex]){t.dom.style.display='none';}
t.on("click",this['on'+triggerIndex+'Click'],this,{preventDefault:true});t.addClassOnOver('l-form-trigger-over');t.addClassOnClick('l-form-trigger-click');},this);this.triggers=ts.elements;},onTrigger1Click:L5.emptyFn,onTrigger2Click:L5.emptyFn});L5.reg('trigger',L5.form.TriggerField);

L5.form.TextArea=L5.extend(L5.form.TextField,{growMin:21,growMax:1000,growAppend:'&#160;\n&#160;',growPad:0,enterIsSpecial:false,preventScrollbars:false,grow:true,onRender:function(ct,position){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"};}
L5.form.TextArea.superclass.onRender.call(this,ct,position);if(this.grow){this.textSizeEl=L5.DomHelper.append(document.body,{tag:"pre",cls:"l-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden");}
this.el.setHeight(this.growMin);}},onDestroy:function(){if(this.textSizeEl){L5.removeNode(this.textSizeEl);}
L5.form.TextArea.superclass.onDestroy.call(this);},fireKey:function(e){if(e.isSpecialKey()&&(this.enterIsSpecial||(e.getKey()!=e.ENTER||e.hasModifier()))){this.fireEvent("specialkey",this,e);}},onKeyUp:function(e){if(!e.isNavKeyPress()||e.getKey()==e.ENTER){this.autoSize();}
L5.form.TextArea.superclass.onKeyUp.call(this,e);},autoSize:function(){if(!this.grow||!this.textSizeEl){return;}
var el=this.el;var v=el.dom.value;var ts=this.textSizeEl;ts.innerHTML='';ts.appendChild(document.createTextNode(v));v=ts.innerHTML;L5.fly(ts).setWidth(this.el.getWidth());if(v.length<1){v="&#160;&#160;";}else{if(L5.isIE){v=v.replace(/\n/g,'<p>&#160;</p>');}
v+=this.growAppend;}
ts.innerHTML=v;var h;if(L5.isIE){h=Math.min(this.growMax,Math.max(ts.offsetHeight/2,this.growMin)+this.growPad);}else{h=Math.min(this.growMax,Math.max(ts.offsetHeight*0.7,this.growMin)+this.growPad);}
if(h!=this.lastHeight){this.lastHeight=h;this.el.setHeight(h);this.fireEvent("autosize",this,h);}}});L5.reg('textarea',L5.form.TextArea);

L5.form.NumberField=L5.extend(L5.form.TextField,{fieldClass:"l-form-field l-form-num-field",allowDecimals:true,decimalSeparator:".",decimalPrecision:2,allowNegative:true,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",baseChars:"0123456789",initEvents:function(){L5.form.NumberField.superclass.initEvents.call(this);var allowed=this.baseChars+'';if(this.allowDecimals){allowed+=this.decimalSeparator;}
if(this.allowNegative){allowed+="-";}
this.stripCharsRe=new RegExp('[^'+allowed+']','gi');var keyPress=function(e){var k=e.getKey();if(!L5.isIE&&(e.isSpecialKey()||k==e.BACKSPACE||k==e.DELETE)){return;}
var c=e.getCharCode();if(allowed.indexOf(String.fromCharCode(c))===-1){e.stopEvent();}};this.el.on("keypress",keyPress,this);},validateValue:function(value){if(!L5.form.NumberField.superclass.validateValue.call(this,value)){return false;}
if(value.length<1){return true;}
value=String(value).replace(this.decimalSeparator,".");if(isNaN(value)){this.markInvalid(String.format(this.nanText,value));return false;}
var num=this.parseValue(value);if(num<this.minValue){this.markInvalid(String.format(this.minText,this.minValue));return false;}
if(num>this.maxValue){this.markInvalid(String.format(this.maxText,this.maxValue));return false;}
return true;},getValue:function(){return this.fixPrecision(this.parseValue(L5.form.NumberField.superclass.getValue.call(this)));},setValue:function(v){v=typeof v=='number'?v:parseFloat(String(v).replace(this.decimalSeparator,".")).toFixed(this.decimalPrecision);v=isNaN(v)?'':String(v).replace(".",this.decimalSeparator);L5.form.NumberField.superclass.setValue.call(this,v);},parseValue:function(value){value=parseFloat(String(value).replace(this.decimalSeparator,".")).toFixed(this.decimalPrecision);return isNaN(value)?'':value;},fixPrecision:function(value){var nan=isNaN(value);if(!this.allowDecimals||this.decimalPrecision==-1||nan||!value){return nan?'':value;}
return parseFloat(value).toFixed(this.decimalPrecision);},beforeBlur:function(){var v=this.parseValue(this.getRawValue());if(v||v===0){this.setValue(v);}}});L5.reg('numberfield',L5.form.NumberField);

L5.form.DateField=L5.extend(L5.form.TriggerField,{format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerClass:'l-form-date-trigger',showToday:true,defaultDate:null,defaultAutoCreate:{tag:"input",type:"text",size:"10",autocomplete:"off"},initComponent:function(){L5.form.DateField.superclass.initComponent.call(this);this.addEvents('select');if(typeof this.minValue=="string"){this.minValue=this.parseDate(this.minValue);}
if(typeof this.maxValue=="string"){this.maxValue=this.parseDate(this.maxValue);}
this.disabledDatesRE=null;this.initDisabledDays();},initDisabledDays:function(){if(this.disabledDates){var dd=this.disabledDates;var re="(?:";for(var i=0;i<dd.length;i++){re+=dd[i];if(i!=dd.length-1)re+="|";}
this.disabledDatesRE=new RegExp(re+")");}},setDisabledDates:function(dd){this.disabledDates=dd;this.initDisabledDays();if(this.menu){this.menu.picker.setDisabledDates(this.disabledDatesRE);}},setDisabledDays:function(dd){this.disabledDays=dd;if(this.menu){this.menu.picker.setDisabledDays(dd);}},setMinValue:function(dt){this.minValue=(typeof dt=="string"?this.parseDate(dt):dt);if(this.menu){this.menu.picker.setMinDate(this.minValue);}},setMaxValue:function(dt){this.maxValue=(typeof dt=="string"?this.parseDate(dt):dt);if(this.menu){this.menu.picker.setMaxDate(this.maxValue);}},validateValue:function(value){value=this.formatDate(value);if(!L5.form.DateField.superclass.validateValue.call(this,value)){return false;}
if(value.length<1){return true;}
var svalue=value;value=this.parseDate(value);if(!value){this.markInvalid(String.format(this.invalidText,svalue,this.format));return false;}
var time=value.getTime();if(this.minValue&&time<this.minValue.getTime()){this.markInvalid(String.format(this.minText,this.formatDate(this.minValue)));return false;}
if(this.maxValue&&time>this.maxValue.getTime()){this.markInvalid(String.format(this.maxText,this.formatDate(this.maxValue)));return false;}
if(this.disabledDays){var day=value.getDay();for(var i=0;i<this.disabledDays.length;i++){if(day===this.disabledDays[i]){this.markInvalid(this.disabledDaysText);return false;}}}
var fvalue=this.formatDate(value);if(this.disabledDatesRE&&this.disabledDatesRE.test(fvalue)){this.markInvalid(String.format(this.disabledDatesText,fvalue));return false;}
return true;},validateBlur:function(){return!this.menu||!this.menu.isVisible();},getValue:function(){return this.parseDate(L5.form.DateField.superclass.getValue.call(this))||"";},setValue:function(date){L5.form.DateField.superclass.setValue.call(this,this.formatDate(this.parseDate(date)));},parseDate:function(value){if(!value||L5.isDate(value)){return value;}
var v=Date.parseDate(value,this.format);if(!v&&this.altFormats){if(!this.altFormatsArray){this.altFormatsArray=this.altFormats.split("|");}
for(var i=0,len=this.altFormatsArray.length;i<len&&!v;i++){v=Date.parseDate(value,this.altFormatsArray[i]);}}
return v;},onDestroy:function(){if(this.menu){this.menu.destroy();}
if(this.wrap){this.wrap.remove();}
L5.form.DateField.superclass.onDestroy.call(this);},formatDate:function(date){return L5.isDate(date)?date.dateFormat(this.format):date;},menuListeners:{select:function(m,d){this.setValue(d);this.fireEvent('select',this,d);},show:function(){this.onFocus();},hide:function(){this.focus.defer(10,this);var ml=this.menuListeners;this.menu.un("select",ml.select,this);this.menu.un("show",ml.show,this);this.menu.un("hide",ml.hide,this);}},onTriggerClick:function(){if(this.disabled){return;}
if(this.menu==null){this.menu=new L5.menu.DateMenu();}
L5.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.disabledDatesRE,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.on(L5.apply({},this.menuListeners,{scope:this}));this.menu.picker.setValue(this.getValue()||this.parseDate(this.defaultDate)||new Date());this.menu.show(this.el,"tl-bl?");},beforeBlur:function(){var v=this.parseDate(this.getRawValue());if(v){this.setValue(v);}}});L5.reg('datefield',L5.form.DateField);

L5.form.DateTimeField=L5.extend(L5.form.DateField,{format:'Y-m-d H:i',defaultAutoCreate:{tag:"input",type:"text",size:"20",autocomplete:"off"},initComponent:function(){L5.form.DateTimeField.superclass.initComponent.call(this);this.afterMethod('afterRender',function(){this.getEl().applyStyles('top:0');});},getValue:function(){return this.parseDate(L5.form.DateField.superclass.getValue.call(this))||'';},onTriggerClick:function(){if(this.disabled){return;}
if(this.menu==null){this.menu=new L5.menu.DatetimeMenu();}
L5.apply(this.menu.picker,{minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.ddMatch,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,showToday:this.showToday,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue))});this.menu.on(L5.apply({},this.menuListeners,{scope:this}));if(this.defaultDate){this.menu.picker.defaultDatetime=this.parseDate(this.defaultDate);}
this.menu.picker.setValue(this.getValue()||this.parseDate(this.defaultDate)||new Date());this.menu.show(this.el,"tl-bl?");}});L5.reg('datetimefield',L5.form.DateTimeField);

L5.form.ComboBox=L5.extend(L5.form.TriggerField,{defaultAutoCreate:{tag:"input",type:"text",size:"24",autocomplete:"off"},listClass:'',selectedClass:'l-combo-selected',triggerClass:'l-form-arrow-trigger',shadow:'sides',listAlign:'tl-bl?',maxHeight:300,minHeight:90,triggerAction:'all',minChars:4,typeAhead:false,queryDelay:500,pageSize:0,selectOnFocus:false,queryParam:'query',loadingText:'Loading...',resizable:false,handleHeight:8,typeAble:true,allQuery:'',mode:'remote',minListWidth:70,forceSelection:false,typeAheadDelay:250,lazyInit:false,initComponent:function(){L5.form.ComboBox.superclass.initComponent.call(this);this.addEvents('expand','collapse','beforeselect','select','beforequery');if(this.transform){this.allowDomMove=false;var s=L5.getDom(this.transform);if(!this.hiddenName){this.hiddenName=s.name;}
if(!this.dataset){this.mode='local';var d=[],opts=s.options;for(var i=0,len=opts.length;i<len;i++){var o=opts[i];var value=(L5.isIE?o.getAttributeNode('value').specified:o.hasAttribute('value'))?o.value:o.text;if(o.selected){this.value=value;}
d.push([value,o.text]);}
this.dataset=new L5.model.SimpleDataset({'id':0,fields:['value','text'],data:d});this.valueField='value';this.displayField='text';}
s.name=L5.id();if(!this.lazyRender){this.target=true;this.el=L5.DomHelper.insertBefore(s,this.autoCreate||this.defaultAutoCreate);L5.removeNode(s);this.render(this.el.parentNode);}else{L5.removeNode(s);}}
else if(L5.isArray(this.dataset)){if(L5.isArray(this.dataset[0])){this.dataset=new L5.model.SimpleDataset({fields:['value','text'],data:this.dataset});this.valueField='value';}else{this.dataset=new L5.model.SimpleDataset({fields:['text'],data:this.dataset,expandData:true});this.valueField='text';}
this.displayField='text';this.mode='local';}
if(!this.displayField)
this.displayField='text';if(!this.valueField)
this.valueField='value';this.selectedIndex=-1;if(this.mode=='local'){if(this.initialConfig.queryDelay===undefined){this.queryDelay=10;}
if(this.initialConfig.minChars===undefined){this.minChars=0;}}},onRender:function(ct,position){L5.form.ComboBox.superclass.onRender.call(this,ct,position);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:'input',type:'hidden',name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},'before',true);this.el.dom.removeAttribute('name');}
if(L5.isGecko){this.el.dom.setAttribute('autocomplete','off');}
this.wrap.dom.style.display="inline-block";if(!this.lazyInit){this.initList();}else{this.on('focus',this.initList,this,{single:true});}
if(typeof this.editable=='function'){this.editable=this.editable.call();}
if(typeof this.typeAble=='function'){this.typeAble=this.typeAble.call();}
if(!this.typeAble){this.typeAble=true;this.setEditable(false);}
this.disabled=!this.editable;},initValue:function(){L5.form.ComboBox.superclass.initValue.call(this);if(this.hiddenField){this.hiddenField.value=this.hiddenValue!==undefined?this.hiddenValue:this.value!==undefined?this.value:'';}},initList:function(){if(!this.list){var cls='l-combo-list';this.list=new L5.Layer({shadow:this.shadow,cls:[cls,this.listClass].join(' '),constrain:false});var lw=this.listWidth||Math.max(this.wrap.getWidth(),this.minListWidth);this.list.setWidth(lw);this.list.swallowEvent('mousewheel');this.assetHeight=0;if(this.title){this.header=this.list.createChild({cls:cls+'-hd',html:this.title});this.assetHeight+=this.header.getHeight();}
this.innerList=this.list.createChild({cls:cls+'-inner'});this.innerList.on('mouseover',this.onViewOver,this);this.innerList.on('mousemove',this.onViewMove,this);this.innerList.setWidth(lw-this.list.getFrameWidth('lr'));if(this.pageSize){this.footer=this.list.createChild({cls:cls+'-ft'});this.pageTb=new L5.PagingToolbar({dataset:this.dataset,pageSize:this.pageSize,renderTo:this.footer});this.assetHeight+=this.footer.getHeight();}
if(!this.tpl){this.tpl='<tpl for="."><div class="'+cls+'-item">{'+this.displayField+'}</div></tpl>';}
this.view=new L5.DataView({applyTo:this.innerList,tpl:this.tpl,singleSelect:true,selectedClass:this.selectedClass,itemSelector:this.itemSelector||'.'+cls+'-item'});this.view.on('click',this.onViewClick,this);this.bindDataset(this.dataset,true);if(this.resizable){this.resizer=new L5.Resizable(this.list,{pinned:true,handles:'se'});this.resizer.on('resize',function(r,w,h){this.maxHeight=h-this.handleHeight-this.list.getFrameWidth('tb')-this.assetHeight;this.listWidth=w;this.innerList.setWidth(w-this.list.getFrameWidth('lr'));this.restrictHeight();},this);this[this.pageSize?'footer':'innerList'].setStyle('margin-bottom',this.handleHeight+'px');}}},getDataset:function(){return this.dataset;},bindDataset:function(dataset,initial){if(this.dataset&&!initial){this.dataset.un('beforeload',this.onBeforeLoad,this);this.dataset.un('load',this.onLoad,this);this.dataset.un('loadexception',this.collapse,this);if(!dataset){this.dataset=null;if(this.view){this.view.setDataset(null);}}}
if(dataset){this.dataset=L5.DatasetMgr.lookup(dataset);this.dataset.on('beforeload',this.onBeforeLoad,this);this.dataset.on('load',this.onLoad,this);this.dataset.on('loadexception',this.collapse,this);if(this.view){this.view.setDataset(dataset);}}},initEvents:function(){L5.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new L5.KeyNav(this.el,{"up":function(e){this.inKeyMode=true;this.selectPrev();},"down":function(e){if(!this.isExpanded()){this.onTriggerClick();}else{this.inKeyMode=true;this.selectNext();}},"enter":function(e){this.onViewClick();this.delayedCheck=true;this.unsetDelayCheck.defer(10,this);},"esc":function(e){this.collapse();},"tab":function(e){this.onViewClick(false);return true;},scope:this,doRelay:function(foo,bar,hname){if(hname=='down'||this.scope.isExpanded()){return L5.KeyNav.prototype.doRelay.apply(this,arguments);}
return true;},forceKeyDown:true});this.queryDelay=Math.max(this.queryDelay||10,this.mode=='local'?10:250);this.dqTask=new L5.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new L5.util.DelayedTask(this.onTypeAhead,this);}
if(this.typeAble!==false){this.el.on("keyup",this.onKeyUp,this);}
if(this.forceSelection){this.on('blur',this.doForce,this);}},onDestroy:function(){if(this.view){L5.destroy(this.view);}
if(this.list){if(this.innerList){this.innerList.un('mouseover',this.onViewOver,this);this.innerList.un('mousemove',this.onViewMove,this);}
this.list.destroy();}
if(this.dqTask){this.dqTask.cancel();this.dqTask=null;}
this.bindDataset(null);L5.form.ComboBox.superclass.onDestroy.call(this);},unsetDelayCheck:function(){delete this.delayedCheck;},fireKey:function(e){if(e.isNavKeyPress()&&!this.isExpanded()&&!this.delayedCheck){this.fireEvent("specialkey",this,e);}},onResize:function(w,h){L5.form.ComboBox.superclass.onResize.apply(this,arguments);if(this.list&&this.listWidth===undefined){var lw=Math.max(w,this.minListWidth);this.list.setWidth(lw);this.innerList.setWidth(lw-this.list.getFrameWidth('lr'));}},onEnable:function(){L5.form.ComboBox.superclass.onEnable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=false;}},onDisable:function(){L5.form.ComboBox.superclass.onDisable.apply(this,arguments);if(this.hiddenField){this.hiddenField.disabled=true;}},setEditable:function(value){if(value==this.typeAble){return;}
this.typeAble=value;if(!value){this.el.dom.setAttribute('readOnly',true);this.el.on('mousedown',this.onTriggerClick,this);this.el.addClass('l-combo-noedit');}else{this.el.dom.removeAttribute('readOnly');this.el.un('mousedown',this.onTriggerClick,this);this.el.removeClass('l-combo-noedit');}},onBeforeLoad:function(){if(!this.hasFocus){return;}
this.innerList.update(this.loadingText?'<div class="loading-indicator">'+this.loadingText+'</div>':'');this.restrictHeight();this.selectedIndex=-1;},onLoad:function(){if(!this.hasFocus){return;}
if(this.dataset.getCount()>0){this.expand();this.restrictHeight();if(this.lastQuery==this.allQuery){if(this.typeAble){this.el.dom.select();}
if(!this.selectByValue(this.value,true)){this.select(0,true);}}else{this.selectNext();if(this.typeAhead&&this.lastKey!=L5.EventObject.BACKSPACE&&this.lastKey!=L5.EventObject.DELETE){this.taTask.delay(this.typeAheadDelay);}}}else{this.onEmptyResults();}},onTypeAhead:function(){var typedValue=this.getRawValue();var hasSelect=false;for(var i=0;i<this.dataset.getCount();i++){var reValue=this.dataset.getAt(i).data[this.displayField];if((reValue.lastIndexOf(typedValue)>-1&&!hasSelect)||(typedValue==reValue)){hasSelect=true;this.setRawValue(typedValue);this.selectText(0,reValue.length);this.setValue(this.dataset.getAt(i).data[this.valueField]);}}},onSelect:function(record,index){if(this.fireEvent('beforeselect',this,record,index)!==false){this.setValue(record.data[this.valueField||this.displayField]);this.collapse();this.fireEvent('select',this,record,index);}},getValue:function(){if(this.valueField){return typeof this.value!='undefined'?this.value:'';}else{return L5.form.ComboBox.superclass.getValue.call(this);}},clearValue:function(){if(this.hiddenField){this.hiddenField.value='';}
this.setRawValue('');this.lastSelectionText='';this.applyEmptyText();this.value='';},setValue:function(v){var text=v;if(this.valueField){var r=this.findRecord(this.valueField,v);if(r){text=r.data[this.displayField];}else if(this.valueNotFoundText!==undefined){text=this.valueNotFoundText;}}
this.lastSelectionText=text;if(this.hiddenField){this.hiddenField.value=v;}
L5.form.ComboBox.superclass.setValue.call(this,text);this.value=v;},findRecord:function(prop,value){var record;if(this.dataset.getCount()>0){this.dataset.each(function(r){if(r.data[prop]==value){record=r;return false;}});}
return record;},onViewMove:function(e,t){this.inKeyMode=false;},onViewOver:function(e,t){if(this.inKeyMode){return;}
var item=this.view.findItemFromChild(t);if(item){var index=this.view.indexOf(item);this.select(index,false);}},onViewClick:function(doFocus){var index=this.view.getSelectedIndexes()[0];var r=this.dataset.getAt(index);if(r){this.onSelect(r,index);}
if(doFocus!==false){this.el.focus();}},restrictHeight:function(){this.innerList.dom.style.height='';var inner=this.innerList.dom;var pad=this.list.getFrameWidth('tb')+(this.resizable?this.handleHeight:0)+this.assetHeight;var h=Math.max(inner.clientHeight,inner.offsetHeight,inner.scrollHeight);var ha=this.getPosition()[1]-L5.getBody().getScroll().top;var hb=L5.lib.Dom.getViewHeight()-ha-this.getSize().height;var space=Math.max(ha,hb,this.minHeight||0)-this.list.shadowOffset-pad-5;h=Math.min(h,space,this.maxHeight);this.innerList.setHeight(h);this.list.beginUpdate();this.list.setHeight(h+pad);this.list.alignTo(this.wrap,this.listAlign);this.list.endUpdate();},onEmptyResults:function(){this.collapse();},isExpanded:function(){return this.list&&this.list.isVisible();},selectByValue:function(v,scrollIntoView){if(v!==undefined&&v!==null){var r=this.findRecord(this.valueField||this.displayField,v);if(r){this.select(this.dataset.indexOf(r),scrollIntoView);return true;}}
return false;},select:function(index,scrollIntoView){this.selectedIndex=index;this.view.select(index);if(scrollIntoView!==false){var el=this.view.getNode(index);if(el){this.innerList.scrollChildIntoView(el,false);}}},selectNext:function(){var ct=this.dataset.getCount();if(ct>0){if(this.selectedIndex==-1){this.select(0);}else if(this.selectedIndex<ct-1){this.select(this.selectedIndex+1);}}},selectPrev:function(){var ct=this.dataset.getCount();if(ct>0){if(this.selectedIndex==-1){this.select(0);}else if(this.selectedIndex!=0){this.select(this.selectedIndex-1);}}},onKeyUp:function(e){if(this.typeAble!==false&&!e.isSpecialKey()){this.lastKey=e.getKey();this.dqTask.delay(this.queryDelay);}},validateBlur:function(){return!this.list||!this.list.isVisible();},initQuery:function(){this.doQuery(this.getRawValue());},doForce:function(){if(this.el.dom.value.length>0){this.el.dom.value=this.lastSelectionText===undefined?'':this.lastSelectionText;this.applyEmptyText();}},doQuery:function(q,forceAll){if(q===undefined||q===null){q='';}
var qe={query:q,forceAll:forceAll,combo:this,cancel:false};if(this.fireEvent('beforequery',qe)===false||qe.cancel){return false;}
q=qe.query;forceAll=qe.forceAll;if(forceAll===true||(q.length>=this.minChars)){if(this.lastQuery!==q){this.lastQuery=q;if(this.mode=='local'){this.selectedIndex=-1;if(forceAll){this.dataset.clearFilter();}else{this.dataset.filter(this.displayField,q);}
this.onLoad();}else{this.dataset.baseParams[this.queryParam]=q;this.dataset.load({params:this.getParams(q)});this.expand();}}else{this.selectedIndex=-1;this.onLoad();}}},getParams:function(q){var p={};if(this.pageSize){p.start=0;p.limit=this.pageSize;}
return p;},collapse:function(){if(!this.isExpanded()){return;}
this.list.hide();L5.getDoc().un('mousewheel',this.collapseIf,this);L5.getDoc().un('mousedown',this.collapseIf,this);this.fireEvent('collapse',this);},collapseIf:function(e){if(!e.within(this.wrap)&&!e.within(this.list)){this.collapse();}},expand:function(){if(this.isExpanded()||!this.hasFocus){return;}
this.list.alignTo(this.wrap,this.listAlign);this.list.show();this.innerList.setOverflow('auto');L5.getDoc().on('mousewheel',this.collapseIf,this);L5.getDoc().on('mousedown',this.collapseIf,this);this.fireEvent('expand',this);},onTriggerClick:function(){if(this.disabled){return;}
if(this.isExpanded()){this.collapse();this.el.focus();}else{this.onFocus({});if(this.triggerAction=='all'){this.doQuery(this.allQuery,true);}else{this.doQuery(this.getRawValue());}
this.el.focus();}}});L5.reg('combo',L5.form.ComboBox);

L5.form.Checkbox=L5.extend(L5.form.Field,{checkedCls:'l-form-check-checked',focusCls:'l-form-check-focus',overCls:'l-form-check-over',mouseDownCls:'l-form-check-down',tabIndex:0,checked:false,defaultAutoCreate:{tag:'input',type:'checkbox',autocomplete:'off'},baseCls:'l-form-check',initComponent:function(){L5.form.Checkbox.superclass.initComponent.call(this);this.addEvents('check');},initEvents:function(){L5.form.Checkbox.superclass.initEvents.call(this);this.initCheckEvents();},initCheckEvents:function(){this.innerWrap.removeAllListeners();this.innerWrap.addClassOnOver(this.overCls);this.innerWrap.addClassOnClick(this.mouseDownCls);this.innerWrap.on('click',this.onClick,this);this.innerWrap.on('keyup',this.onKeyUp,this);},onRender:function(ct,position){L5.form.Checkbox.superclass.onRender.call(this,ct,position);if(this.inputValue!==undefined){this.el.dom.value=this.inputValue;}
this.el.addClass('l-hidden');this.innerWrap=this.el.wrap({tabIndex:this.tabIndex,cls:this.baseCls+'-wrap-inner'});this.wrap=this.innerWrap.wrap({cls:this.baseCls+'-wrap'});if(this.boxLabel){this.labelEl=this.innerWrap.createChild({tag:'label',htmlFor:this.el.id,cls:'l-form-cb-label',html:this.boxLabel});}
this.imageEl=this.innerWrap.createChild({tag:'img',src:L5.BLANK_IMAGE_URL,cls:this.baseCls},this.el);if(this.checked){this.setValue(true);}else{this.checked=this.el.dom.checked;}
this.originalValue=this.checked;},afterRender:function(){L5.form.Checkbox.superclass.afterRender.call(this);this.wrap[this.checked?'addClass':'removeClass'](this.checkedCls);},onDestroy:function(){if(this.rendered){L5.destroy(this.imageEl,this.labelEl,this.innerWrap,this.wrap);}
L5.form.Checkbox.superclass.onDestroy.call(this);},onFocus:function(e){L5.form.Checkbox.superclass.onFocus.call(this,e);this.el.addClass(this.focusCls);},onBlur:function(e){L5.form.Checkbox.superclass.onBlur.call(this,e);this.el.removeClass(this.focusCls);},onResize:function(){L5.form.Checkbox.superclass.onResize.apply(this,arguments);if(!this.boxLabel&&!this.fieldLabel){this.el.alignTo(this.wrap,'c-c');}},onKeyUp:function(e){if(e.getKey()==L5.EventObject.SPACE){this.onClick(e);}},onClick:function(e){if(!this.disabled&&!this.readOnly){this.toggleValue();}
e.stopEvent();},onEnable:function(){L5.form.Checkbox.superclass.onEnable.call(this);this.initCheckEvents();},onDisable:function(){L5.form.Checkbox.superclass.onDisable.call(this);this.innerWrap.removeAllListeners();},toggleValue:function(){this.setValue(!this.checked);},getResizeEl:function(){if(!this.resizeEl){this.resizeEl=L5.isSafari?this.wrap:(this.wrap.up('.l-form-element',5)||this.wrap);}
return this.resizeEl;},getPositionEl:function(){return this.wrap;},getActionEl:function(){return this.wrap;},markInvalid:L5.emptyFn,clearInvalid:L5.emptyFn,initValue:L5.emptyFn,getValue:function(){if(this.rendered){return this.el.dom.checked;}
return this.checked;},setValue:function(v){var checked=this.checked;this.checked=(v===true||v==='true'||v=='1'||String(v).toLowerCase()=='on');if(this.rendered){this.el.dom.checked=this.checked;this.el.dom.defaultChecked=this.checked;this.wrap[this.checked?'addClass':'removeClass'](this.checkedCls);}
if(checked!=this.checked){this.fireEvent("check",this,this.checked);if(this.handler){this.handler.call(this.scope||this,this,this.checked);}}}});L5.reg('checkbox',L5.form.Checkbox);

L5.form.CheckboxGroup=L5.extend(L5.form.Field,{columns:'auto',vertical:false,allowBlank:true,blankText:"You must select at least one item in this group",defaultType:'checkbox',groupCls:'l-form-check-group',onRender:function(ct,position){if(!this.el){var panelCfg={cls:this.groupCls,layout:'column',border:false,renderTo:ct};var colCfg={defaultType:this.defaultType,layout:'form',border:false,defaults:{hideLabel:true,anchor:'100%'}}
if(this.items[0].items){L5.apply(panelCfg,{layoutConfig:{columns:this.items.length},defaults:this.defaults,items:this.items})
for(var i=0,len=this.items.length;i<len;i++){L5.applyIf(this.items[i],colCfg);};}else{var numCols,cols=[];if(typeof this.columns=='string'){this.columns=this.items.length;}
if(!L5.isArray(this.columns)){var cs=[];for(var i=0;i<this.columns;i++){cs.push((100/this.columns)*.01);}
this.columns=cs;}
numCols=this.columns.length;for(var i=0;i<numCols;i++){var cc=L5.apply({items:[]},colCfg);cc[this.columns[i]<=1?'columnWidth':'width']=this.columns[i];if(this.defaults){cc.defaults=L5.apply(cc.defaults||{},this.defaults)}
cols.push(cc);};if(this.vertical){var rows=Math.ceil(this.items.length/numCols),ri=0;for(var i=0,len=this.items.length;i<len;i++){if(i>0&&i%rows==0){ri++;}
if(this.items[i].fieldLabel){this.items[i].hideLabel=false;}
cols[ri].items.push(this.items[i]);};}else{for(var i=0,len=this.items.length;i<len;i++){var ci=i%numCols;if(this.items[i].fieldLabel){this.items[i].hideLabel=false;}
cols[ci].items.push(this.items[i]);};}
L5.apply(panelCfg,{layoutConfig:{columns:numCols},items:cols});}
this.panel=new L5.Panel(panelCfg);this.el=this.panel.getEl();if(this.forId&&this.itemCls){var l=this.el.up(this.itemCls).child('label',true);if(l){l.setAttribute('htmlFor',this.forId);}}
var fields=this.panel.findBy(function(c){return c.isFormField;},this);this.items=new L5.util.MixedCollection();this.items.addAll(fields);}
L5.form.CheckboxGroup.superclass.onRender.call(this,ct,position);},validateValue:function(value){if(!this.allowBlank){var blank=true;this.items.each(function(f){if(f.checked){return blank=false;}},this);if(blank){this.markInvalid(this.blankText);return false;}}
return true;},onDisable:function(){this.items.each(function(item){item.disable();})},onEnable:function(){this.items.each(function(item){item.enable();})},onResize:function(w,h){this.panel.setSize(w,h);this.panel.doLayout();},reset:function(){L5.form.CheckboxGroup.superclass.reset.call(this);this.items.each(function(c){if(c.reset){c.reset();}},this);},initValue:L5.emptyFn,getValue:L5.emptyFn,getRawValue:L5.emptyFn,setValue:L5.emptyFn,setRawValue:L5.emptyFn});L5.reg('checkboxgroup',L5.form.CheckboxGroup);

L5.form.Radio=L5.extend(L5.form.Checkbox,{inputType:'radio',baseCls:'l-form-radio',getGroupValue:function(){var c=this.getParent().child('input[name='+this.el.dom.name+']:checked',true);return c?c.value:null;},getParent:function(){return this.el.up('form')||L5.getBody();},toggleValue:function(){if(!this.checked){var els=this.getParent().select('input[name='+this.el.dom.name+']');els.each(function(el){if(el.dom.id==this.id){this.setValue(true);}else{L5.getCmp(el.dom.id).setValue(false);}},this);}},setValue:function(v){if(typeof v=='boolean'){L5.form.Radio.superclass.setValue.call(this,v);}else{var r=this.getParent().child('input[name='+this.el.dom.name+'][value='+v+']',true);if(r&&!r.checked){L5.getCmp(r.id).toggleValue();};}},markInvalid:L5.emptyFn,clearInvalid:L5.emptyFn});L5.reg('radio',L5.form.Radio);

L5.form.RadioGroup=L5.extend(L5.form.CheckboxGroup,{allowBlank:true,blankText:"You must select one item in this group",defaultType:'radio',groupCls:'l-form-radio-group'});L5.reg('radiogroup',L5.form.RadioGroup);

L5.form.Hidden=L5.extend(L5.form.Field,{inputType:'hidden',onRender:function(){L5.form.Hidden.superclass.onRender.apply(this,arguments);},initEvents:function(){this.originalValue=this.getValue();},setSize:L5.emptyFn,setWidth:L5.emptyFn,setHeight:L5.emptyFn,setPosition:L5.emptyFn,setPagePosition:L5.emptyFn,markInvalid:L5.emptyFn,clearInvalid:L5.emptyFn});L5.reg('hidden',L5.form.Hidden);

L5.form.BasicForm=function(el,config){L5.apply(this,config);this.items=new L5.util.MixedCollection(false,function(o){return o.id||(o.id=L5.id());});this.addEvents('beforeaction','actionfailed','actioncomplete');if(el){this.initEl(el);}
L5.form.BasicForm.superclass.constructor.call(this);};L5.extend(L5.form.BasicForm,L5.util.Observable,{timeout:30,activeAction:null,trackResetOnLoad:false,initEl:function(el){this.el=L5.get(el);this.id=this.el.id||L5.id();if(!this.standardSubmit){this.el.on('submit',this.onSubmit,this);}
this.el.addClass('l-form');},getEl:function(){return this.el;},onSubmit:function(e){e.stopEvent();},destroy:function(){this.items.each(function(f){L5.destroy(f);});if(this.el){this.el.removeAllListeners();this.el.remove();}
this.purgeListeners();},isValid:function(){var valid=true;this.items.each(function(f){if(!f.validate()){valid=false;}});return valid;},isDirty:function(){var dirty=false;this.items.each(function(f){if(f.isDirty()){dirty=true;return false;}});return dirty;},doAction:function(action,options){if(typeof action=='string'){action=new L5.form.Action.ACTION_TYPES[action](this,options);}
if(this.fireEvent('beforeaction',this,action)!==false){this.beforeAction(action);action.run.defer(100,action);}
return this;},submit:function(options){if(this.standardSubmit){var v=this.isValid();if(v){this.el.dom.submit();}
return v;}
this.doAction('submit',options);return this;},load:function(options){this.doAction('load',options);return this;},updateRecord:function(record){record.beginEdit();var fs=record.fields;fs.each(function(f){var field=this.findField(f.name);if(field){record.set(f.name,field.getValue());}},this);record.endEdit();return this;},loadRecord:function(record){this.setValues(record.data);return this;},beforeAction:function(action){var o=action.options;if(o.waitMsg){if(this.waitMsgTarget===true){this.el.mask(o.waitMsg,'l-mask-loading');}else if(this.waitMsgTarget){this.waitMsgTarget=L5.get(this.waitMsgTarget);this.waitMsgTarget.mask(o.waitMsg,'l-mask-loading');}else{L5.MessageBox.wait(o.waitMsg,o.waitTitle||this.waitTitle||'Please Wait...');}}},afterAction:function(action,success){this.activeAction=null;var o=action.options;if(o.waitMsg){if(this.waitMsgTarget===true){this.el.unmask();}else if(this.waitMsgTarget){this.waitMsgTarget.unmask();}else{L5.MessageBox.updateProgress(1);L5.MessageBox.hide();}}
if(success){if(o.reset){this.reset();}
L5.callback(o.success,o.scope,[this,action]);this.fireEvent('actioncomplete',this,action);}else{L5.callback(o.failure,o.scope,[this,action]);this.fireEvent('actionfailed',this,action);}},findField:function(id){var field=this.items.get(id);if(!field){this.items.each(function(f){if(f.isFormField&&(f.field==id||f.id==id||f.getName()==id)){field=f;return false;}});}
return field||null;},markInvalid:function(errors){if(L5.isArray(errors)){for(var i=0,len=errors.length;i<len;i++){var fieldError=errors[i];var f=this.findField(fieldError.id);if(f){f.markInvalid(fieldError.msg);}}}else{var field,id;for(id in errors){if(typeof errors[id]!='function'&&(field=this.findField(id))){field.markInvalid(errors[id]);}}}
return this;},setValues:function(values){if(L5.isArray(values)){for(var i=0,len=values.length;i<len;i++){var v=values[i];var f=this.findField(v.id);if(f){f.setValue(v.value);if(this.trackResetOnLoad){f.originalValue=f.getValue();}}}}else{var field,id;for(id in values){if(typeof values[id]!='function'&&(field=this.findField(id))){field.setValue(values[id]);if(this.trackResetOnLoad){field.originalValue=field.getValue();}}}}
return this;},getValues:function(asString){var fs=L5.lib.Ajax.serializeForm(this.el.dom);if(asString===true){return fs;}
return L5.urlDecode(fs);},clearInvalid:function(){this.items.each(function(f){f.clearInvalid();});return this;},reset:function(){this.items.each(function(f){f.reset();});return this;},add:function(){this.items.addAll(Array.prototype.slice.call(arguments,0));return this;},remove:function(field){this.items.remove(field);return this;},render:function(){this.items.each(function(f){if(f.isFormField&&!f.rendered&&document.getElementById(f.id)){f.applyToMarkup(f.id);}});return this;},applyToFields:function(o){this.items.each(function(f){L5.apply(f,o);});return this;},applyIfToFields:function(o){this.items.each(function(f){L5.applyIf(f,o);});return this;}});L5.BasicForm=L5.form.BasicForm;

L5.FormPanel=L5.extend(L5.Panel,{buttonAlign:'center',minButtonWidth:75,labelAlign:'left',monitorValid:false,monitorPoll:200,layout:'form',initComponent:function(){this.form=this.createForm();this.bodyCfg={tag:'form',cls:this.baseCls+'-body',method:this.method||'POST',id:this.formId||L5.id()};if(this.fileUpload){this.bodyCfg.enctype='multipart/form-data';}
L5.FormPanel.superclass.initComponent.call(this);this.initItems();this.addEvents('clientvalidation');this.relayEvents(this.form,['beforeaction','actionfailed','actioncomplete']);},createForm:function(){delete this.initialConfig.listeners;return new L5.form.BasicForm(null,this.initialConfig);},initFields:function(){var f=this.form;var formPanel=this;var fn=function(c){if(c.isFormField){f.add(c);}else if(c.doLayout&&c!=formPanel){L5.applyIf(c,{labelAlign:c.ownerCt.labelAlign,labelWidth:c.ownerCt.labelWidth,itemCls:c.ownerCt.itemCls});if(c.items){c.items.each(fn);}}}
this.items.each(fn);},getLayoutTarget:function(){return this.form.el;},getForm:function(){return this.form;},onRender:function(ct,position){this.initFields();L5.FormPanel.superclass.onRender.call(this,ct,position);this.form.initEl(this.body);},beforeDestroy:function(){L5.FormPanel.superclass.beforeDestroy.call(this);this.stopMonitoring();L5.destroy(this.form);},initEvents:function(){L5.FormPanel.superclass.initEvents.call(this);this.items.on('remove',this.onRemove,this);this.items.on('add',this.onAdd,this);if(this.monitorValid){this.startMonitoring();}},onAdd:function(ct,c){if(c.isFormField){this.form.add(c);}},onRemove:function(c){if(c.isFormField){L5.destroy(c.container.up('.l-form-item'));this.form.remove(c);}},startMonitoring:function(){if(!this.bound){this.bound=true;L5.TaskMgr.start({run:this.bindHandler,interval:this.monitorPoll||200,scope:this});}},stopMonitoring:function(){this.bound=false;},load:function(){this.form.load.apply(this.form,arguments);},onDisable:function(){L5.FormPanel.superclass.onDisable.call(this);if(this.form){this.form.items.each(function(){this.disable();});}},onEnable:function(){L5.FormPanel.superclass.onEnable.call(this);if(this.form){this.form.items.each(function(){this.enable();});}},bindHandler:function(){if(!this.bound){return false;}
var valid=true;this.form.items.each(function(f){if(!f.isValid(true)){valid=false;return false;}});if(this.buttons){for(var i=0,len=this.buttons.length;i<len;i++){var btn=this.buttons[i];if(btn.formBind===true&&btn.disabled===valid){btn.setDisabled(!valid);}}}
this.fireEvent('clientvalidation',this,valid);}});L5.reg('form',L5.FormPanel);L5.form.FormPanel=L5.FormPanel;

L5.form.FieldSet=L5.extend(L5.Panel,{baseCls:'l-fieldset',layout:'form',animCollapse:false,onRender:function(ct,position){if(!this.el){this.el=document.createElement('fieldset');this.el.id=this.id;if(this.title||this.header||this.checkboxToggle){this.el.appendChild(document.createElement('legend')).className='l-fieldset-header';}}
L5.form.FieldSet.superclass.onRender.call(this,ct,position);if(this.checkboxToggle){var o=typeof this.checkboxToggle=='object'?this.checkboxToggle:{tag:'input',type:'checkbox',name:this.checkboxName||this.id+'-checkbox'};this.checkbox=this.header.insertFirst(o);this.checkbox.dom.checked=!this.collapsed;this.checkbox.on('click',this.onCheckClick,this);}},onCollapse:function(doAnim,animArg){if(this.checkbox){this.checkbox.dom.checked=false;}
L5.form.FieldSet.superclass.onCollapse.call(this,doAnim,animArg);},onExpand:function(doAnim,animArg){if(this.checkbox){this.checkbox.dom.checked=true;}
L5.form.FieldSet.superclass.onExpand.call(this,doAnim,animArg);},onCheckClick:function(){this[this.checkbox.dom.checked?'expand':'collapse']();},beforeDestroy:function(){if(this.checkbox){this.checkbox.un('click',this.onCheckClick,this);}
L5.form.FieldSet.superclass.beforeDestroy.call(this);}});L5.reg('fieldset',L5.form.FieldSet);

L5.form.HtmlEditor=L5.extend(L5.form.Field,{enableFormat:true,enableFontSize:true,enableColors:true,enableAlignments:true,enableLists:true,enableSourceEdit:true,enableLinks:true,enableFont:true,createLinkText:'Please enter the URL for the link:',defaultLinkValue:'http:/'+'/',fontFamilies:['Arial','Courier New','Tahoma','Times New Roman','Verdana'],defaultFont:'tahoma',validationEvent:false,deferHeight:true,initialized:false,activated:false,sourceEditMode:false,onFocus:L5.emptyFn,iframePad:3,hideMode:'offsets',defaultAutoCreate:{tag:"textarea",style:"width:500px;height:300px;",autocomplete:"off"},initComponent:function(){this.addEvents('initialize','activate','beforesync','beforepush','sync','push','editmodechange')},createFontOptions:function(){var buf=[],fs=this.fontFamilies,ff,lc;for(var i=0,len=fs.length;i<len;i++){ff=fs[i];lc=ff.toLowerCase();buf.push('<option value="',lc,'" style="font-family:',ff,';"',(this.defaultFont==lc?' selected="true">':'>'),ff,'</option>');}
return buf.join('');},createToolbar:function(editor){var tipsEnabled=L5.QuickTips&&L5.QuickTips.isEnabled();function btn(id,toggle,handler){return{itemId:id,cls:'l-btn-icon l-edit-'+id,enableToggle:toggle!==false,scope:editor,handler:handler||editor.relayBtnCmd,clickEvent:'mousedown',tooltip:tipsEnabled?editor.buttonTips[id]||undefined:undefined,tabIndex:-1};}
var tb=new L5.Toolbar({renderTo:this.wrap.dom.firstChild});tb.el.on('click',function(e){e.preventDefault();});if(this.enableFont&&!L5.isSafari2){this.fontSelect=tb.el.createChild({tag:'select',cls:'l-font-select',html:this.createFontOptions()});this.fontSelect.on('change',function(){var font=this.fontSelect.dom.value;this.relayCmd('fontname',font);this.deferFocus();},this);tb.add(this.fontSelect.dom,'-');};if(this.enableFormat){tb.add(btn('bold'),btn('italic'),btn('underline'));};if(this.enableFontSize){tb.add('-',btn('increasefontsize',false,this.adjustFont),btn('decreasefontsize',false,this.adjustFont));};if(this.enableColors){tb.add('-',{itemId:'forecolor',cls:'l-btn-icon l-edit-forecolor',clickEvent:'mousedown',tooltip:tipsEnabled?editor.buttonTips['forecolor']||undefined:undefined,tabIndex:-1,menu:new L5.menu.ColorMenu({allowReselect:true,focus:L5.emptyFn,value:'000000',plain:true,selectHandler:function(cp,color){this.execCmd('forecolor',L5.isSafari||L5.isIE?'#'+color:color);this.deferFocus();},scope:this,clickEvent:'mousedown'})},{itemId:'backcolor',cls:'l-btn-icon l-edit-backcolor',clickEvent:'mousedown',tooltip:tipsEnabled?editor.buttonTips['backcolor']||undefined:undefined,tabIndex:-1,menu:new L5.menu.ColorMenu({focus:L5.emptyFn,value:'FFFFFF',plain:true,allowReselect:true,selectHandler:function(cp,color){if(L5.isGecko){this.execCmd('useCSS',false);this.execCmd('hilitecolor',color);this.execCmd('useCSS',true);this.deferFocus();}else{this.execCmd(L5.isOpera?'hilitecolor':'backcolor',L5.isSafari||L5.isIE?'#'+color:color);this.deferFocus();}},scope:this,clickEvent:'mousedown'})});};if(this.enableAlignments){tb.add('-',btn('justifyleft'),btn('justifycenter'),btn('justifyright'));};if(!L5.isSafari2){if(this.enableLinks){tb.add('-',btn('createlink',false,this.createLink));};if(this.enableLists){tb.add('-',btn('insertorderedlist'),btn('insertunorderedlist'));}
if(this.enableSourceEdit){tb.add('-',btn('sourceedit',true,function(btn){this.toggleSourceEdit(btn.pressed);}));}}
this.tb=tb;},getDocMarkup:function(){return'<html><head><style type="text/css">body{border:0;margin:0;padding:3px;height:98%;cursor:text;}</style></head><body></body></html>';},getEditorBody:function(){return this.doc.body||this.doc.documentElement;},getDoc:function(){return L5.isIE?this.getWin().document:(this.iframe.contentDocument||this.getWin().document);},getWin:function(){return L5.isIE?this.iframe.contentWindow:window.frames[this.iframe.name];},onRender:function(ct,position){L5.form.HtmlEditor.superclass.onRender.call(this,ct,position);this.el.dom.style.border='0 none';this.el.dom.setAttribute('tabIndex',-1);this.el.addClass('l-hidden');if(L5.isIE){this.el.applyStyles('margin-top:-1px;margin-bottom:-1px;')}
this.wrap=this.el.wrap({cls:'l-html-editor-wrap',cn:{cls:'l-html-editor-tb'}});this.createToolbar(this);this.tb.items.each(function(item){if(item.itemId!='sourceedit'){item.disable();}});var iframe=document.createElement('iframe');iframe.name=L5.id();iframe.frameBorder='0';iframe.src=L5.isIE?L5.SSL_SECURE_URL:"javascript:;";this.wrap.dom.appendChild(iframe);this.iframe=iframe;this.initFrame();if(this.autoMonitorDesignMode!==false){this.monitorTask=L5.TaskMgr.start({run:this.checkDesignMode,scope:this,interval:100});}
if(!this.width){var sz=this.el.getSize();this.setSize(sz.width,this.height||sz.height);}},initFrame:function(){this.doc=this.getDoc();this.win=this.getWin();this.doc.open();this.doc.write(this.getDocMarkup());this.doc.close();var task={run:function(){if(this.doc.body||this.doc.readyState=='complete'){L5.TaskMgr.stop(task);this.doc.designMode="on";this.initEditor.defer(10,this);}},interval:10,duration:10000,scope:this};L5.TaskMgr.start(task);},checkDesignMode:function(){if(this.wrap&&this.wrap.dom.offsetWidth){var doc=this.getDoc();if(!doc){return;}
if(!doc.editorInitialized||String(doc.designMode).toLowerCase()!='on'){this.initFrame();}}},onResize:function(w,h){L5.form.HtmlEditor.superclass.onResize.apply(this,arguments);if(this.el&&this.iframe){if(typeof w=='number'){var aw=w-this.wrap.getFrameWidth('lr');this.el.setWidth(this.adjustWidth('textarea',aw));this.iframe.style.width=Math.max(aw,0)+'px';}
if(typeof h=='number'){var ah=h-this.wrap.getFrameWidth('tb')-this.tb.el.getHeight();this.el.setHeight(this.adjustWidth('textarea',ah));this.iframe.style.height=Math.max(ah,0)+'px';if(this.doc){this.getEditorBody().style.height=Math.max((ah-(this.iframePad*2)),0)+'px';}}}},toggleSourceEdit:function(sourceEditMode){if(sourceEditMode===undefined){sourceEditMode=!this.sourceEditMode;}
this.sourceEditMode=sourceEditMode===true;var btn=this.tb.items.get('sourceedit');if(btn.pressed!==this.sourceEditMode){btn.toggle(this.sourceEditMode);return;}
if(this.sourceEditMode){this.tb.items.each(function(item){if(item.itemId!='sourceedit'){item.disable();}});this.syncValue();this.iframe.className='l-hidden';this.el.removeClass('l-hidden');this.el.dom.removeAttribute('tabIndex');this.el.focus();}else{if(this.initialized){this.tb.items.each(function(item){item.enable();});}
this.pushValue();this.iframe.className='';this.el.addClass('l-hidden');this.el.dom.setAttribute('tabIndex',-1);this.deferFocus();}
var lastSize=this.lastSize;if(lastSize){delete this.lastSize;this.setSize(lastSize);}
this.fireEvent('editmodechange',this,this.sourceEditMode);},createLink:function(){var url=prompt(this.createLinkText,this.defaultLinkValue);if(url&&url!='http:/'+'/'){this.relayCmd('createlink',url);}},adjustSize:L5.BoxComponent.prototype.adjustSize,getResizeEl:function(){return this.wrap;},getPositionEl:function(){return this.wrap;},initEvents:function(){this.originalValue=this.getValue();},markInvalid:L5.emptyFn,clearInvalid:L5.emptyFn,setValue:function(v){L5.form.HtmlEditor.superclass.setValue.call(this,v);this.pushValue();},cleanHtml:function(html){html=String(html);if(html.length>5){if(L5.isSafari){html=html.replace(/\sclass="(?:Apple-style-span|khtml-block-placeholder)"/gi,'');}}
if(html=='&nbsp;'){html='';}
return html;},syncValue:function(){if(this.initialized){var bd=this.getEditorBody();var html=bd.innerHTML;if(L5.isSafari){var bs=bd.getAttribute('style');var m=bs.match(/text-align:(.*?);/i);if(m&&m[1]){html='<div style="'+m[0]+'">'+html+'</div>';}}
html=this.cleanHtml(html);if(this.fireEvent('beforesync',this,html)!==false){this.el.dom.value=html;this.fireEvent('sync',this,html);}}},getValue:function(){this.syncValue();return L5.form.HtmlEditor.superclass.getValue.call(this);},pushValue:function(){if(this.initialized){var v=this.el.dom.value;if(!this.activated&&v.length<1){v='&nbsp;';}
if(this.fireEvent('beforepush',this,v)!==false){this.getEditorBody().innerHTML=v;this.fireEvent('push',this,v);}}},deferFocus:function(){this.focus.defer(10,this);},focus:function(){if(this.win&&!this.sourceEditMode){this.win.focus();}else{this.el.focus();}},initEditor:function(){var dbody=this.getEditorBody();var ss=this.el.getStyles('font-size','font-family','background-image','background-repeat');ss['background-attachment']='fixed';dbody.bgProperties='fixed';L5.DomHelper.applyStyles(dbody,ss);if(this.doc){try{L5.EventManager.removeAll(this.doc);}catch(e){}}
this.doc=this.getDoc();L5.EventManager.on(this.doc,{'mousedown':this.onEditorEvent,'dblclick':this.onEditorEvent,'click':this.onEditorEvent,'keyup':this.onEditorEvent,buffer:100,scope:this});if(L5.isGecko){L5.EventManager.on(this.doc,'keypress',this.applyCommand,this);}
if(L5.isIE||L5.isSafari||L5.isOpera){L5.EventManager.on(this.doc,'keydown',this.fixKeys,this);}
this.initialized=true;this.fireEvent('initialize',this);this.doc.editorInitialized=true;this.pushValue();},onDestroy:function(){if(this.monitorTask){L5.TaskMgr.stop(this.monitorTask);}
if(this.rendered){this.tb.items.each(function(item){if(item.menu){item.menu.removeAll();if(item.menu.el){item.menu.el.destroy();}}
item.destroy();});this.wrap.dom.innerHTML='';this.wrap.remove();}},onFirstFocus:function(){this.activated=true;this.tb.items.each(function(item){item.enable();});if(L5.isGecko){this.win.focus();var s=this.win.getSelection();if(!s.focusNode||s.focusNode.nodeType!=3){var r=s.getRangeAt(0);r.selectNodeContents(this.getEditorBody());r.collapse(true);this.deferFocus();}
try{this.execCmd('useCSS',true);this.execCmd('styleWithCSS',false);}catch(e){}}
this.fireEvent('activate',this);},adjustFont:function(btn){var adjust=btn.itemId=='increasefontsize'?1:-1;var v=parseInt(this.doc.queryCommandValue('FontSize')||2,10);if(L5.isSafari3||L5.isAir){if(v<=10){v=1+adjust;}else if(v<=13){v=2+adjust;}else if(v<=16){v=3+adjust;}else if(v<=18){v=4+adjust;}else if(v<=24){v=5+adjust;}else{v=6+adjust;}
v=v.constrain(1,6);}else{if(L5.isSafari){adjust*=2;}
v=Math.max(1,v+adjust)+(L5.isSafari?'px':0);}
this.execCmd('FontSize',v);},onEditorEvent:function(e){this.updateToolbar();},updateToolbar:function(){if(!this.activated){this.onFirstFocus();return;}
var btns=this.tb.items.map,doc=this.doc;if(this.enableFont&&!L5.isSafari2){var name=(this.doc.queryCommandValue('FontName')||this.defaultFont).toLowerCase();if(name!=this.fontSelect.dom.value){this.fontSelect.dom.value=name;}}
if(this.enableFormat){btns.bold.toggle(doc.queryCommandState('bold'));btns.italic.toggle(doc.queryCommandState('italic'));btns.underline.toggle(doc.queryCommandState('underline'));}
if(this.enableAlignments){btns.justifyleft.toggle(doc.queryCommandState('justifyleft'));btns.justifycenter.toggle(doc.queryCommandState('justifycenter'));btns.justifyright.toggle(doc.queryCommandState('justifyright'));}
if(!L5.isSafari2&&this.enableLists){btns.insertorderedlist.toggle(doc.queryCommandState('insertorderedlist'));btns.insertunorderedlist.toggle(doc.queryCommandState('insertunorderedlist'));}
L5.menu.MenuMgr.hideAll();this.syncValue();},relayBtnCmd:function(btn){this.relayCmd(btn.itemId);},relayCmd:function(cmd,value){(function(){this.focus();this.execCmd(cmd,value);this.updateToolbar();}).defer(10,this);},execCmd:function(cmd,value){this.doc.execCommand(cmd,false,value===undefined?null:value);this.syncValue();},applyCommand:function(e){if(e.ctrlKey){var c=e.getCharCode(),cmd;if(c>0){c=String.fromCharCode(c);switch(c){case'b':cmd='bold';break;case'i':cmd='italic';break;case'u':cmd='underline';break;}
if(cmd){this.win.focus();this.execCmd(cmd);this.deferFocus();e.preventDefault();}}}},insertAtCursor:function(text){if(!this.activated){return;}
if(L5.isIE){this.win.focus();var r=this.doc.selection.createRange();if(r){r.collapse(true);r.pasteHTML(text);this.syncValue();this.deferFocus();}}else if(L5.isGecko||L5.isOpera){this.win.focus();this.execCmd('InsertHTML',text);this.deferFocus();}else if(L5.isSafari){this.execCmd('InsertText',text);this.deferFocus();}},fixKeys:function(){if(L5.isIE){return function(e){var k=e.getKey(),r;if(k==e.TAB){e.stopEvent();r=this.doc.selection.createRange();if(r){r.collapse(true);r.pasteHTML('&nbsp;&nbsp;&nbsp;&nbsp;');this.deferFocus();}}else if(k==e.ENTER){r=this.doc.selection.createRange();if(r){var target=r.parentElement();if(!target||target.tagName.toLowerCase()!='li'){e.stopEvent();r.pasteHTML('<br />');r.collapse(false);r.select();}}}};}else if(L5.isOpera){return function(e){var k=e.getKey();if(k==e.TAB){e.stopEvent();this.win.focus();this.execCmd('InsertHTML','&nbsp;&nbsp;&nbsp;&nbsp;');this.deferFocus();}};}else if(L5.isSafari){return function(e){var k=e.getKey();if(k==e.TAB){e.stopEvent();this.execCmd('InsertText','\t');this.deferFocus();}};}}(),getToolbar:function(){return this.tb;},buttonTips:{bold:{title:'Bold (Ctrl+B)',text:'Make the selected text bold.',cls:'l-html-editor-tip'},italic:{title:'Italic (Ctrl+I)',text:'Make the selected text italic.',cls:'l-html-editor-tip'},underline:{title:'Underline (Ctrl+U)',text:'Underline the selected text.',cls:'l-html-editor-tip'},increasefontsize:{title:'Grow Text',text:'Increase the font size.',cls:'l-html-editor-tip'},decreasefontsize:{title:'Shrink Text',text:'Decrease the font size.',cls:'l-html-editor-tip'},backcolor:{title:'Text Highlight Color',text:'Change the background color of the selected text.',cls:'l-html-editor-tip'},forecolor:{title:'Font Color',text:'Change the color of the selected text.',cls:'l-html-editor-tip'},justifyleft:{title:'Align Text Left',text:'Align text to the left.',cls:'l-html-editor-tip'},justifycenter:{title:'Center Text',text:'Center text in the editor.',cls:'l-html-editor-tip'},justifyright:{title:'Align Text Right',text:'Align text to the right.',cls:'l-html-editor-tip'},insertunorderedlist:{title:'Bullet List',text:'Start a bulleted list.',cls:'l-html-editor-tip'},insertorderedlist:{title:'Numbered List',text:'Start a numbered list.',cls:'l-html-editor-tip'},createlink:{title:'Hyperlink',text:'Make the selected text a hyperlink.',cls:'l-html-editor-tip'},sourceedit:{title:'Source Edit',text:'Switch to source editing mode.',cls:'l-html-editor-tip'}}});L5.reg('htmleditor',L5.form.HtmlEditor);

L5.form.TimeField=L5.extend(L5.form.ComboBox,{minValue:null,maxValue:null,minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H",increment:15,mode:'local',triggerAction:'all',typeAhead:false,initDate:'1/1/2008',initComponent:function(){L5.form.TimeField.superclass.initComponent.call(this);if(typeof this.minValue=="string"){this.minValue=this.parseDate(this.minValue);}
if(typeof this.maxValue=="string"){this.maxValue=this.parseDate(this.maxValue);}
if(!this.dataset){var min=this.parseDate(this.minValue);if(!min){min=new Date(this.initDate).clearTime();}
var max=this.parseDate(this.maxValue);if(!max){max=new Date(this.initDate).clearTime().add('mi',(24*60)-1);}
var times=[];while(min<=max){times.push([min.dateFormat(this.format)]);min=min.add('mi',this.increment);}
this.dataset=new L5.model.SimpleDataset({fields:['text'],data:times});this.displayField='text';}},getValue:function(){var v=L5.form.TimeField.superclass.getValue.call(this);return this.formatDate(this.parseDate(v))||'';},setValue:function(value){L5.form.TimeField.superclass.setValue.call(this,this.formatDate(this.parseDate(value)));},validateValue:L5.form.DateField.prototype.validateValue,parseDate:L5.form.DateField.prototype.parseDate,formatDate:L5.form.DateField.prototype.formatDate,beforeBlur:function(){var v=this.parseDate(this.getRawValue());if(v){this.setValue(v.dateFormat(this.format));}}});L5.reg('timefield',L5.form.TimeField);

L5.form.Label=L5.extend(L5.BoxComponent,{onRender:function(ct,position){if(!this.el){this.el=document.createElement('label');this.el.id=this.getId();this.el.innerHTML=this.text?L5.util.Format.htmlEncode(this.text):(this.html||'');if(this.forId){this.el.setAttribute('for',this.forId);}}
L5.form.Label.superclass.onRender.call(this,ct,position);},setText:function(t,encode){this.text=t;if(this.rendered){this.el.dom.innerHTML=encode!==false?L5.util.Format.htmlEncode(t):t;}
return this;}});L5.reg('label',L5.form.Label);

L5.form.Action=function(form,options){this.form=form;this.options=options||{};};L5.form.Action.CLIENT_INVALID='client';L5.form.Action.SERVER_INVALID='server';L5.form.Action.CONNECT_FAILURE='connect';L5.form.Action.LOAD_FAILURE='load';L5.form.Action.prototype={type:'default',run:function(options){},success:function(response){},handleResponse:function(response){},failure:function(response){this.response=response;this.failureType=L5.form.Action.CONNECT_FAILURE;this.form.afterAction(this,false);},processResponse:function(response){this.response=response;if(!response.responseText){return true;}
this.result=this.handleResponse(response);return this.result;},getUrl:function(appendParams){var url=this.options.url||this.form.url||this.form.el.dom.action;if(appendParams){var p=this.getParams();if(p){url+=(url.indexOf('?')!=-1?'&':'?')+p;}}
return url;},getMethod:function(){return(this.options.method||this.form.method||this.form.el.dom.method||'POST').toUpperCase();},getParams:function(){var bp=this.form.baseParams;var p=this.options.params;if(p){if(typeof p=="object"){p=L5.urlEncode(L5.applyIf(p,bp));}else if(typeof p=='string'&&bp){p+='&'+L5.urlEncode(bp);}}else if(bp){p=L5.urlEncode(bp);}
return p;},createCallback:function(opts){var opts=opts||{};return{success:this.success,failure:this.failure,scope:this,timeout:(opts.timeout*1000)||(this.form.timeout*1000),upload:this.form.fileUpload?this.success:undefined};}};L5.form.Action.Submit=function(form,options){L5.form.Action.Submit.superclass.constructor.call(this,form,options);};L5.extend(L5.form.Action.Submit,L5.form.Action,{type:'submit',run:function(){var o=this.options;var method=this.getMethod();var isGet=method=='GET';if(o.clientValidation===false||this.form.isValid()){L5.Ajax.request(L5.apply(this.createCallback(o),{form:this.form.el.dom,url:this.getUrl(isGet),method:method,headers:o.headers,params:!isGet?this.getParams():null,isUpload:this.form.fileUpload}));}else if(o.clientValidation!==false){this.failureType=L5.form.Action.CLIENT_INVALID;this.form.afterAction(this,false);}},success:function(response){var result=this.processResponse(response);if(result===true||result.success){this.form.afterAction(this,true);return;}
if(result.errors){this.form.markInvalid(result.errors);this.failureType=L5.form.Action.SERVER_INVALID;}
this.form.afterAction(this,false);},handleResponse:function(response){if(this.form.errorReader){var rs=this.form.errorReader.read(response);var errors=[];if(rs.records){for(var i=0,len=rs.records.length;i<len;i++){var r=rs.records[i];errors[i]=r.data;}}
if(errors.length<1){errors=null;}
return{success:rs.success,errors:errors};}
return L5.decode(response.responseText);}});L5.form.Action.Load=function(form,options){L5.form.Action.Load.superclass.constructor.call(this,form,options);this.reader=this.form.reader;};L5.extend(L5.form.Action.Load,L5.form.Action,{type:'load',run:function(){L5.Ajax.request(L5.apply(this.createCallback(this.options),{method:this.getMethod(),url:this.getUrl(false),headers:this.options.headers,params:this.getParams()}));},success:function(response){var result=this.processResponse(response);if(result===true||!result.success||!result.data){this.failureType=L5.form.Action.LOAD_FAILURE;this.form.afterAction(this,false);return;}
this.form.clearInvalid();this.form.setValues(result.data);this.form.afterAction(this,true);},handleResponse:function(response){if(this.form.reader){var rs=this.form.reader.read(response);var data=rs.records&&rs.records[0]?rs.records[0].data:null;return{success:rs.success,data:data};}
return L5.decode(response.responseText);}});L5.form.Action.ACTION_TYPES={'load':L5.form.Action.Load,'submit':L5.form.Action.Submit};

L5.form.VTypes=function(){var alpha=/^[a-zA-Z_]+$/;var alphanum=/^[a-zA-Z0-9_]+$/;var email=/^([\w]+)(\.[\w]+)*@([\w\-]+\.){1,5}([A-Za-z]){2,4}$/;var url=/(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return{'email':function(v){return email.test(v);},'emailText':'This field should be an e-mail address in the format "user@domain.com"','emailMask':/[a-z0-9_\.\-@]/i,'url':function(v){return url.test(v);},'urlText':'This field should be a URL in the format "http:/'+'/www.domain.com"','alpha':function(v){return alpha.test(v);},'alphaText':'This field should only contain letters and _','alphaMask':/[a-z_]/i,'alphanum':function(v){return alphanum.test(v);},'alphanumText':'This field should only contain letters, numbers and _','alphanumMask':/[a-z0-9_]/i};}();

L5.LoadMask=function(el,config){this.el=L5.get(el);L5.apply(this,config);if(this.dataset){this.dataset.on('beforeload',this.onBeforeLoad,this);this.dataset.on('load',this.onLoad,this);this.dataset.on('loadexception',this.onLoad,this);this.removeMask=L5.value(this.removeMask,false);}else{var um=this.el.getUpdater();um.showLoadIndicator=false;um.on('beforeupdate',this.onBeforeLoad,this);um.on('update',this.onLoad,this);um.on('failure',this.onLoad,this);this.removeMask=L5.value(this.removeMask,true);}};L5.LoadMask.prototype={msg:'Loading...',msgCls:'l-mask-loading',disabled:false,disable:function(){this.disabled=true;},enable:function(){this.disabled=false;},onLoad:function(){this.el.unmask(this.removeMask);},onBeforeLoad:function(){if(!this.disabled){this.el.mask(this.msg,this.msgCls);}},show:function(){this.onBeforeLoad();},hide:function(){this.onLoad();},destroy:function(){if(this.dataset){this.dataset.un('beforeload',this.onBeforeLoad,this);this.dataset.un('load',this.onLoad,this);this.dataset.un('loadexception',this.onLoad,this);}else{var um=this.el.getUpdater();um.un('beforeupdate',this.onBeforeLoad,this);um.un('update',this.onLoad,this);um.un('failure',this.onLoad,this);}}};

L5.ProgressBar=L5.extend(L5.BoxComponent,{baseCls:'l-progress',animate:false,waitTimer:null,initComponent:function(){L5.ProgressBar.superclass.initComponent.call(this);this.addEvents("update");},onRender:function(ct,position){L5.ProgressBar.superclass.onRender.call(this,ct,position);var tpl=new L5.Template('<div class="{cls}-wrap">','<div class="{cls}-inner">','<div class="{cls}-bar">','<div class="{cls}-text">','<div>&#160;</div>','</div>','</div>','<div class="{cls}-text {cls}-text-back">','<div>&#160;</div>','</div>','</div>','</div>');if(position){this.el=tpl.insertBefore(position,{cls:this.baseCls},true);}else{this.el=tpl.append(ct,{cls:this.baseCls},true);}
if(this.id){this.el.dom.id=this.id;}
var inner=this.el.dom.firstChild;this.progressBar=L5.get(inner.firstChild);if(this.textEl){this.textEl=L5.get(this.textEl);delete this.textTopEl;}else{this.textTopEl=L5.get(this.progressBar.dom.firstChild);var textBackEl=L5.get(inner.childNodes[1]);this.textTopEl.setStyle("z-index",99).addClass('l-hidden');this.textEl=new L5.CompositeElement([this.textTopEl.dom.firstChild,textBackEl.dom.firstChild]);this.textEl.setWidth(inner.offsetWidth);}
this.progressBar.setHeight(inner.offsetHeight);},afterRender:function(){L5.ProgressBar.superclass.afterRender.call(this);if(this.value){this.updateProgress(this.value,this.text);}else{this.updateText(this.text);}},updateProgress:function(value,text,animate){this.value=value||0;if(text){this.updateText(text);}
if(this.rendered){var w=Math.floor(value*this.el.dom.firstChild.offsetWidth);this.progressBar.setWidth(w,animate===true||(animate!==false&&this.animate));if(this.textTopEl){this.textTopEl.removeClass('l-hidden').setWidth(w);}}
this.fireEvent('update',this,value,text);return this;},wait:function(o){if(!this.waitTimer){var scope=this;o=o||{};this.updateText(o.text);this.waitTimer=L5.TaskMgr.start({run:function(i){var inc=o.increment||10;this.updateProgress(((((i+inc)%inc)+1)*(100/inc))*.01,null,o.animate);},interval:o.interval||1000,duration:o.duration,onStop:function(){if(o.fn){o.fn.apply(o.scope||this);}
this.reset();},scope:scope});}
return this;},isWaiting:function(){return this.waitTimer!=null;},updateText:function(text){this.text=text||'&#160;';if(this.rendered){this.textEl.update(this.text);}
return this;},syncProgressBar:function(){if(this.value){this.updateProgress(this.value,this.text);}
return this;},setSize:function(w,h){L5.ProgressBar.superclass.setSize.call(this,w,h);if(this.textTopEl){var inner=this.el.dom.firstChild;this.textEl.setSize(inner.offsetWidth,inner.offsetHeight);}
this.syncProgressBar();return this;},reset:function(hide){this.updateProgress(0);if(this.textTopEl){this.textTopEl.addClass('l-hidden');}
if(this.waitTimer){this.waitTimer.onStop=null;L5.TaskMgr.stop(this.waitTimer);this.waitTimer=null;}
if(hide===true){this.hide();}
return this;}});L5.reg('progress',L5.ProgressBar);

L5.Slider=L5.extend(L5.BoxComponent,{vertical:false,minValue:0,maxValue:100,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:true,animate:true,dragging:false,initComponent:function(){if(this.value===undefined){this.value=this.minValue;}
L5.Slider.superclass.initComponent.call(this);this.keyIncrement=Math.max(this.increment,this.keyIncrement);this.addEvents('beforechange','change','changecomplete','dragstart','drag','dragend');if(this.vertical){L5.apply(this,L5.Slider.Vertical);}},onRender:function(){this.autoEl={cls:'l-slider '+(this.vertical?'l-slider-vert':'l-slider-horz'),cn:{cls:'l-slider-end',cn:{cls:'l-slider-inner',cn:[{cls:'l-slider-thumb'},{tag:'a',cls:'l-slider-focus',href:"#",tabIndex:'-1',hidefocus:'on'}]}}};L5.Slider.superclass.onRender.apply(this,arguments);this.endEl=this.el.first();this.innerEl=this.endEl.first();this.thumb=this.innerEl.first();this.halfThumb=(this.vertical?this.thumb.getHeight():this.thumb.getWidth())/2;this.focusEl=this.thumb.next();this.initEvents();},initEvents:function(){this.thumb.addClassOnOver('l-slider-thumb-over');this.mon(this.el,'mousedown',this.onMouseDown,this);this.mon(this.el,'keydown',this.onKeyDown,this);this.focusEl.swallowEvent("click",true);this.tracker=new L5.dd.DragTracker({onBeforeStart:this.onBeforeDragStart.createDelegate(this),onStart:this.onDragStart.createDelegate(this),onDrag:this.onDrag.createDelegate(this),onEnd:this.onDragEnd.createDelegate(this),tolerance:3,autoStart:300});this.tracker.initEl(this.thumb);this.on('beforedestroy',this.tracker.destroy,this.tracker);},onMouseDown:function(e){if(this.disabled){return;}
if(this.clickToChange&&e.target!=this.thumb.dom){var local=this.innerEl.translatePoints(e.getXY());this.onClickChange(local);}
this.focus();},onClickChange:function(local){if(local.top>this.clickRange[0]&&local.top<this.clickRange[1]){this.setValue(Math.round(this.reverseValue(local.left)),undefined,true);}},onKeyDown:function(e){if(this.disabled){e.preventDefault();return;}
var k=e.getKey();switch(k){case e.UP:case e.RIGHT:e.stopEvent();if(e.ctrlKey){this.setValue(this.maxValue,undefined,true);}else{this.setValue(this.value+this.keyIncrement,undefined,true);}
break;case e.DOWN:case e.LEFT:e.stopEvent();if(e.ctrlKey){this.setValue(this.minValue,undefined,true);}else{this.setValue(this.value-this.keyIncrement,undefined,true);}
break;default:e.preventDefault();}},doSnap:function(value){if(!this.increment||this.increment==1||!value){return value;}
var newValue=value,inc=this.increment;var m=value%inc;if(m>0){if(m>(inc/2)){newValue=value+(inc-m);}else{newValue=value-m;}}
return newValue.constrain(this.minValue,this.maxValue);},afterRender:function(){L5.Slider.superclass.afterRender.apply(this,arguments);if(this.value!==undefined){var v=this.normalizeValue(this.value);if(v!==this.value){delete this.value;this.setValue(v,false);}else{this.moveThumb(this.translateValue(v),false);}}},getRatio:function(){var w=this.innerEl.getWidth();var v=this.maxValue-this.minValue;return v==0?w:(w/v);},normalizeValue:function(v){if(typeof v!='number'){v=parseInt(v);}
v=Math.round(v);v=this.doSnap(v);v=v.constrain(this.minValue,this.maxValue);return v;},setValue:function(v,animate,changeComplete){v=this.normalizeValue(v);if(v!==this.value&&this.fireEvent('beforechange',this,v,this.value)!==false){this.value=v;this.moveThumb(this.translateValue(v),animate!==false);this.fireEvent('change',this,v);if(changeComplete){this.fireEvent('changecomplete',this,v);}}},translateValue:function(v){var ratio=this.getRatio();return(v*ratio)-(this.minValue*ratio)-this.halfThumb;},reverseValue:function(pos){var ratio=this.getRatio();return(pos+this.halfThumb+(this.minValue*ratio))/ratio;},moveThumb:function(v,animate){if(!animate||this.animate===false){this.thumb.setLeft(v);}else{this.thumb.shift({left:v,stopFx:true,duration:.35});}},focus:function(){this.focusEl.focus(10);},onBeforeDragStart:function(e){return!this.disabled;},onDragStart:function(e){this.thumb.addClass('l-slider-thumb-drag');this.dragging=true;this.dragStartValue=this.value;this.fireEvent('dragstart',this,e);},onDrag:function(e){var pos=this.innerEl.translatePoints(this.tracker.getXY());this.setValue(Math.round(this.reverseValue(pos.left)),false);this.fireEvent('drag',this,e);},onDragEnd:function(e){this.thumb.removeClass('l-slider-thumb-drag');this.dragging=false;this.fireEvent('dragend',this,e);if(this.dragStartValue!=this.value){this.fireEvent('changecomplete',this,this.value);}},onDisable:function(){L5.Slider.superclass.onDisable.call(this);this.thumb.addClass(this.disabledClass);if(L5.isIE){var xy=this.thumb.getXY();this.thumb.hide();this.innerEl.addClass(this.disabledClass).dom.disabled=true;if(!this.thumbHolder){this.thumbHolder=this.endEl.createChild({cls:'l-slider-thumb '+this.disabledClass});}
this.thumbHolder.show().setXY(xy);}},onEnable:function(){L5.Slider.superclass.onEnable.call(this);this.thumb.removeClass(this.disabledClass);if(L5.isIE){this.innerEl.removeClass(this.disabledClass).dom.disabled=false;if(this.thumbHolder){this.thumbHolder.hide();}
this.thumb.show();this.syncThumb();}},onResize:function(w,h){this.innerEl.setWidth(w-(this.el.getPadding('l')+this.endEl.getPadding('r')));this.syncThumb();},syncThumb:function(){if(this.rendered){this.moveThumb(this.translateValue(this.value));}},getValue:function(){return this.value;}});L5.reg('slider',L5.Slider);L5.Slider.Vertical={onResize:function(w,h){this.innerEl.setHeight(h-(this.el.getPadding('t')+this.endEl.getPadding('b')));this.syncThumb();},getRatio:function(){var h=this.innerEl.getHeight();var v=this.maxValue-this.minValue;return h/v;},moveThumb:function(v,animate){if(!animate||this.animate===false){this.thumb.setBottom(v);}else{this.thumb.shift({bottom:v,stopFx:true,duration:.35});}},onDrag:function(e){var pos=this.innerEl.translatePoints(this.tracker.getXY());var bottom=this.innerEl.getHeight()-pos.top;this.setValue(this.minValue+Math.round(bottom/this.getRatio()),false);this.fireEvent('drag',this,e);},onClickChange:function(local){if(local.left>this.clickRange[0]&&local.left<this.clickRange[1]){var bottom=this.innerEl.getHeight()-local.top;this.setValue(this.minValue+Math.round(bottom/this.getRatio()),undefined,true);}}};

L5.StatusBar=L5.extend(L5.Toolbar,{cls:'l-statusbar',busyIconCls:'l-status-busy',busyText:'Loading...',autoClear:5000,activeThreadId:0,initComponent:function(){if(this.statusAlign=='right'){this.cls+=' l-status-right';}
L5.StatusBar.superclass.initComponent.call(this);},afterRender:function(){L5.StatusBar.superclass.afterRender.call(this);var right=this.statusAlign=='right',td=L5.get(this.nextBlock());if(right){this.tr.appendChild(td.dom);}else{td.insertBefore(this.tr.firstChild);}
this.statusEl=td.createChild({cls:'l-status-text '+(this.iconCls||this.defaultIconCls||''),html:this.text||this.defaultText||''});this.statusEl.unselectable();this.spacerEl=td.insertSibling({tag:'td',style:'width:100%',cn:[{cls:'ytb-spacer'}]},right?'before':'after');},setStatus:function(o){o=o||{};if(typeof o=='string'){o={text:o};}
if(o.text!==undefined){this.setText(o.text);}
if(o.iconCls!==undefined){this.setIcon(o.iconCls);}
if(o.clear){var c=o.clear,wait=this.autoClear,defaults={useDefaults:true,anim:true};if(typeof c=='object'){c=L5.applyIf(c,defaults);if(c.wait){wait=c.wait;}}else if(typeof c=='number'){wait=c;c=defaults;}else if(typeof c=='boolean'){c=defaults;}
c.threadId=this.activeThreadId;this.clearStatus.defer(wait,this,[c]);}
return this;},clearStatus:function(o){o=o||{};if(o.threadId&&o.threadId!==this.activeThreadId){return this;}
var text=o.useDefaults?this.defaultText:'',iconCls=o.useDefaults?(this.defaultIconCls?this.defaultIconCls:''):'';if(o.anim){this.statusEl.fadeOut({remove:false,useDisplay:true,scope:this,callback:function(){this.setStatus({text:text,iconCls:iconCls});this.statusEl.show();}});}else{this.statusEl.hide();this.setStatus({text:text,iconCls:iconCls});this.statusEl.show();}
return this;},setText:function(text){this.activeThreadId++;this.text=text||'';if(this.rendered){this.statusEl.update(this.text);}
return this;},getText:function(){return this.text;},setIcon:function(cls){this.activeThreadId++;cls=cls||'';if(this.rendered){if(this.currIconCls){this.statusEl.removeClass(this.currIconCls);this.currIconCls=null;}
if(cls.length>0){this.statusEl.addClass(cls);this.currIconCls=cls;}}else{this.currIconCls=cls;}
return this;},showBusy:function(o){if(typeof o=='string'){o={text:o};}
o=L5.applyIf(o||{},{text:this.busyText,iconCls:this.busyIconCls});return this.setStatus(o);}});L5.reg('statusbar',L5.StatusBar);

L5.SearchArea=function(config){this.count=0;this.htmls="";this.params=new Array();this.dataset;this.data;this.help;L5.apply(this,config);};L5.SearchArea.prototype.addTextField=function(name,desc,sqlName){this.count++;this.htmls+="<td><label>"+desc+":</label></td>";this.htmls+="<td><input type=\"text\" id=\""+name+"\" /></td>";this.setLayOut();if(typeof sqlName=='undefined'||sqlName==null){sqlName=name;}
this.setParameter(name,sqlName);};L5.SearchArea.prototype.setLayOut=function(){if(this.count!=1){if(this.count%2==1){this.htmls+="<tr>"}else{this.htmls+="</tr><tr>";this.count=0;}}}
L5.SearchArea.prototype.addDateField=function(name,desc,config,sqlName){this.htmls+="<td><label>"+desc+":</label></td>";this.htmls+="<td><input id='"+name+"' type='text' onclick='LoushangDate("+config+",this)'></td>";this.setLayOut();if(typeof sqlName=='undefined'||sqlName==null){sqlName=name;}
this.setParameter(name,sqlName);};L5.SearchArea.prototype.addComboField=function(name,desc,ds,sqlName){this.htmls+="<td><label>"+desc+":</label></td>";this.htmls+="<td><select id=\""+name+"\" >";var options="<option dataset=\""+ds+"\">"+"</option>";this.htmls+=options;this.htmls+="</select></td>";this.setLayOut();if(typeof sqlName=='undefined'||sqlName==null){sqlName=name;}
this.setParameter(name,sqlName);};L5.SearchArea.prototype.setParameter=function(name,sqlName){var obj=new Object();obj.name=name;obj.sqlName=sqlName;this.params[this.params.length]=obj;}
L5.SearchArea.prototype.getFormContent=function(){if(this.data){var arr=this.data;for(var i=0;i<arr.length;i++){switch(arr[i].type){case null:case'':case undefined:case'text':this.addTextField(arr[i].name,arr[i].desc);break;case'date':this.addDateField(arr[i].name,arr[i].desc,arr[i].cfg);break;case'combox':this.addComboField(arr[i].name,arr[i].desc,arr[i].data);break;}}}};L5.SearchArea.prototype.setBaseParams=function(){var fieldValue;for(var i=0;i<this.params.length;i++){fieldValue=L5.fly(this.params[i].name).getValue();if(fieldValue!=""){this.dataset.baseParams[this.params[i].sqlName]=fieldValue;}
else
this.dataset.baseParams[this.params[i].sqlName]=undefined;}};L5.SearchArea.prototype.search=function(){this.setBaseParams();this.dataset.load();};L5.SearchArea.prototype.bgSearch=function(condition){if(condition){this.dataset.baseParams[condition.name]=condition.value;this.dataset.load({callback:respondSearch,help:this.help,search:condition});}}
function respondSearch(records,options,success){if(success){var length=records.length;if(length==1){options.help.returns=records[0];options.help.isClear=false;options.help._dirty=true;if(options.help.afterExecute){options.help.afterExecute();}}else{options.help.show(null,null,null,true);var condition=options.search;L5.fly(condition.name).dom.value=condition.value;}}};L5.SearchArea.prototype.clearSearchValue=function(){for(var i=0;i<this.params.length;i++){L5.fly(this.params[i].name).dom.value="";this.dataset.baseParams[this.params[i].name]=undefined;}};L5.SearchArea.prototype.getHtmls=function(){return"<form onsubmit='return false'><table><tr>"+this.htmls+"</tr></table></form>";}

L5.GridHelpWindow=function(config,searchCfg){this.id=config.id;this.width=500;this.height=300;this.closeAction='hide';this.plain=true;this.autoScroll=true;this.title='Help';this.gridPanelHeight;this.searchCfg=searchCfg;this.selectFirst=true;this.showReload=false;this._dirty=false;L5.apply(this,config);this.dataset=config.dataset;this.returns=null;this.initRecord=new this.dataset.recordType({});this.isClear=false;this.searchCfg.help=this;this.searchCfg.dataset=this.dataset;var searchPanelCfg={html:this.searchCfg.getHtmls(),keys:[{key:L5.EventObject.ENTER,fn:this._innerquery,scope:this}],tbar:['->',{text:L5.help_showText?L5.help_showText["queryText"]:'Query',iconCls:"query",handler:this._innerquery,scope:this},'-',{text:L5.help_showText?L5.help_showText["yesText"]:'OK',iconCls:"yes",handler:this._confirm,scope:this},'-',{text:L5.help_showText?L5.help_showText["closeText"]:'Close',iconCls:"undo",handler:this._giveUp,scope:this},'-',{text:L5.help_showText?L5.help_showText["clearText"]:'Clear',iconCls:"no",handler:this._clear,scope:this}]};L5.apply(searchPanelCfg,this.searchCfg);this.searchPanel=new L5.Panel(searchPanelCfg);if(!this.sm){this.sm=new L5.grid.RowSelectionModel();this.sm.singleSelect=true;}
if(!this.gridColumns){this.gridColumns=L5.getGridColumns(this.dataset.fields.items)}
var gridPanelCfg={dataset:this.dataset,sm:this.sm,columns:this.gridColumns,stripeRows:true,autoScroll:true,height:this.gridPanelHeight?this.gridPanelHeight:this.height,viewConfig:{forceFit:L5.getGridColumnsTotalWidth(this.gridColumns)<=this.width?true:false},listeners:{rowdblclick:this._confirm,scope:this},keys:[{key:L5.EventObject.ENTER,fn:this._confirm,scope:this}]};L5.apply(gridPanelCfg,this.gridCfg);this.gridPanel=new L5.grid.GridPanel(gridPanelCfg);this.bbar=new L5.PagingToolbar({dataset:this.dataset,displayInfo:true,displayMsg:(L5.help_showText?L5.help_showText["displayMsgText"]:"rec.{0} to rec.{1}, total: {2}records"),emptyMsg:(L5.help_showText?L5.help_showText["emptyMsgText"]:"no record")});this.items=[this.searchPanel,this.gridPanel];this.items=this.items.concat(this.appendToItems());L5.GridHelpWindow.superclass.constructor.call(this);if(this.selectFirst){this.on('beforeshow',this.selectFirstRow,this);this.dataset.on('load',this.selectFirstRow,this);}};L5.extend(L5.GridHelpWindow,L5.Window,{_giveUp:function(e){this.hide();},_confirm:function(){var record=this.sm.getSelected();if(!record){L5.Msg.alert(L5.alertText?L5.alertText:"Note",L5.help_showText?L5.help_showText["selectRecordText"]:"Please select record");return;}
this.returns=record;this.isClear=false;this.hide();if(this.afterExecute){this.afterExecute();}},_clear:function(e){this.returns=this.initRecord;this.isClear=true;this.hide();if(this.afterExecute){this.afterExecute();}},_innerquery:function(){this.searchCfg.search();},query:function(condition){this.searchCfg.bgSearch(condition);},show:function(animateTarget,cb,scope,noload){L5.GridHelpWindow.superclass.show.call(this,animateTarget,cb,scope);if(noload){return;}
if(this._dirty||this.showReload){this.clearSearchAndLoad();}},clearSearchValue:function(){this.searchCfg.clearSearchValue();},clearSearchAndLoad:function(){this.clearSearchValue();this.dataset.load();},selectFirstRow:function(){var sm=this.gridPanel.getSelectionModel();var gridPanel=this.gridPanel;if(sm.grid){(function(){sm.selectFirstRow();var row=gridPanel.getView().getRow(0);var ele=L5.fly(row);if((typeof ele)!='undefined'&&ele!=null){ele.focus();}}).defer(50);}},getReturn:function(){return this.returns;},appendToItems:function(){return[];}});L5.reg('gridHelp',L5.GridHelpWindow);L5.getGridColumns=function(recordcfg){var columns=new Array();for(var i=0;i<recordcfg.length;i++){var obj=new Object();obj.header=recordcfg[i].name;obj.width=75;obj.field=recordcfg[i].name;obj.sortable=true;if(recordcfg[i].type=="date"){obj.renderer=L5.util.Format.dateRenderer('Y-m-d')}
columns.push(obj);}
return columns;};L5.getGridColumnsTotalWidth=function(columns){var total=0,width=100;for(var i=0;i<columns.length;i++){if(columns[i].width){width=columns[i].width;}
total+=width;}
return total;}
L5.MultiGridHelpWindow=function(config,searchCfg){config.layout='border';config.selectFirst=false;config.gridCfg={region:'center'};searchCfg.region='north';this.isClear=false;this.selectedPanel=new L5.Panel({title:(L5.help_showText?L5.help_showText["selectedRecordText"]:"Select Records"),split:true,autoScroll:true,region:'east',collapsible:true,collapsed:true,html:"<div id='selectedDiv'><select id='selOpts' size='10'  multiple='multiple'></select></div>",width:100,minSize:0,maxSize:500});this.rightClick=new L5.menu.Menu({id:'rightClickCont',items:[{id:'delete',text:(L5.help_showText?L5.help_showText["deleteText"]:"Delete"),handler:this.deleteFn,scope:this},{id:'deleteAll',text:(L5.help_showText?L5.help_showText["deleteAllText"]:"Delete All"),handler:this.deleteAllFn,scope:this}]});this.sm=new L5.grid.CheckboxSelectionModel();this.dataset=config.dataset;this.dataset.on('datachanged',this.selectValues,this);config.sm=this.sm;if(!config.gridColumns){config.gridColumns=L5.getGridColumns(config.dataset.fields.items)}
var allColumns=new Array();allColumns.push(config.sm);config.gridColumns=allColumns.concat(config.gridColumns);this.idField=config.idField;if(this.idField==null||typeof this.idField=='undefined'){this.idField=config.gridColumns[1].field;}
this.displayField=config.displayField;if(this.displayField==null||typeof this.displayField=='undefined'){this.displayField=config.gridColumns[2].field;}
this.selectedData=new L5.util.MixedCollection();this.initedFlag=false;this.selectOptions=null;L5.MultiGridHelpWindow.superclass.constructor.call(this,config,searchCfg);this.sm.on('rowselect',this.selectRow,this);this.sm.on('rowdeselect',this.deselectRow,this);this.on('beforeshow',this.helpObjInit,this);};L5.extend(L5.MultiGridHelpWindow,L5.GridHelpWindow,{appendToItems:function(){return[this.selectedPanel];},selectRow:function(sm,rowIndex,record){this.addItem(record);this.buildOptions(record.get(this.idField),record.get(this.displayField));},deselectRow:function(sm,rowIndex,record){this.removeItem(record);this.buildOptions(record.get(this.idField),record.get(this.displayField),true);},addItem:function(record){this.selectedData.add(record.get(this.idField),record);},removeItem:function(record){this.selectedData.removeKey(record.get(this.idField));},selectValues:function(){var records=this.selectedData.items;var selectedIndex=this.getRowIndex(this.gridPanel.dataset,records,this.idField);for(var n=0;n<selectedIndex.length;n++){if(selectedIndex[n]!=-1){this.sm.selectRow(selectedIndex[n],true);}}},getRowIndex:function(dataset,records,fieldName){var allIndex=new Array();var src;var target;var items;if(dataset.localPage){var start=dataset.pageInfo.startCursor;var end=start+dataset.getCount();items=dataset.data.items.slice(start,end);}else{items=dataset.data.items;}
for(var i=0;i<records.length;i++){var index=-1;target=records[i];for(var j=0;j<items.length;j++){src=items[j];if(target.get(fieldName)==src.get(fieldName)){index=j;break;}}
allIndex.push(index);}
return allIndex;},buildOptions:function(valuePara,namePara,remove){var exist=0;for(var j=this.selectOptions.options.length-1;j>=0;j--)
{var val=this.selectOptions.options[j].value;if(val==valuePara){exist=1;if(remove){L5.removeNode(this.selectOptions.options[j]);}}}
if(remove){return;}
if(exist==0){L5.DomHelper.append(this.selectOptions,{tag:"option",value:valuePara,html:namePara});}},rightClickFn:function(e){e.preventDefault();this.rightClick.showAt(e.getXY());},helpObjInit:function(){if(!this.initedFlag){L5.get('selectedDiv').on('contextmenu',this.rightClickFn,this);this.selectOptions=L5.get('selOpts').dom;L5.DomHelper.useDom=true;this.initedFlag=true;}},deleteFn:function(){var removedRecords=new Array();var key=null;var len=this.selectOptions.length;for(var i=len-1;i>=0;i--){if(this.selectOptions.options[i].selected){key=this.selectOptions.options[i].value;removedRecords.push(this.selectedData.get(key));this.selectedData.removeKey(key);L5.removeNode(this.selectOptions.options[i]);}}
var deselectIndex=this.getRowIndex(this.gridPanel.dataset,removedRecords,this.idField);for(var n=0;n<deselectIndex.length;n++){if(deselectIndex[n]!=-1){this.sm.deselectRow(deselectIndex[n]);}}},deleteAllFn:function(){this.selectOptions.options.length=0;var deselectIndex=this.getRowIndex(this.gridPanel.dataset,this.selectedData.items,this.idField);this.selectedData.clear();for(var n=0;n<deselectIndex.length;n++){if(deselectIndex[n]!=-1){this.sm.deselectRow(deselectIndex[n]);}}},_confirm:function(){var records=this.selectedData.items;if(records.length==0){L5.Msg.alert(L5.alertText,L5.help_showText?L5.help_showText["selectRecordText"]:"Please select record");return;}
this.returns=records;this.isClear=false;this.hide();if(this.afterExecute){this.afterExecute();}},_clear:function(e){this.returns=[this.initRecord];this.isClear=true;this.hide();if(this.afterExecute){this.afterExecute();}}});

L5.QueryWindow=function(config){this.data=[];this.params=[];this.width=300;this.height=150+config.conditions.length*20;this.title="Query Window";if(config){this.config=config;if(this.config.title)
this.title=this.config.title;if(this.config.width)
this.width=this.config.width;if(this.config.height)
this.height=this.config.height;if(this.config.dataset)
this.dataset=L5.DatasetMgr.lookup(this.config.dataset);if(this.config.conditions)
this.data=eval(this.config.conditions);}
this.renderTo=document.body;this.resizable=true;this.layout='fit';this.closeAction='hide';this.plain=true;this.htmls="<form onsubmit='return false'><fieldset><legend>"+(L5.query_showText?L5.query_showText["inputParamTip"]:'Please input query conditions.')+"</legend>";this.getFormContent();this.items=new L5.Panel({html:this.htmls});this.buttons=[{text:(L5.query_showText?L5.query_showText["queryText"]:'Query'),handler:this.query.createDelegate(this)},{text:(L5.query_showText?L5.query_showText["closeText"]:'Close'),handler:this.exit.createDelegate(this)}];this.keys=[{key:L5.EventObject.ENTER,fn:this.query.createDelegate(this)}];L5.QueryWindow.superclass.constructor.call(this);};L5.extend(L5.QueryWindow,L5.Window,{obj:null,addTextField:function(name,desc,operator){this.htmls+="<label>"+desc+":</label>";this.htmls+="<input type=\"text\" id=\""+name+"\"/><br>";obj=new Object();obj.name=name;obj.operator=operator;this.params[this.params.length]=obj;},addDateField:function(name,desc,operator,format){this.htmls+="<label>"+desc+":</label>";this.htmls+="<input id='"+name+"' type='text' format='"+format+"' onclick='LoushangDate(this)'/><br>";obj=new Object();obj.name=name;obj.operator=operator;this.params[this.params.length]=obj;},addComboField:function(name,desc,operator,dataset,key,label){this.htmls+="<label>"+desc+":</label>";this.htmls+="<select id=\""+name+"\" >";this.htmls+="<option value=\"\">"+(L5.query_showText?L5.query_showText["pleaseSelectText"]:'Please select.')+"</option>";var dataset=L5.DatasetMgr.lookup(dataset);var options="";dataset.each(function(record,index){options+="<option value=\""
+record.get(key)+"\">"
+record.get(label)+"</option>";});this.htmls+=options;this.htmls+="</select><br>";obj=new Object();obj.name=name;obj.operator=operator;this.params[this.params.length]=obj;},getFormContent:function(){if(this.data){var arr=this.data;for(var i=0;i<arr.length;i++){switch(arr[i].type){case null:case'':case undefined:case'text':this.addTextField(arr[i].name,arr[i].desc,arr[i].operator);break;case'date':this.addDateField(arr[i].name,arr[i].desc,arr[i].operator,arr[i].format);break;case'combox':this.addComboField(arr[i].name,arr[i].desc,arr[i].operator,arr[i].dataset,arr[i].key,arr[i].label);break;}}}
this.htmls+="</fieldset></form>";},setBaseParams:function(){var fieldValue;for(var i=0;i<this.params.length;i++){fieldValue=L5.fly(this.params[i].name).getValue();if(fieldValue!=""){this.dataset.setParameter(this.params[i].name+"@"+this.params[i].operator,fieldValue);}}},query:function(evt){this.setBaseParams();this.dataset.load();},exit:function(){this.hide();}});

(function(){var createDateMenu=function(renderEl){var dateId=renderEl.dateId||renderEl.getAttribute("dateId");if(dateId==null){renderEl.setAttribute("dateId",L5.id());dateId=renderEl.dateId=(dateId==null?L5.id():dateId)}
var menu=new L5.menu.DateMenu({id:dateId});var prop={};prop.format=renderEl.format||renderEl.getAttribute("format")||"Ymd";prop.value=renderEl.showToday||renderEl.getAttribute("showToday")||true;L5.apply(menu.picker,prop);return menu;};var getDateMenu=function(renderEl){var menu=false;if(renderEl.dateId){menu=L5.menu.MenuMgr.get(renderEl.dateId);}
return menu;};var cacheDateMenu=function(target,datemenu){target.dateId=datemenu.id;target.format=datemenu.picker.format;target.showToday=datemenu.picker.showToday;};var altFormatsArray=["m/d/Y","n/j/Y","n/j/y","m/j/y","n/d/y","m/j/Y","n/d/Y","m-d-y","m-d-Y","m/d","m-d","md","mdy","mdY","d","Y-m-d"];var parseDate=function(value,format){if(!value||L5.isDate(value)){return value;}
var v=Date.parseDate(value,format);if(!v){for(var i=0,len=altFormatsArray.length;i<len&&!v;i++){v=Date.parseDate(value,altFormatsArray[i]);}}
return v;};var targetfocus=function(){try{this.dom.focus();}catch(e){}};var datemenuListeners={select:function(m,d){var target=m.parentMenu.triggerTarget;var format=target.format;var datesellis=target.dateselect;if(!datesellis){var datesel=target.getAttribute("ondateselect");if(!datesel){datesellis=target.dateselect=L5.emptyFn;}else{if(typeof(datesel)=='string'){datesellis=target.dateselect=window[datesel];}}}
if(datesellis(target,d,format)!==false){if(d!=""&&d!=null){var datevalue=d.dateFormat(format);target.value=datevalue;}else{target.value="";}
L5.fireEvent(target,"blur");};},hide:function(datemenu){var target=datemenu.triggerTarget;datemenu.triggerTarget=false;targetfocus.defer(10,target);datemenu.un("select",datemenuListeners.select);datemenu.un("hide",datemenuListeners.hide);}};var showDateMenu=function(target){if((typeof target)=='string'){target=document.getElementById(target);}
var datemenu=getDateMenu(target);if(!datemenu){datemenu=createDateMenu(target);cacheDateMenu(target,datemenu);}
datemenu.triggerTarget=target;datemenu.on(L5.apply({},datemenuListeners));var date=false;var format=target.format;var defaultDate=target.getAttribute("defaultDate");if(target.value&&target.value!=""){var datevalue=target.value;date=parseDate(datevalue,format);}else if(defaultDate&&defaultDate!=""){date=parseDate(defaultDate,format);}
datemenu.picker.setValue(date||new Date());datemenu.show(target,"tl-bl?");};var triggerShowDateMenu=function(evt){var target=evt.srcElement||evt.target;showDateMenu(target);};var clearElValue=function(clearEvt){var target=clearEvt.srcElement||clearEvt.target;if((typeof target)=='string'){target=document.getElementById(target);}
var datemenu=getDateMenu(target);if(datemenu)
datemenu.hide();target.value="";};var addEventListener=function(evt,target,func){if(window.addEventListener){target.addEventListener(evt,func,false);}else if(window.attachEvent){target.attachEvent("on"+evt,func);}else{alert("Not support this explorer");return;}};var preventDefault=function(evt){if(window.event){window.event.returnValue=false;return;}else if(evt.preventDefault){evt.preventDefault();}};var hotKeyListener=function(evt){evt=evt||window.event;if(evt.ctrlKey){var keycode=evt.keyCode||evt.which;var ch=_keycodeMap[keycode];var target=evt.srcElement||evt.target;if(ch==target.hotKey){showDateMenu(target);preventDefault(evt);}}};var addHotKey=function(hotKey,target){target.hotKey=hotKey;addEventListener("keydown",target,hotKeyListener);};var k='LoushangDatebind';var kImg='LoushangDatebindImg';window[k]=function(renderEl,evt,clearEvt,defaultDate){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDate",defaultDate);}
if(evt){addEventListener(evt,renderEl,triggerShowDateMenu);}
if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}
var hotKey=renderEl.getAttribute('hotKey');if(hotKey){addHotKey(hotKey,renderEl);}};window[kImg]=function(renderEl,evt,clearEvt,defaultDate){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDate",defaultDate);}
var img=document.createElement("img");img.src=L5.webPath+"/skins/images/default/button/btn-date.gif";img.style.cursor="pointer";img.style.backgroundAttachment="fixed";renderEl.parentNode.insertBefore(img,renderEl.nextSibling);if(evt){addEventListener(evt,img,function(){showDateMenu(renderEl);});}
if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}
var hotKey=renderEl.getAttribute('hotKey');if(hotKey){addHotKey(hotKey,renderEl);}};var t="LoushangDate";window[t]=function(renderEl,clearEvt,defaultDate){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDate",defaultDate);}
showDateMenu(renderEl);if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}
var tempShowText={selectDataText:"Select Data: ",startText:"Start: ",endText:"End: ",dataSelectText:"Data Selector",yesText:"OK",closeText:"Close",clearText:"Clear",yearText:"Year",dataDetailText:"Data",byTimeperiodText:"By Time Period",byMonthText:"By Month",byYearText:"By Year",selectMonthText:"Select Month: ",selectYearText:"Select Year: ",pleaseSelectDataText:"Please select data.",invalidDataFormatText:"Invalid data format,the valid format: {0}.",pleaseInputStartDataText:"Please input start data.",invalidStartDataFormatText:"Invalid  start data format,the valid format: {0}.",pleaseInputEndDataText:"Please input end data.",invalidStartDataFormatText:"Invalid start data format,the valid format: {0}.",endVSStartDataText:"End data should later than start data.",invalidYearFormatText:"Invalid year format.",invalidMonthFormatText:"Invalid month format."};var tempMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];function showQueryDate(ele,format,img){if(format==undefined||format==""){format="Y-m-d";}
var tempStr4selectData=L5.data_showText?L5.data_showText["selectDataText"]:tempShowText["selectDataText"];var tiem1html=tempStr4selectData+'<input type="text" size="10" id="$dateq1" onclick="LoushangDate(this)" format='+format+'>';if(img=="true"||img==true){tiem1html=tempStr4selectData+'<input type="text" size="10" id="$dateq1"  format='+format+'><img onclick=LoushangDate("$dateq1") src='+L5.webPath+"/skins/images/default/button/btn-date.gif"+' style="cursor:pointer;" >';}
var tempStr4start=L5.data_showText?L5.data_showText["startText"]:tempShowText["startText"];var tempStr4end=L5.data_showText?L5.data_showText["endText"]:tempShowText["endText"];var tiem2html=tempStr4start+'<input type="text" id="$dateq2" onclick="LoushangDate(this)" format='+format+' size="9">&nbsp;&nbsp;&nbsp;'+tempStr4end+'<input type="text" id="$dateq3" onclick="LoushangDate(this)" format='+format+' size="9">';if(img=="true"||img==true){tiem2html=tempStr4start+'<input type="text" id="$dateq2"  format='+format+' size="9"/><img onclick=LoushangDate("$dateq2") src='+L5.webPath+"/skins/images/default/button/btn-date.gif"+' style="cursor:pointer;" >'+'&nbsp;&nbsp;&nbsp;'+tempStr4end+'<input type="text" id="$dateq3"  format='+format+' size="9"/><img onclick=LoushangDate("$dateq3") src='+L5.webPath+"/skins/images/default/button/btn-date.gif"+' style="cursor:pointer;" >';}
var win=L5.getCmp("queryDate~");if(win==null){var tempStr4dataSelect=L5.data_showText?L5.data_showText["dataSelectText"]:tempShowText["dataSelectText"];var tempStr4yes=L5.data_showText?L5.data_showText["yesText"]:tempShowText["yesText"];var tempStr4close=L5.data_showText?L5.data_showText["closeText"]:tempShowText["closeText"];var tempStr4clear=L5.data_showText?L5.data_showText["clearText"]:tempShowText["clearText"];var tempStr4dataDetail=L5.data_showText?L5.data_showText["dataDetailText"]:tempShowText["dataDetailText"];var tempStr4byTimeperiod=L5.data_showText?L5.data_showText["byTimeperiodText"]:tempShowText["byTimeperiodText"];var tempStr4byMonth=L5.data_showText?L5.data_showText["byMonthText"]:tempShowText["byMonthText"];var tempStr4selectMonth=L5.data_showText?L5.data_showText["selectMonthText"]:tempShowText["selectMonthText"];var tempStr4year=L5.data_showText?L5.data_showText["yearText"]:tempShowText["yearText"];var tempStr4byYear=L5.data_showText?L5.data_showText["byYearText"]:tempShowText["byYearText"];var tempStr4selectYear=L5.data_showText?L5.data_showText["selectYearText"]:tempShowText["selectYearText"];win=new L5.Window({id:'queryDate~',title:tempStr4dataSelect,width:350,height:200,autoScroll:false,closeAction:'close',tbar:['->',{iconCls:"yes",text:tempStr4yes,handler:queryOk},{iconCls:"delete",text:tempStr4close,handler:queryClose},{iconCls:"no",text:tempStr4clear,handler:queryClear}],items:[{xtype:'tabpanel',autoScroll:false,listeners:{'tabchange':tabAct},activeTab:0,autoWidth:true,autoHeight:true,id:'tabs',items:[{title:tempStr4dataDetail,frame:true,height:200,html:tiem1html},{title:tempStr4byTimeperiod,frame:true,height:200,html:tiem2html},{title:tempStr4byMonth,frame:true,height:200,html:tempStr4selectMonth+'<input type="text" id="$dateq4" value="2009" size="3" maxlength="4">'+tempStr4year+'<select id="$dateq5">'+'<option value="01">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[0]:tempMonthNames[0])+'</option>'+'<option value="02">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[1]:tempMonthNames[1])+'</option>'+'<option value="03">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[2]:tempMonthNames[2])+'</option>'+'<option value="04">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[3]:tempMonthNames[3])+'</option>'+'<option value="05">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[4]:tempMonthNames[4])+'</option>'+'<option value="06">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[5]:tempMonthNames[5])+'</option>'+'<option value="07">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[6]:tempMonthNames[6])+'</option>'+'<option value="08">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[7]:tempMonthNames[7])+'</option>'+'<option value="09">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[8]:tempMonthNames[8])+'</option>'+'<option value="10">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[9]:tempMonthNames[9])+'</option>'+'<option value="11">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[10]:tempMonthNames[10])+'</option>'+'<option value="12">'+(L5.data_Date_monthNames?L5.data_Date_monthNames[11]:tempMonthNames[11])+'</option>'+'</select>'},{title:tempStr4byYear,frame:true,height:200,html:tempStr4selectYear+'<input type="text" value="2009" size="3" id="$dateq6" maxlength="4">'}]}]});}
var el=L5.fly(ele);var xy=el.getXY();win.setPosition(xy[0],xy[1]+20);win.show(ele);}
window['showQueryDate']=showQueryDate;function tabAct(tabpanle,item){var now=new Date();var year=now.getFullYear();var month=now.getMonth()+1;if(month<10){month='0'+month;}else{month=''+month;}
var tempStr4byMonth=L5.data_showText?L5.data_showText["byMonthText"]:tempShowText["byMonthText"];var tempStr4byYear=L5.data_showText?L5.data_showText["byYearText"]:tempShowText["byYearText"];var tempStr4dataDetail=L5.data_showText?L5.data_showText["dataDetailText"]:tempShowText["dataDetailText"];if(item.title==tempStr4byMonth){L5.getDom("$dateq4").value=year;L5.getDom("$dateq5").value=month;}else if(item.title==tempStr4byYear){L5.getDom("$dateq6").value=year;}else if(item.title==tempStr4dataDetail){var format=document.getElementById("$dateq1").getAttribute("format");L5.getDom("$dateq1").value=now.dateFormat(format);}}
function queryOk(){var win=L5.getCmp("queryDate~");var v=getV(win.getComponent(0));if(v!=null&&v!=""){win.animateTarget.dom.value=v;}else{return;}
win.close();}
function queryClear(){var win=L5.getCmp("queryDate~");win.animateTarget.dom.value="";win.close();}
function queryClose(){var win=L5.getCmp("queryDate~");win.close();}
function getV(cmp){var t=cmp.getActiveTab().title;var tempStr4dataDetail=L5.data_showText?L5.data_showText["dataDetailText"]:tempShowText["dataDetailText"];var tempStr4pleaseSelectData=L5.data_showText?L5.data_showText["pleaseSelectDataText"]:tempShowText["pleaseSelectDataText"];var tempStr4invalidDataFormat=L5.data_showText?L5.data_showText["invalidDataFormatText"]:tempShowText["invalidDataFormatText"];var tempStr4byTimeperiod=L5.data_showText?L5.data_showText["byTimeperiodText"]:tempShowText["byTimeperiodText"];var tempStr4pleaseInputStartData=L5.data_showText?L5.data_showText["pleaseInputStartDataText"]:tempShowText["pleaseInputStartDataText"];var tempStr4invalidStartDataFormat=L5.data_showText?L5.data_showText["invalidStartDataFormatText"]:tempShowText["invalidStartDataFormatText"];var tempStr4pleaseInputEndData=L5.data_showText?L5.data_showText["pleaseInputEndDataText"]:tempShowText["pleaseInputEndDataText"];var tempStr4invalidStartDataFormat=L5.data_showText?L5.data_showText["invalidStartDataFormatText"]:tempShowText["invalidStartDataFormatText"];var tempStr4endVSStartData=L5.data_showText?L5.data_showText["endVSStartDataText"]:tempShowText["endVSStartDataText"];var tempStr4byMonth=L5.data_showText?L5.data_showText["byMonthText"]:tempShowText["byMonthText"];var tempStr4invalidMonthFormat=L5.data_showText?L5.data_showText["invalidMonthFormatText"]:tempShowText["invalidMonthFormatText"];var tempStr4byYear=L5.data_showText?L5.data_showText["byYearText"]:tempShowText["byYearText"];var tempStr4invalidYearFormat=L5.data_showText?L5.data_showText["invalidYearFormatText"]:tempShowText["invalidYearFormatText"];if(t==tempStr4dataDetail){var v=L5.getDom("$dateq1").value;var format=document.getElementById("$dateq1").getAttribute("format");if(v==null||v==""){alert(tempStr4pleaseSelectData);return;}
if(!L5.isDateTime.call(v,format)){alert(String.format(tempStr4invalidDataFormat,format));return;}
return v;}else if(t==tempStr4byTimeperiod){var v1=L5.getDom("$dateq2").value;var v2=L5.getDom("$dateq3").value;if(v1==null||v1==""){alert(tempStr4pleaseInputStartData);return;}
var format2=document.getElementById("$dateq2").getAttribute("format");if(!L5.isDateTime.call(v1,format2)){alert(String.format(tempStr4invalidStartDataFormat,format2));return;}
if(v2==null||v2==""){alert(tempStr4pleaseInputEndData);return;}
var format3=document.getElementById("$dateq3").getAttribute("format");if(!L5.isDateTime.call(v2,format3)){alert(String.format(tempStr4invalidStartDataFormat,format3));return;}
if(v1>v2){alert(tempStr4endVSStartData);return;}
return v1+"~"+v2;}else if(t==tempStr4byMonth){var v1=L5.getDom("$dateq4").value;var v2=L5.getDom("$dateq5").value;if(/^[-\+]?\d+$/.test(v1)==false){alert(tempStr4invalidMonthFormat)
return;}
return v1+"-"+v2}else if(t==tempStr4byYear){var v1=L5.getDom("$dateq6").value;if(/^[-\+]?\d+$/.test(v1)==false){alert(tempStr4invalidYearFormat)
return;}
return v1;}}})();

(function(){var showDatetimeMenu=function(target){if((typeof target)=='string'){target=document.getElementById(target);}
var datetimemenu=getDatetimeMenu(target);if(!datetimemenu){datetimemenu=createDatetimeMenu(target);cacheDatetimeMenu(target,datetimemenu);}
datetimemenu.triggerTarget=target;datetimemenu.on(L5.apply({},datetimemenuListeners));var datetime=false;var format=target.format;var defaultDateTime=target.getAttribute("defaultDateTime");if(defaultDateTime){datetimemenu.picker.defaultDatetime=parseDatetime(defaultDateTime,format);}
if(target.value&&target.value!=""){var datetimevalue=target.value;datetime=parseDatetime(datetimevalue,format);}else if(defaultDateTime&&defaultDateTime!=""){datetime=parseDatetime(defaultDateTime,format);}
datetimemenu.picker.setValue(datetime||new Date());datetimemenu.show(target,"tl-bl?");};var triggerShowDatetimeMenu=function(evt){var target=evt.srcElement||evt.target;showDatetimeMenu(target);};var clearElValue=function(clearEvt){var target=clearEvt.srcElement||clearEvt.target;if((typeof target)=='string'){target=document.getElementById(target);}
var datetimemenu=getDatetimeMenu(target);if(datetimemenu)
datetimemenu.hide();target.value="";};var createDatetimeMenu=function(renderEl){var datetimeId=renderEl.datetimeId||renderEl.getAttribute("datetimeId");if(datetimeId==null){renderEl.setAttribute("datetimeId",L5.id());datetimeId=renderEl.datetimeId=(datetimeId==null?L5.id():datetimeId)}
var menu=new L5.menu.DatetimeMenu({id:datetimeId});var prop={};prop.format=renderEl.format||renderEl.getAttribute("format")||"Ymd";prop.value=renderEl.showToday||renderEl.getAttribute("showToday")||true;L5.apply(menu.picker,prop);return menu;};var cacheDatetimeMenu=function(target,datetimemenu){target.dateId=datetimemenu.id;target.format=datetimemenu.picker.format;target.showToday=datetimemenu.picker.showToday;};var getDatetimeMenu=function(renderEl){var menu=false;if(renderEl.datetimeId){menu=L5.menu.MenuMgr.get(renderEl.datetimeId);}
return menu;};var targetfocus=function(){try{this.dom.focus();}catch(e){}};var datetimemenuListeners={select:function(m,d){var target=m.parentMenu.triggerTarget;var format=target.format;var datesellis=target.datetimeselect;if(!datesellis){var datesel=target.getAttribute("ondatetimeselect");if(!datesel){datesellis=target.datetimeselect=L5.emptyFn;}else{if(typeof(datesel)=='string'){datesellis=target.datetimeselect=window[datesel];}}}
if(datesellis(target,d,format)!==false){var datevalue=d.dateFormat(format);target.value=datevalue;L5.fireEvent(target,"blur");};},hide:function(datetimemenu){var target=datetimemenu.triggerTarget;datetimemenu.triggerTarget=false;targetfocus.defer(10,target);datetimemenu.un("select",datetimemenuListeners.select);datetimemenu.un("hide",datetimemenuListeners.hide);}};var altFormatsArray=["m/d/Y","m/d/Y h","m/d/Y h:i","m/d/Y h:i:s","n/j/Y","n/j/Y h","n/j/Y h:i","n/j/Y h:i:s","n/j/y","n/j/y h","n/j/y h:i","n/j/y h:i:s","m/j/y","m/j/y h","m/j/y h:i","m/j/y h:i:s","n/d/y","n/d/y h","n/d/y h:i","n/d/y h:i:s","m/j/Y","m/j/Y h","m/j/Y h:i","m/j/Y h:i:s","n/d/Y","n/d/Y h","n/d/Y h:i","n/d/Y h:i:s","m-d-y","m-d-y h","m-d-y h:i","m-d-y h:i:s","m-d-Y","m-d-Y h","m-d-Y h:i","m-d-Y h:i:s","m/d","m/d h","m/d h:i","m/d h:i:s","m-d","m-d h","m-d h:i","m-d h:i:s","md","md h","md h:i","md h:i:s","mdy","mdy h","mdy h:i","mdy h:i:s","mdY","mdY h","mdY h:i","mdY h:i:s","d","d h","d h:i","d h:i:s","Y-m-d","Y-m-d h","Y-m-d h:i","Y-m-d h:i:s"];var parseDatetime=function(value,format){if(!value||L5.isDate(value)){return value;}
var v=Date.parseDate(value,format);if(!v){for(var i=0,len=altFormatsArray.length;i<len&&!v;i++){v=Date.parseDate(value,altFormatsArray[i]);}}
return v;};var addEventListener=function(evt,target,func){if(window.addEventListener){target.addEventListener(evt,func,false);}else if(window.attachEvent){target.attachEvent("on"+evt,func);}else{alert("Not support this explorer");return;}};var addHotKey=function(hotKey,target){target.hotKey=hotKey;addEventListener("keydown",target,hotKeyListener);};var hotKeyListener=function(evt){evt=evt||window.event;if(evt.ctrlKey){var keycode=evt.keyCode||evt.which;var ch=_keycodeMap[keycode];var target=evt.srcElement||evt.target;if(ch==target.hotKey){showDatetimeMenu(target);preventDefault(evt);}}};var preventDefault=function(evt){if(window.event){window.event.returnValue=false;return;}else if(evt.preventDefault){evt.preventDefault();}};var k='LoushangDatetimebind';var kImg='LoushangDatetimebindImg';window[k]=function(renderEl,evt,clearEvt,defaultDateTime){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDateTime",defaultDateTime);}
if(evt){addEventListener(evt,renderEl,triggerShowDatetimeMenu);}
if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}
var hotKey=renderEl.getAttribute('hotKey');if(hotKey){addHotKey(hotKey,renderEl);}}
var t="Lous"+"han"+"gDa"+"te"+'ti'+'me';window[t]=function(renderEl,clearEvt,defaultDateTime){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDateTime",defaultDateTime);}
showDatetimeMenu(renderEl);if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}
window[kImg]=function(renderEl,evt,clearEvt,defaultDateTime){if((typeof renderEl)=='string'){renderEl=document.getElementById(renderEl);}
if(renderEl){renderEl.setAttribute("defaultDateTime",defaultDateTime);}
var img=document.createElement("img");img.src=L5.webPath+"/skins/images/default/button/btn-date.gif";img.style.cursor="pointer";img.style.backgroundAttachment="fixed";renderEl.parentNode.insertBefore(img,renderEl.nextSibling);if(evt){addEventListener(evt,img,function(){showDatetimeMenu(renderEl);});}
if(clearEvt){if(clearEvt!='false'&&clearEvt!=false){if(clearEvt=='true'||clearEvt==true)
clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}}else if(clearEvt==false||clearEvt=='false'){}else{clearEvt='dblclick';addEventListener(clearEvt,renderEl,clearElValue);}
var hotKey=renderEl.getAttribute('hotKey');if(hotKey){addHotKey(hotKey,renderEl);}}})()

L5.ux.DDView=function(config){if(!config.itemSelector){var tpl=config.tpl;if(this.classRe.test(tpl)){config.tpl=tpl.replace(this.classRe,'class=$1x-combo-list-item $2$1');}
else{config.tpl=tpl.replace(this.tagRe,'$1 class="l-combo-list-item" $2');}
config.itemSelector=".l-combo-list-item";}
L5.ux.DDView.superclass.constructor.call(this,L5.apply(config,{border:false}));};L5.extend(L5.ux.DDView,L5.DataView,{sortDir:'ASC',isFormField:true,classRe:/class=([\u0027\u0022])(.*)\1/,tagRe:/(<\w*)(.*?>)/,reset:L5.emptyFn,clearInvalid:L5.form.Field.prototype.clearInvalid,afterRender:function(){L5.ux.DDView.superclass.afterRender.call(this);if(this.dragGroup){this.setDraggable(this.dragGroup.split(","));}
if(this.dropGroup){this.setDroppable(this.dropGroup.split(","));}
if(this.deletable){this.setDeletable();}
this.isDirtyFlag=false;this.addEvents("drop");},validate:function(){return true;},destroy:function(){this.purgeListeners();this.getEl().removeAllListeners();this.getEl().remove();if(this.dragZone){if(this.dragZone.destroy){this.dragZone.destroy();}}
if(this.dropZone){if(this.dropZone.destroy){this.dropZone.destroy();}}},getName:function(){return this.name;},setValue:function(v){if(!this.dataset){throw"DDView.setValue(). DDView must be constructed with a valid Dataset";}
var data={};data[this.dataset.reader.meta.root]=v?[].concat(v):[];this.dataset.proxy=new L5.model.MemoryProxy(data);this.dataset.load();},getValue:function(){var result='(';this.dataset.each(function(rec){result+=rec.id+',';});return result.substr(0,result.length-1)+')';},getIds:function(){var i=0,result=new Array(this.dataset.getCount());this.dataset.each(function(rec){result[i++]=rec.id;});return result;},isDirty:function(){return this.isDirtyFlag;},getTargetFromEvent:function(e){var target=e.getTarget();while((target!==null)&&(target.parentNode!=this.el.dom)){target=target.parentNode;}
if(!target){target=this.el.dom.lastChild||this.el.dom;}
return target;},getDragData:function(e){var target=this.findItemFromChild(e.getTarget());if(target){if(!this.isSelected(target)){delete this.ignoreNextClick;this.onItemClick(target,this.indexOf(target),e);this.ignoreNextClick=true;}
var dragData={sourceView:this,viewNodes:[],records:[],copy:this.copy||(this.allowCopy&&e.ctrlKey)};if(this.getSelectionCount()==1){var i=this.getSelectedIndexes()[0];var n=this.getNode(i);dragData.viewNodes.push(dragData.ddel=n);dragData.records.push(this.dataset.getAt(i));dragData.repairXY=L5.fly(n).getXY();}else{dragData.ddel=document.createElement('div');dragData.ddel.className='multi-proxy';this.collectSelection(dragData);}
return dragData;}
return false;},getRepairXY:function(e){return this.dragData.repairXY;},collectSelection:function(data){data.repairXY=L5.fly(this.getSelectedNodes()[0]).getXY();if(this.preserveSelectionOrder===true){L5.each(this.getSelectedIndexes(),function(i){var n=this.getNode(i);var dragNode=n.cloneNode(true);dragNode.id=L5.id();data.ddel.appendChild(dragNode);data.records.push(this.dataset.getAt(i));data.viewNodes.push(n);},this);}else{var i=0;this.dataset.each(function(rec){if(this.isSelected(i)){var n=this.getNode(i);var dragNode=n.cloneNode(true);dragNode.id=L5.id();data.ddel.appendChild(dragNode);data.records.push(this.dataset.getAt(i));data.viewNodes.push(n);}
i++;},this);}},setDraggable:function(ddGroup){if(ddGroup instanceof Array){L5.each(ddGroup,this.setDraggable,this);return;}
if(this.dragZone){this.dragZone.addToGroup(ddGroup);}else{this.dragZone=new L5.dd.DragZone(this.getEl(),{containerScroll:true,ddGroup:ddGroup});if(!this.multiSelect){this.singleSelect=true;}
this.dragZone.getDragData=this.getDragData.createDelegate(this);this.dragZone.getRepairXY=this.getRepairXY;this.dragZone.onEndDrag=this.onEndDrag;}},setDroppable:function(ddGroup){if(ddGroup instanceof Array){L5.each(ddGroup,this.setDroppable,this);return;}
if(this.dropZone){this.dropZone.addToGroup(ddGroup);}else{this.dropZone=new L5.dd.DropZone(this.getEl(),{owningView:this,containerScroll:true,ddGroup:ddGroup});this.dropZone.getTargetFromEvent=this.getTargetFromEvent.createDelegate(this);this.dropZone.onNodeEnter=this.onNodeEnter.createDelegate(this);this.dropZone.onNodeOver=this.onNodeOver.createDelegate(this);this.dropZone.onNodeOut=this.onNodeOut.createDelegate(this);this.dropZone.onNodeDrop=this.onNodeDrop.createDelegate(this);}},getDropPoint:function(e,n,dd){if(n==this.el.dom){return"above";}
var t=L5.lib.Dom.getY(n),b=t+n.offsetHeight;var c=t+(b-t)/2;var y=L5.lib.Event.getPageY(e);if(y<=c){return"above";}else{return"below";}},isValidDropPoint:function(pt,n,data){if(!data.viewNodes||(data.viewNodes.length!=1)){return true;}
var d=data.viewNodes[0];if(d==n){return false;}
if((pt=="below")&&(n.nextSibling==d)){return false;}
if((pt=="above")&&(n.previousSibling==d)){return false;}
return true;},onNodeEnter:function(n,dd,e,data){if(this.highlightColor&&(data.sourceView!=this)){this.el.highlight(this.highlightColor);}
return false;},onNodeOver:function(n,dd,e,data){var dragElClass=this.dropNotAllowed;var pt=this.getDropPoint(e,n,dd);if(this.isValidDropPoint(pt,n,data)){if(this.appendOnly||this.sortField){return"l-tree-drop-ok-below";}
if(pt){var targetElClass;if(pt=="above"){dragElClass=n.previousSibling?"l-tree-drop-ok-between":"l-tree-drop-ok-above";targetElClass="l-view-drag-insert-above";}else{dragElClass=n.nextSibling?"l-tree-drop-ok-between":"l-tree-drop-ok-below";targetElClass="l-view-drag-insert-below";}
if(this.lastInsertClass!=targetElClass){L5.fly(n).replaceClass(this.lastInsertClass,targetElClass);this.lastInsertClass=targetElClass;}}}
return dragElClass;},onNodeOut:function(n,dd,e,data){this.removeDropIndicators(n);},onNodeDrop:function(n,dd,e,data){if(this.fireEvent("drop",this,n,dd,e,data)===false){return false;}
var pt=this.getDropPoint(e,n,dd);var insertAt=(this.appendOnly||(n==this.el.dom))?this.dataset.getCount():n.viewIndex;if(pt=="below"){insertAt++;}
if(data.sourceView==this){if(pt=="below"){if(data.viewNodes[0]==n){data.viewNodes.shift();}}else{if(data.viewNodes[data.viewNodes.length-1]==n){data.viewNodes.pop();}}
if(!data.viewNodes.length){return false;}
if(insertAt>this.dataset.indexOf(data.records[0])){insertAt--;}}
if(data.node instanceof L5.tree.TreeNode){var r=data.node.getOwnerTree().recordFromNode(data.node);if(r){data.records=[r];}}
if(!data.records){alert("Programming problem. Drag data contained no Records");return false;}
for(var i=0;i<data.records.length;i++){var r=data.records[i];var recTemp={};L5.applyIf(recTemp,r);var dup=this.dataset.getById(r.id);if(dup&&(dd!=this.dragZone)){if(!this.allowDup&&!this.allowTrash){L5.fly(this.getNode(this.dataset.indexOf(dup))).frame("red",1);return true}
var x=new L5.model.Record();r.id=x.id;delete x;}
if(data.copy){this.dataset.insert(insertAt++,r.copy());}else{if(data.sourceView){data.sourceView.isDirtyFlag=true;data.sourceView.dataset.remove(r);}
if(!this.allowTrash){var dsChangeRecs=this.dataset.getAllChangedRecords();for(var k=0;k<dsChangeRecs.length;k++){var valueField=0;if(L5.getCmp(this.el.parent().parent().parent().id))
valueField=L5.getCmp(this.el.parent().parent().parent().id).valueField;if(dsChangeRecs[k].get(valueField)===recTemp.get(valueField)){recTemp=dsChangeRecs[k];break;}}
this.dataset.insert(insertAt++,recTemp);}}
if(this.sortField){this.dataset.sort(this.sortField,this.sortDir);}
this.isDirtyFlag=true;}
this.dragZone.cachedTarget=null;return true;},onEndDrag:function(data,e){var d=L5.get(this.dragData.ddel);if(d&&d.hasClass("multi-proxy")){d.remove();}},removeDropIndicators:function(n){if(n){L5.fly(n).removeClass(["l-view-drag-insert-above","l-view-drag-insert-left","l-view-drag-insert-right","l-view-drag-insert-below"]);this.lastInsertClass="_noclass";}},setDeletable:function(imageUrl){if(!this.singleSelect&&!this.multiSelect){this.singleSelect=true;}
var c=this.getContextMenu();this.contextMenu.on("itemclick",function(item){switch(item.id){case"delete":this.remove(this.getSelectedIndexes());break;}},this);this.contextMenu.add({icon:imageUrl||AU.resolveUrl("/images/delete.gif"),id:"delete",text:AU.getMessage("deleteItem")});},getContextMenu:function(){if(!this.contextMenu){this.contextMenu=new L5.menu.Menu({id:this.id+"-contextmenu"});this.el.on("contextmenu",this.showContextMenu,this);}
return this.contextMenu;},disableContextMenu:function(){if(this.contextMenu){this.el.un("contextmenu",this.showContextMenu,this);}},showContextMenu:function(e,item){item=this.findItemFromChild(e.getTarget());if(item){e.stopEvent();this.select(this.getNode(item),this.multiSelect&&e.ctrlKey,true);this.contextMenu.showAt(e.getXY());}},remove:function(selectedIndices){selectedIndices=[].concat(selectedIndices);for(var i=0;i<selectedIndices.length;i++){var rec=this.dataset.getAt(selectedIndices[i]);this.dataset.remove(rec);}},onDblClick:function(e){var item=this.findItemFromChild(e.getTarget());if(item){if(this.fireEvent("dblclick",this,this.indexOf(item),item,e)===false){return false;}
if(this.dragGroup){var targets=L5.dd.DragDropMgr.getRelated(this.dragZone,true);while(targets.indexOf(this.dropZone)!==-1){targets.remove(this.dropZone);}
if((targets.length==1)&&(targets[0].owningView)){this.dragZone.cachedTarget=null;var el=L5.get(targets[0].getEl());var box=el.getBox(true);targets[0].onNodeDrop(el.dom,{target:el.dom,xy:[box.x,box.y+box.height-1]},null,this.getDragData(e));}}}},onItemClick:function(item,index,e){if(this.ignoreNextClick){delete this.ignoreNextClick;return;}
if(this.fireEvent("beforeclick",this,index,item,e)===false){return false;}
if(this.multiSelect||this.singleSelect){if(this.multiSelect&&e.shiftKey&&this.lastSelection){this.select(this.getNodes(this.indexOf(this.lastSelection),index),false);}else if(this.isSelected(item)&&e.ctrlKey){this.deselect(item);}else{this.deselect(item);this.select(item,this.multiSelect&&e.ctrlKey);this.lastSelection=item;}
e.preventDefault();}
return true;}});

L5.ux.Multiselect=L5.extend(L5.form.Field,{dataset:null,dataFields:[],data:[],displayField:1,valueField:0,allowBlank:true,minLength:0,maxLength:Number.MAX_VALUE,blankText:L5.form.TextField.prototype.blankText,minLengthText:'Minimum {0} item(s) required',maxLengthText:'Maximum {0} item(s) allowed',copy:false,allowDup:false,allowTrash:false,legend:null,focusClass:undefined,delimiter:',',view:null,dragGroup:null,dropGroup:null,tbar:null,appendOnly:false,sortField:null,sortDir:'ASC',defaultAutoCreate:{tag:"div"},initComponent:function(){L5.ux.Multiselect.superclass.initComponent.call(this);this.addEvents({'dblclick':true,'click':true,'change':true,'drop':true});},onRender:function(ct,position){var fs,cls,tpl;L5.ux.Multiselect.superclass.onRender.call(this,ct,position);cls='ux-mselect';fs=new L5.form.FieldSet({renderTo:this.el,title:this.legend,height:this.height,width:this.width,style:"padding:1px;",tbar:this.tbar});fs.body.addClass(cls);tpl='<tpl for="."><div class="'+cls+'-item';if(L5.isIE||L5.isIE7)tpl+='" unselectable=on';else tpl+=' l-unselectable"';tpl+='>{'+this.displayField+'}</div></tpl>';if(!this.dataset){this.dataset=new L5.model.SimpleDataset({fields:this.dataFields,data:this.data});}
this.view=new L5.ux.DDView({multiSelect:true,dataset:this.dataset,selectedClass:cls+"-selected",tpl:tpl,allowDup:this.allowDup,copy:this.copy,allowTrash:this.allowTrash,dragGroup:this.dragGroup,dropGroup:this.dropGroup,itemSelector:"."+cls+"-item",isFormField:false,applyTo:fs.body,appendOnly:this.appendOnly,sortField:this.sortField,sortDir:this.sortDir});fs.add(this.view);this.view.on('click',this.onViewClick,this);this.view.on('beforeClick',this.onViewBeforeClick,this);this.view.on('dblclick',this.onViewDblClick,this);this.view.on('drop',function(ddView,n,dd,e,data){return this.fireEvent("drop",ddView,n,dd,e,data);},this);this.hiddenName=this.name;var hiddenTag={tag:"input",type:"hidden",value:"",name:this.name};if(this.isFormField){this.hiddenField=this.el.createChild(hiddenTag);}else{this.hiddenField=L5.get(document.body).createChild(hiddenTag);}
fs.doLayout();},initValue:L5.emptyFn,onViewClick:function(vw,index,node,e){var arrayIndex=this.preClickSelections.indexOf(index);if(arrayIndex!=-1)
{this.preClickSelections.splice(arrayIndex,1);this.view.clearSelections(true);this.view.select(this.preClickSelections);}
this.fireEvent('change',this,this.getValue(),this.hiddenField.dom.value);this.hiddenField.dom.value=this.getValue();this.fireEvent('click',this,e);this.validate();},onViewBeforeClick:function(vw,index,node,e){this.preClickSelections=this.view.getSelectedIndexes();if(this.disabled){return false;}},onViewDblClick:function(vw,index,node,e){return this.fireEvent('dblclick',vw,index,node,e);},getValue:function(valueField){var returnArray=[];var selectionsArray=this.view.getSelectedIndexes();if(selectionsArray.length==0){return'';}
for(var i=0;i<selectionsArray.length;i++){returnArray.push(this.dataset.getAt(selectionsArray[i]).get(((valueField!=null)?valueField:this.valueField)));}
return returnArray.join(this.delimiter);},setValue:function(values){var index;var selections=[];this.view.clearSelections();this.hiddenField.dom.value='';if(!values||(values=='')){return;}
if(!(values instanceof Array)){values=values.split(this.delimiter);}
for(var i=0;i<values.length;i++){index=this.view.dataset.indexOf(this.view.dataset.query(this.valueField,new RegExp('^'+values[i]+'$',"i")).itemAt(0));selections.push(index);}
this.view.select(selections);this.hiddenField.dom.value=this.getValue();this.validate();},reset:function(){this.setValue('');},getRawValue:function(valueField){var tmp=this.getValue(valueField);if(tmp.length){tmp=tmp.split(this.delimiter);}
else{tmp=[];}
return tmp;},setRawValue:function(values){setValue(values);},validateValue:function(value){if(value.length<1){if(this.allowBlank){this.clearInvalid();return true;}else{this.markInvalid(this.blankText);return false;}}
if(value.length<this.minLength){this.markInvalid(String.format(this.minLengthText,this.minLength));return false;}
if(value.length>this.maxLength){this.markInvalid(String.format(this.maxLengthText,this.maxLength));return false;}
return true;}});L5.reg("multiselect",L5.ux.Multiselect);L5.ux.ItemSelector=L5.extend(L5.form.Field,{name:null,field:null,msWidth:150,msHeight:200,hideNavIcons:false,iconUp:"multiselect_up2",iconDown:"multiselect_down2",iconLeft:"multiselect_left2",iconRight:"multiselect_right2",iconTop:"multiselect_top2",iconBottom:"multiselect_bottom2",drawUpIcon:true,drawDownIcon:true,drawLeftIcon:true,drawRightIcon:true,drawTopIcon:true,drawBotIcon:true,fromDataset:null,toDataset:null,fromData:null,displayField:1,valueField:0,switchToFrom:false,allowDup:false,focusClass:undefined,delimiter:',',readOnly:false,toLegend:"Selected Items",fromLegend:"Optional Items",toSortField:null,fromSortField:null,toSortDir:'ASC',fromSortDir:'ASC',toTBar:null,fromTBar:null,bodyStyle:null,border:false,defaultAutoCreate:{tag:"div"},initComponent:function(){L5.ux.ItemSelector.superclass.initComponent.call(this);this.addEvents({'rowdblclick':true,'change':true});},onRender:function(ct,position){L5.ux.ItemSelector.superclass.onRender.call(this,ct,position);if(!this.fromDataset&&this.fromData){this.fromDataset=new L5.model.SimpleDataset({fields:this.dataFields,id:0,data:this.fromData});}
this.fromMultiselect=new L5.ux.Multiselect({legend:L5.fromLegendText?L5.fromLegendText:this.fromLegend,delimiter:this.delimiter,allowDup:this.allowDup,copy:this.allowDup,allowTrash:this.allowDup,dragGroup:this.readOnly?null:"drop2-"+this.el.dom.id,dropGroup:this.readOnly?null:"drop2-"+this.el.dom.id+",drop1-"+this.el.dom.id,width:this.msWidth,height:this.msHeight,dataFields:this.dataFields,displayField:this.displayField,valueField:this.valueField,dataset:this.fromDataset,isFormField:false,tbar:this.fromTBar,appendOnly:false,sortField:this.fromSortField,sortDir:this.fromSortDir});this.fromMultiselect.on('dblclick',this.onRowDblClick,this);if(!this.toDataset){this.toDataset=new L5.model.Dataset({fields:this.dataFields});}
this.toDataset.on('add',this.valueChanged,this);this.toDataset.on('remove',this.valueChanged,this);this.toDataset.on('load',this.valueChanged,this);this.toMultiselect=new L5.ux.Multiselect({legend:L5.toLegendText?L5.toLegendText:this.toLegend,delimiter:this.delimiter,allowDup:this.allowDup,dragGroup:this.readOnly?null:"drop1-"+this.el.dom.id,dropGroup:this.readOnly?null:"drop2-"+this.el.dom.id+",drop1-"+this.el.dom.id,width:this.msWidth,height:this.msHeight,displayField:this.displayField,valueField:this.valueField,dataset:this.toDataset,isFormField:false,tbar:this.toTBar,sortField:this.toSortField,sortDir:this.toSortDir});this.toMultiselect.on('dblclick',this.onRowDblClick,this);var p=new L5.Panel({bodyStyle:this.bodyStyle,border:this.border,layout:"table",layoutConfig:{columns:3}});p.add(this.switchToFrom?this.toMultiselect:this.fromMultiselect);var icons=new L5.Panel({header:false});p.add(icons);p.add(this.switchToFrom?this.fromMultiselect:this.toMultiselect);p.render(this.el);icons.el.down('.'+icons.bwrapCls).remove();var el=icons.getEl();if(!this.toSortField){this.toTopIcon=el.createChild({tag:"button",cls:this.iconTop,style:{margin:'2px',width:'20px'}});el.createChild({tag:'br'});this.upIcon=el.createChild({tag:"button",cls:this.iconUp,style:{margin:'2px',width:'20px'}});el.createChild({tag:'br'});}
this.addIcon=el.createChild({tag:"button",cls:this.switchToFrom?this.iconLeft:this.iconRight,style:{margin:'2px',width:'20px'}});el.createChild({tag:'br'});this.removeIcon=el.createChild({tag:"button",cls:this.switchToFrom?this.iconRight:this.iconLeft,style:{margin:'2px',width:'20px'}});el.createChild({tag:'br'});if(!this.toSortField){this.downIcon=el.createChild({tag:"button",cls:this.iconDown,style:{margin:'2px',width:'20px'}});el.createChild({tag:'br'});this.toBottomIcon=el.createChild({tag:"button",cls:this.iconBottom,style:{margin:'2px',width:'20px'}});}
if(!this.readOnly){if(!this.toSortField){this.toTopIcon.on('click',this.toTop,this);this.upIcon.on('click',this.up,this);this.downIcon.on('click',this.down,this);this.toBottomIcon.on('click',this.toBottom,this);}
this.addIcon.on('click',this.fromTo,this);this.removeIcon.on('click',this.toFrom,this);}
if(!this.drawUpIcon||this.hideNavIcons){this.upIcon.dom.style.display='none';}
if(!this.drawDownIcon||this.hideNavIcons){this.downIcon.dom.style.display='none';}
if(!this.drawLeftIcon||this.hideNavIcons){this.addIcon.dom.style.display='none';}
if(!this.drawRightIcon||this.hideNavIcons){this.removeIcon.dom.style.display='none';}
if(!this.drawTopIcon||this.hideNavIcons){this.toTopIcon.dom.style.display='none';}
if(!this.drawBotIcon||this.hideNavIcons){this.toBottomIcon.dom.style.display='none';}
var tb=p.body.first();if(L5.isIE){this.el.setWidth(p.body.first().getWidth());}else{this.el.setWidth(p.body.first().getWidth()+105);}
p.body.removeClass();this.hiddenName=this.name;var temp=L5.get(this.id);if(temp==null){var hiddenTag={tag:"input",type:"hidden",value:"",name:this.name,field:this.field,systype:'itemselector'};this.hiddenField=this.el.createChild(hiddenTag);}else{this.hiddenField=temp;}
this.valueChanged(this.toDataset);},initValue:L5.emptyFn,setSelectedValues:function(values){if(!(values instanceof Array)){if(!values||values==""){this.reset();return;}
values=values.split(this.delimiter);}
this.reset(false);var formDataset,toDataset;var records=[];for(var i=0;i<values.length;i++){var record=this.fromMultiselect.dataset.getById(values[i]);if(record){records[records.length]=record;this.fromMultiselect.dataset.remove(record);}}
if(records){this.toMultiselect.dataset.add(records);}},toTop:function(){var selectionsArray=this.toMultiselect.view.getSelectedIndexes();var records=[];if(selectionsArray.length>0){selectionsArray.sort();for(var i=0;i<selectionsArray.length;i++){record=this.toMultiselect.view.dataset.getAt(selectionsArray[i]);records.push(record);}
selectionsArray=[];for(var i=records.length-1;i>-1;i--){record=records[i];this.toMultiselect.view.dataset.remove(record);this.toMultiselect.view.dataset.insert(0,record);selectionsArray.push(((records.length-1)-i));}}
this.toMultiselect.view.refresh();this.toMultiselect.view.select(selectionsArray);},toBottom:function(){var selectionsArray=this.toMultiselect.view.getSelectedIndexes();var records=[];if(selectionsArray.length>0){selectionsArray.sort();for(var i=0;i<selectionsArray.length;i++){record=this.toMultiselect.view.dataset.getAt(selectionsArray[i]);records.push(record);}
selectionsArray=[];for(var i=0;i<records.length;i++){record=records[i];this.toMultiselect.view.dataset.remove(record);this.toMultiselect.view.dataset.add(record);selectionsArray.push((this.toMultiselect.view.dataset.getCount())-(records.length-i));}}
this.toMultiselect.view.refresh();this.toMultiselect.view.select(selectionsArray);},up:function(){var record=null;var selectionsArray=this.toMultiselect.view.getSelectedIndexes();selectionsArray.sort();var newSelectionsArray=[];if(selectionsArray.length>0){for(var i=0;i<selectionsArray.length;i++){record=this.toMultiselect.view.dataset.getAt(selectionsArray[i]);if((selectionsArray[i]-1)>=0){this.toMultiselect.view.dataset.remove(record);this.toMultiselect.view.dataset.insert(selectionsArray[i]-1,record);newSelectionsArray.push(selectionsArray[i]-1);}}
this.toMultiselect.view.refresh();this.toMultiselect.view.select(newSelectionsArray);}},down:function(){var record=null;var selectionsArray=this.toMultiselect.view.getSelectedIndexes();selectionsArray.sort();selectionsArray.reverse();var newSelectionsArray=[];if(selectionsArray.length>0){for(var i=0;i<selectionsArray.length;i++){record=this.toMultiselect.view.dataset.getAt(selectionsArray[i]);if((selectionsArray[i]+1)<this.toMultiselect.view.dataset.getCount()){this.toMultiselect.view.dataset.remove(record);this.toMultiselect.view.dataset.insert(selectionsArray[i]+1,record);newSelectionsArray.push(selectionsArray[i]+1);}}
this.toMultiselect.view.refresh();this.toMultiselect.view.select(newSelectionsArray);}},fromTo:function(){var selectionsArray=this.fromMultiselect.view.getSelectedIndexes();var records=[];if(selectionsArray.length>0){for(var i=0;i<selectionsArray.length;i++){record=this.fromMultiselect.view.dataset.getAt(selectionsArray[i]);records.push(record);}
if(!this.allowDup)selectionsArray=[];for(var i=0;i<records.length;i++){record=records[i];if(this.allowDup){var x=new L5.model.Record();record.id=x.id;delete x;this.toMultiselect.view.dataset.add(record);}else{var toDsChangeRecs=this.toMultiselect.view.dataset.getAllChangedRecords();var toRecTemp={};L5.applyIf(toRecTemp,record);this.fromMultiselect.view.dataset.remove(record);for(var k=0;k<toDsChangeRecs.length;k++){if(toDsChangeRecs[k].get(this.valueField)===toRecTemp.get(this.valueField)){toRecTemp=toDsChangeRecs[k];break;}}
this.toMultiselect.view.dataset.add(toRecTemp);selectionsArray.push((this.toMultiselect.view.dataset.getCount()-1));}}}
this.toMultiselect.view.refresh();this.fromMultiselect.view.refresh();if(this.toSortField)this.toMultiselect.dataset.sort(this.toSortField,this.toSortDir);if(this.allowDup)this.fromMultiselect.view.select(selectionsArray);else this.toMultiselect.view.select(selectionsArray);},toFrom:function(){var selectionsArray=this.toMultiselect.view.getSelectedIndexes();var records=[];if(selectionsArray.length>0){for(var i=0;i<selectionsArray.length;i++){record=this.toMultiselect.view.dataset.getAt(selectionsArray[i]);records.push(record);}
selectionsArray=[];for(var i=0;i<records.length;i++){record=records[i];var formRecTemp={};L5.applyIf(formRecTemp,record);this.toMultiselect.view.dataset.remove(record);if(!this.allowDup){var fromDsChangeRecs=this.fromMultiselect.view.dataset.getAllChangedRecords();for(var k=0;k<fromDsChangeRecs.length;k++){if(fromDsChangeRecs[k].get(this.valueField)===formRecTemp.get(this.valueField)){formRecTemp=fromDsChangeRecs[k];break;}}
this.fromMultiselect.view.dataset.add(formRecTemp);selectionsArray.push((this.fromMultiselect.view.dataset.getCount()-1));}}}
this.fromMultiselect.view.refresh();this.toMultiselect.view.refresh();if(this.fromSortField)this.fromMultiselect.dataset.sort(this.fromSortField,this.fromSortDir);this.fromMultiselect.view.select(selectionsArray);},valueChanged:function(ds){var record=null;var values=[];for(var i=0;i<ds.getCount();i++){record=ds.getAt(i);values.push(record.get(this.valueField));}
this.hiddenField.dom.value=values.join(this.delimiter);L5.fireEvent(this.hiddenField.dom,'change');this.fireEvent('change',this,this.getValue(),this.hiddenField.dom.value);},getValue:function(){return this.hiddenField.dom.value;},onRowDblClick:function(vw,index,node,e){return this.fireEvent('rowdblclick',vw,index,node,e);},reset:function(trigger){range=this.toMultiselect.dataset.getRange();if(range.length==0)return;this.toMultiselect.dataset.removeAll();if(!this.allowDup){this.fromMultiselect.dataset.add(range);if(!this.fromMultiselect.dataset.remoteSort){this.fromMultiselect.dataset.sort(this.fromSortField,'ASC');}}
if(trigger===false){return;}
this.valueChanged(this.toMultiselect.dataset);}});L5.reg("itemselector",L5.ux.ItemSelector);

(function(){var EV=L5.lib.Event;L5.ux.ManagedIFrame=function(){var args=Array.prototype.slice.call(arguments,0),el=L5.get(args[0]),config=args[0];if(el&&el.dom&&el.dom.tagName=='IFRAME'){config=args[1]||{};}else{config=args[0]||args[1]||{};el=config.autoCreate?L5.get(L5.DomHelper.append(config.autoCreate.parent||document.body,L5.apply({tag:'iframe',src:(L5.isIE&&L5.isSecure)?L5.SSL_SECURE_URL:''},config.autoCreate))):null;}
if(!el||el.dom.tagName!='IFRAME')return el;el.dom.name||(el.dom.name=el.dom.id);el.dom.mifId=el.dom.id;this.addEvents({"focus":true,"blur":true,"unload":true,"domready":true,"documentloaded":true,"exception":true,"message":true});if(config.listeners){this.listeners=config.listeners;L5.ux.ManagedIFrame.superclass.constructor.call(this);}
L5.apply(el,this);el.addClass('x-managed-iframe');if(config.style){el.applyStyles(config.style);}
el._maskEl=el.parent('.x-managed-iframe-mask')||el.parent().addClass('x-managed-iframe-mask');L5.apply(el,{disableMessaging:config.disableMessaging===true,loadMask:L5.apply({msg:'Loading..',msgCls:'x-mask-loading',maskEl:el._maskEl,hideOnReady:true,disabled:!config.loadMask},config.loadMask),_eventName:L5.isIE?'onreadystatechange':'onload',_windowContext:null,eventsFollowFrameLinks:typeof config.eventsFollowFrameLinks=='undefined'?true:config.eventsFollowFrameLinks});el.dom[el._eventName]=el.loadHandler.createDelegate(el);var um=el.updateManager=new L5.UpdateManager(el,true);um.showLoadIndicator=config.showLoadIndicator||false;if(config.src){el.setSrc(config.src);}else{var content=config.html||config.content||false;if(content){el.update.defer(10,el,[content]);}}
return L5.ux.ManagedIFrame.Manager.register(el);};var MIM=L5.ux.ManagedIFrame.Manager=function(){var frames={};var readyHandler=function(e,target){try{var id=target?target.mifId:null,frame;if((frame=this.getFrameById(id||target.id))&&frame._frameAction){frame.loadHandler({type:'domready'});}}catch(rhEx){}};var implementation={shimCls:'x-frame-shim',register:function(frame){frame.manager=this;frames[frame.id]=frames[frame.dom.name]={ref:frame,elCache:{}};return frame;},deRegister:function(frame){frame._unHook();delete frames[frame.id];delete frames[frame.dom.name];},hideShims:function(){if(!this.shimApplied)return;L5.select('.'+this.shimCls,true).removeClass(this.shimCls+'-on');this.shimApplied=false;},showShims:function(){if(!this.shimApplied){this.shimApplied=true;L5.select('.'+this.shimCls,true).addClass(this.shimCls+'-on');}},getFrameById:function(id){return typeof id=='string'?(frames[id]?frames[id].ref||null:null):null;},getFrameByName:function(name){return this.getFrameById(name);},getFrameHash:function(frame){return frame.id?frames[frame.id]:null;},eventProxy:function(e){if(!e)return;e=L5.EventObject.setEvent(e);var be=e.browserEvent||e;if(e.type=='unload'){this._unHook();}
if(!be['eventPhase']||(be['eventPhase']==(be['AT_TARGET']||2))){return this.fireEvent(e.type,e);}},_flyweights:{},destroy:function(){if(this._domreadySignature){L5.EventManager.un.apply(L5.EventManager,this._domreadySignature);}},removeNode:L5.isIE?function(frame,n){frame=MIM.getFrameHash(frame);if(frame&&n&&n.tagName!='BODY'){d=frame.scratchDiv||(frame.scratchDiv=frame.getDocument().createElement('div'));d.appendChild(n);d.innerHTML='';}}:function(frame,n){if(n&&n.parentNode&&n.tagName!='BODY'){n.parentNode.removeChild(n);}}};if(document.addEventListener){L5.EventManager.on.apply(L5.EventManager,implementation._domreadySignature=[window,"DOMFrameContentLoaded",readyHandler,implementation]);}
L5.EventManager.on(window,'beforeunload',implementation.destroy,implementation);return implementation;}();MIM.showDragMask=MIM.showShims;MIM.hideDragMask=MIM.hideShims;MIM.El=function(frame,el,forceNew){var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null;}
var elCache=frameObj.elCache||(frameObj.elCache={});var dom=frame.getDom(el);if(!dom){return null;}
var id=dom.id;if(forceNew!==true&&id&&elCache[id]){return elCache[id];}
this.dom=dom;this.id=id||L5.id(dom);};MIM.El.get=function(frame,el){var ex,elm,id,doc;if(!frame||!el){return null;}
var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null;}
var elCache=frameObj.elCache||(frameObj.elCache={});if(!(doc=frame.getDocument())){return null;}
if(typeof el=="string"){if(!(elm=frame.getDom(el))){return null;}
if(ex=elCache[el]){ex.dom=elm;}else{ex=elCache[el]=new MIM.El(frame,elm);}
return ex;}else if(el.tagName){if(!(id=el.id)){id=L5.id(el);}
if(ex=elCache[id]){ex.dom=el;}else{ex=elCache[id]=new MIM.El(frame,el);}
return ex;}else if(el instanceof MIM.El){if(el!=frameObj.docEl){el.dom=frame.getDom(el.id)||el.dom;elCache[el.id]=el;}
return el;}else if(el.isComposite){return el;}else if(L5.isArray(el)){return frame.select(el);}else if(el==doc){if(!frameObj.docEl){var f=function(){};f.prototype=MIM.El.prototype;frameObj.docEl=new f();frameObj.docEl.dom=doc;}
return frameObj.docEl;}
return null;};L5.apply(MIM.El.prototype,L5.Element.prototype);L5.extend(L5.ux.ManagedIFrame,L5.util.Observable,{src:null,resetUrl:L5.isIE&&L5.isSecure?L5.SSL_SECURE_URL:'about:blank',setSrc:function(url,discardUrl,callback){var src=url||this.src||this.resetUrl;this._windowContext=null;this._unHook();this._frameAction=this.frameInit=this._domReady=false;if(L5.isOpera){this.reset();}
this._callBack=callback||false;this.showMask();(function(){var s=typeof src=='function'?src()||'':src;try{this._frameAction=true;this.dom.src=s;this.frameInit=true;this.checkDOM();}catch(ex){this.fireEvent('exception',this,ex);}}).defer(100,this);if(discardUrl!==true){this.src=src;}
return this;},reset:function(src,callback){this.dom.src=src||this.resetUrl;if(typeof callback=='function'){callback.defer(100);}
return this;},scriptRE:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,update:function(content,loadScripts,callback){loadScripts=loadScripts||this.getUpdater().loadScripts||false;content=L5.DomHelper.markup(content||'');content=loadScripts===true?content:content.replace(this.scriptRE,"");var doc;if(doc=this.getDocument()){this._frameAction=!!content.length;this._windowContext=this.src=null;this._callBack=callback||false;this._unHook();this.showMask();doc.open();doc.write(content);doc.close();this.frameInit=true;if(this._frameAction){this.checkDOM();}else{this.hideMask(true);if(this._callBack)this._callBack();}}else{this.hideMask(true);if(this._callBack)this._callBack();}
return this;},disableMessaging:true,_XFrameMessaging:function(){var tagStack={'$':[]};var isEmpty=function(v,allowBlank){return v===null||v===undefined||(!allowBlank?v==='':false);};window.sendMessage=function(message,tag,origin){var MIF;if(MIF=arguments.callee.manager){if(message._fromHost){var fn,result;var compTag=message.tag||tag||null;var mstack=!isEmpty(compTag)?tagStack[compTag.toLowerCase()]||[]:tagStack["$"];for(var i=0,l=mstack.length;i<l;i++){if(fn=mstack[i]){result=fn.apply(fn.__scope,arguments)===false?false:result;if(fn.__single){mstack[i]=null;}
if(result===false){break;}}}
return result;}else{message={type:isEmpty(tag)?'message':'message:'+tag.toLowerCase().replace(/^\s+|\s+$/g,''),data:message,domain:origin||document.domain,uri:document.documentURI,source:window,tag:isEmpty(tag)?null:tag.toLowerCase()};try{return MIF.disableMessaging!==true?MIF.fireEvent.call(MIF,message.type,MIF,message):null;}catch(ex){}
return null;}}};window.onhostmessage=function(fn,scope,single,tag){if(typeof fn=='function'){if(!isEmpty(fn.__index)){throw"onhostmessage: duplicate handler definition"+(tag?" for tag:"+tag:'');}
var k=isEmpty(tag)?"$":tag.toLowerCase();tagStack[k]||(tagStack[k]=[]);L5.apply(fn,{__tag:k,__single:single||false,__scope:scope||window,__index:tagStack[k].length});tagStack[k].push(fn);}else
{throw"onhostmessage: function required";}};window.unhostmessage=function(fn){if(typeof fn=='function'&&typeof fn.__index!='undefined'){var k=fn.__tag||"$";tagStack[k][fn.__index]=null;}};},get:function(el){return MIM.El.get(this,el);},fly:function(el,named){named=named||'_global';el=this.getDom(el);if(!el){return null;}
if(!MIM._flyweights[named]){MIM._flyweights[named]=new L5.Element.Flyweight();}
MIM._flyweights[named].dom=el;return MIM._flyweights[named];},getDom:function(el){var d;if(!el||!(d=this.getDocument())){return null;}
return el.dom?el.dom:(typeof el=='string'?d.getElementById(el):el);},select:function(selector,unique){var d;return(d=this.getDocument())?L5.Element.select(selector,unique,d):null;},query:function(selector){var d;return(d=this.getDocument())?L5.DomQuery.select(selector,d):null;},getDoc:function(){return this.get(this.getDocument());},removeNode:function(node){MIM.removeNode(this,this.getDom(node));},_unHook:function(){var elcache,h=MIM.getFrameHash(this)||{};if(this._hooked&&h&&(elcache=h.elCache)){for(var id in elcache){var el=elcache[id];delete elcache[id];if(el.removeAllListeners)el.removeAllListeners();}
if(h.docEl){h.docEl.removeAllListeners();h.docEl=null;delete h.docEl;}}
this._hooked=this._domReady=this._domFired=false;},_renderHook:function(){this._windowContext=this.CSS=null;this._hooked=false;try{if(this.writeScript('(function(){(window.hostMIF = parent.L5.get("'+
this.dom.id+'"))._windowContext='+
(L5.isIE?'window':'{eval:function(s){return eval(s);}}')+';})();')){this._frameProxy||(this._frameProxy=MIM.eventProxy.createDelegate(this));var w=this.getWindow();EV.doAdd(w,'focus',this._frameProxy);EV.doAdd(w,'blur',this._frameProxy);EV.doAdd(w,'unload',this._frameProxy);if(this.disableMessaging!==true){this.loadFunction({name:'XMessage',fn:this._XFrameMessaging},false,true);var sm;if(sm=w.sendMessage){sm.manager=this;}}
this.CSS=new CSSInterface(this.getDocument());}}catch(ex){}
return this.domWritable();},sendMessage:function(message,tag,origin){var win;if(this.disableMessaging!==true&&(win=this.getWindow())){tag||(tag=message.tag||'');tag=tag.toLowerCase();message=L5.applyIf(message.data?message:{data:message},{type:L5.isEmpty(tag)?'message':'message:'+tag,domain:origin||document.domain,uri:document.documentURI,source:window,tag:tag||null,_fromHost:this});return win.sendMessage?win.sendMessage.call(null,message,tag,origin):null;}
return null;},_windowContext:null,getDocument:function(){var win=this.getWindow(),doc=null;try{doc=(L5.isIE&&win?win.document:null)||this.dom.contentDocument||window.frames[this.id].document||null;}catch(gdEx){return false;}
return doc;},getBody:function(){var d;return(d=this.getDocument())?d.body:null;},getDocumentURI:function(){var URI,d;try{URI=this.src&&(d=this.getDocument())?d.location.href:null;}catch(ex){}
return URI||this.src;},getWindow:function(){var dom=this.dom,win=null;try{win=dom.contentWindow||window.frames[dom.name]||null;}catch(gwEx){}
return win;},print:function(){try{var win=this.getWindow();if(L5.isIE){win.focus();}
win.print();}catch(ex){throw'print exception: '+(ex.description||ex.message||ex);}},destroy:function(){this.removeAllListeners();if(this.dom){this.dom[this._eventName]=null;L5.ux.ManagedIFrame.Manager.deRegister(this);this._windowContext=null;if(L5.isIE&&this.dom.src){this.dom.src='javascript:false';}
this._maskEl=null;this.remove();}
if(this.loadMask){L5.apply(this.loadMask,{masker:null,maskEl:null});}},domWritable:function(){return!!this._windowContext;},execScript:function(block,useDOM){try{if(this.domWritable()){if(useDOM){this.writeScript(block);}else{return this._windowContext.eval(block);}}else{throw'execScript:non-secure context'}}catch(ex){this.fireEvent('exception',this,ex);return false;}
return true;},writeScript:function(block,attributes){attributes=L5.apply({},attributes||{},{type:"text/javascript",text:block});try{var head,script,doc=this.getDocument();if(doc&&typeof doc.getElementsByTagName!='undefined'){if(!(head=doc.getElementsByTagName("head")[0])){head=doc.createElement("head");doc.getElementsByTagName("html")[0].appendChild(head);}
if(head&&(script=doc.createElement("script"))){for(var attrib in attributes){if(attributes.hasOwnProperty(attrib)&&attrib in script){script[attrib]=attributes[attrib];}}
return!!head.appendChild(script);}}}catch(ex){this.fireEvent('exception',this,ex);}
return false;},loadFunction:function(fn,useDOM,invokeIt){var name=fn.name||fn;var fn=fn.fn||window[fn];this.execScript(name+'='+fn,useDOM);if(invokeIt){this.execScript(name+'()');}},showMask:function(msg,msgCls,forced){var lmask;if((lmask=this.loadMask)&&(!lmask.disabled||forced)){if(lmask._vis)return;lmask.masker||(lmask.masker=L5.get(lmask.maskEl||this.dom.parentNode||this.wrap({tag:'div',style:{position:'relative'}})));lmask._vis=true;lmask.masker.mask.defer(lmask.delay||5,lmask.masker,[msg||lmask.msg,msgCls||lmask.msgCls]);}},hideMask:function(forced){var tlm;if((tlm=this.loadMask)&&!tlm.disabled&&tlm.masker){if(!forced&&(tlm.hideOnReady!==true&&this._domReady)){return;}
tlm._vis=false;tlm.masker.unmask.defer(tlm.delay||5,tlm.masker);}},loadHandler:function(e,target){if(!this.frameInit||(!this._frameAction&&!this.eventsFollowFrameLinks)){return;}
target||(target={});var rstatus=(e&&typeof e.type!=='undefined'?e.type:this.dom.readyState);switch(rstatus){case'loading':case'interactive':break;case'domready':if(this._domReady)return;this._domReady=true;if(this._hooked=this._renderHook()){this._domFired=true;this.fireEvent("domready",this);}
case'domfail':this._domReady=true;this.hideMask();break;case'load':case'complete':if(!this._domReady){this.loadHandler({type:'domready',id:this.id});}
this.hideMask(true);if(this._frameAction||this.eventsFollowFrameLinks){this.fireEvent.defer(50,this,["documentloaded",this]);}
this._frameAction=this._frameInit=false;if(this.eventsFollowFrameLinks){this._domFired=this._domReady=false;}
if(this._callBack){this._callBack(this);}
break;default:}
this.frameState=rstatus;},checkDOM:function(win){if(L5.isOpera||L5.isGecko||!this._frameAction)return;var n=0,win=win||this.getWindow(),manager=this,domReady=false,max=300;var poll=function(){try{var doc=manager.getDocument(),body=null;if(doc===false){throw"Document Access Denied";}
if(!manager._domReady){domReady=!!(doc&&doc.getElementsByTagName);domReady=domReady&&(body=doc.getElementsByTagName('body')[0])&&!!body.innerHTML.length;}}catch(ex){n=max;}
if(!manager._frameAction||manager._domReady)return;if((++n<max)&&!domReady)
{setTimeout(arguments.callee,10);return;}
manager.loadHandler({type:domReady?'domready':'domfail'});};setTimeout(poll,40);}});var styleCamelRe=/(-[a-z])/gi;var styleCamelFn=function(m,a){return a.charAt(1).toUpperCase();};var CSSInterface=function(hostDocument){var doc;if(hostDocument){doc=hostDocument;return{rules:null,createStyleSheet:function(cssText,id){var ss;if(!doc)return;var head=doc.getElementsByTagName("head")[0];var rules=doc.createElement("style");rules.setAttribute("type","text/css");if(id){rules.setAttribute("id",id);}
if(L5.isIE){head.appendChild(rules);ss=rules.styleSheet;ss.cssText=cssText;}else{try{rules.appendChild(doc.createTextNode(cssText));}catch(e){rules.cssText=cssText;}
head.appendChild(rules);ss=rules.styleSheet?rules.styleSheet:(rules.sheet||doc.styleSheets[doc.styleSheets.length-1]);}
this.cacheStyleSheet(ss);return ss;},removeStyleSheet:function(id){if(!doc)return;var existing=doc.getElementById(id);if(existing){existing.parentNode.removeChild(existing);}},swapStyleSheet:function(id,url){this.removeStyleSheet(id);if(!doc)return;var ss=doc.createElement("link");ss.setAttribute("rel","stylesheet");ss.setAttribute("type","text/css");ss.setAttribute("id",id);ss.setAttribute("href",url);doc.getElementsByTagName("head")[0].appendChild(ss);},refreshCache:function(){return this.getRules(true);},cacheStyleSheet:function(ss){if(this.rules){this.rules={};}
try{var ssRules=ss.cssRules||ss.rules;for(var j=ssRules.length-1;j>=0;--j){this.rules[ssRules[j].selectorText]=ssRules[j];}}catch(e){}},getRules:function(refreshCache){if(this.rules==null||refreshCache){this.rules={};if(doc){var ds=doc.styleSheets;for(var i=0,len=ds.length;i<len;i++){try{this.cacheStyleSheet(ds[i]);}catch(e){}}}}
return this.rules;},getRule:function(selector,refreshCache){var rs=this.getRules(refreshCache);if(!L5.isArray(selector)){return rs[selector];}
for(var i=0;i<selector.length;i++){if(rs[selector[i]]){return rs[selector[i]];}}
return null;},updateRule:function(selector,property,value){if(!L5.isArray(selector)){var rule=this.getRule(selector);if(rule){rule.style[property.replace(styleCamelRe,styleCamelFn)]=value;return true;}}else{for(var i=0;i<selector.length;i++){if(this.updateRule(selector[i],property,value)){return true;}}}
return false;}};}};L5.ux.ManagedIframePanel=L5.extend(L5.Panel,{defaultSrc:null,bodyStyle:{height:'100%',width:'100%',position:'relative'},frameStyle:{overflow:'auto'},frameConfig:null,hideMode:!L5.isIE?'display':'display',shimCls:L5.ux.ManagedIFrame.Manager.shimCls,shimUrl:null,loadMask:false,stateful:false,animCollapse:L5.isIE&&L5.enableFx,autoScroll:false,closable:true,ctype:"L5.ux.ManagedIframePanel",showLoadIndicator:false,unsupportedText:'Inline frames are NOT enabled\/supported by your browser.',initComponent:function(){this.bodyCfg||(this.bodyCfg={cls:'x-managed-iframe-mask',children:[L5.apply({tag:'iframe',frameborder:0,cls:'x-managed-iframe',style:this.frameStyle||null,html:this.unsupportedText||null},this.frameConfig?this.frameConfig.autoCreate||{}:false,L5.isIE&&L5.isSecure?{src:L5.SSL_SECURE_URL}:false),{tag:'img',src:this.shimUrl||L5.BLANK_IMAGE_URL,cls:this.shimCls,galleryimg:"no"}]});this.autoScroll=false;this.items=null;if(this.stateful!==false){this.stateEvents||(this.stateEvents=['documentloaded']);}
L5.ux.ManagedIframePanel.superclass.initComponent.call(this);this.monitorResize||(this.monitorResize=this.fitToParent);this.addEvents({documentloaded:true,domready:true,message:true,exception:true});this.addListener=this.on;},doLayout:function(){if(this.fitToParent&&!this.ownerCt){var pos=this.getPosition(),size=(L5.get(this.fitToParent)||this.getEl().parent()).getViewSize();this.setSize(size.width-pos[0],size.height-pos[1]);}
L5.ux.ManagedIframePanel.superclass.doLayout.apply(this,arguments);},beforeDestroy:function(){if(this.rendered){if(this.tools){for(var k in this.tools){L5.destroy(this.tools[k]);}}
if(this.header&&this.headerAsText){var s;if(s=this.header.child('span'))s.remove();this.header.update('');}
L5.each(['iframe','shim','header','topToolbar','bottomToolbar','footer','loadMask','body','bwrap'],function(elName){if(this[elName]){if(typeof this[elName].destroy=='function'){this[elName].destroy();}else{L5.destroy(this[elName]);}
this[elName]=null;delete this[elName];}},this);}
L5.ux.ManagedIframePanel.superclass.beforeDestroy.call(this);},onDestroy:function(){L5.Panel.superclass.onDestroy.call(this);},onRender:function(ct,position){L5.ux.ManagedIframePanel.superclass.onRender.call(this,ct,position);if(this.iframe=this.body.child('iframe.x-managed-iframe')){this.iframe.ownerCt=this;var El=L5.Element;var mode=El[this.hideMode.toUpperCase()]||'x-hide-nosize';L5.each([this[this.collapseEl],this.floating?null:this.getActionEl(),this.iframe],function(el){if(el)el.setVisibilityMode(mode);},this);if(this.loadMask){this.loadMask=L5.apply({disabled:false,maskEl:this.body,hideOnReady:true},this.loadMask);}
if(this.iframe=new L5.ux.ManagedIFrame(this.iframe,{loadMask:this.loadMask,showLoadIndicator:this.showLoadIndicator,disableMessaging:this.disableMessaging,style:this.frameStyle})){this.loadMask=this.iframe.loadMask;this.relayEvents(this.iframe,["blur","focus","unload","documentloaded","domready","exception","message"].concat(this._msgTagHandlers||[]));delete this._msgTagHandlers;}
this.getUpdater().showLoadIndicator=this.showLoadIndicator||false;var ownerCt=this.ownerCt;while(ownerCt){ownerCt.on('afterlayout',function(container,layout){var MIM=L5.ux.ManagedIFrame.Manager,st=false;L5.each(['north','south','east','west'],function(region){var reg;if((reg=layout[region])&&reg.splitEl){st=true;if(!reg.split._splitTrapped){reg.split.on('beforeresize',MIM.showShims,MIM);reg.split._splitTrapped=true;}}},this);if(st&&!this._splitTrapped){this.on('resize',MIM.hideShims,MIM);this._splitTrapped=true;}},this,{single:true});ownerCt=ownerCt.ownerCt;}}
this.shim=L5.get(this.body.child('.'+this.shimCls));},toggleShim:function(){if(this.shim&&this.shimCls)this.shim.toggleClass(this.shimCls+'-on');},afterRender:function(container){var html=this.html;delete this.html;L5.ux.ManagedIframePanel.superclass.afterRender.call(this);if(this.iframe){if(this.defaultSrc){this.setSrc();}
else if(html){this.iframe.update(typeof html=='object'?L5.DomHelper.markup(html):html);}}},sendMessage:function(){if(this.iframe){this.iframe.sendMessage.apply(this.iframe,arguments);}},on:function(name){var tagRE=/^message\:/i,n=null;if(typeof name=='object'){for(var na in name){if(!this.filterOptRe.test(na)&&tagRE.test(na)){n||(n=[]);n.push(na.toLowerCase());}}}else if(tagRE.test(name)){n=[name.toLowerCase()];}
if(this.getFrame()&&n){this.relayEvents(this.iframe,n);}else{this._msgTagHandlers||(this._msgTagHandlers=[]);if(n)this._msgTagHandlers=this._msgTagHandlers.concat(n);}
L5.ux.ManagedIframePanel.superclass.on.apply(this,arguments);},setSrc:function(url,discardUrl,callback){url=url||this.defaultSrc||false;if(!url)return this;if(url.url){callback=url.callback||false;discardUrl=url.discardUrl||false;url=url.url||false;}
var src=url||(L5.isIE&&L5.isSecure?L5.SSL_SECURE_URL:'');if(this.rendered&&this.iframe){this.iframe.setSrc(src,discardUrl,callback);}
return this;},getState:function(){var URI=this.iframe?this.iframe.getDocumentURI()||null:null;return L5.apply(L5.ux.ManagedIframePanel.superclass.getState.call(this)||{},URI?{defaultSrc:typeof URI=='function'?URI():URI}:null);},getUpdater:function(){return this.rendered?(this.iframe||this.body).getUpdater():null;},getFrame:function(){return this.rendered?this.iframe:null},getFrameWindow:function(){return this.rendered&&this.iframe?this.iframe.getWindow():null;},getFrameDocument:function(){return this.rendered&&this.iframe?this.iframe.getDocument():null;},getFrameDoc:function(){return this.rendered&&this.iframe?this.iframe.getDoc():null;},getFrameBody:function(){return this.rendered&&this.iframe?this.iframe.getBody():null;},load:function(loadCfg){var um;if(um=this.getUpdater()){if(loadCfg&&loadCfg.renderer){um.setRenderer(loadCfg.renderer);delete loadCfg.renderer;}
um.update.apply(um,arguments);}
return this;},doAutoLoad:function(){this.load(typeof this.autoLoad=='object'?this.autoLoad:{url:this.autoLoad});}});L5.reg('iframepanel',L5.ux.ManagedIframePanel);L5.ux.ManagedIframePortlet=L5.extend(L5.ux.ManagedIframePanel,{anchor:'100%',frame:true,collapseEl:'bwrap',collapsible:true,draggable:true,cls:'x-portlet'});L5.reg('iframeportlet',L5.ux.ManagedIframePortlet);L5.apply(L5.Element.prototype,{setVisible:function(visible,animate){if(!animate||!L5.lib.Anim){if(this.visibilityMode==L5.Element.DISPLAY){this.setDisplayed(visible);}else if(this.visibilityMode==L5.Element.VISIBILITY){this.fixDisplay();this.dom.style.visibility=visible?"visible":"hidden";}else{this[visible?'removeClass':'addClass'](String(this.visibilityMode));}}else{var dom=this.dom;var visMode=this.visibilityMode;if(visible){this.setOpacity(.01);this.setVisible(true);}
this.anim({opacity:{to:(visible?1:0)}},this.preanim(arguments,1),null,.35,'easeIn',function(){if(!visible){if(visMode==L5.Element.DISPLAY){dom.style.display="none";}else if(visMode==L5.Element.VISIBILITY){dom.style.visibility="hidden";}else{L5.get(dom).addClass(String(visMode));}
L5.get(dom).setOpacity(1);}});}
return this;},isVisible:function(deep){var vis=!(this.getStyle("visibility")=="hidden"||this.getStyle("display")=="none"||this.hasClass(this.visibilityMode));if(deep!==true||!vis){return vis;}
var p=this.dom.parentNode;while(p&&p.tagName.toLowerCase()!="body"){if(!L5.fly(p,'_isVisible').isVisible()){return false;}
p=p.parentNode;}
return true;}});L5.onReady(function(){var CSS=L5.util.CSS,rules=[];CSS.getRule('.x-managed-iframe')||(rules.push('.x-managed-iframe {height:100%;width:100%;overflow:auto;}'));CSS.getRule('.x-managed-iframe-mask')||(rules.push('.x-managed-iframe-mask{width:100%;height:100%;position:relative;}'));if(!CSS.getRule('.x-frame-shim')){rules.push('.x-frame-shim {z-index:8500;position:absolute;top:0px;left:0px;background:transparent!important;overflow:hidden;display:none;}');rules.push('.x-frame-shim-on{width:100%;height:100%;display:block;zoom:1;}');rules.push('.ext-ie6 .x-frame-shim{margin-left:5px;margin-top:3px;}');}
CSS.getRule('.x-hide-nosize')||(rules.push('.x-hide-nosize,.x-hide-nosize *{height:0px!important;width:0px!important;border:none;}'));if(!!rules.length){CSS.createStyleSheet(rules.join(' '));}});})();

L5.DataPilot=function(config){config=config||{};this.path=L5.webPath+"/skins/images/";L5.apply(this,config);this.dataset=L5.DatasetMgr.lookup(config.dataset);this.id=config.id;this.addEvents("turnFirst","prevPage","movePrev","moveNext","nextPage","turnLast");L5.DataPilot.superclass.constructor.call(this);};L5.extend(L5.DataPilot,L5.BoxComponent,{firstRecordText:"First Record",prevRecordText:"Previous Record",nextRecordText:"Next Record",prevPageText:"Previous Page",nextPageText:"Next Page",lastRecordText:"Last Record",autoCreate:{html:'<table class="DataPilot" cellspacing="1" cellpadding="0"><tr></tr></table>'},onRender:function(ct,position){L5.DataPilot.superclass.onRender.call(this,ct,position);this.el=ct.createChild(L5.apply({id:this.id},this.autoCreate),position);this.tr=this.el.child("tr",true);if(!this.imgTemplate){if(!L5.DataPilot.imgButtonTemplate){L5.DataPilot.imgButtonTemplate=new L5.Template('<td><button class="Button" title="{0}" style="padding-left: 2px; padding-right: 2px;"><table><tbody><tr><td><img src="{1}"/></td></tr></tbody></table></button></td>');}
this.imgTemplate=L5.DataPilot.imgButtonTemplate;}
var targs=[this.firstRecordText,this.path+"move_first.gif"];this.turnFirstEl=this.imgTemplate.append(this.tr,targs,true);targs=[this.prevPageText,this.path+"prev_page.gif"];this.prevPageEl=this.imgTemplate.append(this.tr,targs,true);targs=[this.prevRecordText,this.path+"move_prev.gif"];this.movePrevEl=this.imgTemplate.append(this.tr,targs,true);targs=[this.nextRecordText,this.path+"move_next.gif"];this.moveNextEl=this.imgTemplate.append(this.tr,targs,true);targs=[this.nextPageText,this.path+"next_page.gif"];this.nextPageEl=this.imgTemplate.append(this.tr,targs,true);targs=[this.lastRecordText,this.path+"move_last.gif"];this.turnLastEl=this.imgTemplate.append(this.tr,targs,true);},afterRender:function(){this.add.apply(this,this.items);this.turnFirstEl.first().on("click",this.turnFirst,this);this.prevPageEl.first().on("click",this.prevPage,this);this.movePrevEl.first().on("click",this.movePrev,this);this.moveNextEl.first().on("click",this.moveNext,this);this.nextPageEl.first().on("click",this.nextPage,this);this.turnLastEl.first().on("click",this.turnLast,this);},add:function(){var a=arguments,l=a.length;for(var i=0;i<l;i++){var el=a[i];this.addButton(el);}},addButton:function(config){if(!this.butTemplate){if(!L5.DataPilot.buttonTemplate){L5.DataPilot.buttonTemplate=new L5.Template('<td><button class="Button" title="{0}" style="padding-left: 3px; padding-right: 3px;">{0}</button></td>');}
this.butTemplate=L5.DataPilot.buttonTemplate;}
var button=this.butTemplate.append(this.tr,[config.text],true);if(config.handler!=null)
button.first().on("click",config.handler,this);},nextBlock:function(){var td=document.createElement("td");this.tr.appendChild(td);return td;},turnFirst:function(){this.dataset.turnFirst();this.fireEvent("turnFirst",this,this.dataset);},turnLast:function(){this.dataset.turnLast();this.fireEvent("turnLast",this,this.dataset);},moveNext:function(){this.dataset.moveNext();this.fireEvent("moveNext",this,this.dataset);},movePrev:function(){this.dataset.movePrev();this.fireEvent("movePrev",this,this.dataset);},nextPage:function(){this.dataset.turnNext();this.fireEvent("nextPage",this,this.dataset);},prevPage:function(){this.dataset.turnPrev();this.fireEvent("prevPage",this,this.dataset);}});L5.reg('DataPilot',L5.DataPilot);

L5.TabCloseMenu=L5.extend(L5.TabPanel,{constructor:function(config){L5.apply(this,config,{closeTabText:"Close Tab",closeOtherTabsText:"Close Other Tabs",closeTabIconCls:"",closeOtherTabsIconCls:""});},init:function(tp){var tabs=tp,menu,ctxItem;tabs.on("contextmenu",function(ts,item,e){var self=this;if(L5.isEmpty(menu)){menu=new L5.menu.Menu({listeners:{show:function(el){el.items.items[0].setText(String.format(self.closeTabText,ctxItem.title));}},items:[{id:tabs.id+"-close",text:this.closeTabText,iconCls:this.closeTabIconCls,handler:function(){tabs.closeTab?tabs.closeTab(ctxItem):tabs.remove(ctxItem);}},{id:tabs.id+"-close-others",text:this.closeOtherTabsText,iconCls:this.closeOtherTabsIconCls,handler:function(){tabs.items.each(function(item){if(item.closable&&item!=ctxItem){tabs.closeTab?tabs.closeTab(item):tabs.remove(item);}});}}]});}
ctxItem=item;var items=menu.items,disableOthers=true;items.get(tabs.id+"-close").setDisabled(!item.closable);tabs.items.each(function(){if(this!=item&&this.closable){disableOthers=false;return false;}});items.get(tabs.id+"-close-others").setDisabled(disableOthers);menu.showAt(e.getPoint());},this);}});if(typeof Sys!=="undefined"){Sys.Application.notifyScriptLoaded();}

L5.ux.FloatPanel=L5.extend(L5.Panel,{width:300,height:200,autoScroll:false,location:"top",floatDivCls:"l-floatpanel-imgdiv",allowDomMove:false,initComponent:function(){L5.ux.FloatPanel.superclass.initComponent.call(this);},onRender:function(ct,position){this.renderDom=document.body;if(this.location=="right"){this.floatDivCls=this.floatDivCls+"-right";this.topPos=this.renderDom.clientHeight/3;this.rightPos=0;}else if(this.location=="top"){this.floatDivCls=this.floatDivCls+"-top";this.topPos=0;this.rightPos=this.renderDom.clientWidth/20;}
if(!this.el){var floatParentDiv=ct.createChild({id:this.id+'_floatParentDiv',style:'position:absolute;right:'+this.rightPos+';top:'+this.topPos+';',cls:this.float_parent_div},position);var floatMeumDiv=floatParentDiv.createChild({id:this.id+'_floatMeumDiv',style:'position:relative;overflow:hidden;z-index:50px;',cls:this.floatDivCls});floatMeumDiv=floatMeumDiv.dom;if(this.location=="right"){floatMeumDiv.style.width="15"+"px";floatMeumDiv.style.height="200"+"px";}else if(this.location=="top"){floatMeumDiv.style.width="125"+"px";floatMeumDiv.style.height="15"+"px";}
this.el=floatParentDiv.createChild({id:this.id,cls:this.baseCls});this.floatMeumDiv=floatMeumDiv;this.floatPanelDom=this.el.dom;}
L5.ux.FloatPanel.superclass.onRender.call(this,L5.get(this.renderDom),position);},afterRender:function(){L5.ux.FloatPanel.superclass.afterRender.call(this);this.initEvents();if(typeof(HTMLElement)!="undefined"){HTMLElement.prototype.contains=function(obj){while(obj!=null&&typeof(obj.tagName)!="undefind"){if(obj==this)return true;obj=obj.parentNode;}
return false;};}
this.floatPanelDom.style.display="none";},initEvents:function(){L5.ux.FloatPanel.superclass.initEvents.call(this);var renderDom=this.renderDom;if(L5.get(renderDom)==L5.get(document.body)){renderDom=window;}
L5.EventManager.on(renderDom,'scroll',this.syncScroll,this);L5.get(this.floatMeumDiv).on('mouseover',this.show,this);this.el.on('mouseout',this.hide,this);},beforeDestroy:function(){L5.destroy(this.floatMeumDiv,this.floatPanelDom);L5.ux.FloatPanel.superclass.beforeDestroy.call(this);},hide:function(theEvent){if(this.fireEvent("beforehide",this)!==false){this.hidden=true;if(this.rendered){this.hideFloatButton(theEvent);}
this.fireEvent("hide",this);}
return this;},hideFloatButton:function(theEvent){if(theEvent){var browser=navigator.userAgent;if(browser.indexOf("Firefox")>0){if(this.floatPanelDom.contains(theEvent.relatedTarget)){return;}}
if(browser.indexOf("MSIE")>0||browser.indexOf("Presto")>=0){if(this.floatPanelDom.contains(event.toElement)){return;}}}
this.floatMeumDiv.style.display="block";this.floatPanelDom.style.display="none";},show:function(){if(this.fireEvent("beforeshow",this)!==false){this.hidden=false;if(this.autoRender){this.render(typeof this.autoRender=='boolean'?L5.getBody():this.autoRender);}
if(this.rendered){this.showFloatButton();}
this.fireEvent("show",this);}
return this;},setSize:function(w,h){this.width=w?w:this.width;this.height=h?h:this.height;L5.ux.FloatPanel.superclass.setSize.call(this,w,h);},showFloatButton:function(){this.floatMeumDiv.style.display="none";this.floatPanelDom.style.left="";this.floatPanelDom.style.display="block";var initScrollLeft=this.renderDom.scrollLeft||document.body.scrollLeft||window.pageXOffset||document.documentElement.scrollLeft||0;if(this.location=="right"){this.floatPanelDom.style.top=this.floatMeumDiv.style.posTop+20+"px";this.floatPanelDom.style.right=(this.rightPos-initScrollLeft)+"px";}else if(this.location=="top"){this.floatPanelDom.style.top=this.floatMeumDiv.style.posTop+"px";this.floatPanelDom.style.right=(this.rightPos-initScrollLeft)+"px";}
this.floatPanelDom.style.position="relative";},syncScroll:function(){if(this.floatMeumDiv!=null){var scrollY=this.renderDom.scrollTop||document.body.scrollTop||window.pageYOffset||document.documentElement.scrollTop||0;var scrollX=this.renderDom.scrollLeft||document.body.scrollLeft||window.pageXOffset||document.documentElement.scrollLeft||0;if(this.floatMeumDiv.style.top=="")
this.floatMeumDiv.style.top=0+"px";this.floatMeumDiv.style.top=scrollY+"px";if(this.floatPanelDom.style.top=="")
this.floatPanelDom.style.top=0+"px";this.floatPanelDom.style.top=scrollY+"px";if(this.floatMeumDiv.style.left=="")
this.floatMeumDiv.style.left=0+"px";this.floatMeumDiv.style.left=scrollX+"px";if(this.floatPanelDom.style.left=="")
this.floatPanelDom.style.left=0+"px";this.floatPanelDom.style.left=scrollX+"px";}}});L5.reg('floatpanel',L5.ux.FloatPanel);

L5.ux.MuiltLineToolBar=function(config,colCount){this.colCount=colCount;L5.ux.MuiltLineToolBar.superclass.constructor.call(this,config);};(function(){var T=L5.ux.MuiltLineToolBar;L5.extend(T,L5.Toolbar,{onRender:function(ct,position){T.superclass.onRender.call(this,ct,position);this.tbody=this.el.child("tbody",true);this.createItemIndex=0;},nextBlock:function(){var index=this.createItemIndex++;if(index%this.colCount==0){this.tr=document.createElement("tr");this.tbody.appendChild(this.tr);}
var td=document.createElement("td");this.tr.appendChild(td);return td;},onDestroy:function(){T.superclass.onDestroy.call(this);if(this.rendered){L5.Element.uncache(this.tbody);}},insertButton:function(index,item){L5.Msg.showMsg(L5.sysAlert?L5.sysAlert:"System Alert",L5.noMethodError?L5.noMethodError:"This class does not support this method.");}});L5.reg('muiltlinetoolbar',L5.ux.MuiltLineToolBar);})();

L5.ux.FloatMuiltLineToolBar=function(config){this.initFloatBar(config);}
L5.ux.FloatMuiltLineToolBar.prototype={floatPanel:{},muiltLineBar:{},initFloatBar:function(config){L5.apply(this,config);config.bodyStyle="border:0px;filter:alpha(opacity=85);backgroundColor:#d0def0;"
this.floatPanel=new L5.ux.FloatPanel(config);this.floatPanel.on("show",this.adjustSize,this);if(this.floatPanel){if(L5.isArray(this.mtbar)){this.muiltLineBar=new L5.ux.MuiltLineToolBar(this.mtbar,this.colCount);}
this.muiltLineBar.render(this.floatPanel.body);this.muiltLineBar.el.dom.childNodes[0].className+=" l-toolbar-float";this.muiltLineBar.el.dom.style.background="";}},adjustSize:function(){var size=L5.get(this.muiltLineBar.tbody).getSize();this.floatPanel.setSize(this.width?undefined:size.width+2,this.height?undefined:size.height+2);}}
L5.reg('floatmuiltlinebar',L5.ux.FloatMuiltLineToolBar);
